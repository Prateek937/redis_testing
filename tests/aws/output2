cluster Size: 1
------------------------------------------------------------------

[34m******* init  *******[0m

[33m### CREATING CLUSTER OF 3 NODES  172.31.5.140:6379 172.31.5.202:6379 172.31.5.105:6379 ###
[0m
> redis-cli --cluster create  172.31.5.140:6379 172.31.5.202:6379 172.31.5.105:6379 --cluster-replicas 0 --cluster-yes | grep OK | awk '{ gsub(/[[0-9;]*m/, ""); print }'
assertion error.
 {
  keys1: 0,
  keys2: 0,
  keys: 0,
  slots1: 0,
  slots2: 16384,
  nodes1: 1,
  nodes2: 3,
  nodes: 2
}
precheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 0 keys | 0 slots | 0 slaves.
[OK] 0 keys in 1 masters.
0.00 keys per slot on average.

postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 0 keys | 5461 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 0 keys | 5461 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 0 keys | 5462 slots | 0 slaves.
[OK] 0 keys in 3 masters.
0.00 keys per slot on average.
 
total slots: 16384
cluster created successfully

[34m******* init  completed ******* [0m 

------------------------------------------------------------------

[34m******* write , 500000 *******[0m

[33m### WRITING 500000 KEYS ###
[0m
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 166652 keys | 5461 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 166609 keys | 5461 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 166739 keys | 5462 slots | 0 slaves.
[OK] 500000 keys in 3 masters.
30.52 keys per slot on average.
 
total slots: 16384
0.5M keys written successfully

[34m******* write , 500000 completed ******* [0m 

------------------------------------------------------------------

[34m******* resize , 8 *******[0m

{ clusterSize: 3 }
[33m### ADDING 172.31.5.54:6379 NODE TO CLUSTER ###
[0m
> redis-cli --cluster add-node 172.31.5.54:6379 172.31.5.140:6379 | awk '{ gsub(/[[0-9;]*m/, ""); print }'
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 166652 keys | 5461 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 166609 keys | 5461 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 166739 keys | 5462 slots | 0 slaves.
[OK] 500000 keys in 4 masters.
30.52 keys per slot on average.
 
total slots: 16384
node added successfully
waiting... 2 1 


[33m### ADDING 172.31.5.174:6379 NODE TO CLUSTER ###
[0m
> redis-cli --cluster add-node 172.31.5.174:6379 172.31.5.140:6379 | awk '{ gsub(/[[0-9;]*m/, ""); print }'
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 166652 keys | 5461 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 166739 keys | 5462 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 166609 keys | 5461 slots | 0 slaves.
[OK] 500000 keys in 5 masters.
30.52 keys per slot on average.
 
total slots: 16384
node added successfully
waiting... 2 1 


[33m### ADDING 172.31.5.145:6379 NODE TO CLUSTER ###
[0m
> redis-cli --cluster add-node 172.31.5.145:6379 172.31.5.140:6379 | awk '{ gsub(/[[0-9;]*m/, ""); print }'
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 166652 keys | 5461 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 166739 keys | 5462 slots | 0 slaves.
172.31.5.145:6379 (d611c8f1...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 166609 keys | 5461 slots | 0 slaves.
[OK] 500000 keys in 6 masters.
30.52 keys per slot on average.
 
total slots: 16384
node added successfully
waiting... 2 1 


[33m### ADDING 172.31.5.233:6379 NODE TO CLUSTER ###
[0m
> redis-cli --cluster add-node 172.31.5.233:6379 172.31.5.140:6379 | awk '{ gsub(/[[0-9;]*m/, ""); print }'
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 166652 keys | 5461 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 166739 keys | 5462 slots | 0 slaves.
172.31.5.145:6379 (d611c8f1...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 166609 keys | 5461 slots | 0 slaves.
172.31.5.233:6379 (250399ba...) -> 0 keys | 0 slots | 0 slaves.
[OK] 500000 keys in 7 masters.
30.52 keys per slot on average.
 
total slots: 16384
node added successfully
waiting... 2 1 


[33m### ADDING 172.31.5.119:6379 NODE TO CLUSTER ###
[0m
> redis-cli --cluster add-node 172.31.5.119:6379 172.31.5.140:6379 | awk '{ gsub(/[[0-9;]*m/, ""); print }'
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 166652 keys | 5461 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.119:6379 (5b270992...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 166739 keys | 5462 slots | 0 slaves.
172.31.5.145:6379 (d611c8f1...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 166609 keys | 5461 slots | 0 slaves.
172.31.5.233:6379 (250399ba...) -> 0 keys | 0 slots | 0 slaves.
[OK] 500000 keys in 8 masters.
30.52 keys per slot on average.
 
total slots: 16384
node added successfully
waiting... 2 1 


waiting... 10 9 8 7 6 5 4 3 2 1 


[33m### REBALANCING CLUSTER ON 172.31.5.54:6379 ###
[0m
> redis-cli --cluster rebalance 172.31.5.54:6379 --cluster-use-empty-masters | grep -i Rebalancing
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 62529 keys | 2048 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 62483 keys | 2048 slots | 0 slaves.
172.31.5.119:6379 (5b270992...) -> 62517 keys | 2048 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 62439 keys | 2048 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 62497 keys | 2048 slots | 0 slaves.
172.31.5.145:6379 (d611c8f1...) -> 62553 keys | 2048 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 62483 keys | 2048 slots | 0 slaves.
172.31.5.233:6379 (250399ba...) -> 62499 keys | 2048 slots | 0 slaves.
[OK] 500000 keys in 8 masters.
30.52 keys per slot on average.
 
total slots: 16384
>>> Rebalancing across 8 nodes. Total weight = 8.00



[34m******* resize , 8 completed ******* [0m 

------------------------------------------------------------------

[34m******* write , 500000 *******[0m

[33m### WRITING 500000 KEYS ###
[0m
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 125043 keys | 2048 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 124982 keys | 2048 slots | 0 slaves.
172.31.5.119:6379 (5b270992...) -> 125034 keys | 2048 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 124864 keys | 2048 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 124993 keys | 2048 slots | 0 slaves.
172.31.5.145:6379 (d611c8f1...) -> 125145 keys | 2048 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 124966 keys | 2048 slots | 0 slaves.
172.31.5.233:6379 (250399ba...) -> 124973 keys | 2048 slots | 0 slaves.
[OK] 1000000 keys in 8 masters.
61.04 keys per slot on average.
 
total slots: 16384
0.5M keys written successfully

[34m******* write , 500000 completed ******* [0m 

------------------------------------------------------------------

[34m******* resize , 3 *******[0m

{ clusterSize: 8 }
[33m### REBALANCING CLUSTER ON 172.31.5.119:6379 ###
[0m
> redis-cli --cluster rebalance 172.31.5.119:6379 --cluster-use-empty-masters | grep -i Rebalancing
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 125043 keys | 2048 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 124982 keys | 2048 slots | 0 slaves.
172.31.5.119:6379 (5b270992...) -> 125034 keys | 2048 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 124864 keys | 2048 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 124993 keys | 2048 slots | 0 slaves.
172.31.5.145:6379 (d611c8f1...) -> 125145 keys | 2048 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 124966 keys | 2048 slots | 0 slaves.
172.31.5.233:6379 (250399ba...) -> 124973 keys | 2048 slots | 0 slaves.
[OK] 1000000 keys in 8 masters.
61.04 keys per slot on average.
 
total slots: 16384
*** No rebalancing needed! All nodes are within the 2.00% threshold.


{ distribution: [ 683, 683, 682 ] }
[33m### RESHARDING FROM 172.31.5.119 TO 172.31.5.140 ###
[0m
{ reshardFrom: '172.31.5.119', reshardTo: '172.31.5.140', slots: 683 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 166875 keys | 2731 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 124982 keys | 2048 slots | 0 slaves.
172.31.5.119:6379 (5b270992...) -> 83202 keys | 1365 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 124864 keys | 2048 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 124993 keys | 2048 slots | 0 slaves.
172.31.5.145:6379 (d611c8f1...) -> 125145 keys | 2048 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 124966 keys | 2048 slots | 0 slaves.
172.31.5.233:6379 (250399ba...) -> 124973 keys | 2048 slots | 0 slaves.
[OK] 1000000 keys in 8 masters.
61.04 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.119 TO 172.31.5.202 ###
[0m
{ reshardFrom: '172.31.5.119', reshardTo: '172.31.5.202', slots: 683 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 166875 keys | 2731 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 124982 keys | 2048 slots | 0 slaves.
172.31.5.119:6379 (5b270992...) -> 41498 keys | 682 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 124864 keys | 2048 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 166697 keys | 2731 slots | 0 slaves.
172.31.5.145:6379 (d611c8f1...) -> 125145 keys | 2048 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 124966 keys | 2048 slots | 0 slaves.
172.31.5.233:6379 (250399ba...) -> 124973 keys | 2048 slots | 0 slaves.
[OK] 1000000 keys in 8 masters.
61.04 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.119 TO 172.31.5.105 ###
[0m
{ reshardFrom: '172.31.5.119', reshardTo: '172.31.5.105', slots: 682 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 166875 keys | 2731 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 124982 keys | 2048 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 124864 keys | 2048 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 166697 keys | 2731 slots | 0 slaves.
172.31.5.145:6379 (d611c8f1...) -> 125145 keys | 2048 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 166464 keys | 2730 slots | 1 slaves.
172.31.5.233:6379 (250399ba...) -> 124973 keys | 2048 slots | 0 slaves.
[OK] 1000000 keys in 7 masters.
61.04 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### REMOVING 172.31.5.119:6379 FROM CLUSTER ###
[0m
> redis-cli --cluster del-node 172.31.5.119:6379 5b2709925891bf338ba0ae4dd886cb39ea357987
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 166875 keys | 2731 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 124982 keys | 2048 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 124864 keys | 2048 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 166697 keys | 2731 slots | 0 slaves.
172.31.5.145:6379 (d611c8f1...) -> 125145 keys | 2048 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 166464 keys | 2730 slots | 0 slaves.
172.31.5.233:6379 (250399ba...) -> 124973 keys | 2048 slots | 0 slaves.
[OK] 1000000 keys in 7 masters.
61.04 keys per slot on average.
 
total slots: 16384
Removing node 5b2709925891bf338ba0ae4dd886cb39ea357987 from cluster 172.31.5.119:6379
Sending CLUSTER FORGET messages to the cluster...
Sending CLUSTER RESET SOFT to the deleted node.
{ distribution: [ 683, 683, 682 ] }
[33m### RESHARDING FROM 172.31.5.233 TO 172.31.5.202 ###
[0m
{ reshardFrom: '172.31.5.233', reshardTo: '172.31.5.202', slots: 683 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 166875 keys | 2731 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 124982 keys | 2048 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 124864 keys | 2048 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 208401 keys | 3414 slots | 0 slaves.
172.31.5.145:6379 (d611c8f1...) -> 125145 keys | 2048 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 166464 keys | 2730 slots | 0 slaves.
172.31.5.233:6379 (250399ba...) -> 83269 keys | 1365 slots | 0 slaves.
[OK] 1000000 keys in 7 masters.
61.04 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.233 TO 172.31.5.105 ###
[0m
{ reshardFrom: '172.31.5.233', reshardTo: '172.31.5.105', slots: 683 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 166875 keys | 2731 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 124982 keys | 2048 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 124864 keys | 2048 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 208401 keys | 3414 slots | 0 slaves.
172.31.5.145:6379 (d611c8f1...) -> 125145 keys | 2048 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 208271 keys | 3413 slots | 0 slaves.
172.31.5.233:6379 (250399ba...) -> 41462 keys | 682 slots | 0 slaves.
[OK] 1000000 keys in 7 masters.
61.04 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.233 TO 172.31.5.140 ###
[0m
{ reshardFrom: '172.31.5.233', reshardTo: '172.31.5.140', slots: 682 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 208337 keys | 3413 slots | 1 slaves.
172.31.5.54:6379 (76360353...) -> 124982 keys | 2048 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 124864 keys | 2048 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 208401 keys | 3414 slots | 0 slaves.
172.31.5.145:6379 (d611c8f1...) -> 125145 keys | 2048 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 208271 keys | 3413 slots | 0 slaves.
[OK] 1000000 keys in 6 masters.
61.04 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### REMOVING 172.31.5.233:6379 FROM CLUSTER ###
[0m
> redis-cli --cluster del-node 172.31.5.233:6379 250399ba29619b7a1a6d2ed08a6fc58a65b395e2
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 208337 keys | 3413 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 124982 keys | 2048 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 124864 keys | 2048 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 208401 keys | 3414 slots | 0 slaves.
172.31.5.145:6379 (d611c8f1...) -> 125145 keys | 2048 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 208271 keys | 3413 slots | 0 slaves.
[OK] 1000000 keys in 6 masters.
61.04 keys per slot on average.
 
total slots: 16384
Removing node 250399ba29619b7a1a6d2ed08a6fc58a65b395e2 from cluster 172.31.5.233:6379
Sending CLUSTER FORGET messages to the cluster...
Sending CLUSTER RESET SOFT to the deleted node.
{ distribution: [ 683, 683, 682 ] }
[33m### RESHARDING FROM 172.31.5.145 TO 172.31.5.105 ###
[0m
{ reshardFrom: '172.31.5.145', reshardTo: '172.31.5.105', slots: 683 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 208337 keys | 3413 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 124982 keys | 2048 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 124864 keys | 2048 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 208401 keys | 3414 slots | 0 slaves.
172.31.5.145:6379 (d611c8f1...) -> 83552 keys | 1365 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 249864 keys | 4096 slots | 0 slaves.
[OK] 1000000 keys in 6 masters.
61.04 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.145 TO 172.31.5.140 ###
[0m
{ reshardFrom: '172.31.5.145', reshardTo: '172.31.5.140', slots: 683 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 250119 keys | 4096 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 124982 keys | 2048 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 124864 keys | 2048 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 208401 keys | 3414 slots | 0 slaves.
172.31.5.145:6379 (d611c8f1...) -> 41770 keys | 682 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 249864 keys | 4096 slots | 0 slaves.
[OK] 1000000 keys in 6 masters.
61.04 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.145 TO 172.31.5.202 ###
[0m
{ reshardFrom: '172.31.5.145', reshardTo: '172.31.5.202', slots: 682 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 250119 keys | 4096 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 124982 keys | 2048 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 124864 keys | 2048 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 250171 keys | 4096 slots | 1 slaves.
172.31.5.105:6379 (9d4816cf...) -> 249864 keys | 4096 slots | 0 slaves.
[OK] 1000000 keys in 5 masters.
61.04 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### REMOVING 172.31.5.145:6379 FROM CLUSTER ###
[0m
> redis-cli --cluster del-node 172.31.5.145:6379 d611c8f107b68363148c7a7021067200ee2a4a4a
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 250119 keys | 4096 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 124982 keys | 2048 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 124864 keys | 2048 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 250171 keys | 4096 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 249864 keys | 4096 slots | 0 slaves.
[OK] 1000000 keys in 5 masters.
61.04 keys per slot on average.
 
total slots: 16384
Removing node d611c8f107b68363148c7a7021067200ee2a4a4a from cluster 172.31.5.145:6379
Sending CLUSTER FORGET messages to the cluster...
Sending CLUSTER RESET SOFT to the deleted node.
{ distribution: [ 683, 683, 682 ] }
[33m### RESHARDING FROM 172.31.5.174 TO 172.31.5.140 ###
[0m
{ reshardFrom: '172.31.5.174', reshardTo: '172.31.5.140', slots: 683 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 291796 keys | 4779 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 124982 keys | 2048 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 83187 keys | 1365 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 250171 keys | 4096 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 249864 keys | 4096 slots | 0 slaves.
[OK] 1000000 keys in 5 masters.
61.04 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.174 TO 172.31.5.202 ###
[0m
{ reshardFrom: '172.31.5.174', reshardTo: '172.31.5.202', slots: 683 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 291796 keys | 4779 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 124982 keys | 2048 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 41516 keys | 682 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 291842 keys | 4779 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 249864 keys | 4096 slots | 0 slaves.
[OK] 1000000 keys in 5 masters.
61.04 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.174 TO 172.31.5.105 ###
[0m
{ reshardFrom: '172.31.5.174', reshardTo: '172.31.5.105', slots: 682 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 291796 keys | 4779 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 124982 keys | 2048 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 291842 keys | 4779 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 291380 keys | 4778 slots | 1 slaves.
[OK] 1000000 keys in 4 masters.
61.04 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### REMOVING 172.31.5.174:6379 FROM CLUSTER ###
[0m
> redis-cli --cluster del-node 172.31.5.174:6379 eb78bad30480efb75d2dd8edc1693b69278a4bf3
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 291796 keys | 4779 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 124982 keys | 2048 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 291842 keys | 4779 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 291380 keys | 4778 slots | 0 slaves.
[OK] 1000000 keys in 4 masters.
61.04 keys per slot on average.
 
total slots: 16384
Removing node eb78bad30480efb75d2dd8edc1693b69278a4bf3 from cluster 172.31.5.174:6379
Sending CLUSTER FORGET messages to the cluster...
Sending CLUSTER RESET SOFT to the deleted node.
{ distribution: [ 683, 683, 682 ] }
[33m### RESHARDING FROM 172.31.5.54 TO 172.31.5.202 ###
[0m
{ reshardFrom: '172.31.5.54', reshardTo: '172.31.5.202', slots: 683 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 291796 keys | 4779 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 83164 keys | 1365 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 333660 keys | 5462 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 291380 keys | 4778 slots | 0 slaves.
[OK] 1000000 keys in 4 masters.
61.04 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.54 TO 172.31.5.105 ###
[0m
{ reshardFrom: '172.31.5.54', reshardTo: '172.31.5.105', slots: 683 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 291796 keys | 4779 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 41605 keys | 682 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 333660 keys | 5462 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 332939 keys | 5461 slots | 0 slaves.
[OK] 1000000 keys in 4 masters.
61.04 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.54 TO 172.31.5.140 ###
[0m
{ reshardFrom: '172.31.5.54', reshardTo: '172.31.5.140', slots: 682 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 333401 keys | 5461 slots | 1 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 333660 keys | 5462 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 332939 keys | 5461 slots | 0 slaves.
[OK] 1000000 keys in 3 masters.
61.04 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### REMOVING 172.31.5.54:6379 FROM CLUSTER ###
[0m
> redis-cli --cluster del-node 172.31.5.54:6379 763603530a9c3f684038efa73d48c1e19edd2ed9
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 333401 keys | 5461 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 333660 keys | 5462 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 332939 keys | 5461 slots | 0 slaves.
[OK] 1000000 keys in 3 masters.
61.04 keys per slot on average.
 
total slots: 16384
Removing node 763603530a9c3f684038efa73d48c1e19edd2ed9 from cluster 172.31.5.54:6379
Sending CLUSTER FORGET messages to the cluster...
Sending CLUSTER RESET SOFT to the deleted node.
[33m### REBALANCING CLUSTER ON 172.31.5.140:6379 ###
[0m
> redis-cli --cluster rebalance 172.31.5.140:6379 --cluster-use-empty-masters | grep -i Rebalancing
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 333401 keys | 5461 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 333660 keys | 5462 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 332939 keys | 5461 slots | 0 slaves.
[OK] 1000000 keys in 3 masters.
61.04 keys per slot on average.
 
total slots: 16384
*** No rebalancing needed! All nodes are within the 2.00% threshold.


waiting... 65 64 63 62 61 60 59 58 57 56 55 54 53 52 51 50 49 48 47 46 45 44 43 42 41 40 39 38 37 36 35 34 33 32 31 30 29 28 27 26 25 24 23 22 21 20 19 18 17 16 15 14 13 12 11 10 9 8 7 6 5 4 3 2 1 



[34m******* resize , 3 completed ******* [0m 

------------------------------------------------------------------

[34m******* write , 500000 *******[0m

[33m### WRITING 500000 KEYS ###
[0m
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 500122 keys | 5461 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 500535 keys | 5462 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 499343 keys | 5461 slots | 0 slaves.
[OK] 1500000 keys in 3 masters.
91.55 keys per slot on average.
 
total slots: 16384
0.5M keys written successfully

[34m******* write , 500000 completed ******* [0m 

------------------------------------------------------------------

[34m******* resize , 8 *******[0m

{ clusterSize: 3 }
[33m### ADDING 172.31.5.54:6379 NODE TO CLUSTER ###
[0m
> redis-cli --cluster add-node 172.31.5.54:6379 172.31.5.140:6379 | awk '{ gsub(/[[0-9;]*m/, ""); print }'
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 500122 keys | 5461 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 500535 keys | 5462 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 499343 keys | 5461 slots | 0 slaves.
[OK] 1500000 keys in 4 masters.
91.55 keys per slot on average.
 
total slots: 16384
node added successfully
waiting... 2 1 


[33m### ADDING 172.31.5.174:6379 NODE TO CLUSTER ###
[0m
> redis-cli --cluster add-node 172.31.5.174:6379 172.31.5.140:6379 | awk '{ gsub(/[[0-9;]*m/, ""); print }'
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 500122 keys | 5461 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 500535 keys | 5462 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 499343 keys | 5461 slots | 0 slaves.
[OK] 1500000 keys in 5 masters.
91.55 keys per slot on average.
 
total slots: 16384
node added successfully
waiting... 2 1 


[33m### ADDING 172.31.5.145:6379 NODE TO CLUSTER ###
[0m
> redis-cli --cluster add-node 172.31.5.145:6379 172.31.5.140:6379 | awk '{ gsub(/[[0-9;]*m/, ""); print }'
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 500122 keys | 5461 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 500535 keys | 5462 slots | 0 slaves.
172.31.5.145:6379 (d611c8f1...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 499343 keys | 5461 slots | 0 slaves.
[OK] 1500000 keys in 6 masters.
91.55 keys per slot on average.
 
total slots: 16384
node added successfully
waiting... 2 1 


[33m### ADDING 172.31.5.233:6379 NODE TO CLUSTER ###
[0m
> redis-cli --cluster add-node 172.31.5.233:6379 172.31.5.140:6379 | awk '{ gsub(/[[0-9;]*m/, ""); print }'
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 500122 keys | 5461 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 500535 keys | 5462 slots | 0 slaves.
172.31.5.145:6379 (d611c8f1...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 499343 keys | 5461 slots | 0 slaves.
172.31.5.233:6379 (250399ba...) -> 0 keys | 0 slots | 0 slaves.
[OK] 1500000 keys in 7 masters.
91.55 keys per slot on average.
 
total slots: 16384
node added successfully
waiting... 2 1 


[33m### ADDING 172.31.5.119:6379 NODE TO CLUSTER ###
[0m
> redis-cli --cluster add-node 172.31.5.119:6379 172.31.5.140:6379 | awk '{ gsub(/[[0-9;]*m/, ""); print }'
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 500122 keys | 5461 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.119:6379 (5b270992...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 500535 keys | 5462 slots | 0 slaves.
172.31.5.145:6379 (d611c8f1...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 499343 keys | 5461 slots | 0 slaves.
172.31.5.233:6379 (250399ba...) -> 0 keys | 0 slots | 0 slaves.
[OK] 1500000 keys in 8 masters.
91.55 keys per slot on average.
 
total slots: 16384
node added successfully
waiting... 2 1 


waiting... 10 9 8 7 6 5 4 3 2 1 


[33m### REBALANCING CLUSTER ON 172.31.5.54:6379 ###
[0m
> redis-cli --cluster rebalance 172.31.5.54:6379 --cluster-use-empty-masters | grep -i Rebalancing
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 187888 keys | 2048 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 187999 keys | 2048 slots | 0 slaves.
172.31.5.119:6379 (5b270992...) -> 186904 keys | 2048 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 187490 keys | 2048 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 187653 keys | 2048 slots | 0 slaves.
172.31.5.145:6379 (d611c8f1...) -> 187048 keys | 2048 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 187466 keys | 2048 slots | 0 slaves.
172.31.5.233:6379 (250399ba...) -> 187552 keys | 2048 slots | 0 slaves.
[OK] 1500000 keys in 8 masters.
91.55 keys per slot on average.
 
total slots: 16384
>>> Rebalancing across 8 nodes. Total weight = 8.00



[34m******* resize , 8 completed ******* [0m 

------------------------------------------------------------------

[34m******* write , 500000 *******[0m

[33m### WRITING 500000 KEYS ###
[0m
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 250541 keys | 2048 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 250683 keys | 2048 slots | 0 slaves.
172.31.5.119:6379 (5b270992...) -> 249153 keys | 2048 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 249969 keys | 2048 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 250246 keys | 2048 slots | 0 slaves.
172.31.5.145:6379 (d611c8f1...) -> 249353 keys | 2048 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 249966 keys | 2048 slots | 0 slaves.
172.31.5.233:6379 (250399ba...) -> 250089 keys | 2048 slots | 0 slaves.
[OK] 2000000 keys in 8 masters.
122.07 keys per slot on average.
 
total slots: 16384
0.5M keys written successfully

[34m******* write , 500000 completed ******* [0m 

------------------------------------------------------------------

[34m******* resize , 4 *******[0m

{ clusterSize: 8 }
[33m### REBALANCING CLUSTER ON 172.31.5.119:6379 ###
[0m
> redis-cli --cluster rebalance 172.31.5.119:6379 --cluster-use-empty-masters | grep -i Rebalancing
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 250541 keys | 2048 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 250683 keys | 2048 slots | 0 slaves.
172.31.5.119:6379 (5b270992...) -> 249153 keys | 2048 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 249969 keys | 2048 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 250246 keys | 2048 slots | 0 slaves.
172.31.5.145:6379 (d611c8f1...) -> 249353 keys | 2048 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 249966 keys | 2048 slots | 0 slaves.
172.31.5.233:6379 (250399ba...) -> 250089 keys | 2048 slots | 0 slaves.
[OK] 2000000 keys in 8 masters.
122.07 keys per slot on average.
 
total slots: 16384
*** No rebalancing needed! All nodes are within the 2.00% threshold.


{ distribution: [ 512, 512, 512, 512 ] }
[33m### RESHARDING FROM 172.31.5.119 TO 172.31.5.140 ###
[0m
{ reshardFrom: '172.31.5.119', reshardTo: '172.31.5.140', slots: 512 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 312589 keys | 2560 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 250683 keys | 2048 slots | 0 slaves.
172.31.5.119:6379 (5b270992...) -> 187105 keys | 1536 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 249969 keys | 2048 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 250246 keys | 2048 slots | 0 slaves.
172.31.5.145:6379 (d611c8f1...) -> 249353 keys | 2048 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 249966 keys | 2048 slots | 0 slaves.
172.31.5.233:6379 (250399ba...) -> 250089 keys | 2048 slots | 0 slaves.
[OK] 2000000 keys in 8 masters.
122.07 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.119 TO 172.31.5.202 ###
[0m
{ reshardFrom: '172.31.5.119', reshardTo: '172.31.5.202', slots: 512 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 312589 keys | 2560 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 250683 keys | 2048 slots | 0 slaves.
172.31.5.119:6379 (5b270992...) -> 124456 keys | 1024 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 249969 keys | 2048 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 312895 keys | 2560 slots | 0 slaves.
172.31.5.145:6379 (d611c8f1...) -> 249353 keys | 2048 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 249966 keys | 2048 slots | 0 slaves.
172.31.5.233:6379 (250399ba...) -> 250089 keys | 2048 slots | 0 slaves.
[OK] 2000000 keys in 8 masters.
122.07 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.119 TO 172.31.5.105 ###
[0m
{ reshardFrom: '172.31.5.119', reshardTo: '172.31.5.105', slots: 512 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 312589 keys | 2560 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 250683 keys | 2048 slots | 0 slaves.
172.31.5.119:6379 (5b270992...) -> 62096 keys | 512 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 249969 keys | 2048 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 312895 keys | 2560 slots | 0 slaves.
172.31.5.145:6379 (d611c8f1...) -> 249353 keys | 2048 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 312326 keys | 2560 slots | 0 slaves.
172.31.5.233:6379 (250399ba...) -> 250089 keys | 2048 slots | 0 slaves.
[OK] 2000000 keys in 8 masters.
122.07 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.119 TO 172.31.5.54 ###
[0m
{ reshardFrom: '172.31.5.119', reshardTo: '172.31.5.54', slots: 512 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 312589 keys | 2560 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 312779 keys | 2560 slots | 1 slaves.
172.31.5.174:6379 (eb78bad3...) -> 249969 keys | 2048 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 312895 keys | 2560 slots | 0 slaves.
172.31.5.145:6379 (d611c8f1...) -> 249353 keys | 2048 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 312326 keys | 2560 slots | 0 slaves.
172.31.5.233:6379 (250399ba...) -> 250089 keys | 2048 slots | 0 slaves.
[OK] 2000000 keys in 7 masters.
122.07 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### REMOVING 172.31.5.119:6379 FROM CLUSTER ###
[0m
> redis-cli --cluster del-node 172.31.5.119:6379 5b2709925891bf338ba0ae4dd886cb39ea357987
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 312589 keys | 2560 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 312779 keys | 2560 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 249969 keys | 2048 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 312895 keys | 2560 slots | 0 slaves.
172.31.5.145:6379 (d611c8f1...) -> 249353 keys | 2048 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 312326 keys | 2560 slots | 0 slaves.
172.31.5.233:6379 (250399ba...) -> 250089 keys | 2048 slots | 0 slaves.
[OK] 2000000 keys in 7 masters.
122.07 keys per slot on average.
 
total slots: 16384
Removing node 5b2709925891bf338ba0ae4dd886cb39ea357987 from cluster 172.31.5.119:6379
Sending CLUSTER FORGET messages to the cluster...
Sending CLUSTER RESET SOFT to the deleted node.
{ distribution: [ 512, 512, 512, 512 ] }
[33m### RESHARDING FROM 172.31.5.233 TO 172.31.5.202 ###
[0m
{ reshardFrom: '172.31.5.233', reshardTo: '172.31.5.202', slots: 512 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 312589 keys | 2560 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 312779 keys | 2560 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 249969 keys | 2048 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 375592 keys | 3072 slots | 0 slaves.
172.31.5.145:6379 (d611c8f1...) -> 249353 keys | 2048 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 312326 keys | 2560 slots | 0 slaves.
172.31.5.233:6379 (250399ba...) -> 187392 keys | 1536 slots | 0 slaves.
[OK] 2000000 keys in 7 masters.
122.07 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.233 TO 172.31.5.105 ###
[0m
{ reshardFrom: '172.31.5.233', reshardTo: '172.31.5.105', slots: 512 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 312589 keys | 2560 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 312779 keys | 2560 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 249969 keys | 2048 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 375592 keys | 3072 slots | 0 slaves.
172.31.5.145:6379 (d611c8f1...) -> 249353 keys | 2048 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 374615 keys | 3072 slots | 0 slaves.
172.31.5.233:6379 (250399ba...) -> 125103 keys | 1024 slots | 0 slaves.
[OK] 2000000 keys in 7 masters.
122.07 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.233 TO 172.31.5.54 ###
[0m
{ reshardFrom: '172.31.5.233', reshardTo: '172.31.5.54', slots: 512 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 312589 keys | 2560 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 375490 keys | 3072 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 249969 keys | 2048 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 375592 keys | 3072 slots | 0 slaves.
172.31.5.145:6379 (d611c8f1...) -> 249353 keys | 2048 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 374615 keys | 3072 slots | 0 slaves.
172.31.5.233:6379 (250399ba...) -> 62392 keys | 512 slots | 0 slaves.
[OK] 2000000 keys in 7 masters.
122.07 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.233 TO 172.31.5.140 ###
[0m
{ reshardFrom: '172.31.5.233', reshardTo: '172.31.5.140', slots: 512 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 374981 keys | 3072 slots | 1 slaves.
172.31.5.54:6379 (76360353...) -> 375490 keys | 3072 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 249969 keys | 2048 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 375592 keys | 3072 slots | 0 slaves.
172.31.5.145:6379 (d611c8f1...) -> 249353 keys | 2048 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 374615 keys | 3072 slots | 0 slaves.
[OK] 2000000 keys in 6 masters.
122.07 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### REMOVING 172.31.5.233:6379 FROM CLUSTER ###
[0m
> redis-cli --cluster del-node 172.31.5.233:6379 250399ba29619b7a1a6d2ed08a6fc58a65b395e2
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 374981 keys | 3072 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 375490 keys | 3072 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 249969 keys | 2048 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 375592 keys | 3072 slots | 0 slaves.
172.31.5.145:6379 (d611c8f1...) -> 249353 keys | 2048 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 374615 keys | 3072 slots | 0 slaves.
[OK] 2000000 keys in 6 masters.
122.07 keys per slot on average.
 
total slots: 16384
Removing node 250399ba29619b7a1a6d2ed08a6fc58a65b395e2 from cluster 172.31.5.233:6379
Sending CLUSTER FORGET messages to the cluster...
Sending CLUSTER RESET SOFT to the deleted node.
{ distribution: [ 512, 512, 512, 512 ] }
[33m### RESHARDING FROM 172.31.5.145 TO 172.31.5.105 ###
[0m
{ reshardFrom: '172.31.5.145', reshardTo: '172.31.5.105', slots: 512 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 374981 keys | 3072 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 375490 keys | 3072 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 249969 keys | 2048 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 375592 keys | 3072 slots | 0 slaves.
172.31.5.145:6379 (d611c8f1...) -> 187305 keys | 1536 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 436663 keys | 3584 slots | 0 slaves.
[OK] 2000000 keys in 6 masters.
122.07 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.145 TO 172.31.5.54 ###
[0m
{ reshardFrom: '172.31.5.145', reshardTo: '172.31.5.54', slots: 512 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 374981 keys | 3072 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 437806 keys | 3584 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 249969 keys | 2048 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 375592 keys | 3072 slots | 0 slaves.
172.31.5.145:6379 (d611c8f1...) -> 124989 keys | 1024 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 436663 keys | 3584 slots | 0 slaves.
[OK] 2000000 keys in 6 masters.
122.07 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.145 TO 172.31.5.140 ###
[0m
{ reshardFrom: '172.31.5.145', reshardTo: '172.31.5.140', slots: 512 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 437863 keys | 3584 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 437806 keys | 3584 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 249969 keys | 2048 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 375592 keys | 3072 slots | 0 slaves.
172.31.5.145:6379 (d611c8f1...) -> 62107 keys | 512 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 436663 keys | 3584 slots | 0 slaves.
[OK] 2000000 keys in 6 masters.
122.07 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.145 TO 172.31.5.202 ###
[0m
{ reshardFrom: '172.31.5.145', reshardTo: '172.31.5.202', slots: 512 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 437863 keys | 3584 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 437806 keys | 3584 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 249969 keys | 2048 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 437699 keys | 3584 slots | 1 slaves.
172.31.5.105:6379 (9d4816cf...) -> 436663 keys | 3584 slots | 0 slaves.
[OK] 2000000 keys in 5 masters.
122.07 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### REMOVING 172.31.5.145:6379 FROM CLUSTER ###
[0m
> redis-cli --cluster del-node 172.31.5.145:6379 d611c8f107b68363148c7a7021067200ee2a4a4a
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 437863 keys | 3584 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 437806 keys | 3584 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 249969 keys | 2048 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 437699 keys | 3584 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 436663 keys | 3584 slots | 0 slaves.
[OK] 2000000 keys in 5 masters.
122.07 keys per slot on average.
 
total slots: 16384
Removing node d611c8f107b68363148c7a7021067200ee2a4a4a from cluster 172.31.5.145:6379
Sending CLUSTER FORGET messages to the cluster...
Sending CLUSTER RESET SOFT to the deleted node.
{ distribution: [ 512, 512, 512, 512 ] }
[33m### RESHARDING FROM 172.31.5.174 TO 172.31.5.54 ###
[0m
{ reshardFrom: '172.31.5.174', reshardTo: '172.31.5.54', slots: 512 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 437863 keys | 3584 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 499905 keys | 4096 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 187870 keys | 1536 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 437699 keys | 3584 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 436663 keys | 3584 slots | 0 slaves.
[OK] 2000000 keys in 5 masters.
122.07 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.174 TO 172.31.5.140 ###
[0m
{ reshardFrom: '172.31.5.174', reshardTo: '172.31.5.140', slots: 512 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 500430 keys | 4096 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 499905 keys | 4096 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 125303 keys | 1024 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 437699 keys | 3584 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 436663 keys | 3584 slots | 0 slaves.
[OK] 2000000 keys in 5 masters.
122.07 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.174 TO 172.31.5.202 ###
[0m
{ reshardFrom: '172.31.5.174', reshardTo: '172.31.5.202', slots: 512 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 500430 keys | 4096 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 499905 keys | 4096 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 62355 keys | 512 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 500647 keys | 4096 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 436663 keys | 3584 slots | 0 slaves.
[OK] 2000000 keys in 5 masters.
122.07 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.174 TO 172.31.5.105 ###
[0m
{ reshardFrom: '172.31.5.174', reshardTo: '172.31.5.105', slots: 512 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 500430 keys | 4096 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 499905 keys | 4096 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 500647 keys | 4096 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 499018 keys | 4096 slots | 1 slaves.
[OK] 2000000 keys in 4 masters.
122.07 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### REMOVING 172.31.5.174:6379 FROM CLUSTER ###
[0m
> redis-cli --cluster del-node 172.31.5.174:6379 eb78bad30480efb75d2dd8edc1693b69278a4bf3
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 500430 keys | 4096 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 499905 keys | 4096 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 500647 keys | 4096 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 499018 keys | 4096 slots | 0 slaves.
[OK] 2000000 keys in 4 masters.
122.07 keys per slot on average.
 
total slots: 16384
Removing node eb78bad30480efb75d2dd8edc1693b69278a4bf3 from cluster 172.31.5.174:6379
Sending CLUSTER FORGET messages to the cluster...
Sending CLUSTER RESET SOFT to the deleted node.
[33m### REBALANCING CLUSTER ON 172.31.5.140:6379 ###
[0m
> redis-cli --cluster rebalance 172.31.5.140:6379 --cluster-use-empty-masters | grep -i Rebalancing
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 500430 keys | 4096 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 499905 keys | 4096 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 500647 keys | 4096 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 499018 keys | 4096 slots | 0 slaves.
[OK] 2000000 keys in 4 masters.
122.07 keys per slot on average.
 
total slots: 16384
*** No rebalancing needed! All nodes are within the 2.00% threshold.


waiting... 65 64 63 62 61 60 59 58 57 56 55 54 53 52 51 50 49 48 47 46 45 44 43 42 41 40 39 38 37 36 35 34 33 32 31 30 29 28 27 26 25 24 23 22 21 20 19 18 17 16 15 14 13 12 11 10 9 8 7 6 5 4 3 2 1 



[34m******* resize , 4 completed ******* [0m 

------------------------------------------------------------------

[34m******* write , 500000 *******[0m

[33m### WRITING 500000 KEYS ###
[0m
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 625351 keys | 4096 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 624932 keys | 4096 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 625581 keys | 4096 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 624136 keys | 4096 slots | 0 slaves.
[OK] 2500000 keys in 4 masters.
152.59 keys per slot on average.
 
total slots: 16384
0.5M keys written successfully

[34m******* write , 500000 completed ******* [0m 

------------------------------------------------------------------

[34m******* resize , 8 *******[0m

{ clusterSize: 4 }
[33m### ADDING 172.31.5.174:6379 NODE TO CLUSTER ###
[0m
> redis-cli --cluster add-node 172.31.5.174:6379 172.31.5.140:6379 | awk '{ gsub(/[[0-9;]*m/, ""); print }'
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 625351 keys | 4096 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 624932 keys | 4096 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 625581 keys | 4096 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 624136 keys | 4096 slots | 0 slaves.
[OK] 2500000 keys in 5 masters.
152.59 keys per slot on average.
 
total slots: 16384
node added successfully
waiting... 2 1 


[33m### ADDING 172.31.5.145:6379 NODE TO CLUSTER ###
[0m
> redis-cli --cluster add-node 172.31.5.145:6379 172.31.5.140:6379 | awk '{ gsub(/[[0-9;]*m/, ""); print }'
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 625351 keys | 4096 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 624932 keys | 4096 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 625581 keys | 4096 slots | 0 slaves.
172.31.5.145:6379 (d611c8f1...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 624136 keys | 4096 slots | 0 slaves.
[OK] 2500000 keys in 6 masters.
152.59 keys per slot on average.
 
total slots: 16384
node added successfully
waiting... 2 1 


[33m### ADDING 172.31.5.233:6379 NODE TO CLUSTER ###
[0m
> redis-cli --cluster add-node 172.31.5.233:6379 172.31.5.140:6379 | awk '{ gsub(/[[0-9;]*m/, ""); print }'
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 625351 keys | 4096 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 624932 keys | 4096 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 625581 keys | 4096 slots | 0 slaves.
172.31.5.145:6379 (d611c8f1...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 624136 keys | 4096 slots | 0 slaves.
172.31.5.233:6379 (250399ba...) -> 0 keys | 0 slots | 0 slaves.
[OK] 2500000 keys in 7 masters.
152.59 keys per slot on average.
 
total slots: 16384
node added successfully
waiting... 2 1 


[33m### ADDING 172.31.5.119:6379 NODE TO CLUSTER ###
[0m
> redis-cli --cluster add-node 172.31.5.119:6379 172.31.5.140:6379 | awk '{ gsub(/[[0-9;]*m/, ""); print }'
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 625351 keys | 4096 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 624932 keys | 4096 slots | 0 slaves.
172.31.5.119:6379 (5b270992...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 625581 keys | 4096 slots | 0 slaves.
172.31.5.145:6379 (d611c8f1...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 624136 keys | 4096 slots | 0 slaves.
172.31.5.233:6379 (250399ba...) -> 0 keys | 0 slots | 0 slaves.
[OK] 2500000 keys in 8 masters.
152.59 keys per slot on average.
 
total slots: 16384
node added successfully
waiting... 2 1 


waiting... 10 9 8 7 6 5 4 3 2 1 


[33m### REBALANCING CLUSTER ON 172.31.5.174:6379 ###
[0m
> redis-cli --cluster rebalance 172.31.5.174:6379 --cluster-use-empty-masters | grep -i Rebalancing
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 313237 keys | 2048 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 312569 keys | 2048 slots | 0 slaves.
172.31.5.119:6379 (5b270992...) -> 312363 keys | 2048 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 312114 keys | 2048 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 312503 keys | 2048 slots | 0 slaves.
172.31.5.145:6379 (d611c8f1...) -> 313078 keys | 2048 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 312469 keys | 2048 slots | 0 slaves.
172.31.5.233:6379 (250399ba...) -> 311667 keys | 2048 slots | 0 slaves.
[OK] 2500000 keys in 8 masters.
152.59 keys per slot on average.
 
total slots: 16384
>>> Rebalancing across 8 nodes. Total weight = 8.00



[34m******* resize , 8 completed ******* [0m 

------------------------------------------------------------------

[34m******* write , 500000 *******[0m

[33m### WRITING 500000 KEYS ###
[0m
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 375616 keys | 2048 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 375037 keys | 2048 slots | 0 slaves.
172.31.5.119:6379 (5b270992...) -> 374923 keys | 2048 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 374585 keys | 2048 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 375018 keys | 2048 slots | 0 slaves.
172.31.5.145:6379 (d611c8f1...) -> 375526 keys | 2048 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 374994 keys | 2048 slots | 0 slaves.
172.31.5.233:6379 (250399ba...) -> 374301 keys | 2048 slots | 0 slaves.
[OK] 3000000 keys in 8 masters.
183.11 keys per slot on average.
 
total slots: 16384
0.5M keys written successfully

[34m******* write , 500000 completed ******* [0m 

------------------------------------------------------------------

[34m******* resize , 5 *******[0m

{ clusterSize: 8 }
[33m### REBALANCING CLUSTER ON 172.31.5.119:6379 ###
[0m
> redis-cli --cluster rebalance 172.31.5.119:6379 --cluster-use-empty-masters | grep -i Rebalancing
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 375616 keys | 2048 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 375037 keys | 2048 slots | 0 slaves.
172.31.5.119:6379 (5b270992...) -> 374923 keys | 2048 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 374585 keys | 2048 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 375018 keys | 2048 slots | 0 slaves.
172.31.5.145:6379 (d611c8f1...) -> 375526 keys | 2048 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 374994 keys | 2048 slots | 0 slaves.
172.31.5.233:6379 (250399ba...) -> 374301 keys | 2048 slots | 0 slaves.
[OK] 3000000 keys in 8 masters.
183.11 keys per slot on average.
 
total slots: 16384
*** No rebalancing needed! All nodes are within the 2.00% threshold.


{ distribution: [ 410, 410, 410, 409, 409 ] }
[33m### RESHARDING FROM 172.31.5.119 TO 172.31.5.140 ###
[0m
{ reshardFrom: '172.31.5.119', reshardTo: '172.31.5.140', slots: 410 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 450477 keys | 2458 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 375037 keys | 2048 slots | 0 slaves.
172.31.5.119:6379 (5b270992...) -> 300062 keys | 1638 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 374585 keys | 2048 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 375018 keys | 2048 slots | 0 slaves.
172.31.5.145:6379 (d611c8f1...) -> 375526 keys | 2048 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 374994 keys | 2048 slots | 0 slaves.
172.31.5.233:6379 (250399ba...) -> 374301 keys | 2048 slots | 0 slaves.
[OK] 3000000 keys in 8 masters.
183.11 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.119 TO 172.31.5.202 ###
[0m
{ reshardFrom: '172.31.5.119', reshardTo: '172.31.5.202', slots: 410 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 450477 keys | 2458 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 375037 keys | 2048 slots | 0 slaves.
172.31.5.119:6379 (5b270992...) -> 224861 keys | 1228 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 374585 keys | 2048 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 450219 keys | 2458 slots | 0 slaves.
172.31.5.145:6379 (d611c8f1...) -> 375526 keys | 2048 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 374994 keys | 2048 slots | 0 slaves.
172.31.5.233:6379 (250399ba...) -> 374301 keys | 2048 slots | 0 slaves.
[OK] 3000000 keys in 8 masters.
183.11 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.119 TO 172.31.5.105 ###
[0m
{ reshardFrom: '172.31.5.119', reshardTo: '172.31.5.105', slots: 410 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 450477 keys | 2458 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 375037 keys | 2048 slots | 0 slaves.
172.31.5.119:6379 (5b270992...) -> 149941 keys | 818 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 374585 keys | 2048 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 450219 keys | 2458 slots | 0 slaves.
172.31.5.145:6379 (d611c8f1...) -> 375526 keys | 2048 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 449914 keys | 2458 slots | 0 slaves.
172.31.5.233:6379 (250399ba...) -> 374301 keys | 2048 slots | 0 slaves.
[OK] 3000000 keys in 8 masters.
183.11 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.119 TO 172.31.5.54 ###
[0m
{ reshardFrom: '172.31.5.119', reshardTo: '172.31.5.54', slots: 409 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 450477 keys | 2458 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 450242 keys | 2457 slots | 0 slaves.
172.31.5.119:6379 (5b270992...) -> 74736 keys | 409 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 374585 keys | 2048 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 450219 keys | 2458 slots | 0 slaves.
172.31.5.145:6379 (d611c8f1...) -> 375526 keys | 2048 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 449914 keys | 2458 slots | 0 slaves.
172.31.5.233:6379 (250399ba...) -> 374301 keys | 2048 slots | 0 slaves.
[OK] 3000000 keys in 8 masters.
183.11 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.119 TO 172.31.5.174 ###
[0m
{ reshardFrom: '172.31.5.119', reshardTo: '172.31.5.174', slots: 409 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 450477 keys | 2458 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 450242 keys | 2457 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 449321 keys | 2457 slots | 1 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 450219 keys | 2458 slots | 0 slaves.
172.31.5.145:6379 (d611c8f1...) -> 375526 keys | 2048 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 449914 keys | 2458 slots | 0 slaves.
172.31.5.233:6379 (250399ba...) -> 374301 keys | 2048 slots | 0 slaves.
[OK] 3000000 keys in 7 masters.
183.11 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### REMOVING 172.31.5.119:6379 FROM CLUSTER ###
[0m
> redis-cli --cluster del-node 172.31.5.119:6379 5b2709925891bf338ba0ae4dd886cb39ea357987
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 450477 keys | 2458 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 450242 keys | 2457 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 449321 keys | 2457 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 450219 keys | 2458 slots | 0 slaves.
172.31.5.145:6379 (d611c8f1...) -> 375526 keys | 2048 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 449914 keys | 2458 slots | 0 slaves.
172.31.5.233:6379 (250399ba...) -> 374301 keys | 2048 slots | 0 slaves.
[OK] 3000000 keys in 7 masters.
183.11 keys per slot on average.
 
total slots: 16384
Removing node 5b2709925891bf338ba0ae4dd886cb39ea357987 from cluster 172.31.5.119:6379
Sending CLUSTER FORGET messages to the cluster...
Sending CLUSTER RESET SOFT to the deleted node.
{ distribution: [ 410, 410, 410, 409, 409 ] }
[33m### RESHARDING FROM 172.31.5.233 TO 172.31.5.202 ###
[0m
{ reshardFrom: '172.31.5.233', reshardTo: '172.31.5.202', slots: 410 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 450477 keys | 2458 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 450242 keys | 2457 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 449321 keys | 2457 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 525033 keys | 2868 slots | 0 slaves.
172.31.5.145:6379 (d611c8f1...) -> 375526 keys | 2048 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 449914 keys | 2458 slots | 0 slaves.
172.31.5.233:6379 (250399ba...) -> 299487 keys | 1638 slots | 0 slaves.
[OK] 3000000 keys in 7 masters.
183.11 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.233 TO 172.31.5.105 ###
[0m
{ reshardFrom: '172.31.5.233', reshardTo: '172.31.5.105', slots: 410 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 450477 keys | 2458 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 450242 keys | 2457 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 449321 keys | 2457 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 525033 keys | 2868 slots | 0 slaves.
172.31.5.145:6379 (d611c8f1...) -> 375526 keys | 2048 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 524689 keys | 2868 slots | 0 slaves.
172.31.5.233:6379 (250399ba...) -> 224712 keys | 1228 slots | 0 slaves.
[OK] 3000000 keys in 7 masters.
183.11 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.233 TO 172.31.5.54 ###
[0m
{ reshardFrom: '172.31.5.233', reshardTo: '172.31.5.54', slots: 410 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 450477 keys | 2458 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 525470 keys | 2867 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 449321 keys | 2457 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 525033 keys | 2868 slots | 0 slaves.
172.31.5.145:6379 (d611c8f1...) -> 375526 keys | 2048 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 524689 keys | 2868 slots | 0 slaves.
172.31.5.233:6379 (250399ba...) -> 149484 keys | 818 slots | 0 slaves.
[OK] 3000000 keys in 7 masters.
183.11 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.233 TO 172.31.5.174 ###
[0m
{ reshardFrom: '172.31.5.233', reshardTo: '172.31.5.174', slots: 409 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 450477 keys | 2458 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 525470 keys | 2867 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 523993 keys | 2866 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 525033 keys | 2868 slots | 0 slaves.
172.31.5.145:6379 (d611c8f1...) -> 375526 keys | 2048 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 524689 keys | 2868 slots | 0 slaves.
172.31.5.233:6379 (250399ba...) -> 74812 keys | 409 slots | 0 slaves.
[OK] 3000000 keys in 7 masters.
183.11 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.233 TO 172.31.5.140 ###
[0m
{ reshardFrom: '172.31.5.233', reshardTo: '172.31.5.140', slots: 409 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 525289 keys | 2867 slots | 1 slaves.
172.31.5.54:6379 (76360353...) -> 525470 keys | 2867 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 523993 keys | 2866 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 525033 keys | 2868 slots | 0 slaves.
172.31.5.145:6379 (d611c8f1...) -> 375526 keys | 2048 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 524689 keys | 2868 slots | 0 slaves.
[OK] 3000000 keys in 6 masters.
183.11 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### REMOVING 172.31.5.233:6379 FROM CLUSTER ###
[0m
> redis-cli --cluster del-node 172.31.5.233:6379 250399ba29619b7a1a6d2ed08a6fc58a65b395e2
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 525289 keys | 2867 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 525470 keys | 2867 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 523993 keys | 2866 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 525033 keys | 2868 slots | 0 slaves.
172.31.5.145:6379 (d611c8f1...) -> 375526 keys | 2048 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 524689 keys | 2868 slots | 0 slaves.
[OK] 3000000 keys in 6 masters.
183.11 keys per slot on average.
 
total slots: 16384
Removing node 250399ba29619b7a1a6d2ed08a6fc58a65b395e2 from cluster 172.31.5.233:6379
Sending CLUSTER FORGET messages to the cluster...
Sending CLUSTER RESET SOFT to the deleted node.
{ distribution: [ 410, 410, 410, 409, 409 ] }
[33m### RESHARDING FROM 172.31.5.145 TO 172.31.5.105 ###
[0m
{ reshardFrom: '172.31.5.145', reshardTo: '172.31.5.105', slots: 410 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 525289 keys | 2867 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 525470 keys | 2867 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 523993 keys | 2866 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 525033 keys | 2868 slots | 0 slaves.
172.31.5.145:6379 (d611c8f1...) -> 300104 keys | 1638 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 600111 keys | 3278 slots | 0 slaves.
[OK] 3000000 keys in 6 masters.
183.11 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.145 TO 172.31.5.54 ###
[0m
{ reshardFrom: '172.31.5.145', reshardTo: '172.31.5.54', slots: 410 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 525289 keys | 2867 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 600645 keys | 3277 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 523993 keys | 2866 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 525033 keys | 2868 slots | 0 slaves.
172.31.5.145:6379 (d611c8f1...) -> 224929 keys | 1228 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 600111 keys | 3278 slots | 0 slaves.
[OK] 3000000 keys in 6 masters.
183.11 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.145 TO 172.31.5.174 ###
[0m
{ reshardFrom: '172.31.5.145', reshardTo: '172.31.5.174', slots: 410 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 525289 keys | 2867 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 600645 keys | 3277 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 599304 keys | 3276 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 525033 keys | 2868 slots | 0 slaves.
172.31.5.145:6379 (d611c8f1...) -> 149618 keys | 818 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 600111 keys | 3278 slots | 0 slaves.
[OK] 3000000 keys in 6 masters.
183.11 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.145 TO 172.31.5.140 ###
[0m
{ reshardFrom: '172.31.5.145', reshardTo: '172.31.5.140', slots: 409 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 599914 keys | 3276 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 600645 keys | 3277 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 599304 keys | 3276 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 525033 keys | 2868 slots | 0 slaves.
172.31.5.145:6379 (d611c8f1...) -> 74993 keys | 409 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 600111 keys | 3278 slots | 0 slaves.
[OK] 3000000 keys in 6 masters.
183.11 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.145 TO 172.31.5.202 ###
[0m
{ reshardFrom: '172.31.5.145', reshardTo: '172.31.5.202', slots: 409 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 599914 keys | 3276 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 600645 keys | 3277 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 599304 keys | 3276 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 600026 keys | 3277 slots | 1 slaves.
172.31.5.105:6379 (9d4816cf...) -> 600111 keys | 3278 slots | 0 slaves.
[OK] 3000000 keys in 5 masters.
183.11 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### REMOVING 172.31.5.145:6379 FROM CLUSTER ###
[0m
> redis-cli --cluster del-node 172.31.5.145:6379 d611c8f107b68363148c7a7021067200ee2a4a4a
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 599914 keys | 3276 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 600645 keys | 3277 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 599304 keys | 3276 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 600026 keys | 3277 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 600111 keys | 3278 slots | 0 slaves.
[OK] 3000000 keys in 5 masters.
183.11 keys per slot on average.
 
total slots: 16384
Removing node d611c8f107b68363148c7a7021067200ee2a4a4a from cluster 172.31.5.145:6379
Sending CLUSTER FORGET messages to the cluster...
Sending CLUSTER RESET SOFT to the deleted node.
[33m### REBALANCING CLUSTER ON 172.31.5.140:6379 ###
[0m
> redis-cli --cluster rebalance 172.31.5.140:6379 --cluster-use-empty-masters | grep -i Rebalancing
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 599914 keys | 3276 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 600645 keys | 3277 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 599304 keys | 3276 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 600026 keys | 3277 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 600111 keys | 3278 slots | 0 slaves.
[OK] 3000000 keys in 5 masters.
183.11 keys per slot on average.
 
total slots: 16384
*** No rebalancing needed! All nodes are within the 2.00% threshold.


waiting... 65 64 63 62 61 60 59 58 57 56 55 54 53 52 51 50 49 48 47 46 45 44 43 42 41 40 39 38 37 36 35 34 33 32 31 30 29 28 27 26 25 24 23 22 21 20 19 18 17 16 15 14 13 12 11 10 9 8 7 6 5 4 3 2 1 



[34m******* resize , 5 completed ******* [0m 

------------------------------------------------------------------

[34m******* write , 500000 *******[0m

[33m### WRITING 500000 KEYS ###
[0m
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 699925 keys | 3276 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 700868 keys | 3277 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 699152 keys | 3276 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 700032 keys | 3277 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 700023 keys | 3278 slots | 0 slaves.
[OK] 3500000 keys in 5 masters.
213.62 keys per slot on average.
 
total slots: 16384
0.5M keys written successfully

[34m******* write , 500000 completed ******* [0m 

------------------------------------------------------------------

[34m******* resize , 8 *******[0m

{ clusterSize: 5 }
[33m### ADDING 172.31.5.145:6379 NODE TO CLUSTER ###
[0m
> redis-cli --cluster add-node 172.31.5.145:6379 172.31.5.140:6379 | awk '{ gsub(/[[0-9;]*m/, ""); print }'
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 699925 keys | 3276 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 700868 keys | 3277 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 699152 keys | 3276 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 700032 keys | 3277 slots | 0 slaves.
172.31.5.145:6379 (d611c8f1...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 700023 keys | 3278 slots | 0 slaves.
[OK] 3500000 keys in 6 masters.
213.62 keys per slot on average.
 
total slots: 16384
node added successfully
waiting... 2 1 


[33m### ADDING 172.31.5.233:6379 NODE TO CLUSTER ###
[0m
> redis-cli --cluster add-node 172.31.5.233:6379 172.31.5.140:6379 | awk '{ gsub(/[[0-9;]*m/, ""); print }'
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 699925 keys | 3276 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 700868 keys | 3277 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 699152 keys | 3276 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 700032 keys | 3277 slots | 0 slaves.
172.31.5.145:6379 (d611c8f1...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 700023 keys | 3278 slots | 0 slaves.
172.31.5.233:6379 (250399ba...) -> 0 keys | 0 slots | 0 slaves.
[OK] 3500000 keys in 7 masters.
213.62 keys per slot on average.
 
total slots: 16384
node added successfully
waiting... 2 1 


[33m### ADDING 172.31.5.119:6379 NODE TO CLUSTER ###
[0m
> redis-cli --cluster add-node 172.31.5.119:6379 172.31.5.140:6379 | awk '{ gsub(/[[0-9;]*m/, ""); print }'
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 699925 keys | 3276 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 700868 keys | 3277 slots | 0 slaves.
172.31.5.119:6379 (5b270992...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 699152 keys | 3276 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 700032 keys | 3277 slots | 0 slaves.
172.31.5.145:6379 (d611c8f1...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 700023 keys | 3278 slots | 0 slaves.
172.31.5.233:6379 (250399ba...) -> 0 keys | 0 slots | 0 slaves.
[OK] 3500000 keys in 8 masters.
213.62 keys per slot on average.
 
total slots: 16384
node added successfully
waiting... 2 1 


waiting... 10 9 8 7 6 5 4 3 2 1 


[33m### REBALANCING CLUSTER ON 172.31.5.145:6379 ###
[0m
> redis-cli --cluster rebalance 172.31.5.145:6379 --cluster-use-empty-masters | grep -i Rebalancing
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 437763 keys | 2048 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 437531 keys | 2048 slots | 0 slaves.
172.31.5.119:6379 (5b270992...) -> 437407 keys | 2048 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 437076 keys | 2048 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 437529 keys | 2048 slots | 0 slaves.
172.31.5.145:6379 (d611c8f1...) -> 437709 keys | 2048 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 437494 keys | 2048 slots | 0 slaves.
172.31.5.233:6379 (250399ba...) -> 437491 keys | 2048 slots | 0 slaves.
[OK] 3500000 keys in 8 masters.
213.62 keys per slot on average.
 
total slots: 16384
>>> Rebalancing across 8 nodes. Total weight = 8.00



[34m******* resize , 8 completed ******* [0m 

------------------------------------------------------------------

[34m******* write , 500000 *******[0m

[33m### WRITING 500000 KEYS ###
[0m
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 500211 keys | 2048 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 500063 keys | 2048 slots | 0 slaves.
172.31.5.119:6379 (5b270992...) -> 499958 keys | 2048 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 499624 keys | 2048 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 500021 keys | 2048 slots | 0 slaves.
172.31.5.145:6379 (d611c8f1...) -> 500162 keys | 2048 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 499968 keys | 2048 slots | 0 slaves.
172.31.5.233:6379 (250399ba...) -> 499993 keys | 2048 slots | 0 slaves.
[OK] 4000000 keys in 8 masters.
244.14 keys per slot on average.
 
total slots: 16384
0.5M keys written successfully

[34m******* write , 500000 completed ******* [0m 

------------------------------------------------------------------

[34m******* resize , 6 *******[0m

{ clusterSize: 8 }
[33m### REBALANCING CLUSTER ON 172.31.5.119:6379 ###
[0m
> redis-cli --cluster rebalance 172.31.5.119:6379 --cluster-use-empty-masters | grep -i Rebalancing
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 500211 keys | 2048 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 500063 keys | 2048 slots | 0 slaves.
172.31.5.119:6379 (5b270992...) -> 499958 keys | 2048 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 499624 keys | 2048 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 500021 keys | 2048 slots | 0 slaves.
172.31.5.145:6379 (d611c8f1...) -> 500162 keys | 2048 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 499968 keys | 2048 slots | 0 slaves.
172.31.5.233:6379 (250399ba...) -> 499993 keys | 2048 slots | 0 slaves.
[OK] 4000000 keys in 8 masters.
244.14 keys per slot on average.
 
total slots: 16384
*** No rebalancing needed! All nodes are within the 2.00% threshold.


{ distribution: [ 342, 342, 341, 341, 341, 341 ] }
[33m### RESHARDING FROM 172.31.5.119 TO 172.31.5.140 ###
[0m
{ reshardFrom: '172.31.5.119', reshardTo: '172.31.5.140', slots: 342 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 583677 keys | 2390 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 500063 keys | 2048 slots | 0 slaves.
172.31.5.119:6379 (5b270992...) -> 416492 keys | 1706 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 499624 keys | 2048 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 500021 keys | 2048 slots | 0 slaves.
172.31.5.145:6379 (d611c8f1...) -> 500162 keys | 2048 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 499968 keys | 2048 slots | 0 slaves.
172.31.5.233:6379 (250399ba...) -> 499993 keys | 2048 slots | 0 slaves.
[OK] 4000000 keys in 8 masters.
244.14 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.119 TO 172.31.5.202 ###
[0m
{ reshardFrom: '172.31.5.119', reshardTo: '172.31.5.202', slots: 342 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 583677 keys | 2390 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 500063 keys | 2048 slots | 0 slaves.
172.31.5.119:6379 (5b270992...) -> 332854 keys | 1364 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 499624 keys | 2048 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 583659 keys | 2390 slots | 0 slaves.
172.31.5.145:6379 (d611c8f1...) -> 500162 keys | 2048 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 499968 keys | 2048 slots | 0 slaves.
172.31.5.233:6379 (250399ba...) -> 499993 keys | 2048 slots | 0 slaves.
[OK] 4000000 keys in 8 masters.
244.14 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.119 TO 172.31.5.105 ###
[0m
{ reshardFrom: '172.31.5.119', reshardTo: '172.31.5.105', slots: 341 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 583677 keys | 2390 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 500063 keys | 2048 slots | 0 slaves.
172.31.5.119:6379 (5b270992...) -> 249920 keys | 1023 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 499624 keys | 2048 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 583659 keys | 2390 slots | 0 slaves.
172.31.5.145:6379 (d611c8f1...) -> 500162 keys | 2048 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 582902 keys | 2389 slots | 0 slaves.
172.31.5.233:6379 (250399ba...) -> 499993 keys | 2048 slots | 0 slaves.
[OK] 4000000 keys in 8 masters.
244.14 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.119 TO 172.31.5.54 ###
[0m
{ reshardFrom: '172.31.5.119', reshardTo: '172.31.5.54', slots: 341 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 583677 keys | 2390 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 583226 keys | 2389 slots | 0 slaves.
172.31.5.119:6379 (5b270992...) -> 166757 keys | 682 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 499624 keys | 2048 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 583659 keys | 2390 slots | 0 slaves.
172.31.5.145:6379 (d611c8f1...) -> 500162 keys | 2048 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 582902 keys | 2389 slots | 0 slaves.
172.31.5.233:6379 (250399ba...) -> 499993 keys | 2048 slots | 0 slaves.
[OK] 4000000 keys in 8 masters.
244.14 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.119 TO 172.31.5.174 ###
[0m
{ reshardFrom: '172.31.5.119', reshardTo: '172.31.5.174', slots: 341 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 583677 keys | 2390 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 583226 keys | 2389 slots | 0 slaves.
172.31.5.119:6379 (5b270992...) -> 83572 keys | 341 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 582809 keys | 2389 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 583659 keys | 2390 slots | 0 slaves.
172.31.5.145:6379 (d611c8f1...) -> 500162 keys | 2048 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 582902 keys | 2389 slots | 0 slaves.
172.31.5.233:6379 (250399ba...) -> 499993 keys | 2048 slots | 0 slaves.
[OK] 4000000 keys in 8 masters.
244.14 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.119 TO 172.31.5.145 ###
[0m
{ reshardFrom: '172.31.5.119', reshardTo: '172.31.5.145', slots: 341 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 583677 keys | 2390 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 583226 keys | 2389 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 582809 keys | 2389 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 583659 keys | 2390 slots | 0 slaves.
172.31.5.145:6379 (d611c8f1...) -> 583734 keys | 2389 slots | 1 slaves.
172.31.5.105:6379 (9d4816cf...) -> 582902 keys | 2389 slots | 0 slaves.
172.31.5.233:6379 (250399ba...) -> 499993 keys | 2048 slots | 0 slaves.
[OK] 4000000 keys in 7 masters.
244.14 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### REMOVING 172.31.5.119:6379 FROM CLUSTER ###
[0m
> redis-cli --cluster del-node 172.31.5.119:6379 5b2709925891bf338ba0ae4dd886cb39ea357987
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 583677 keys | 2390 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 583226 keys | 2389 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 582809 keys | 2389 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 583659 keys | 2390 slots | 0 slaves.
172.31.5.145:6379 (d611c8f1...) -> 583734 keys | 2389 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 582902 keys | 2389 slots | 0 slaves.
172.31.5.233:6379 (250399ba...) -> 499993 keys | 2048 slots | 0 slaves.
[OK] 4000000 keys in 7 masters.
244.14 keys per slot on average.
 
total slots: 16384
Removing node 5b2709925891bf338ba0ae4dd886cb39ea357987 from cluster 172.31.5.119:6379
Sending CLUSTER FORGET messages to the cluster...
Sending CLUSTER RESET SOFT to the deleted node.
{ distribution: [ 342, 342, 341, 341, 341, 341 ] }
[33m### RESHARDING FROM 172.31.5.233 TO 172.31.5.202 ###
[0m
{ reshardFrom: '172.31.5.233', reshardTo: '172.31.5.202', slots: 342 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 583677 keys | 2390 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 583226 keys | 2389 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 582809 keys | 2389 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 666935 keys | 2732 slots | 0 slaves.
172.31.5.145:6379 (d611c8f1...) -> 583734 keys | 2389 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 582902 keys | 2389 slots | 0 slaves.
172.31.5.233:6379 (250399ba...) -> 416717 keys | 1706 slots | 0 slaves.
[OK] 4000000 keys in 7 masters.
244.14 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.233 TO 172.31.5.105 ###
[0m
{ reshardFrom: '172.31.5.233', reshardTo: '172.31.5.105', slots: 342 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 583677 keys | 2390 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 583226 keys | 2389 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 582809 keys | 2389 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 666935 keys | 2732 slots | 0 slaves.
172.31.5.145:6379 (d611c8f1...) -> 583734 keys | 2389 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 666382 keys | 2731 slots | 0 slaves.
172.31.5.233:6379 (250399ba...) -> 333237 keys | 1364 slots | 0 slaves.
[OK] 4000000 keys in 7 masters.
244.14 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.233 TO 172.31.5.54 ###
[0m
{ reshardFrom: '172.31.5.233', reshardTo: '172.31.5.54', slots: 341 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 583677 keys | 2390 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 666355 keys | 2730 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 582809 keys | 2389 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 666935 keys | 2732 slots | 0 slaves.
172.31.5.145:6379 (d611c8f1...) -> 583734 keys | 2389 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 666382 keys | 2731 slots | 0 slaves.
172.31.5.233:6379 (250399ba...) -> 250108 keys | 1023 slots | 0 slaves.
[OK] 4000000 keys in 7 masters.
244.14 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.233 TO 172.31.5.174 ###
[0m
{ reshardFrom: '172.31.5.233', reshardTo: '172.31.5.174', slots: 341 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 583677 keys | 2390 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 666355 keys | 2730 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 666119 keys | 2730 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 666935 keys | 2732 slots | 0 slaves.
172.31.5.145:6379 (d611c8f1...) -> 583734 keys | 2389 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 666382 keys | 2731 slots | 0 slaves.
172.31.5.233:6379 (250399ba...) -> 166798 keys | 682 slots | 0 slaves.
[OK] 4000000 keys in 7 masters.
244.14 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.233 TO 172.31.5.145 ###
[0m
{ reshardFrom: '172.31.5.233', reshardTo: '172.31.5.145', slots: 341 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 583677 keys | 2390 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 666355 keys | 2730 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 666119 keys | 2730 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 666935 keys | 2732 slots | 0 slaves.
172.31.5.145:6379 (d611c8f1...) -> 667046 keys | 2730 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 666382 keys | 2731 slots | 0 slaves.
172.31.5.233:6379 (250399ba...) -> 83486 keys | 341 slots | 0 slaves.
[OK] 4000000 keys in 7 masters.
244.14 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.233 TO 172.31.5.140 ###
[0m
{ reshardFrom: '172.31.5.233', reshardTo: '172.31.5.140', slots: 341 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 667163 keys | 2731 slots | 1 slaves.
172.31.5.54:6379 (76360353...) -> 666355 keys | 2730 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 666119 keys | 2730 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 666935 keys | 2732 slots | 0 slaves.
172.31.5.145:6379 (d611c8f1...) -> 667046 keys | 2730 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 666382 keys | 2731 slots | 0 slaves.
[OK] 4000000 keys in 6 masters.
244.14 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### REMOVING 172.31.5.233:6379 FROM CLUSTER ###
[0m
> redis-cli --cluster del-node 172.31.5.233:6379 250399ba29619b7a1a6d2ed08a6fc58a65b395e2
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 667163 keys | 2731 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 666355 keys | 2730 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 666119 keys | 2730 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 666935 keys | 2732 slots | 0 slaves.
172.31.5.145:6379 (d611c8f1...) -> 667046 keys | 2730 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 666382 keys | 2731 slots | 0 slaves.
[OK] 4000000 keys in 6 masters.
244.14 keys per slot on average.
 
total slots: 16384
Removing node 250399ba29619b7a1a6d2ed08a6fc58a65b395e2 from cluster 172.31.5.233:6379
Sending CLUSTER FORGET messages to the cluster...
Sending CLUSTER RESET SOFT to the deleted node.
[33m### REBALANCING CLUSTER ON 172.31.5.140:6379 ###
[0m
> redis-cli --cluster rebalance 172.31.5.140:6379 --cluster-use-empty-masters | grep -i Rebalancing
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 667163 keys | 2731 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 666355 keys | 2730 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 666119 keys | 2730 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 666935 keys | 2732 slots | 0 slaves.
172.31.5.145:6379 (d611c8f1...) -> 667046 keys | 2730 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 666382 keys | 2731 slots | 0 slaves.
[OK] 4000000 keys in 6 masters.
244.14 keys per slot on average.
 
total slots: 16384
*** No rebalancing needed! All nodes are within the 2.00% threshold.


waiting... 65 64 63 62 61 60 59 58 57 56 55 54 53 52 51 50 49 48 47 46 45 44 43 42 41 40 39 38 37 36 35 34 33 32 31 30 29 28 27 26 25 24 23 22 21 20 19 18 17 16 15 14 13 12 11 10 9 8 7 6 5 4 3 2 1 



[34m******* resize , 6 completed ******* [0m 

------------------------------------------------------------------

[34m******* write , 500000 *******[0m

[33m### WRITING 500000 KEYS ###
[0m
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 750618 keys | 2731 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 749696 keys | 2730 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 749318 keys | 2730 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 750303 keys | 2732 slots | 0 slaves.
172.31.5.145:6379 (d611c8f1...) -> 750354 keys | 2730 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 749711 keys | 2731 slots | 0 slaves.
[OK] 4500000 keys in 6 masters.
274.66 keys per slot on average.
 
total slots: 16384
0.5M keys written successfully

[34m******* write , 500000 completed ******* [0m 

------------------------------------------------------------------

[34m******* resize , 8 *******[0m

{ clusterSize: 6 }
[33m### ADDING 172.31.5.233:6379 NODE TO CLUSTER ###
[0m
> redis-cli --cluster add-node 172.31.5.233:6379 172.31.5.140:6379 | awk '{ gsub(/[[0-9;]*m/, ""); print }'
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 750618 keys | 2731 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 749696 keys | 2730 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 749318 keys | 2730 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 750303 keys | 2732 slots | 0 slaves.
172.31.5.145:6379 (d611c8f1...) -> 750354 keys | 2730 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 749711 keys | 2731 slots | 0 slaves.
172.31.5.233:6379 (250399ba...) -> 0 keys | 0 slots | 0 slaves.
[OK] 4500000 keys in 7 masters.
274.66 keys per slot on average.
 
total slots: 16384
node added successfully
waiting... 2 1 


[33m### ADDING 172.31.5.119:6379 NODE TO CLUSTER ###
[0m
> redis-cli --cluster add-node 172.31.5.119:6379 172.31.5.140:6379 | awk '{ gsub(/[[0-9;]*m/, ""); print }'
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 750618 keys | 2731 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 749696 keys | 2730 slots | 0 slaves.
172.31.5.119:6379 (5b270992...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 749318 keys | 2730 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 750303 keys | 2732 slots | 0 slaves.
172.31.5.145:6379 (d611c8f1...) -> 750354 keys | 2730 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 749711 keys | 2731 slots | 0 slaves.
172.31.5.233:6379 (250399ba...) -> 0 keys | 0 slots | 0 slaves.
[OK] 4500000 keys in 8 masters.
274.66 keys per slot on average.
 
total slots: 16384
node added successfully
waiting... 2 1 


waiting... 10 9 8 7 6 5 4 3 2 1 


[33m### REBALANCING CLUSTER ON 172.31.5.233:6379 ###
[0m
> redis-cli --cluster rebalance 172.31.5.233:6379 --cluster-use-empty-masters | grep -i Rebalancing
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 562767 keys | 2048 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 562309 keys | 2048 slots | 0 slaves.
172.31.5.119:6379 (5b270992...) -> 562757 keys | 2048 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 561850 keys | 2048 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 562549 keys | 2048 slots | 0 slaves.
172.31.5.145:6379 (d611c8f1...) -> 562992 keys | 2048 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 562458 keys | 2048 slots | 0 slaves.
172.31.5.233:6379 (250399ba...) -> 562318 keys | 2048 slots | 0 slaves.
[OK] 4500000 keys in 8 masters.
274.66 keys per slot on average.
 
total slots: 16384
>>> Rebalancing across 8 nodes. Total weight = 8.00



[34m******* resize , 8 completed ******* [0m 

------------------------------------------------------------------

[34m******* write , 500000 *******[0m

[33m### WRITING 500000 KEYS ###
[0m
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 625191 keys | 2048 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 624800 keys | 2048 slots | 0 slaves.
172.31.5.119:6379 (5b270992...) -> 625249 keys | 2048 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 624463 keys | 2048 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 625072 keys | 2048 slots | 0 slaves.
172.31.5.145:6379 (d611c8f1...) -> 625367 keys | 2048 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 624971 keys | 2048 slots | 0 slaves.
172.31.5.233:6379 (250399ba...) -> 624887 keys | 2048 slots | 0 slaves.
[OK] 5000000 keys in 8 masters.
305.18 keys per slot on average.
 
total slots: 16384
0.5M keys written successfully

[34m******* write , 500000 completed ******* [0m 

------------------------------------------------------------------

[34m******* resize , 7 *******[0m

{ clusterSize: 8 }
[33m### REBALANCING CLUSTER ON 172.31.5.119:6379 ###
[0m
> redis-cli --cluster rebalance 172.31.5.119:6379 --cluster-use-empty-masters | grep -i Rebalancing
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 625191 keys | 2048 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 624800 keys | 2048 slots | 0 slaves.
172.31.5.119:6379 (5b270992...) -> 625249 keys | 2048 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 624463 keys | 2048 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 625072 keys | 2048 slots | 0 slaves.
172.31.5.145:6379 (d611c8f1...) -> 625367 keys | 2048 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 624971 keys | 2048 slots | 0 slaves.
172.31.5.233:6379 (250399ba...) -> 624887 keys | 2048 slots | 0 slaves.
[OK] 5000000 keys in 8 masters.
305.18 keys per slot on average.
 
total slots: 16384
*** No rebalancing needed! All nodes are within the 2.00% threshold.


{ distribution: [
    293, 293, 293,
    293, 292, 292,
    292
  ] }
[33m### RESHARDING FROM 172.31.5.119 TO 172.31.5.140 ###
[0m
{ reshardFrom: '172.31.5.119', reshardTo: '172.31.5.140', slots: 293 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 714659 keys | 2341 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 624800 keys | 2048 slots | 0 slaves.
172.31.5.119:6379 (5b270992...) -> 535781 keys | 1755 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 624463 keys | 2048 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 625072 keys | 2048 slots | 0 slaves.
172.31.5.145:6379 (d611c8f1...) -> 625367 keys | 2048 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 624971 keys | 2048 slots | 0 slaves.
172.31.5.233:6379 (250399ba...) -> 624887 keys | 2048 slots | 0 slaves.
[OK] 5000000 keys in 8 masters.
305.18 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.119 TO 172.31.5.202 ###
[0m
{ reshardFrom: '172.31.5.119', reshardTo: '172.31.5.202', slots: 293 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 714659 keys | 2341 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 624800 keys | 2048 slots | 0 slaves.
172.31.5.119:6379 (5b270992...) -> 446474 keys | 1462 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 624463 keys | 2048 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 714379 keys | 2341 slots | 0 slaves.
172.31.5.145:6379 (d611c8f1...) -> 625367 keys | 2048 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 624971 keys | 2048 slots | 0 slaves.
172.31.5.233:6379 (250399ba...) -> 624887 keys | 2048 slots | 0 slaves.
[OK] 5000000 keys in 8 masters.
305.18 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.119 TO 172.31.5.105 ###
[0m
{ reshardFrom: '172.31.5.119', reshardTo: '172.31.5.105', slots: 293 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 714659 keys | 2341 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 624800 keys | 2048 slots | 0 slaves.
172.31.5.119:6379 (5b270992...) -> 356966 keys | 1169 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 624463 keys | 2048 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 714379 keys | 2341 slots | 0 slaves.
172.31.5.145:6379 (d611c8f1...) -> 625367 keys | 2048 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 714479 keys | 2341 slots | 0 slaves.
172.31.5.233:6379 (250399ba...) -> 624887 keys | 2048 slots | 0 slaves.
[OK] 5000000 keys in 8 masters.
305.18 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.119 TO 172.31.5.54 ###
[0m
{ reshardFrom: '172.31.5.119', reshardTo: '172.31.5.54', slots: 293 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 714659 keys | 2341 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 713947 keys | 2341 slots | 0 slaves.
172.31.5.119:6379 (5b270992...) -> 267819 keys | 876 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 624463 keys | 2048 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 714379 keys | 2341 slots | 0 slaves.
172.31.5.145:6379 (d611c8f1...) -> 625367 keys | 2048 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 714479 keys | 2341 slots | 0 slaves.
172.31.5.233:6379 (250399ba...) -> 624887 keys | 2048 slots | 0 slaves.
[OK] 5000000 keys in 8 masters.
305.18 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.119 TO 172.31.5.174 ###
[0m
{ reshardFrom: '172.31.5.119', reshardTo: '172.31.5.174', slots: 292 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 714659 keys | 2341 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 713947 keys | 2341 slots | 0 slaves.
172.31.5.119:6379 (5b270992...) -> 178564 keys | 584 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 713718 keys | 2340 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 714379 keys | 2341 slots | 0 slaves.
172.31.5.145:6379 (d611c8f1...) -> 625367 keys | 2048 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 714479 keys | 2341 slots | 0 slaves.
172.31.5.233:6379 (250399ba...) -> 624887 keys | 2048 slots | 0 slaves.
[OK] 5000000 keys in 8 masters.
305.18 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.119 TO 172.31.5.145 ###
[0m
{ reshardFrom: '172.31.5.119', reshardTo: '172.31.5.145', slots: 292 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 714659 keys | 2341 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 713947 keys | 2341 slots | 0 slaves.
172.31.5.119:6379 (5b270992...) -> 89258 keys | 292 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 713718 keys | 2340 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 714379 keys | 2341 slots | 0 slaves.
172.31.5.145:6379 (d611c8f1...) -> 714673 keys | 2340 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 714479 keys | 2341 slots | 0 slaves.
172.31.5.233:6379 (250399ba...) -> 624887 keys | 2048 slots | 0 slaves.
[OK] 5000000 keys in 8 masters.
305.18 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.119 TO 172.31.5.233 ###
[0m
{ reshardFrom: '172.31.5.119', reshardTo: '172.31.5.233', slots: 292 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 714659 keys | 2341 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 713947 keys | 2341 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 713718 keys | 2340 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 714379 keys | 2341 slots | 0 slaves.
172.31.5.145:6379 (d611c8f1...) -> 714673 keys | 2340 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 714479 keys | 2341 slots | 0 slaves.
172.31.5.233:6379 (250399ba...) -> 714145 keys | 2340 slots | 1 slaves.
[OK] 5000000 keys in 7 masters.
305.18 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### REMOVING 172.31.5.119:6379 FROM CLUSTER ###
[0m
> redis-cli --cluster del-node 172.31.5.119:6379 5b2709925891bf338ba0ae4dd886cb39ea357987
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 714659 keys | 2341 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 713947 keys | 2341 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 713718 keys | 2340 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 714379 keys | 2341 slots | 0 slaves.
172.31.5.145:6379 (d611c8f1...) -> 714673 keys | 2340 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 714479 keys | 2341 slots | 0 slaves.
172.31.5.233:6379 (250399ba...) -> 714145 keys | 2340 slots | 0 slaves.
[OK] 5000000 keys in 7 masters.
305.18 keys per slot on average.
 
total slots: 16384
Removing node 5b2709925891bf338ba0ae4dd886cb39ea357987 from cluster 172.31.5.119:6379
Sending CLUSTER FORGET messages to the cluster...
Sending CLUSTER RESET SOFT to the deleted node.
[33m### REBALANCING CLUSTER ON 172.31.5.140:6379 ###
[0m
> redis-cli --cluster rebalance 172.31.5.140:6379 --cluster-use-empty-masters | grep -i Rebalancing
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 714659 keys | 2341 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 713947 keys | 2341 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 713718 keys | 2340 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 714379 keys | 2341 slots | 0 slaves.
172.31.5.145:6379 (d611c8f1...) -> 714673 keys | 2340 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 714479 keys | 2341 slots | 0 slaves.
172.31.5.233:6379 (250399ba...) -> 714145 keys | 2340 slots | 0 slaves.
[OK] 5000000 keys in 7 masters.
305.18 keys per slot on average.
 
total slots: 16384
*** No rebalancing needed! All nodes are within the 2.00% threshold.


waiting... 65 64 63 62 61 60 59 58 57 56 55 54 53 52 51 50 49 48 47 46 45 44 43 42 41 40 39 38 37 36 35 34 33 32 31 30 29 28 27 26 25 24 23 22 21 20 19 18 17 16 15 14 13 12 11 10 9 8 7 6 5 4 3 2 1 



[34m******* resize , 7 completed ******* [0m 

------------------------------------------------------------------

[34m******* write , 500000 *******[0m

[33m### WRITING 500000 KEYS ###
[0m
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 786210 keys | 2341 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 785301 keys | 2341 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 784898 keys | 2340 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 785838 keys | 2341 slots | 0 slaves.
172.31.5.145:6379 (d611c8f1...) -> 786280 keys | 2340 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 785936 keys | 2341 slots | 0 slaves.
172.31.5.233:6379 (250399ba...) -> 785537 keys | 2340 slots | 0 slaves.
[OK] 5500000 keys in 7 masters.
335.69 keys per slot on average.
 
total slots: 16384
0.5M keys written successfully

[34m******* write , 500000 completed ******* [0m 

------------------------------------------------------------------

[34m******* resize , 3 *******[0m

{ clusterSize: 7 }
[33m### REBALANCING CLUSTER ON 172.31.5.233:6379 ###
[0m
> redis-cli --cluster rebalance 172.31.5.233:6379 --cluster-use-empty-masters | grep -i Rebalancing
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 786210 keys | 2341 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 785301 keys | 2341 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 784898 keys | 2340 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 785838 keys | 2341 slots | 0 slaves.
172.31.5.145:6379 (d611c8f1...) -> 786280 keys | 2340 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 785936 keys | 2341 slots | 0 slaves.
172.31.5.233:6379 (250399ba...) -> 785537 keys | 2340 slots | 0 slaves.
[OK] 5500000 keys in 7 masters.
335.69 keys per slot on average.
 
total slots: 16384
*** No rebalancing needed! All nodes are within the 2.00% threshold.


{ distribution: [ 780, 780, 780 ] }
[33m### RESHARDING FROM 172.31.5.233 TO 172.31.5.140 ###
[0m
{ reshardFrom: '172.31.5.233', reshardTo: '172.31.5.140', slots: 780 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 1047799 keys | 3121 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 785301 keys | 2341 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 784898 keys | 2340 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 785838 keys | 2341 slots | 0 slaves.
172.31.5.145:6379 (d611c8f1...) -> 786280 keys | 2340 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 785936 keys | 2341 slots | 0 slaves.
172.31.5.233:6379 (250399ba...) -> 523948 keys | 1560 slots | 0 slaves.
[OK] 5500000 keys in 7 masters.
335.69 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.233 TO 172.31.5.202 ###
[0m
{ reshardFrom: '172.31.5.233', reshardTo: '172.31.5.202', slots: 780 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 1047799 keys | 3121 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 785301 keys | 2341 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 784898 keys | 2340 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 1047625 keys | 3121 slots | 0 slaves.
172.31.5.145:6379 (d611c8f1...) -> 786280 keys | 2340 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 785936 keys | 2341 slots | 0 slaves.
172.31.5.233:6379 (250399ba...) -> 262161 keys | 780 slots | 0 slaves.
[OK] 5500000 keys in 7 masters.
335.69 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.233 TO 172.31.5.105 ###
[0m
{ reshardFrom: '172.31.5.233', reshardTo: '172.31.5.105', slots: 780 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 1047799 keys | 3121 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 785301 keys | 2341 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 784898 keys | 2340 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 1047625 keys | 3121 slots | 0 slaves.
172.31.5.145:6379 (d611c8f1...) -> 786280 keys | 2340 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 1048097 keys | 3121 slots | 1 slaves.
[OK] 5500000 keys in 6 masters.
335.69 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### REMOVING 172.31.5.233:6379 FROM CLUSTER ###
[0m
> redis-cli --cluster del-node 172.31.5.233:6379 250399ba29619b7a1a6d2ed08a6fc58a65b395e2
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 1047799 keys | 3121 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 785301 keys | 2341 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 784898 keys | 2340 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 1047625 keys | 3121 slots | 0 slaves.
172.31.5.145:6379 (d611c8f1...) -> 786280 keys | 2340 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 1048097 keys | 3121 slots | 0 slaves.
[OK] 5500000 keys in 6 masters.
335.69 keys per slot on average.
 
total slots: 16384
Removing node 250399ba29619b7a1a6d2ed08a6fc58a65b395e2 from cluster 172.31.5.233:6379
Sending CLUSTER FORGET messages to the cluster...
Sending CLUSTER RESET SOFT to the deleted node.
{ distribution: [ 780, 780, 780 ] }
[33m### RESHARDING FROM 172.31.5.145 TO 172.31.5.202 ###
[0m
{ reshardFrom: '172.31.5.145', reshardTo: '172.31.5.202', slots: 780 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 1047799 keys | 3121 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 785301 keys | 2341 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 784898 keys | 2340 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 1309762 keys | 3901 slots | 0 slaves.
172.31.5.145:6379 (d611c8f1...) -> 524143 keys | 1560 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 1048097 keys | 3121 slots | 0 slaves.
[OK] 5500000 keys in 6 masters.
335.69 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.145 TO 172.31.5.105 ###
[0m
{ reshardFrom: '172.31.5.145', reshardTo: '172.31.5.105', slots: 780 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 1047799 keys | 3121 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 785301 keys | 2341 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 784898 keys | 2340 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 1309762 keys | 3901 slots | 0 slaves.
172.31.5.145:6379 (d611c8f1...) -> 262353 keys | 780 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 1309887 keys | 3901 slots | 0 slaves.
[OK] 5500000 keys in 6 masters.
335.69 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.145 TO 172.31.5.140 ###
[0m
{ reshardFrom: '172.31.5.145', reshardTo: '172.31.5.140', slots: 780 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 1310152 keys | 3901 slots | 1 slaves.
172.31.5.54:6379 (76360353...) -> 785301 keys | 2341 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 784898 keys | 2340 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 1309762 keys | 3901 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 1309887 keys | 3901 slots | 0 slaves.
[OK] 5500000 keys in 5 masters.
335.69 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### REMOVING 172.31.5.145:6379 FROM CLUSTER ###
[0m
> redis-cli --cluster del-node 172.31.5.145:6379 d611c8f107b68363148c7a7021067200ee2a4a4a
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 1310152 keys | 3901 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 785301 keys | 2341 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 784898 keys | 2340 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 1309762 keys | 3901 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 1309887 keys | 3901 slots | 0 slaves.
[OK] 5500000 keys in 5 masters.
335.69 keys per slot on average.
 
total slots: 16384
Removing node d611c8f107b68363148c7a7021067200ee2a4a4a from cluster 172.31.5.145:6379
Sending CLUSTER FORGET messages to the cluster...
Sending CLUSTER RESET SOFT to the deleted node.
{ distribution: [ 780, 780, 780 ] }
[33m### RESHARDING FROM 172.31.5.174 TO 172.31.5.105 ###
[0m
{ reshardFrom: '172.31.5.174', reshardTo: '172.31.5.105', slots: 780 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 1310152 keys | 3901 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 785301 keys | 2341 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 523464 keys | 1560 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 1309762 keys | 3901 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 1571321 keys | 4681 slots | 0 slaves.
[OK] 5500000 keys in 5 masters.
335.69 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.174 TO 172.31.5.140 ###
[0m
{ reshardFrom: '172.31.5.174', reshardTo: '172.31.5.140', slots: 780 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 1571998 keys | 4681 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 785301 keys | 2341 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 261618 keys | 780 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 1309762 keys | 3901 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 1571321 keys | 4681 slots | 0 slaves.
[OK] 5500000 keys in 5 masters.
335.69 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.174 TO 172.31.5.202 ###
[0m
{ reshardFrom: '172.31.5.174', reshardTo: '172.31.5.202', slots: 780 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 1571998 keys | 4681 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 785301 keys | 2341 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 1571380 keys | 4681 slots | 1 slaves.
172.31.5.105:6379 (9d4816cf...) -> 1571321 keys | 4681 slots | 0 slaves.
[OK] 5500000 keys in 4 masters.
335.69 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### REMOVING 172.31.5.174:6379 FROM CLUSTER ###
[0m
> redis-cli --cluster del-node 172.31.5.174:6379 eb78bad30480efb75d2dd8edc1693b69278a4bf3
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 1571998 keys | 4681 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 785301 keys | 2341 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 1571380 keys | 4681 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 1571321 keys | 4681 slots | 0 slaves.
[OK] 5500000 keys in 4 masters.
335.69 keys per slot on average.
 
total slots: 16384
Removing node eb78bad30480efb75d2dd8edc1693b69278a4bf3 from cluster 172.31.5.174:6379
Sending CLUSTER FORGET messages to the cluster...
Sending CLUSTER RESET SOFT to the deleted node.
{ distribution: [ 781, 780, 780 ] }
[33m### RESHARDING FROM 172.31.5.54 TO 172.31.5.140 ###
[0m
{ reshardFrom: '172.31.5.54', reshardTo: '172.31.5.140', slots: 781 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 1834130 keys | 5462 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 523169 keys | 1560 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 1571380 keys | 4681 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 1571321 keys | 4681 slots | 0 slaves.
[OK] 5500000 keys in 4 masters.
335.69 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.54 TO 172.31.5.202 ###
[0m
{ reshardFrom: '172.31.5.54', reshardTo: '172.31.5.202', slots: 780 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 1834130 keys | 5462 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 261082 keys | 780 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 1833467 keys | 5461 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 1571321 keys | 4681 slots | 0 slaves.
[OK] 5500000 keys in 4 masters.
335.69 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.54 TO 172.31.5.105 ###
[0m
{ reshardFrom: '172.31.5.54', reshardTo: '172.31.5.105', slots: 780 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 1834130 keys | 5462 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 1833467 keys | 5461 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 1832403 keys | 5461 slots | 1 slaves.
[OK] 5500000 keys in 3 masters.
335.69 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### REMOVING 172.31.5.54:6379 FROM CLUSTER ###
[0m
> redis-cli --cluster del-node 172.31.5.54:6379 763603530a9c3f684038efa73d48c1e19edd2ed9
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 1834130 keys | 5462 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 1833467 keys | 5461 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 1832403 keys | 5461 slots | 0 slaves.
[OK] 5500000 keys in 3 masters.
335.69 keys per slot on average.
 
total slots: 16384
Removing node 763603530a9c3f684038efa73d48c1e19edd2ed9 from cluster 172.31.5.54:6379
Sending CLUSTER FORGET messages to the cluster...
Sending CLUSTER RESET SOFT to the deleted node.
[33m### REBALANCING CLUSTER ON 172.31.5.140:6379 ###
[0m
> redis-cli --cluster rebalance 172.31.5.140:6379 --cluster-use-empty-masters | grep -i Rebalancing
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 1834130 keys | 5462 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 1833467 keys | 5461 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 1832403 keys | 5461 slots | 0 slaves.
[OK] 5500000 keys in 3 masters.
335.69 keys per slot on average.
 
total slots: 16384
*** No rebalancing needed! All nodes are within the 2.00% threshold.


waiting... 65 64 63 62 61 60 59 58 57 56 55 54 53 52 51 50 49 48 47 46 45 44 43 42 41 40 39 38 37 36 35 34 33 32 31 30 29 28 27 26 25 24 23 22 21 20 19 18 17 16 15 14 13 12 11 10 9 8 7 6 5 4 3 2 1 



[34m******* resize , 3 completed ******* [0m 

------------------------------------------------------------------

[34m******* write , 500000 *******[0m

[33m### WRITING 500000 KEYS ###
[0m
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 2000880 keys | 5462 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 2000114 keys | 5461 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 1999006 keys | 5461 slots | 0 slaves.
[OK] 6000000 keys in 3 masters.
366.21 keys per slot on average.
 
total slots: 16384
0.5M keys written successfully

[34m******* write , 500000 completed ******* [0m 

------------------------------------------------------------------

[34m******* resize , 7 *******[0m

{ clusterSize: 3 }
[33m### ADDING 172.31.5.54:6379 NODE TO CLUSTER ###
[0m
> redis-cli --cluster add-node 172.31.5.54:6379 172.31.5.140:6379 | awk '{ gsub(/[[0-9;]*m/, ""); print }'
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 2000880 keys | 5462 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 2000114 keys | 5461 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 1999006 keys | 5461 slots | 0 slaves.
[OK] 6000000 keys in 4 masters.
366.21 keys per slot on average.
 
total slots: 16384
node added successfully
waiting... 2 1 


[33m### ADDING 172.31.5.174:6379 NODE TO CLUSTER ###
[0m
> redis-cli --cluster add-node 172.31.5.174:6379 172.31.5.140:6379 | awk '{ gsub(/[[0-9;]*m/, ""); print }'
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 2000880 keys | 5462 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 2000114 keys | 5461 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 1999006 keys | 5461 slots | 0 slaves.
[OK] 6000000 keys in 5 masters.
366.21 keys per slot on average.
 
total slots: 16384
node added successfully
waiting... 2 1 


[33m### ADDING 172.31.5.145:6379 NODE TO CLUSTER ###
[0m
> redis-cli --cluster add-node 172.31.5.145:6379 172.31.5.140:6379 | awk '{ gsub(/[[0-9;]*m/, ""); print }'
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 2000880 keys | 5462 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 2000114 keys | 5461 slots | 0 slaves.
172.31.5.145:6379 (d611c8f1...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 1999006 keys | 5461 slots | 0 slaves.
[OK] 6000000 keys in 6 masters.
366.21 keys per slot on average.
 
total slots: 16384
node added successfully
waiting... 2 1 


[33m### ADDING 172.31.5.233:6379 NODE TO CLUSTER ###
[0m
> redis-cli --cluster add-node 172.31.5.233:6379 172.31.5.140:6379 | awk '{ gsub(/[[0-9;]*m/, ""); print }'
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 2000880 keys | 5462 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 2000114 keys | 5461 slots | 0 slaves.
172.31.5.145:6379 (d611c8f1...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 1999006 keys | 5461 slots | 0 slaves.
172.31.5.233:6379 (250399ba...) -> 0 keys | 0 slots | 0 slaves.
[OK] 6000000 keys in 7 masters.
366.21 keys per slot on average.
 
total slots: 16384
node added successfully
waiting... 2 1 


waiting... 10 9 8 7 6 5 4 3 2 1 


[33m### REBALANCING CLUSTER ON 172.31.5.54:6379 ###
[0m
> redis-cli --cluster rebalance 172.31.5.54:6379 --cluster-use-empty-masters | grep -i Rebalancing
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 857422 keys | 2340 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 857210 keys | 2341 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 857007 keys | 2341 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 856699 keys | 2340 slots | 0 slaves.
172.31.5.145:6379 (d611c8f1...) -> 857838 keys | 2341 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 856623 keys | 2340 slots | 0 slaves.
172.31.5.233:6379 (250399ba...) -> 857201 keys | 2341 slots | 0 slaves.
[OK] 6000000 keys in 7 masters.
366.21 keys per slot on average.
 
total slots: 16384
>>> Rebalancing across 7 nodes. Total weight = 7.00



[34m******* resize , 7 completed ******* [0m 

------------------------------------------------------------------

[34m******* write , 500000 *******[0m

[33m### WRITING 500000 KEYS ###
[0m
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 928895 keys | 2340 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 928636 keys | 2341 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 928403 keys | 2341 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 928062 keys | 2340 slots | 0 slaves.
172.31.5.145:6379 (d611c8f1...) -> 929344 keys | 2341 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 928025 keys | 2340 slots | 0 slaves.
172.31.5.233:6379 (250399ba...) -> 928635 keys | 2341 slots | 0 slaves.
[OK] 6500000 keys in 7 masters.
396.73 keys per slot on average.
 
total slots: 16384
0.5M keys written successfully

[34m******* write , 500000 completed ******* [0m 

------------------------------------------------------------------

[34m******* resize , 4 *******[0m

{ clusterSize: 7 }
[33m### REBALANCING CLUSTER ON 172.31.5.233:6379 ###
[0m
> redis-cli --cluster rebalance 172.31.5.233:6379 --cluster-use-empty-masters | grep -i Rebalancing
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 928895 keys | 2340 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 928636 keys | 2341 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 928403 keys | 2341 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 928062 keys | 2340 slots | 0 slaves.
172.31.5.145:6379 (d611c8f1...) -> 929344 keys | 2341 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 928025 keys | 2340 slots | 0 slaves.
172.31.5.233:6379 (250399ba...) -> 928635 keys | 2341 slots | 0 slaves.
[OK] 6500000 keys in 7 masters.
396.73 keys per slot on average.
 
total slots: 16384
*** No rebalancing needed! All nodes are within the 2.00% threshold.


{ distribution: [ 586, 585, 585, 585 ] }
[33m### RESHARDING FROM 172.31.5.233 TO 172.31.5.140 ###
[0m
{ reshardFrom: '172.31.5.233', reshardTo: '172.31.5.140', slots: 586 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 1161201 keys | 2926 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 928636 keys | 2341 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 928403 keys | 2341 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 928062 keys | 2340 slots | 0 slaves.
172.31.5.145:6379 (d611c8f1...) -> 929344 keys | 2341 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 928025 keys | 2340 slots | 0 slaves.
172.31.5.233:6379 (250399ba...) -> 696329 keys | 1755 slots | 0 slaves.
[OK] 6500000 keys in 7 masters.
396.73 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.233 TO 172.31.5.202 ###
[0m
{ reshardFrom: '172.31.5.233', reshardTo: '172.31.5.202', slots: 585 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 1161201 keys | 2926 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 928636 keys | 2341 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 928403 keys | 2341 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 1159972 keys | 2925 slots | 0 slaves.
172.31.5.145:6379 (d611c8f1...) -> 929344 keys | 2341 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 928025 keys | 2340 slots | 0 slaves.
172.31.5.233:6379 (250399ba...) -> 464419 keys | 1170 slots | 0 slaves.
[OK] 6500000 keys in 7 masters.
396.73 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.233 TO 172.31.5.105 ###
[0m
{ reshardFrom: '172.31.5.233', reshardTo: '172.31.5.105', slots: 585 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 1161201 keys | 2926 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 928636 keys | 2341 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 928403 keys | 2341 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 1159972 keys | 2925 slots | 0 slaves.
172.31.5.145:6379 (d611c8f1...) -> 929344 keys | 2341 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 1159864 keys | 2925 slots | 0 slaves.
172.31.5.233:6379 (250399ba...) -> 232580 keys | 585 slots | 0 slaves.
[OK] 6500000 keys in 7 masters.
396.73 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.233 TO 172.31.5.54 ###
[0m
{ reshardFrom: '172.31.5.233', reshardTo: '172.31.5.54', slots: 585 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 1161201 keys | 2926 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 1161216 keys | 2926 slots | 1 slaves.
172.31.5.174:6379 (eb78bad3...) -> 928403 keys | 2341 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 1159972 keys | 2925 slots | 0 slaves.
172.31.5.145:6379 (d611c8f1...) -> 929344 keys | 2341 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 1159864 keys | 2925 slots | 0 slaves.
[OK] 6500000 keys in 6 masters.
396.73 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### REMOVING 172.31.5.233:6379 FROM CLUSTER ###
[0m
> redis-cli --cluster del-node 172.31.5.233:6379 250399ba29619b7a1a6d2ed08a6fc58a65b395e2
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 1161201 keys | 2926 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 1161216 keys | 2926 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 928403 keys | 2341 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 1159972 keys | 2925 slots | 0 slaves.
172.31.5.145:6379 (d611c8f1...) -> 929344 keys | 2341 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 1159864 keys | 2925 slots | 0 slaves.
[OK] 6500000 keys in 6 masters.
396.73 keys per slot on average.
 
total slots: 16384
Removing node 250399ba29619b7a1a6d2ed08a6fc58a65b395e2 from cluster 172.31.5.233:6379
Sending CLUSTER FORGET messages to the cluster...
Sending CLUSTER RESET SOFT to the deleted node.
{ distribution: [ 586, 585, 585, 585 ] }
[33m### RESHARDING FROM 172.31.5.145 TO 172.31.5.202 ###
[0m
{ reshardFrom: '172.31.5.145', reshardTo: '172.31.5.202', slots: 586 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 1161201 keys | 2926 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 1161216 keys | 2926 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 928403 keys | 2341 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 1392280 keys | 3511 slots | 0 slaves.
172.31.5.145:6379 (d611c8f1...) -> 697036 keys | 1755 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 1159864 keys | 2925 slots | 0 slaves.
[OK] 6500000 keys in 6 masters.
396.73 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.145 TO 172.31.5.105 ###
[0m
{ reshardFrom: '172.31.5.145', reshardTo: '172.31.5.105', slots: 585 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 1161201 keys | 2926 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 1161216 keys | 2926 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 928403 keys | 2341 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 1392280 keys | 3511 slots | 0 slaves.
172.31.5.145:6379 (d611c8f1...) -> 464504 keys | 1170 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 1392396 keys | 3510 slots | 0 slaves.
[OK] 6500000 keys in 6 masters.
396.73 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.145 TO 172.31.5.54 ###
[0m
{ reshardFrom: '172.31.5.145', reshardTo: '172.31.5.54', slots: 585 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 1161201 keys | 2926 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 1393095 keys | 3511 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 928403 keys | 2341 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 1392280 keys | 3511 slots | 0 slaves.
172.31.5.145:6379 (d611c8f1...) -> 232625 keys | 585 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 1392396 keys | 3510 slots | 0 slaves.
[OK] 6500000 keys in 6 masters.
396.73 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.145 TO 172.31.5.140 ###
[0m
{ reshardFrom: '172.31.5.145', reshardTo: '172.31.5.140', slots: 585 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 1393826 keys | 3511 slots | 1 slaves.
172.31.5.54:6379 (76360353...) -> 1393095 keys | 3511 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 928403 keys | 2341 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 1392280 keys | 3511 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 1392396 keys | 3510 slots | 0 slaves.
[OK] 6500000 keys in 5 masters.
396.73 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### REMOVING 172.31.5.145:6379 FROM CLUSTER ###
[0m
> redis-cli --cluster del-node 172.31.5.145:6379 d611c8f107b68363148c7a7021067200ee2a4a4a
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 1393826 keys | 3511 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 1393095 keys | 3511 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 928403 keys | 2341 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 1392280 keys | 3511 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 1392396 keys | 3510 slots | 0 slaves.
[OK] 6500000 keys in 5 masters.
396.73 keys per slot on average.
 
total slots: 16384
Removing node d611c8f107b68363148c7a7021067200ee2a4a4a from cluster 172.31.5.145:6379
Sending CLUSTER FORGET messages to the cluster...
Sending CLUSTER RESET SOFT to the deleted node.
{ distribution: [ 586, 585, 585, 585 ] }
[33m### RESHARDING FROM 172.31.5.174 TO 172.31.5.105 ###
[0m
{ reshardFrom: '172.31.5.174', reshardTo: '172.31.5.105', slots: 586 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 1393826 keys | 3511 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 1393095 keys | 3511 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 695824 keys | 1755 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 1392280 keys | 3511 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 1624975 keys | 4096 slots | 0 slaves.
[OK] 6500000 keys in 5 masters.
396.73 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.174 TO 172.31.5.54 ###
[0m
{ reshardFrom: '172.31.5.174', reshardTo: '172.31.5.54', slots: 585 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 1393826 keys | 3511 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 1625005 keys | 4096 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 463914 keys | 1170 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 1392280 keys | 3511 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 1624975 keys | 4096 slots | 0 slaves.
[OK] 6500000 keys in 5 masters.
396.73 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.174 TO 172.31.5.140 ###
[0m
{ reshardFrom: '172.31.5.174', reshardTo: '172.31.5.140', slots: 585 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 1625626 keys | 4096 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 1625005 keys | 4096 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 232114 keys | 585 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 1392280 keys | 3511 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 1624975 keys | 4096 slots | 0 slaves.
[OK] 6500000 keys in 5 masters.
396.73 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.174 TO 172.31.5.202 ###
[0m
{ reshardFrom: '172.31.5.174', reshardTo: '172.31.5.202', slots: 585 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 1625626 keys | 4096 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 1625005 keys | 4096 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 1624394 keys | 4096 slots | 1 slaves.
172.31.5.105:6379 (9d4816cf...) -> 1624975 keys | 4096 slots | 0 slaves.
[OK] 6500000 keys in 4 masters.
396.73 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### REMOVING 172.31.5.174:6379 FROM CLUSTER ###
[0m
> redis-cli --cluster del-node 172.31.5.174:6379 eb78bad30480efb75d2dd8edc1693b69278a4bf3
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 1625626 keys | 4096 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 1625005 keys | 4096 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 1624394 keys | 4096 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 1624975 keys | 4096 slots | 0 slaves.
[OK] 6500000 keys in 4 masters.
396.73 keys per slot on average.
 
total slots: 16384
Removing node eb78bad30480efb75d2dd8edc1693b69278a4bf3 from cluster 172.31.5.174:6379
Sending CLUSTER FORGET messages to the cluster...
Sending CLUSTER RESET SOFT to the deleted node.
[33m### REBALANCING CLUSTER ON 172.31.5.140:6379 ###
[0m
> redis-cli --cluster rebalance 172.31.5.140:6379 --cluster-use-empty-masters | grep -i Rebalancing
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 1625626 keys | 4096 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 1625005 keys | 4096 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 1624394 keys | 4096 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 1624975 keys | 4096 slots | 0 slaves.
[OK] 6500000 keys in 4 masters.
396.73 keys per slot on average.
 
total slots: 16384
*** No rebalancing needed! All nodes are within the 2.00% threshold.


waiting... 65 64 63 62 61 60 59 58 57 56 55 54 53 52 51 50 49 48 47 46 45 44 43 42 41 40 39 38 37 36 35 34 33 32 31 30 29 28 27 26 25 24 23 22 21 20 19 18 17 16 15 14 13 12 11 10 9 8 7 6 5 4 3 2 1 



[34m******* resize , 4 completed ******* [0m 

------------------------------------------------------------------

[34m******* write , 500000 *******[0m

[33m### WRITING 500000 KEYS ###
[0m
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 1750739 keys | 4096 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 1750065 keys | 4096 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 1749230 keys | 4096 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 1749966 keys | 4096 slots | 0 slaves.
[OK] 7000000 keys in 4 masters.
427.25 keys per slot on average.
 
total slots: 16384
0.5M keys written successfully

[34m******* write , 500000 completed ******* [0m 

------------------------------------------------------------------

[34m******* resize , 7 *******[0m

{ clusterSize: 4 }
[33m### ADDING 172.31.5.174:6379 NODE TO CLUSTER ###
[0m
> redis-cli --cluster add-node 172.31.5.174:6379 172.31.5.140:6379 | awk '{ gsub(/[[0-9;]*m/, ""); print }'
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 1750739 keys | 4096 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 1750065 keys | 4096 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 1749230 keys | 4096 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 1749966 keys | 4096 slots | 0 slaves.
[OK] 7000000 keys in 5 masters.
427.25 keys per slot on average.
 
total slots: 16384
node added successfully
waiting... 2 1 


[33m### ADDING 172.31.5.145:6379 NODE TO CLUSTER ###
[0m
> redis-cli --cluster add-node 172.31.5.145:6379 172.31.5.140:6379 | awk '{ gsub(/[[0-9;]*m/, ""); print }'
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 1750739 keys | 4096 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 1750065 keys | 4096 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 1749230 keys | 4096 slots | 0 slaves.
172.31.5.145:6379 (d611c8f1...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 1749966 keys | 4096 slots | 0 slaves.
[OK] 7000000 keys in 6 masters.
427.25 keys per slot on average.
 
total slots: 16384
node added successfully
waiting... 2 1 


[33m### ADDING 172.31.5.233:6379 NODE TO CLUSTER ###
[0m
> redis-cli --cluster add-node 172.31.5.233:6379 172.31.5.140:6379 | awk '{ gsub(/[[0-9;]*m/, ""); print }'
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 1750739 keys | 4096 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 1750065 keys | 4096 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 1749230 keys | 4096 slots | 0 slaves.
172.31.5.145:6379 (d611c8f1...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 1749966 keys | 4096 slots | 0 slaves.
172.31.5.233:6379 (250399ba...) -> 0 keys | 0 slots | 0 slaves.
[OK] 7000000 keys in 7 masters.
427.25 keys per slot on average.
 
total slots: 16384
node added successfully
waiting... 2 1 


waiting... 10 9 8 7 6 5 4 3 2 1 


[33m### REBALANCING CLUSTER ON 172.31.5.174:6379 ###
[0m
> redis-cli --cluster rebalance 172.31.5.174:6379 --cluster-use-empty-masters | grep -i Rebalancing
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 999803 keys | 2340 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 1000481 keys | 2340 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 1001801 keys | 2342 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 999226 keys | 2340 slots | 0 slaves.
172.31.5.145:6379 (d611c8f1...) -> 999730 keys | 2341 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 999343 keys | 2340 slots | 0 slaves.
172.31.5.233:6379 (250399ba...) -> 999616 keys | 2341 slots | 0 slaves.
[OK] 7000000 keys in 7 masters.
427.25 keys per slot on average.
 
total slots: 16384
>>> Rebalancing across 7 nodes. Total weight = 7.00



[34m******* resize , 7 completed ******* [0m 

------------------------------------------------------------------

[34m******* write , 500000 *******[0m

[33m### WRITING 500000 KEYS ###
[0m
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 1071179 keys | 2340 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 1071898 keys | 2340 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 1073369 keys | 2342 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 1070598 keys | 2340 slots | 0 slaves.
172.31.5.145:6379 (d611c8f1...) -> 1071174 keys | 2341 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 1070728 keys | 2340 slots | 0 slaves.
172.31.5.233:6379 (250399ba...) -> 1071054 keys | 2341 slots | 0 slaves.
[OK] 7500000 keys in 7 masters.
457.76 keys per slot on average.
 
total slots: 16384
0.5M keys written successfully

[34m******* write , 500000 completed ******* [0m 

------------------------------------------------------------------

[34m******* resize , 5 *******[0m

{ clusterSize: 7 }
[33m### REBALANCING CLUSTER ON 172.31.5.233:6379 ###
[0m
> redis-cli --cluster rebalance 172.31.5.233:6379 --cluster-use-empty-masters | grep -i Rebalancing
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 1071179 keys | 2340 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 1071898 keys | 2340 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 1073369 keys | 2342 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 1070598 keys | 2340 slots | 0 slaves.
172.31.5.145:6379 (d611c8f1...) -> 1071174 keys | 2341 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 1070728 keys | 2340 slots | 0 slaves.
172.31.5.233:6379 (250399ba...) -> 1071054 keys | 2341 slots | 0 slaves.
[OK] 7500000 keys in 7 masters.
457.76 keys per slot on average.
 
total slots: 16384
*** No rebalancing needed! All nodes are within the 2.00% threshold.


{ distribution: [ 469, 468, 468, 468, 468 ] }
[33m### RESHARDING FROM 172.31.5.233 TO 172.31.5.140 ###
[0m
{ reshardFrom: '172.31.5.233', reshardTo: '172.31.5.140', slots: 469 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 1285478 keys | 2809 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 1071898 keys | 2340 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 1073369 keys | 2342 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 1070598 keys | 2340 slots | 0 slaves.
172.31.5.145:6379 (d611c8f1...) -> 1071174 keys | 2341 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 1070728 keys | 2340 slots | 0 slaves.
172.31.5.233:6379 (250399ba...) -> 856755 keys | 1872 slots | 0 slaves.
[OK] 7500000 keys in 7 masters.
457.76 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.233 TO 172.31.5.202 ###
[0m
{ reshardFrom: '172.31.5.233', reshardTo: '172.31.5.202', slots: 468 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 1285478 keys | 2809 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 1071898 keys | 2340 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 1073369 keys | 2342 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 1285189 keys | 2808 slots | 0 slaves.
172.31.5.145:6379 (d611c8f1...) -> 1071174 keys | 2341 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 1070728 keys | 2340 slots | 0 slaves.
172.31.5.233:6379 (250399ba...) -> 642164 keys | 1404 slots | 0 slaves.
[OK] 7500000 keys in 7 masters.
457.76 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.233 TO 172.31.5.105 ###
[0m
{ reshardFrom: '172.31.5.233', reshardTo: '172.31.5.105', slots: 468 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 1285478 keys | 2809 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 1071898 keys | 2340 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 1073369 keys | 2342 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 1285189 keys | 2808 slots | 0 slaves.
172.31.5.145:6379 (d611c8f1...) -> 1071174 keys | 2341 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 1284988 keys | 2808 slots | 0 slaves.
172.31.5.233:6379 (250399ba...) -> 427904 keys | 936 slots | 0 slaves.
[OK] 7500000 keys in 7 masters.
457.76 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.233 TO 172.31.5.54 ###
[0m
{ reshardFrom: '172.31.5.233', reshardTo: '172.31.5.54', slots: 468 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 1285478 keys | 2809 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 1285748 keys | 2808 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 1073369 keys | 2342 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 1285189 keys | 2808 slots | 0 slaves.
172.31.5.145:6379 (d611c8f1...) -> 1071174 keys | 2341 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 1284988 keys | 2808 slots | 0 slaves.
172.31.5.233:6379 (250399ba...) -> 214054 keys | 468 slots | 0 slaves.
[OK] 7500000 keys in 7 masters.
457.76 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.233 TO 172.31.5.174 ###
[0m
{ reshardFrom: '172.31.5.233', reshardTo: '172.31.5.174', slots: 468 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 1285478 keys | 2809 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 1285748 keys | 2808 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 1287423 keys | 2810 slots | 1 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 1285189 keys | 2808 slots | 0 slaves.
172.31.5.145:6379 (d611c8f1...) -> 1071174 keys | 2341 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 1284988 keys | 2808 slots | 0 slaves.
[OK] 7500000 keys in 6 masters.
457.76 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### REMOVING 172.31.5.233:6379 FROM CLUSTER ###
[0m
> redis-cli --cluster del-node 172.31.5.233:6379 250399ba29619b7a1a6d2ed08a6fc58a65b395e2
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 1285478 keys | 2809 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 1285748 keys | 2808 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 1287423 keys | 2810 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 1285189 keys | 2808 slots | 0 slaves.
172.31.5.145:6379 (d611c8f1...) -> 1071174 keys | 2341 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 1284988 keys | 2808 slots | 0 slaves.
[OK] 7500000 keys in 6 masters.
457.76 keys per slot on average.
 
total slots: 16384
Removing node 250399ba29619b7a1a6d2ed08a6fc58a65b395e2 from cluster 172.31.5.233:6379
Sending CLUSTER FORGET messages to the cluster...
Sending CLUSTER RESET SOFT to the deleted node.
{ distribution: [ 469, 468, 468, 468, 468 ] }
[33m### RESHARDING FROM 172.31.5.145 TO 172.31.5.202 ###
[0m
{ reshardFrom: '172.31.5.145', reshardTo: '172.31.5.202', slots: 469 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 1285478 keys | 2809 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 1285748 keys | 2808 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 1287423 keys | 2810 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 1499240 keys | 3277 slots | 0 slaves.
172.31.5.145:6379 (d611c8f1...) -> 857123 keys | 1872 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 1284988 keys | 2808 slots | 0 slaves.
[OK] 7500000 keys in 6 masters.
457.76 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.145 TO 172.31.5.105 ###
[0m
{ reshardFrom: '172.31.5.145', reshardTo: '172.31.5.105', slots: 468 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 1285478 keys | 2809 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 1285748 keys | 2808 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 1287423 keys | 2810 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 1499240 keys | 3277 slots | 0 slaves.
172.31.5.145:6379 (d611c8f1...) -> 642446 keys | 1404 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 1499665 keys | 3276 slots | 0 slaves.
[OK] 7500000 keys in 6 masters.
457.76 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.145 TO 172.31.5.54 ###
[0m
{ reshardFrom: '172.31.5.145', reshardTo: '172.31.5.54', slots: 468 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 1285478 keys | 2809 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 1499519 keys | 3276 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 1287423 keys | 2810 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 1499240 keys | 3277 slots | 0 slaves.
172.31.5.145:6379 (d611c8f1...) -> 428675 keys | 936 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 1499665 keys | 3276 slots | 0 slaves.
[OK] 7500000 keys in 6 masters.
457.76 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.145 TO 172.31.5.174 ###
[0m
{ reshardFrom: '172.31.5.145', reshardTo: '172.31.5.174', slots: 468 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 1285478 keys | 2809 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 1499519 keys | 3276 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 1501351 keys | 3278 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 1499240 keys | 3277 slots | 0 slaves.
172.31.5.145:6379 (d611c8f1...) -> 214747 keys | 468 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 1499665 keys | 3276 slots | 0 slaves.
[OK] 7500000 keys in 6 masters.
457.76 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.145 TO 172.31.5.140 ###
[0m
{ reshardFrom: '172.31.5.145', reshardTo: '172.31.5.140', slots: 468 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 1500225 keys | 3277 slots | 1 slaves.
172.31.5.54:6379 (76360353...) -> 1499519 keys | 3276 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 1501351 keys | 3278 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 1499240 keys | 3277 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 1499665 keys | 3276 slots | 0 slaves.
[OK] 7500000 keys in 5 masters.
457.76 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### REMOVING 172.31.5.145:6379 FROM CLUSTER ###
[0m
> redis-cli --cluster del-node 172.31.5.145:6379 d611c8f107b68363148c7a7021067200ee2a4a4a
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 1500225 keys | 3277 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 1499519 keys | 3276 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 1501351 keys | 3278 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 1499240 keys | 3277 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 1499665 keys | 3276 slots | 0 slaves.
[OK] 7500000 keys in 5 masters.
457.76 keys per slot on average.
 
total slots: 16384
Removing node d611c8f107b68363148c7a7021067200ee2a4a4a from cluster 172.31.5.145:6379
Sending CLUSTER FORGET messages to the cluster...
Sending CLUSTER RESET SOFT to the deleted node.
[33m### REBALANCING CLUSTER ON 172.31.5.140:6379 ###
[0m
> redis-cli --cluster rebalance 172.31.5.140:6379 --cluster-use-empty-masters | grep -i Rebalancing
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 1500225 keys | 3277 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 1499519 keys | 3276 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 1501351 keys | 3278 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 1499240 keys | 3277 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 1499665 keys | 3276 slots | 0 slaves.
[OK] 7500000 keys in 5 masters.
457.76 keys per slot on average.
 
total slots: 16384
*** No rebalancing needed! All nodes are within the 2.00% threshold.


waiting... 65 64 63 62 61 60 59 58 57 56 55 54 53 52 51 50 49 48 47 46 45 44 43 42 41 40 39 38 37 36 35 34 33 32 31 30 29 28 27 26 25 24 23 22 21 20 19 18 17 16 15 14 13 12 11 10 9 8 7 6 5 4 3 2 1 



[34m******* resize , 5 completed ******* [0m 

------------------------------------------------------------------

[34m******* write , 500000 *******[0m

[33m### WRITING 500000 KEYS ###
[0m
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 1600212 keys | 3277 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 1599500 keys | 3276 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 1601342 keys | 3278 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 1599329 keys | 3277 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 1599617 keys | 3276 slots | 0 slaves.
[OK] 8000000 keys in 5 masters.
488.28 keys per slot on average.
 
total slots: 16384
0.5M keys written successfully

[34m******* write , 500000 completed ******* [0m 

------------------------------------------------------------------

[34m******* resize , 7 *******[0m

{ clusterSize: 5 }
[33m### ADDING 172.31.5.145:6379 NODE TO CLUSTER ###
[0m
> redis-cli --cluster add-node 172.31.5.145:6379 172.31.5.140:6379 | awk '{ gsub(/[[0-9;]*m/, ""); print }'
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 1600212 keys | 3277 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 1599500 keys | 3276 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 1601342 keys | 3278 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 1599329 keys | 3277 slots | 0 slaves.
172.31.5.145:6379 (d611c8f1...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 1599617 keys | 3276 slots | 0 slaves.
[OK] 8000000 keys in 6 masters.
488.28 keys per slot on average.
 
total slots: 16384
node added successfully
waiting... 2 1 


[33m### ADDING 172.31.5.233:6379 NODE TO CLUSTER ###
[0m
> redis-cli --cluster add-node 172.31.5.233:6379 172.31.5.140:6379 | awk '{ gsub(/[[0-9;]*m/, ""); print }'
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 1600212 keys | 3277 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 1599500 keys | 3276 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 1601342 keys | 3278 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 1599329 keys | 3277 slots | 0 slaves.
172.31.5.145:6379 (d611c8f1...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 1599617 keys | 3276 slots | 0 slaves.
172.31.5.233:6379 (250399ba...) -> 0 keys | 0 slots | 0 slaves.
[OK] 8000000 keys in 7 masters.
488.28 keys per slot on average.
 
total slots: 16384
node added successfully
waiting... 2 1 


waiting... 10 9 8 7 6 5 4 3 2 1 


[33m### REBALANCING CLUSTER ON 172.31.5.145:6379 ###
[0m
> redis-cli --cluster rebalance 172.31.5.145:6379 --cluster-use-empty-masters | grep -i Rebalancing
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 1143237 keys | 2340 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 1142898 keys | 2340 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 1142722 keys | 2340 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 1142048 keys | 2340 slots | 0 slaves.
172.31.5.145:6379 (d611c8f1...) -> 1143028 keys | 2342 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 1142157 keys | 2340 slots | 0 slaves.
172.31.5.233:6379 (250399ba...) -> 1143910 keys | 2342 slots | 0 slaves.
[OK] 8000000 keys in 7 masters.
488.28 keys per slot on average.
 
total slots: 16384
>>> Rebalancing across 7 nodes. Total weight = 7.00



[34m******* resize , 7 completed ******* [0m 

------------------------------------------------------------------

[34m******* write , 500000 *******[0m

[33m### WRITING 500000 KEYS ###
[0m
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 1214671 keys | 2340 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 1214309 keys | 2340 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 1214143 keys | 2340 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 1213441 keys | 2340 slots | 0 slaves.
172.31.5.145:6379 (d611c8f1...) -> 1214529 keys | 2342 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 1213543 keys | 2340 slots | 0 slaves.
172.31.5.233:6379 (250399ba...) -> 1215364 keys | 2342 slots | 0 slaves.
[OK] 8500000 keys in 7 masters.
518.80 keys per slot on average.
 
total slots: 16384
0.5M keys written successfully

[34m******* write , 500000 completed ******* [0m 

------------------------------------------------------------------

[34m******* resize , 6 *******[0m

{ clusterSize: 7 }
[33m### REBALANCING CLUSTER ON 172.31.5.233:6379 ###
[0m
> redis-cli --cluster rebalance 172.31.5.233:6379 --cluster-use-empty-masters | grep -i Rebalancing
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 1214671 keys | 2340 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 1214309 keys | 2340 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 1214143 keys | 2340 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 1213441 keys | 2340 slots | 0 slaves.
172.31.5.145:6379 (d611c8f1...) -> 1214529 keys | 2342 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 1213543 keys | 2340 slots | 0 slaves.
172.31.5.233:6379 (250399ba...) -> 1215364 keys | 2342 slots | 0 slaves.
[OK] 8500000 keys in 7 masters.
518.80 keys per slot on average.
 
total slots: 16384
*** No rebalancing needed! All nodes are within the 2.00% threshold.


{ distribution: [ 391, 391, 390, 390, 390, 390 ] }
[33m### RESHARDING FROM 172.31.5.233 TO 172.31.5.140 ###
[0m
{ reshardFrom: '172.31.5.233', reshardTo: '172.31.5.140', slots: 391 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 1417886 keys | 2731 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 1214309 keys | 2340 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 1214143 keys | 2340 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 1213441 keys | 2340 slots | 0 slaves.
172.31.5.145:6379 (d611c8f1...) -> 1214529 keys | 2342 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 1213543 keys | 2340 slots | 0 slaves.
172.31.5.233:6379 (250399ba...) -> 1012149 keys | 1951 slots | 0 slaves.
[OK] 8500000 keys in 7 masters.
518.80 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.233 TO 172.31.5.202 ###
[0m
{ reshardFrom: '172.31.5.233', reshardTo: '172.31.5.202', slots: 391 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 1417886 keys | 2731 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 1214309 keys | 2340 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 1214143 keys | 2340 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 1416330 keys | 2731 slots | 0 slaves.
172.31.5.145:6379 (d611c8f1...) -> 1214529 keys | 2342 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 1213543 keys | 2340 slots | 0 slaves.
172.31.5.233:6379 (250399ba...) -> 809260 keys | 1560 slots | 0 slaves.
[OK] 8500000 keys in 7 masters.
518.80 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.233 TO 172.31.5.105 ###
[0m
{ reshardFrom: '172.31.5.233', reshardTo: '172.31.5.105', slots: 390 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 1417886 keys | 2731 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 1214309 keys | 2340 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 1214143 keys | 2340 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 1416330 keys | 2731 slots | 0 slaves.
172.31.5.145:6379 (d611c8f1...) -> 1214529 keys | 2342 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 1415384 keys | 2730 slots | 0 slaves.
172.31.5.233:6379 (250399ba...) -> 607419 keys | 1170 slots | 0 slaves.
[OK] 8500000 keys in 7 masters.
518.80 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.233 TO 172.31.5.54 ###
[0m
{ reshardFrom: '172.31.5.233', reshardTo: '172.31.5.54', slots: 390 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 1417886 keys | 2731 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 1417238 keys | 2730 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 1214143 keys | 2340 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 1416330 keys | 2731 slots | 0 slaves.
172.31.5.145:6379 (d611c8f1...) -> 1214529 keys | 2342 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 1415384 keys | 2730 slots | 0 slaves.
172.31.5.233:6379 (250399ba...) -> 404490 keys | 780 slots | 0 slaves.
[OK] 8500000 keys in 7 masters.
518.80 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.233 TO 172.31.5.174 ###
[0m
{ reshardFrom: '172.31.5.233', reshardTo: '172.31.5.174', slots: 390 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 1417886 keys | 2731 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 1417238 keys | 2730 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 1416159 keys | 2730 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 1416330 keys | 2731 slots | 0 slaves.
172.31.5.145:6379 (d611c8f1...) -> 1214529 keys | 2342 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 1415384 keys | 2730 slots | 0 slaves.
172.31.5.233:6379 (250399ba...) -> 202474 keys | 390 slots | 0 slaves.
[OK] 8500000 keys in 7 masters.
518.80 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.233 TO 172.31.5.145 ###
[0m
{ reshardFrom: '172.31.5.233', reshardTo: '172.31.5.145', slots: 390 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 1417886 keys | 2731 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 1417238 keys | 2730 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 1416159 keys | 2730 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 1416330 keys | 2731 slots | 0 slaves.
172.31.5.145:6379 (d611c8f1...) -> 1417003 keys | 2732 slots | 1 slaves.
172.31.5.105:6379 (9d4816cf...) -> 1415384 keys | 2730 slots | 0 slaves.
[OK] 8500000 keys in 6 masters.
518.80 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### REMOVING 172.31.5.233:6379 FROM CLUSTER ###
[0m
> redis-cli --cluster del-node 172.31.5.233:6379 250399ba29619b7a1a6d2ed08a6fc58a65b395e2
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 1417886 keys | 2731 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 1417238 keys | 2730 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 1416159 keys | 2730 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 1416330 keys | 2731 slots | 0 slaves.
172.31.5.145:6379 (d611c8f1...) -> 1417003 keys | 2732 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 1415384 keys | 2730 slots | 0 slaves.
[OK] 8500000 keys in 6 masters.
518.80 keys per slot on average.
 
total slots: 16384
Removing node 250399ba29619b7a1a6d2ed08a6fc58a65b395e2 from cluster 172.31.5.233:6379
Sending CLUSTER FORGET messages to the cluster...
Sending CLUSTER RESET SOFT to the deleted node.
[33m### REBALANCING CLUSTER ON 172.31.5.140:6379 ###
[0m
> redis-cli --cluster rebalance 172.31.5.140:6379 --cluster-use-empty-masters | grep -i Rebalancing
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 1417886 keys | 2731 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 1417238 keys | 2730 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 1416159 keys | 2730 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 1416330 keys | 2731 slots | 0 slaves.
172.31.5.145:6379 (d611c8f1...) -> 1417003 keys | 2732 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 1415384 keys | 2730 slots | 0 slaves.
[OK] 8500000 keys in 6 masters.
518.80 keys per slot on average.
 
total slots: 16384
*** No rebalancing needed! All nodes are within the 2.00% threshold.


waiting... 65 64 63 62 61 60 59 58 57 56 55 54 53 52 51 50 49 48 47 46 45 44 43 42 41 40 39 38 37 36 35 34 33 32 31 30 29 28 27 26 25 24 23 22 21 20 19 18 17 16 15 14 13 12 11 10 9 8 7 6 5 4 3 2 1 



[34m******* resize , 6 completed ******* [0m 

------------------------------------------------------------------

[34m******* write , 500000 *******[0m

[33m### WRITING 500000 KEYS ###
[0m
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 1501380 keys | 2731 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 1500702 keys | 2730 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 1499449 keys | 2730 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 1499616 keys | 2731 slots | 0 slaves.
172.31.5.145:6379 (d611c8f1...) -> 1500263 keys | 2732 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 1498590 keys | 2730 slots | 0 slaves.
[OK] 9000000 keys in 6 masters.
549.32 keys per slot on average.
 
total slots: 16384
0.5M keys written successfully

[34m******* write , 500000 completed ******* [0m 

------------------------------------------------------------------

[34m******* resize , 3 *******[0m

{ clusterSize: 6 }
[33m### REBALANCING CLUSTER ON 172.31.5.145:6379 ###
[0m
> redis-cli --cluster rebalance 172.31.5.145:6379 --cluster-use-empty-masters | grep -i Rebalancing
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 1501380 keys | 2731 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 1500702 keys | 2730 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 1499449 keys | 2730 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 1499616 keys | 2731 slots | 0 slaves.
172.31.5.145:6379 (d611c8f1...) -> 1500263 keys | 2732 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 1498590 keys | 2730 slots | 0 slaves.
[OK] 9000000 keys in 6 masters.
549.32 keys per slot on average.
 
total slots: 16384
*** No rebalancing needed! All nodes are within the 2.00% threshold.


{ distribution: [ 911, 911, 910 ] }
[33m### RESHARDING FROM 172.31.5.145 TO 172.31.5.140 ###
[0m
{ reshardFrom: '172.31.5.145', reshardTo: '172.31.5.140', slots: 911 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 2000645 keys | 3642 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 1500702 keys | 2730 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 1499449 keys | 2730 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 1499616 keys | 2731 slots | 0 slaves.
172.31.5.145:6379 (d611c8f1...) -> 1000998 keys | 1821 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 1498590 keys | 2730 slots | 0 slaves.
[OK] 9000000 keys in 6 masters.
549.32 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.145 TO 172.31.5.202 ###
[0m
{ reshardFrom: '172.31.5.145', reshardTo: '172.31.5.202', slots: 911 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 2000645 keys | 3642 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 1500702 keys | 2730 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 1499449 keys | 2730 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 2000680 keys | 3642 slots | 0 slaves.
172.31.5.145:6379 (d611c8f1...) -> 499934 keys | 910 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 1498590 keys | 2730 slots | 0 slaves.
[OK] 9000000 keys in 6 masters.
549.32 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.145 TO 172.31.5.105 ###
[0m
{ reshardFrom: '172.31.5.145', reshardTo: '172.31.5.105', slots: 910 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 2000645 keys | 3642 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 1500702 keys | 2730 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 1499449 keys | 2730 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 2000680 keys | 3642 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 1998524 keys | 3640 slots | 1 slaves.
[OK] 9000000 keys in 5 masters.
549.32 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### REMOVING 172.31.5.145:6379 FROM CLUSTER ###
[0m
> redis-cli --cluster del-node 172.31.5.145:6379 d611c8f107b68363148c7a7021067200ee2a4a4a
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 2000645 keys | 3642 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 1500702 keys | 2730 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 1499449 keys | 2730 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 2000680 keys | 3642 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 1998524 keys | 3640 slots | 0 slaves.
[OK] 9000000 keys in 5 masters.
549.32 keys per slot on average.
 
total slots: 16384
Removing node d611c8f107b68363148c7a7021067200ee2a4a4a from cluster 172.31.5.145:6379
Sending CLUSTER FORGET messages to the cluster...
Sending CLUSTER RESET SOFT to the deleted node.
{ distribution: [ 910, 910, 910 ] }
[33m### RESHARDING FROM 172.31.5.174 TO 172.31.5.202 ###
[0m
{ reshardFrom: '172.31.5.174', reshardTo: '172.31.5.202', slots: 910 }
assertion error.
 {
  keys1: 9000000,
  keys2: 7001477,
  keys: 0,
  slots1: 16384,
  slots2: 16384,
  nodes1: 5,
  nodes2: 5,
  nodes: 0
}
precheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 2000645 keys | 3642 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 1500702 keys | 2730 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 1499449 keys | 2730 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 2000680 keys | 3642 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 1998524 keys | 3640 slots | 0 slaves.
[OK] 9000000 keys in 5 masters.
549.32 keys per slot on average.

postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 2000645 keys | 3642 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 1500702 keys | 2730 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 1000169 keys | 1820 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 2499960 keys | 4552 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 1 keys | 3640 slots | 0 slaves.
[OK] 7001477 keys in 5 masters.
427.34 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.174 TO 172.31.5.105 ###
[0m
{ reshardFrom: '172.31.5.174', reshardTo: '172.31.5.105', slots: 910 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 2000645 keys | 3642 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 1500702 keys | 2730 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 500064 keys | 910 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 2499960 keys | 4552 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 500106 keys | 4550 slots | 0 slaves.
[OK] 7001477 keys in 5 masters.
427.34 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.174 TO 172.31.5.140 ###
[0m
{ reshardFrom: '172.31.5.174', reshardTo: '172.31.5.140', slots: 910 }
assertion error.
 {
  keys1: 7001477,
  keys2: 4501517,
  keys: 0,
  slots1: 16384,
  slots2: 16384,
  nodes1: 5,
  nodes2: 4,
  nodes: -1
}
precheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 2000645 keys | 3642 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 1500702 keys | 2730 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 500064 keys | 910 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 2499960 keys | 4552 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 500106 keys | 4550 slots | 0 slaves.
[OK] 7001477 keys in 5 masters.
427.34 keys per slot on average.

postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 2500709 keys | 4552 slots | 1 slaves.
172.31.5.54:6379 (76360353...) -> 1500702 keys | 2730 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 0 keys | 4552 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 500106 keys | 4550 slots | 0 slaves.
[OK] 4501517 keys in 4 masters.
274.75 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### REMOVING 172.31.5.174:6379 FROM CLUSTER ###
[0m
> redis-cli --cluster del-node 172.31.5.174:6379 eb78bad30480efb75d2dd8edc1693b69278a4bf3
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 2500709 keys | 4552 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 1500702 keys | 2730 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 0 keys | 4552 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 500106 keys | 4550 slots | 0 slaves.
[OK] 4501517 keys in 4 masters.
274.75 keys per slot on average.
 
total slots: 16384
Removing node eb78bad30480efb75d2dd8edc1693b69278a4bf3 from cluster 172.31.5.174:6379
Sending CLUSTER FORGET messages to the cluster...
Sending CLUSTER RESET SOFT to the deleted node.
{ distribution: [ 910, 910, 910 ] }
[33m### RESHARDING FROM 172.31.5.54 TO 172.31.5.105 ###
[0m
{ reshardFrom: '172.31.5.54', reshardTo: '172.31.5.105', slots: 910 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 2500709 keys | 4552 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 999996 keys | 1820 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 0 keys | 4552 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 1000812 keys | 5460 slots | 0 slaves.
[OK] 4501517 keys in 4 masters.
274.75 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.54 TO 172.31.5.140 ###
[0m
{ reshardFrom: '172.31.5.54', reshardTo: '172.31.5.140', slots: 910 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 3000265 keys | 5462 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 500440 keys | 910 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 0 keys | 4552 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 1000812 keys | 5460 slots | 0 slaves.
[OK] 4501517 keys in 4 masters.
274.75 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.54 TO 172.31.5.202 ###
[0m
{ reshardFrom: '172.31.5.54', reshardTo: '172.31.5.202', slots: 910 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 3000265 keys | 5462 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 500440 keys | 5462 slots | 1 slaves.
172.31.5.105:6379 (9d4816cf...) -> 1000812 keys | 5460 slots | 0 slaves.
[OK] 4501517 keys in 3 masters.
274.75 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### REMOVING 172.31.5.54:6379 FROM CLUSTER ###
[0m
> redis-cli --cluster del-node 172.31.5.54:6379 763603530a9c3f684038efa73d48c1e19edd2ed9
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 3000265 keys | 5462 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 500440 keys | 5462 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 1000812 keys | 5460 slots | 0 slaves.
[OK] 4501517 keys in 3 masters.
274.75 keys per slot on average.
 
total slots: 16384
Removing node 763603530a9c3f684038efa73d48c1e19edd2ed9 from cluster 172.31.5.54:6379
Sending CLUSTER FORGET messages to the cluster...
Sending CLUSTER RESET SOFT to the deleted node.
[33m### REBALANCING CLUSTER ON 172.31.5.140:6379 ###
[0m
> redis-cli --cluster rebalance 172.31.5.140:6379 --cluster-use-empty-masters | grep -i Rebalancing
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 3000265 keys | 5462 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 500440 keys | 5462 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 1000812 keys | 5460 slots | 0 slaves.
[OK] 4501517 keys in 3 masters.
274.75 keys per slot on average.
 
total slots: 16384
*** No rebalancing needed! All nodes are within the 2.00% threshold.


waiting... 65 64 63 62 61 60 59 58 57 56 55 54 53 52 51 50 49 48 47 46 45 44 43 42 41 40 39 38 37 36 35 34 33 32 31 30 29 28 27 26 25 24 23 22 21 20 19 18 17 16 15 14 13 12 11 10 9 8 7 6 5 4 3 2 1 



[34m******* resize , 3 completed ******* [0m 

------------------------------------------------------------------

[34m******* write , 500000 *******[0m

[33m### WRITING 500000 KEYS ###
[0m
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 3166975 keys | 5462 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 667196 keys | 5462 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 1167346 keys | 5460 slots | 0 slaves.
[OK] 5001517 keys in 3 masters.
305.27 keys per slot on average.
 
total slots: 16384
0.5M keys written successfully

[34m******* write , 500000 completed ******* [0m 

------------------------------------------------------------------

[34m******* resize , 6 *******[0m

{ clusterSize: 3 }
[33m### ADDING 172.31.5.54:6379 NODE TO CLUSTER ###
[0m
> redis-cli --cluster add-node 172.31.5.54:6379 172.31.5.140:6379 | awk '{ gsub(/[[0-9;]*m/, ""); print }'
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 3166975 keys | 5462 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 667196 keys | 5462 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 1167346 keys | 5460 slots | 0 slaves.
[OK] 5001517 keys in 4 masters.
305.27 keys per slot on average.
 
total slots: 16384
node added successfully
waiting... 2 1 


[33m### ADDING 172.31.5.174:6379 NODE TO CLUSTER ###
[0m
> redis-cli --cluster add-node 172.31.5.174:6379 172.31.5.140:6379 | awk '{ gsub(/[[0-9;]*m/, ""); print }'
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 3166975 keys | 5462 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 667196 keys | 5462 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 1167346 keys | 5460 slots | 0 slaves.
[OK] 5001517 keys in 5 masters.
305.27 keys per slot on average.
 
total slots: 16384
node added successfully
waiting... 2 1 


[33m### ADDING 172.31.5.145:6379 NODE TO CLUSTER ###
[0m
> redis-cli --cluster add-node 172.31.5.145:6379 172.31.5.140:6379 | awk '{ gsub(/[[0-9;]*m/, ""); print }'
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 3166975 keys | 5462 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 667196 keys | 5462 slots | 0 slaves.
172.31.5.145:6379 (d611c8f1...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 1167346 keys | 5460 slots | 0 slaves.
[OK] 5001517 keys in 6 masters.
305.27 keys per slot on average.
 
total slots: 16384
node added successfully
waiting... 2 1 


waiting... 10 9 8 7 6 5 4 3 2 1 


[33m### REBALANCING CLUSTER ON 172.31.5.54:6379 ###
[0m
> redis-cli --cluster rebalance 172.31.5.54:6379 --cluster-use-empty-masters | grep -i Rebalancing
assertion error.
 {
  keys1: 5001517,
  keys2: 3417397,
  keys: 0,
  slots1: 16384,
  slots2: 16384,
  nodes1: 6,
  nodes2: 6,
  nodes: 0
}
precheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 3166975 keys | 5462 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 667196 keys | 5462 slots | 0 slaves.
172.31.5.145:6379 (d611c8f1...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 1167346 keys | 5460 slots | 0 slaves.
[OK] 5001517 keys in 6 masters.
305.27 keys per slot on average.

postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 0 keys | 2730 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 1582855 keys | 2732 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 1084766 keys | 2731 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 297880 keys | 2730 slots | 0 slaves.
172.31.5.145:6379 (d611c8f1...) -> 368700 keys | 2731 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 83196 keys | 2730 slots | 0 slaves.
[OK] 3417397 keys in 6 masters.
208.58 keys per slot on average.
 
total slots: 16384
>>> Rebalancing across 6 nodes. Total weight = 6.00



[34m******* resize , 6 completed ******* [0m 

------------------------------------------------------------------

[34m******* write , 500000 *******[0m

[33m### WRITING 500000 KEYS ###
[0m
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 83214 keys | 2730 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 1666303 keys | 2732 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 1168057 keys | 2731 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 381224 keys | 2730 slots | 0 slaves.
172.31.5.145:6379 (d611c8f1...) -> 452060 keys | 2731 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 166539 keys | 2730 slots | 0 slaves.
[OK] 3917397 keys in 6 masters.
239.10 keys per slot on average.
 
total slots: 16384
0.5M keys written successfully

[34m******* write , 500000 completed ******* [0m 

------------------------------------------------------------------

[34m******* resize , 4 *******[0m

{ clusterSize: 6 }
[33m### REBALANCING CLUSTER ON 172.31.5.145:6379 ###
[0m
> redis-cli --cluster rebalance 172.31.5.145:6379 --cluster-use-empty-masters | grep -i Rebalancing
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 83214 keys | 2730 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 1666303 keys | 2732 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 1168057 keys | 2731 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 381224 keys | 2730 slots | 0 slaves.
172.31.5.145:6379 (d611c8f1...) -> 452060 keys | 2731 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 166539 keys | 2730 slots | 0 slaves.
[OK] 3917397 keys in 6 masters.
239.10 keys per slot on average.
 
total slots: 16384
*** No rebalancing needed! All nodes are within the 2.00% threshold.


{ distribution: [ 683, 683, 683, 682 ] }
[33m### RESHARDING FROM 172.31.5.145 TO 172.31.5.140 ###
[0m
{ reshardFrom: '172.31.5.145', reshardTo: '172.31.5.140', slots: 683 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 124960 keys | 3413 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 1666303 keys | 2732 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 1168057 keys | 2731 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 381224 keys | 2730 slots | 0 slaves.
172.31.5.145:6379 (d611c8f1...) -> 410314 keys | 2048 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 166539 keys | 2730 slots | 0 slaves.
[OK] 3917397 keys in 6 masters.
239.10 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.145 TO 172.31.5.202 ###
[0m
{ reshardFrom: '172.31.5.145', reshardTo: '172.31.5.202', slots: 683 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 124960 keys | 3413 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 1666303 keys | 2732 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 1168057 keys | 2731 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 422894 keys | 3413 slots | 0 slaves.
172.31.5.145:6379 (d611c8f1...) -> 368644 keys | 1365 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 166539 keys | 2730 slots | 0 slaves.
[OK] 3917397 keys in 6 masters.
239.10 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.145 TO 172.31.5.105 ###
[0m
{ reshardFrom: '172.31.5.145', reshardTo: '172.31.5.105', slots: 683 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 124960 keys | 3413 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 1666303 keys | 2732 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 1168057 keys | 2731 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 422894 keys | 3413 slots | 0 slaves.
172.31.5.145:6379 (d611c8f1...) -> 326953 keys | 682 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 208230 keys | 3413 slots | 0 slaves.
[OK] 3917397 keys in 6 masters.
239.10 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.145 TO 172.31.5.54 ###
[0m
{ reshardFrom: '172.31.5.145', reshardTo: '172.31.5.54', slots: 682 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 124960 keys | 3413 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 1993256 keys | 3414 slots | 1 slaves.
172.31.5.174:6379 (eb78bad3...) -> 1168057 keys | 2731 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 422894 keys | 3413 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 208230 keys | 3413 slots | 0 slaves.
[OK] 3917397 keys in 5 masters.
239.10 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### REMOVING 172.31.5.145:6379 FROM CLUSTER ###
[0m
> redis-cli --cluster del-node 172.31.5.145:6379 d611c8f107b68363148c7a7021067200ee2a4a4a
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 124960 keys | 3413 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 1993256 keys | 3414 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 1168057 keys | 2731 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 422894 keys | 3413 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 208230 keys | 3413 slots | 0 slaves.
[OK] 3917397 keys in 5 masters.
239.10 keys per slot on average.
 
total slots: 16384
Removing node d611c8f107b68363148c7a7021067200ee2a4a4a from cluster 172.31.5.145:6379
Sending CLUSTER FORGET messages to the cluster...
Sending CLUSTER RESET SOFT to the deleted node.
{ distribution: [ 683, 683, 683, 682 ] }
[33m### RESHARDING FROM 172.31.5.174 TO 172.31.5.202 ###
[0m
{ reshardFrom: '172.31.5.174', reshardTo: '172.31.5.202', slots: 683 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 124960 keys | 3413 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 1993256 keys | 3414 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 993554 keys | 2048 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 597397 keys | 4096 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 208230 keys | 3413 slots | 0 slaves.
[OK] 3917397 keys in 5 masters.
239.10 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.174 TO 172.31.5.105 ###
[0m
{ reshardFrom: '172.31.5.174', reshardTo: '172.31.5.105', slots: 683 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 124960 keys | 3413 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 1993256 keys | 3414 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 790844 keys | 1365 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 597397 keys | 4096 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 410940 keys | 4096 slots | 0 slaves.
[OK] 3917397 keys in 5 masters.
239.10 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.174 TO 172.31.5.54 ###
[0m
{ reshardFrom: '172.31.5.174', reshardTo: '172.31.5.54', slots: 683 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 124960 keys | 3413 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 2410355 keys | 4097 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 373745 keys | 682 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 597397 keys | 4096 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 410940 keys | 4096 slots | 0 slaves.
[OK] 3917397 keys in 5 masters.
239.10 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.174 TO 172.31.5.140 ###
[0m
{ reshardFrom: '172.31.5.174', reshardTo: '172.31.5.140', slots: 682 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 498705 keys | 4095 slots | 1 slaves.
172.31.5.54:6379 (76360353...) -> 2410355 keys | 4097 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 597397 keys | 4096 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 410940 keys | 4096 slots | 0 slaves.
[OK] 3917397 keys in 4 masters.
239.10 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### REMOVING 172.31.5.174:6379 FROM CLUSTER ###
[0m
> redis-cli --cluster del-node 172.31.5.174:6379 eb78bad30480efb75d2dd8edc1693b69278a4bf3
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 498705 keys | 4095 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 2410355 keys | 4097 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 597397 keys | 4096 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 410940 keys | 4096 slots | 0 slaves.
[OK] 3917397 keys in 4 masters.
239.10 keys per slot on average.
 
total slots: 16384
Removing node eb78bad30480efb75d2dd8edc1693b69278a4bf3 from cluster 172.31.5.174:6379
Sending CLUSTER FORGET messages to the cluster...
Sending CLUSTER RESET SOFT to the deleted node.
[33m### REBALANCING CLUSTER ON 172.31.5.140:6379 ###
[0m
> redis-cli --cluster rebalance 172.31.5.140:6379 --cluster-use-empty-masters | grep -i Rebalancing
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 498705 keys | 4095 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 2410355 keys | 4097 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 597397 keys | 4096 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 410940 keys | 4096 slots | 0 slaves.
[OK] 3917397 keys in 4 masters.
239.10 keys per slot on average.
 
total slots: 16384
*** No rebalancing needed! All nodes are within the 2.00% threshold.


waiting... 65 64 63 62 61 60 59 58 57 56 55 54 53 52 51 50 49 48 47 46 45 44 43 42 41 40 39 38 37 36 35 34 33 32 31 30 29 28 27 26 25 24 23 22 21 20 19 18 17 16 15 14 13 12 11 10 9 8 7 6 5 4 3 2 1 



[34m******* resize , 4 completed ******* [0m 

------------------------------------------------------------------

[34m******* write , 500000 *******[0m

[33m### WRITING 500000 KEYS ###
[0m
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 623742 keys | 4095 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 2535314 keys | 4097 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 722387 keys | 4096 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 535954 keys | 4096 slots | 0 slaves.
[OK] 4417397 keys in 4 masters.
269.62 keys per slot on average.
 
total slots: 16384
0.5M keys written successfully

[34m******* write , 500000 completed ******* [0m 

------------------------------------------------------------------

[34m******* resize , 6 *******[0m

{ clusterSize: 4 }
[33m### ADDING 172.31.5.174:6379 NODE TO CLUSTER ###
[0m
> redis-cli --cluster add-node 172.31.5.174:6379 172.31.5.140:6379 | awk '{ gsub(/[[0-9;]*m/, ""); print }'
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 623742 keys | 4095 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 2535314 keys | 4097 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 722387 keys | 4096 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 535954 keys | 4096 slots | 0 slaves.
[OK] 4417397 keys in 5 masters.
269.62 keys per slot on average.
 
total slots: 16384
node added successfully
waiting... 2 1 


[33m### ADDING 172.31.5.145:6379 NODE TO CLUSTER ###
[0m
> redis-cli --cluster add-node 172.31.5.145:6379 172.31.5.140:6379 | awk '{ gsub(/[[0-9;]*m/, ""); print }'
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 623742 keys | 4095 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 2535314 keys | 4097 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 722387 keys | 4096 slots | 0 slaves.
172.31.5.145:6379 (d611c8f1...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 535954 keys | 4096 slots | 0 slaves.
[OK] 4417397 keys in 6 masters.
269.62 keys per slot on average.
 
total slots: 16384
node added successfully
waiting... 2 1 


waiting... 10 9 8 7 6 5 4 3 2 1 


[33m### REBALANCING CLUSTER ON 172.31.5.174:6379 ###
[0m
> redis-cli --cluster rebalance 172.31.5.174:6379 --cluster-use-empty-masters | grep -i Rebalancing
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 169575 keys | 2730 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 1695790 keys | 2730 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 1096733 keys | 2732 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 464548 keys | 2730 slots | 0 slaves.
172.31.5.145:6379 (d611c8f1...) -> 740935 keys | 2732 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 249816 keys | 2730 slots | 0 slaves.
[OK] 4417397 keys in 6 masters.
269.62 keys per slot on average.
 
total slots: 16384
>>> Rebalancing across 6 nodes. Total weight = 6.00



[34m******* resize , 6 completed ******* [0m 

------------------------------------------------------------------

[34m******* write , 500000 *******[0m

[33m### WRITING 500000 KEYS ###
[0m
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 252902 keys | 2730 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 1779178 keys | 2730 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 1180069 keys | 2732 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 547882 keys | 2730 slots | 0 slaves.
172.31.5.145:6379 (d611c8f1...) -> 824307 keys | 2732 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 333059 keys | 2730 slots | 0 slaves.
[OK] 4917397 keys in 6 masters.
300.13 keys per slot on average.
 
total slots: 16384
0.5M keys written successfully

[34m******* write , 500000 completed ******* [0m 

------------------------------------------------------------------

[34m******* resize , 5 *******[0m

{ clusterSize: 6 }
[33m### REBALANCING CLUSTER ON 172.31.5.145:6379 ###
[0m
> redis-cli --cluster rebalance 172.31.5.145:6379 --cluster-use-empty-masters | grep -i Rebalancing
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 252902 keys | 2730 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 1779178 keys | 2730 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 1180069 keys | 2732 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 547882 keys | 2730 slots | 0 slaves.
172.31.5.145:6379 (d611c8f1...) -> 824307 keys | 2732 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 333059 keys | 2730 slots | 0 slaves.
[OK] 4917397 keys in 6 masters.
300.13 keys per slot on average.
 
total slots: 16384
*** No rebalancing needed! All nodes are within the 2.00% threshold.


{ distribution: [ 547, 547, 546, 546, 546 ] }
[33m### RESHARDING FROM 172.31.5.145 TO 172.31.5.140 ###
[0m
{ reshardFrom: '172.31.5.145', reshardTo: '172.31.5.140', slots: 547 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 319763 keys | 3277 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 1779178 keys | 2730 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 1180069 keys | 2732 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 547882 keys | 2730 slots | 0 slaves.
172.31.5.145:6379 (d611c8f1...) -> 757446 keys | 2185 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 333059 keys | 2730 slots | 0 slaves.
[OK] 4917397 keys in 6 masters.
300.13 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.145 TO 172.31.5.202 ###
[0m
{ reshardFrom: '172.31.5.145', reshardTo: '172.31.5.202', slots: 547 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 319763 keys | 3277 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 1779178 keys | 2730 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 1180069 keys | 2732 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 614604 keys | 3277 slots | 0 slaves.
172.31.5.145:6379 (d611c8f1...) -> 690724 keys | 1638 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 333059 keys | 2730 slots | 0 slaves.
[OK] 4917397 keys in 6 masters.
300.13 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.145 TO 172.31.5.105 ###
[0m
{ reshardFrom: '172.31.5.145', reshardTo: '172.31.5.105', slots: 546 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 319763 keys | 3277 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 1779178 keys | 2730 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 1180069 keys | 2732 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 614604 keys | 3277 slots | 0 slaves.
172.31.5.145:6379 (d611c8f1...) -> 506331 keys | 1092 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 517452 keys | 3276 slots | 0 slaves.
[OK] 4917397 keys in 6 masters.
300.13 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.145 TO 172.31.5.54 ###
[0m
{ reshardFrom: '172.31.5.145', reshardTo: '172.31.5.54', slots: 546 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 319763 keys | 3277 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 1964230 keys | 3276 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 1180069 keys | 2732 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 614604 keys | 3277 slots | 0 slaves.
172.31.5.145:6379 (d611c8f1...) -> 321279 keys | 546 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 517452 keys | 3276 slots | 0 slaves.
[OK] 4917397 keys in 6 masters.
300.13 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.145 TO 172.31.5.174 ###
[0m
{ reshardFrom: '172.31.5.145', reshardTo: '172.31.5.174', slots: 546 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 319763 keys | 3277 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 1964230 keys | 3276 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 1501348 keys | 3278 slots | 1 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 614604 keys | 3277 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 517452 keys | 3276 slots | 0 slaves.
[OK] 4917397 keys in 5 masters.
300.13 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### REMOVING 172.31.5.145:6379 FROM CLUSTER ###
[0m
> redis-cli --cluster del-node 172.31.5.145:6379 d611c8f107b68363148c7a7021067200ee2a4a4a
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 319763 keys | 3277 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 1964230 keys | 3276 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 1501348 keys | 3278 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 614604 keys | 3277 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 517452 keys | 3276 slots | 0 slaves.
[OK] 4917397 keys in 5 masters.
300.13 keys per slot on average.
 
total slots: 16384
Removing node d611c8f107b68363148c7a7021067200ee2a4a4a from cluster 172.31.5.145:6379
Sending CLUSTER FORGET messages to the cluster...
Sending CLUSTER RESET SOFT to the deleted node.
[33m### REBALANCING CLUSTER ON 172.31.5.140:6379 ###
[0m
> redis-cli --cluster rebalance 172.31.5.140:6379 --cluster-use-empty-masters | grep -i Rebalancing
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 319763 keys | 3277 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 1964230 keys | 3276 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 1501348 keys | 3278 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 614604 keys | 3277 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 517452 keys | 3276 slots | 0 slaves.
[OK] 4917397 keys in 5 masters.
300.13 keys per slot on average.
 
total slots: 16384
*** No rebalancing needed! All nodes are within the 2.00% threshold.


waiting... 65 64 63 62 61 60 59 58 57 56 55 54 53 52 51 50 49 48 47 46 45 44 43 42 41 40 39 38 37 36 35 34 33 32 31 30 29 28 27 26 25 24 23 22 21 20 19 18 17 16 15 14 13 12 11 10 9 8 7 6 5 4 3 2 1 



[34m******* resize , 5 completed ******* [0m 

------------------------------------------------------------------

[34m******* write , 500000 *******[0m

[33m### WRITING 500000 KEYS ###
[0m
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 419739 keys | 3277 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 2064194 keys | 3276 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 1601338 keys | 3278 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 714603 keys | 3277 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 617523 keys | 3276 slots | 0 slaves.
[OK] 5417397 keys in 5 masters.
330.65 keys per slot on average.
 
total slots: 16384
0.5M keys written successfully

[34m******* write , 500000 completed ******* [0m 

------------------------------------------------------------------

[34m******* resize , 3 *******[0m

{ clusterSize: 5 }
[33m### REBALANCING CLUSTER ON 172.31.5.174:6379 ###
[0m
> redis-cli --cluster rebalance 172.31.5.174:6379 --cluster-use-empty-masters | grep -i Rebalancing
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 419739 keys | 3277 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 2064194 keys | 3276 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 1601338 keys | 3278 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 714603 keys | 3277 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 617523 keys | 3276 slots | 0 slaves.
[OK] 5417397 keys in 5 masters.
330.65 keys per slot on average.
 
total slots: 16384
*** No rebalancing needed! All nodes are within the 2.00% threshold.


{ distribution: [ 1093, 1093, 1092 ] }
[33m### RESHARDING FROM 172.31.5.174 TO 172.31.5.140 ###
[0m
{ reshardFrom: '172.31.5.174', reshardTo: '172.31.5.140', slots: 1093 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 1186488 keys | 4370 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 2064194 keys | 3276 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 834589 keys | 2185 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 714603 keys | 3277 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 617523 keys | 3276 slots | 0 slaves.
[OK] 5417397 keys in 5 masters.
330.65 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.174 TO 172.31.5.202 ###
[0m
{ reshardFrom: '172.31.5.174', reshardTo: '172.31.5.202', slots: 1093 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 1186488 keys | 4370 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 2064194 keys | 3276 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 553403 keys | 1092 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 995789 keys | 4370 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 617523 keys | 3276 slots | 0 slaves.
[OK] 5417397 keys in 5 masters.
330.65 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.174 TO 172.31.5.105 ###
[0m
{ reshardFrom: '172.31.5.174', reshardTo: '172.31.5.105', slots: 1092 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 1186488 keys | 4370 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 2064194 keys | 3276 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 995789 keys | 4370 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 1170926 keys | 4368 slots | 1 slaves.
[OK] 5417397 keys in 4 masters.
330.65 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### REMOVING 172.31.5.174:6379 FROM CLUSTER ###
[0m
> redis-cli --cluster del-node 172.31.5.174:6379 eb78bad30480efb75d2dd8edc1693b69278a4bf3
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 1186488 keys | 4370 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 2064194 keys | 3276 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 995789 keys | 4370 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 1170926 keys | 4368 slots | 0 slaves.
[OK] 5417397 keys in 4 masters.
330.65 keys per slot on average.
 
total slots: 16384
Removing node eb78bad30480efb75d2dd8edc1693b69278a4bf3 from cluster 172.31.5.174:6379
Sending CLUSTER FORGET messages to the cluster...
Sending CLUSTER RESET SOFT to the deleted node.
{ distribution: [ 1092, 1092, 1092 ] }
[33m### RESHARDING FROM 172.31.5.54 TO 172.31.5.202 ###
[0m
{ reshardFrom: '172.31.5.54', reshardTo: '172.31.5.202', slots: 1092 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 1186488 keys | 4370 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 1533013 keys | 2184 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 1526970 keys | 5462 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 1170926 keys | 4368 slots | 0 slaves.
[OK] 5417397 keys in 4 masters.
330.65 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.54 TO 172.31.5.105 ###
[0m
{ reshardFrom: '172.31.5.54', reshardTo: '172.31.5.105', slots: 1092 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 1186488 keys | 4370 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 766580 keys | 1092 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 1526970 keys | 5462 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 1937359 keys | 5460 slots | 0 slaves.
[OK] 5417397 keys in 4 masters.
330.65 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.54 TO 172.31.5.140 ###
[0m
{ reshardFrom: '172.31.5.54', reshardTo: '172.31.5.140', slots: 1092 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 1953068 keys | 5462 slots | 1 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 1526970 keys | 5462 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 1937359 keys | 5460 slots | 0 slaves.
[OK] 5417397 keys in 3 masters.
330.65 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### REMOVING 172.31.5.54:6379 FROM CLUSTER ###
[0m
> redis-cli --cluster del-node 172.31.5.54:6379 763603530a9c3f684038efa73d48c1e19edd2ed9
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 1953068 keys | 5462 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 1526970 keys | 5462 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 1937359 keys | 5460 slots | 0 slaves.
[OK] 5417397 keys in 3 masters.
330.65 keys per slot on average.
 
total slots: 16384
Removing node 763603530a9c3f684038efa73d48c1e19edd2ed9 from cluster 172.31.5.54:6379
Sending CLUSTER FORGET messages to the cluster...
Sending CLUSTER RESET SOFT to the deleted node.
[33m### REBALANCING CLUSTER ON 172.31.5.140:6379 ###
[0m
> redis-cli --cluster rebalance 172.31.5.140:6379 --cluster-use-empty-masters | grep -i Rebalancing
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 1953068 keys | 5462 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 1526970 keys | 5462 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 1937359 keys | 5460 slots | 0 slaves.
[OK] 5417397 keys in 3 masters.
330.65 keys per slot on average.
 
total slots: 16384
*** No rebalancing needed! All nodes are within the 2.00% threshold.


waiting... 65 64 63 62 61 60 59 58 57 56 55 54 53 52 51 50 49 48 47 46 45 44 43 42 41 40 39 38 37 36 35 34 33 32 31 30 29 28 27 26 25 24 23 22 21 20 19 18 17 16 15 14 13 12 11 10 9 8 7 6 5 4 3 2 1 



[34m******* resize , 3 completed ******* [0m 

------------------------------------------------------------------

[34m******* write , 500000 *******[0m

[33m### WRITING 500000 KEYS ###
[0m
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 2119784 keys | 5462 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 1693594 keys | 5462 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 2104019 keys | 5460 slots | 0 slaves.
[OK] 5917397 keys in 3 masters.
361.17 keys per slot on average.
 
total slots: 16384
0.5M keys written successfully

[34m******* write , 500000 completed ******* [0m 

------------------------------------------------------------------

[34m******* resize , 5 *******[0m

{ clusterSize: 3 }
[33m### ADDING 172.31.5.54:6379 NODE TO CLUSTER ###
[0m
> redis-cli --cluster add-node 172.31.5.54:6379 172.31.5.140:6379 | awk '{ gsub(/[[0-9;]*m/, ""); print }'
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 2119784 keys | 5462 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 1693594 keys | 5462 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 2104019 keys | 5460 slots | 0 slaves.
[OK] 5917397 keys in 4 masters.
361.17 keys per slot on average.
 
total slots: 16384
node added successfully
waiting... 2 1 


[33m### ADDING 172.31.5.174:6379 NODE TO CLUSTER ###
[0m
> redis-cli --cluster add-node 172.31.5.174:6379 172.31.5.140:6379 | awk '{ gsub(/[[0-9;]*m/, ""); print }'
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 2119784 keys | 5462 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 1693594 keys | 5462 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 2104019 keys | 5460 slots | 0 slaves.
[OK] 5917397 keys in 5 masters.
361.17 keys per slot on average.
 
total slots: 16384
node added successfully
waiting... 2 1 


waiting... 10 9 8 7 6 5 4 3 2 1 


[33m### REBALANCING CLUSTER ON 172.31.5.54:6379 ###
[0m
> redis-cli --cluster rebalance 172.31.5.54:6379 --cluster-use-empty-masters | grep -i Rebalancing
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 820064 keys | 3276 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 1614043 keys | 3278 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 1515010 keys | 3278 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 1113982 keys | 3276 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 854298 keys | 3276 slots | 0 slaves.
[OK] 5917397 keys in 5 masters.
361.17 keys per slot on average.
 
total slots: 16384
>>> Rebalancing across 5 nodes. Total weight = 5.00



[34m******* resize , 5 completed ******* [0m 

------------------------------------------------------------------

[34m******* write , 500000 *******[0m

[33m### WRITING 500000 KEYS ###
[0m
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 919937 keys | 3276 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 1714139 keys | 3278 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 1615054 keys | 3278 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 1213964 keys | 3276 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 954303 keys | 3276 slots | 0 slaves.
[OK] 6417397 keys in 5 masters.
391.69 keys per slot on average.
 
total slots: 16384
0.5M keys written successfully

[34m******* write , 500000 completed ******* [0m 

------------------------------------------------------------------

[34m******* resize , 4 *******[0m

{ clusterSize: 5 }
[33m### REBALANCING CLUSTER ON 172.31.5.174:6379 ###
[0m
> redis-cli --cluster rebalance 172.31.5.174:6379 --cluster-use-empty-masters | grep -i Rebalancing
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 919937 keys | 3276 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 1714139 keys | 3278 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 1615054 keys | 3278 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 1213964 keys | 3276 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 954303 keys | 3276 slots | 0 slaves.
[OK] 6417397 keys in 5 masters.
391.69 keys per slot on average.
 
total slots: 16384
*** No rebalancing needed! All nodes are within the 2.00% threshold.


{ distribution: [ 820, 820, 819, 819 ] }
[33m### RESHARDING FROM 172.31.5.174 TO 172.31.5.140 ###
[0m
{ reshardFrom: '172.31.5.174', reshardTo: '172.31.5.140', slots: 820 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 1095091 keys | 4096 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 1714139 keys | 3278 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 1439900 keys | 2458 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 1213964 keys | 3276 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 954303 keys | 3276 slots | 0 slaves.
[OK] 6417397 keys in 5 masters.
391.69 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.174 TO 172.31.5.202 ###
[0m
{ reshardFrom: '172.31.5.174', reshardTo: '172.31.5.202', slots: 820 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 1095091 keys | 4096 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 1714139 keys | 3278 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 1035509 keys | 1638 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 1618355 keys | 4096 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 954303 keys | 3276 slots | 0 slaves.
[OK] 6417397 keys in 5 masters.
391.69 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.174 TO 172.31.5.105 ###
[0m
{ reshardFrom: '172.31.5.174', reshardTo: '172.31.5.105', slots: 819 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 1095091 keys | 4096 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 1714139 keys | 3278 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 624768 keys | 819 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 1618355 keys | 4096 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 1365044 keys | 4095 slots | 0 slaves.
[OK] 6417397 keys in 5 masters.
391.69 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.174 TO 172.31.5.54 ###
[0m
{ reshardFrom: '172.31.5.174', reshardTo: '172.31.5.54', slots: 819 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 1095091 keys | 4096 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 2338907 keys | 4097 slots | 1 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 1618355 keys | 4096 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 1365044 keys | 4095 slots | 0 slaves.
[OK] 6417397 keys in 4 masters.
391.69 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### REMOVING 172.31.5.174:6379 FROM CLUSTER ###
[0m
> redis-cli --cluster del-node 172.31.5.174:6379 eb78bad30480efb75d2dd8edc1693b69278a4bf3
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 1095091 keys | 4096 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 2338907 keys | 4097 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 1618355 keys | 4096 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 1365044 keys | 4095 slots | 0 slaves.
[OK] 6417397 keys in 4 masters.
391.69 keys per slot on average.
 
total slots: 16384
Removing node eb78bad30480efb75d2dd8edc1693b69278a4bf3 from cluster 172.31.5.174:6379
Sending CLUSTER FORGET messages to the cluster...
Sending CLUSTER RESET SOFT to the deleted node.
[33m### REBALANCING CLUSTER ON 172.31.5.140:6379 ###
[0m
> redis-cli --cluster rebalance 172.31.5.140:6379 --cluster-use-empty-masters | grep -i Rebalancing
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 1095091 keys | 4096 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 2338907 keys | 4097 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 1618355 keys | 4096 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 1365044 keys | 4095 slots | 0 slaves.
[OK] 6417397 keys in 4 masters.
391.69 keys per slot on average.
 
total slots: 16384
*** No rebalancing needed! All nodes are within the 2.00% threshold.


waiting... 65 64 63 62 61 60 59 58 57 56 55 54 53 52 51 50 49 48 47 46 45 44 43 42 41 40 39 38 37 36 35 34 33 32 31 30 29 28 27 26 25 24 23 22 21 20 19 18 17 16 15 14 13 12 11 10 9 8 7 6 5 4 3 2 1 



[34m******* resize , 4 completed ******* [0m 

------------------------------------------------------------------

[34m******* write , 500000 *******[0m

[33m### WRITING 500000 KEYS ###
[0m
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 1220318 keys | 4096 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 2463804 keys | 4097 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 1743315 keys | 4096 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 1489960 keys | 4095 slots | 0 slaves.
[OK] 6917397 keys in 4 masters.
422.20 keys per slot on average.
 
total slots: 16384
0.5M keys written successfully

[34m******* write , 500000 completed ******* [0m 

------------------------------------------------------------------

[34m******* resize , 3 *******[0m

{ clusterSize: 4 }
[33m### REBALANCING CLUSTER ON 172.31.5.54:6379 ###
[0m
> redis-cli --cluster rebalance 172.31.5.54:6379 --cluster-use-empty-masters | grep -i Rebalancing
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 1220318 keys | 4096 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 2463804 keys | 4097 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 1743315 keys | 4096 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 1489960 keys | 4095 slots | 0 slaves.
[OK] 6917397 keys in 4 masters.
422.20 keys per slot on average.
 
total slots: 16384
*** No rebalancing needed! All nodes are within the 2.00% threshold.


{ distribution: [ 1366, 1366, 1365 ] }
[33m### RESHARDING FROM 172.31.5.54 TO 172.31.5.140 ###
[0m
{ reshardFrom: '172.31.5.54', reshardTo: '172.31.5.140', slots: 1366 }
assertion error.
 {
  keys1: 6917397,
  keys2: 5136855,
  keys: 0,
  slots1: 16384,
  slots2: 16384,
  nodes1: 4,
  nodes2: 4,
  nodes: 0
}
precheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 1220318 keys | 4096 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 2463804 keys | 4097 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 1743315 keys | 4096 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 1489960 keys | 4095 slots | 0 slaves.
[OK] 6917397 keys in 4 masters.
422.20 keys per slot on average.

postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 404913 keys | 5462 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 1498667 keys | 2731 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 1743315 keys | 4096 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 1489960 keys | 4095 slots | 0 slaves.
[OK] 5136855 keys in 4 masters.
313.53 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.54 TO 172.31.5.202 ###
[0m
{ reshardFrom: '172.31.5.54', reshardTo: '172.31.5.202', slots: 1366 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 404913 keys | 5462 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 1082449 keys | 1365 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 2159533 keys | 5462 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 1489960 keys | 4095 slots | 0 slaves.
[OK] 5136855 keys in 4 masters.
313.53 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.54 TO 172.31.5.105 ###
[0m
{ reshardFrom: '172.31.5.54', reshardTo: '172.31.5.105', slots: 1365 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 404913 keys | 5462 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 2159533 keys | 5462 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 2572409 keys | 5460 slots | 1 slaves.
[OK] 5136855 keys in 3 masters.
313.53 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### REMOVING 172.31.5.54:6379 FROM CLUSTER ###
[0m
> redis-cli --cluster del-node 172.31.5.54:6379 763603530a9c3f684038efa73d48c1e19edd2ed9
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 404913 keys | 5462 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 2159533 keys | 5462 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 2572409 keys | 5460 slots | 0 slaves.
[OK] 5136855 keys in 3 masters.
313.53 keys per slot on average.
 
total slots: 16384
Removing node 763603530a9c3f684038efa73d48c1e19edd2ed9 from cluster 172.31.5.54:6379
Sending CLUSTER FORGET messages to the cluster...
Sending CLUSTER RESET SOFT to the deleted node.
[33m### REBALANCING CLUSTER ON 172.31.5.140:6379 ###
[0m
> redis-cli --cluster rebalance 172.31.5.140:6379 --cluster-use-empty-masters | grep -i Rebalancing
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 404913 keys | 5462 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 2159533 keys | 5462 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 2572409 keys | 5460 slots | 0 slaves.
[OK] 5136855 keys in 3 masters.
313.53 keys per slot on average.
 
total slots: 16384
*** No rebalancing needed! All nodes are within the 2.00% threshold.


waiting... 65 64 63 62 61 60 59 58 57 56 55 54 53 52 51 50 49 48 47 46 45 44 43 42 41 40 39 38 37 36 35 34 33 32 31 30 29 28 27 26 25 24 23 22 21 20 19 18 17 16 15 14 13 12 11 10 9 8 7 6 5 4 3 2 1 



[34m******* resize , 3 completed ******* [0m 

------------------------------------------------------------------

[34m******* write , 500000 *******[0m

[33m### WRITING 500000 KEYS ###
[0m
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 571718 keys | 5462 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 2326203 keys | 5462 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 2738934 keys | 5460 slots | 0 slaves.
[OK] 5636855 keys in 3 masters.
344.05 keys per slot on average.
 
total slots: 16384
0.5M keys written successfully

[34m******* write , 500000 completed ******* [0m 

------------------------------------------------------------------

[34m******* resize , 4 *******[0m

{ clusterSize: 3 }
[33m### ADDING 172.31.5.54:6379 NODE TO CLUSTER ###
[0m
> redis-cli --cluster add-node 172.31.5.54:6379 172.31.5.140:6379 | awk '{ gsub(/[[0-9;]*m/, ""); print }'
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 571718 keys | 5462 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 2326203 keys | 5462 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 2738934 keys | 5460 slots | 0 slaves.
[OK] 5636855 keys in 4 masters.
344.05 keys per slot on average.
 
total slots: 16384
node added successfully
waiting... 2 1 


waiting... 10 9 8 7 6 5 4 3 2 1 


[33m### REBALANCING CLUSTER ON 172.31.5.54:6379 ###
[0m
> redis-cli --cluster rebalance 172.31.5.54:6379 --cluster-use-empty-masters | grep -i Rebalancing
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 125236 keys | 4096 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 1814853 keys | 4096 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 1868271 keys | 4096 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 1828495 keys | 4096 slots | 0 slaves.
[OK] 5636855 keys in 4 masters.
344.05 keys per slot on average.
 
total slots: 16384
>>> Rebalancing across 4 nodes. Total weight = 4.00



[34m******* resize , 4 completed ******* [0m 

------------------------------------------------------------------

[34m******* write , 500000 *******[0m

[33m### WRITING 500000 KEYS ###
[0m
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 250013 keys | 4096 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 1939895 keys | 4096 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 1993314 keys | 4096 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 1953633 keys | 4096 slots | 0 slaves.
[OK] 6136855 keys in 4 masters.
374.56 keys per slot on average.
 
total slots: 16384
0.5M keys written successfully

[34m******* write , 500000 completed ******* [0m 

------------------------------------------------------------------

[34m******* resize , 5 *******[0m

{ clusterSize: 4 }
[33m### ADDING 172.31.5.174:6379 NODE TO CLUSTER ###
[0m
> redis-cli --cluster add-node 172.31.5.174:6379 172.31.5.140:6379 | awk '{ gsub(/[[0-9;]*m/, ""); print }'
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 250013 keys | 4096 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 1939895 keys | 4096 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 1993314 keys | 4096 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 1953633 keys | 4096 slots | 0 slaves.
[OK] 6136855 keys in 5 masters.
374.56 keys per slot on average.
 
total slots: 16384
node added successfully
waiting... 2 1 


waiting... 10 9 8 7 6 5 4 3 2 1 


[33m### REBALANCING CLUSTER ON 172.31.5.174:6379 ###
[0m
> redis-cli --cluster rebalance 172.31.5.174:6379 --cluster-use-empty-masters | grep -i Rebalancing
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 199981 keys | 3276 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 1799792 keys | 3276 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 1370268 keys | 3280 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 1513817 keys | 3276 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 1252997 keys | 3276 slots | 0 slaves.
[OK] 6136855 keys in 5 masters.
374.56 keys per slot on average.
 
total slots: 16384
>>> Rebalancing across 5 nodes. Total weight = 5.00



[34m******* resize , 5 completed ******* [0m 

------------------------------------------------------------------

[34m******* write , 500000 *******[0m

[33m### WRITING 500000 KEYS ###
[0m
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 299992 keys | 3276 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 1899797 keys | 3276 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 1470362 keys | 3280 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 1613810 keys | 3276 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 1352894 keys | 3276 slots | 0 slaves.
[OK] 6636855 keys in 5 masters.
405.08 keys per slot on average.
 
total slots: 16384
0.5M keys written successfully

[34m******* write , 500000 completed ******* [0m 

------------------------------------------------------------------

[34m******* resize , 6 *******[0m

{ clusterSize: 5 }
[33m### ADDING 172.31.5.145:6379 NODE TO CLUSTER ###
[0m
> redis-cli --cluster add-node 172.31.5.145:6379 172.31.5.140:6379 | awk '{ gsub(/[[0-9;]*m/, ""); print }'
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 299992 keys | 3276 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 1899797 keys | 3276 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 1470362 keys | 3280 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 1613810 keys | 3276 slots | 0 slaves.
172.31.5.145:6379 (d611c8f1...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 1352894 keys | 3276 slots | 0 slaves.
[OK] 6636855 keys in 6 masters.
405.08 keys per slot on average.
 
total slots: 16384
node added successfully
waiting... 2 1 


waiting... 10 9 8 7 6 5 4 3 2 1 


[33m### REBALANCING CLUSTER ON 172.31.5.145:6379 ###
[0m
> redis-cli --cluster rebalance 172.31.5.145:6379 --cluster-use-empty-masters | grep -i Rebalancing
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 250048 keys | 2730 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 1534954 keys | 2730 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 1420062 keys | 2730 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 1131021 keys | 2730 slots | 0 slaves.
172.31.5.145:6379 (d611c8f1...) -> 1384729 keys | 2734 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 916041 keys | 2730 slots | 0 slaves.
[OK] 6636855 keys in 6 masters.
405.08 keys per slot on average.
 
total slots: 16384
>>> Rebalancing across 6 nodes. Total weight = 6.00



[34m******* resize , 6 completed ******* [0m 

------------------------------------------------------------------

[34m******* write , 500000 *******[0m

[33m### WRITING 500000 KEYS ###
[0m
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 333290 keys | 2730 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 1618223 keys | 2730 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 1503365 keys | 2730 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 1214389 keys | 2730 slots | 0 slaves.
172.31.5.145:6379 (d611c8f1...) -> 1468204 keys | 2734 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 999384 keys | 2730 slots | 0 slaves.
[OK] 7136855 keys in 6 masters.
435.60 keys per slot on average.
 
total slots: 16384
0.5M keys written successfully

[34m******* write , 500000 completed ******* [0m 

------------------------------------------------------------------

[34m******* resize , 7 *******[0m

{ clusterSize: 6 }
[33m### ADDING 172.31.5.233:6379 NODE TO CLUSTER ###
[0m
> redis-cli --cluster add-node 172.31.5.233:6379 172.31.5.140:6379 | awk '{ gsub(/[[0-9;]*m/, ""); print }'
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 333290 keys | 2730 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 1618223 keys | 2730 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 1503365 keys | 2730 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 1214389 keys | 2730 slots | 0 slaves.
172.31.5.145:6379 (d611c8f1...) -> 1468204 keys | 2734 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 999384 keys | 2730 slots | 0 slaves.
172.31.5.233:6379 (250399ba...) -> 0 keys | 0 slots | 0 slaves.
[OK] 7136855 keys in 7 masters.
435.60 keys per slot on average.
 
total slots: 16384
node added successfully
waiting... 2 1 


waiting... 10 9 8 7 6 5 4 3 2 1 


[33m### REBALANCING CLUSTER ON 172.31.5.233:6379 ###
[0m
> redis-cli --cluster rebalance 172.31.5.233:6379 --cluster-use-empty-masters | grep -i Rebalancing
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 285685 keys | 2340 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 1392635 keys | 2340 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 1365660 keys | 2340 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 856870 keys | 2340 slots | 0 slaves.
172.31.5.145:6379 (d611c8f1...) -> 1420146 keys | 2340 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 856623 keys | 2340 slots | 0 slaves.
172.31.5.233:6379 (250399ba...) -> 959236 keys | 2344 slots | 0 slaves.
[OK] 7136855 keys in 7 masters.
435.60 keys per slot on average.
 
total slots: 16384
>>> Rebalancing across 7 nodes. Total weight = 7.00



[34m******* resize , 7 completed ******* [0m 

------------------------------------------------------------------

[34m******* write , 500000 *******[0m

[33m### WRITING 500000 KEYS ###
[0m
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 357032 keys | 2340 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 1464023 keys | 2340 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 1437090 keys | 2340 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 928323 keys | 2340 slots | 0 slaves.
172.31.5.145:6379 (d611c8f1...) -> 1491606 keys | 2340 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 928070 keys | 2340 slots | 0 slaves.
172.31.5.233:6379 (250399ba...) -> 1030711 keys | 2344 slots | 0 slaves.
[OK] 7636855 keys in 7 masters.
466.12 keys per slot on average.
 
total slots: 16384
0.5M keys written successfully

[34m******* write , 500000 completed ******* [0m 

------------------------------------------------------------------

[34m******* resize , 8 *******[0m

{ clusterSize: 7 }
[33m### ADDING 172.31.5.119:6379 NODE TO CLUSTER ###
[0m
> redis-cli --cluster add-node 172.31.5.119:6379 172.31.5.140:6379 | awk '{ gsub(/[[0-9;]*m/, ""); print }'
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 357032 keys | 2340 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 1464023 keys | 2340 slots | 0 slaves.
172.31.5.119:6379 (5b270992...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 1437090 keys | 2340 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 928323 keys | 2340 slots | 0 slaves.
172.31.5.145:6379 (d611c8f1...) -> 1491606 keys | 2340 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 928070 keys | 2340 slots | 0 slaves.
172.31.5.233:6379 (250399ba...) -> 1030711 keys | 2344 slots | 0 slaves.
[OK] 7636855 keys in 8 masters.
466.12 keys per slot on average.
 
total slots: 16384
node added successfully
waiting... 2 1 


waiting... 10 9 8 7 6 5 4 3 2 1 


[33m### REBALANCING CLUSTER ON 172.31.5.119:6379 ###
[0m
> redis-cli --cluster rebalance 172.31.5.119:6379 --cluster-use-empty-masters | grep -i Rebalancing
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 312510 keys | 2048 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 1348065 keys | 2048 slots | 0 slaves.
172.31.5.119:6379 (5b270992...) -> 622283 keys | 2048 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 1392606 keys | 2048 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 812459 keys | 2048 slots | 0 slaves.
172.31.5.145:6379 (d611c8f1...) -> 1350971 keys | 2048 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 812445 keys | 2048 slots | 0 slaves.
172.31.5.233:6379 (250399ba...) -> 985516 keys | 2048 slots | 0 slaves.
[OK] 7636855 keys in 8 masters.
466.12 keys per slot on average.
 
total slots: 16384
>>> Rebalancing across 8 nodes. Total weight = 8.00



[34m******* resize , 8 completed ******* [0m 

------------------------------------------------------------------

[34m******* write , 500000 *******[0m

[33m### WRITING 500000 KEYS ###
[0m
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.140:6379 ###
[0m172.31.5.140:6379 (d3c95fd7...) -> 374944 keys | 2048 slots | 0 slaves.
172.31.5.54:6379 (76360353...) -> 1410568 keys | 2048 slots | 0 slaves.
172.31.5.119:6379 (5b270992...) -> 684775 keys | 2048 slots | 0 slaves.
172.31.5.174:6379 (eb78bad3...) -> 1455130 keys | 2048 slots | 0 slaves.
172.31.5.202:6379 (f0a9fd60...) -> 875061 keys | 2048 slots | 0 slaves.
172.31.5.145:6379 (d611c8f1...) -> 1413534 keys | 2048 slots | 0 slaves.
172.31.5.105:6379 (9d4816cf...) -> 874941 keys | 2048 slots | 0 slaves.
172.31.5.233:6379 (250399ba...) -> 1047902 keys | 2048 slots | 0 slaves.
[OK] 8136855 keys in 8 masters.
496.63 keys per slot on average.
 
total slots: 16384
0.5M keys written successfully

[34m******* write , 500000 completed ******* [0m 

Time Taken: 12892.346 seconds...

---DONE---
