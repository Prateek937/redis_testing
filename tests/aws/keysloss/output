cluster Size: 3
[33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 9988 keys | 5461 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 10010 keys | 5462 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 10002 keys | 5461 slots | 0 slaves.
[OK] 30000 keys in 3 masters.
1.83 keys per slot on average.

------------------------------------------------------------------

[34m******* init  *******[0m

[33m### FLUSHING DATABASE : 172.31.5.90:6379 ###[0m
> redis-cli -h 172.31.5.90 -p 6379 flushall
[33m### FLUSHING DATABASE : 172.31.5.123:6379 ###[0m
> redis-cli -h 172.31.5.123 -p 6379 flushall
[33m### FLUSHING DATABASE : 172.31.5.101:6379 ###[0m
> redis-cli -h 172.31.5.101 -p 6379 flushall
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 0 keys | 5461 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 0 keys | 5462 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 0 keys | 5461 slots | 0 slaves.
[OK] 0 keys in 3 masters.
0.00 keys per slot on average.
 
total slots: 16384
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 0 keys | 5461 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 0 keys | 5462 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 0 keys | 5461 slots | 0 slaves.
[OK] 0 keys in 3 masters.
0.00 keys per slot on average.
 
total slots: 16384
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 0 keys | 5461 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 0 keys | 5462 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 0 keys | 5461 slots | 0 slaves.
[OK] 0 keys in 3 masters.
0.00 keys per slot on average.
 
total slots: 16384
cluster flushed successfully!

[34m******* init  completed ******* [0m 

------------------------------------------------------------------

[34m******* write , 500000 *******[0m

[33m### WRITING 500000 KEYS ###
[0m
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 166497 keys | 5461 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 166707 keys | 5462 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 166796 keys | 5461 slots | 0 slaves.
[OK] 500000 keys in 3 masters.
30.52 keys per slot on average.
 
total slots: 16384
0.5M keys written successfully

[34m******* write , 500000 completed ******* [0m 

------------------------------------------------------------------

[34m******* resize , 8 *******[0m

{ clusterSize: 3 }
[33m### ADDING 172.31.5.162:6379 NODE TO CLUSTER ###
[0m
> redis-cli --cluster add-node 172.31.5.162:6379 172.31.5.90:6379 | awk '{ gsub(/[[0-9;]*m/, ""); print }'
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 166497 keys | 5461 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 166707 keys | 5462 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 166796 keys | 5461 slots | 0 slaves.
[OK] 500000 keys in 4 masters.
30.52 keys per slot on average.
 
total slots: 16384
node added successfully
waiting... 2 1 


[33m### ADDING 172.31.5.254:6379 NODE TO CLUSTER ###
[0m
> redis-cli --cluster add-node 172.31.5.254:6379 172.31.5.90:6379 | awk '{ gsub(/[[0-9;]*m/, ""); print }'
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 166497 keys | 5461 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 166707 keys | 5462 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 166796 keys | 5461 slots | 0 slaves.
[OK] 500000 keys in 5 masters.
30.52 keys per slot on average.
 
total slots: 16384
node added successfully
waiting... 2 1 


[33m### ADDING 172.31.5.19:6379 NODE TO CLUSTER ###
[0m
> redis-cli --cluster add-node 172.31.5.19:6379 172.31.5.90:6379 | awk '{ gsub(/[[0-9;]*m/, ""); print }'
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 166497 keys | 5461 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 166707 keys | 5462 slots | 0 slaves.
172.31.5.19:6379 (e04d781f...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 166796 keys | 5461 slots | 0 slaves.
[OK] 500000 keys in 6 masters.
30.52 keys per slot on average.
 
total slots: 16384
node added successfully
waiting... 2 1 


[33m### ADDING 172.31.5.31:6379 NODE TO CLUSTER ###
[0m
> redis-cli --cluster add-node 172.31.5.31:6379 172.31.5.90:6379 | awk '{ gsub(/[[0-9;]*m/, ""); print }'
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 166497 keys | 5461 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 166707 keys | 5462 slots | 0 slaves.
172.31.5.19:6379 (e04d781f...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 166796 keys | 5461 slots | 0 slaves.
172.31.5.31:6379 (da230fc3...) -> 0 keys | 0 slots | 0 slaves.
[OK] 500000 keys in 7 masters.
30.52 keys per slot on average.
 
total slots: 16384
node added successfully
waiting... 2 1 


[33m### ADDING 172.31.5.106:6379 NODE TO CLUSTER ###
[0m
> redis-cli --cluster add-node 172.31.5.106:6379 172.31.5.90:6379 | awk '{ gsub(/[[0-9;]*m/, ""); print }'
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 166497 keys | 5461 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 166707 keys | 5462 slots | 0 slaves.
172.31.5.106:6379 (79b25185...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.19:6379 (e04d781f...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 166796 keys | 5461 slots | 0 slaves.
172.31.5.31:6379 (da230fc3...) -> 0 keys | 0 slots | 0 slaves.
[OK] 500000 keys in 8 masters.
30.52 keys per slot on average.
 
total slots: 16384
node added successfully
waiting... 2 1 


waiting... 10 9 8 7 6 5 4 3 2 1 


[33m### REBALANCING CLUSTER ON 172.31.5.162:6379 ###
[0m
> redis-cli --cluster rebalance 172.31.5.162:6379 --cluster-use-empty-masters | grep -i Rebalancing
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 62500 keys | 2048 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 62414 keys | 2048 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 62501 keys | 2048 slots | 0 slaves.
172.31.5.106:6379 (79b25185...) -> 62520 keys | 2048 slots | 0 slaves.
172.31.5.19:6379 (e04d781f...) -> 62643 keys | 2048 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 62512 keys | 2048 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 62473 keys | 2048 slots | 0 slaves.
172.31.5.31:6379 (da230fc3...) -> 62437 keys | 2048 slots | 0 slaves.
[OK] 500000 keys in 8 masters.
30.52 keys per slot on average.
 
total slots: 16384
>>> Rebalancing across 8 nodes. Total weight = 8.00



[34m******* resize , 8 completed ******* [0m 

------------------------------------------------------------------

[34m******* write , 500000 *******[0m

[33m### WRITING 500000 KEYS ###
[0m
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 124999 keys | 2048 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 124937 keys | 2048 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 125001 keys | 2048 slots | 0 slaves.
172.31.5.106:6379 (79b25185...) -> 124994 keys | 2048 slots | 0 slaves.
172.31.5.19:6379 (e04d781f...) -> 125088 keys | 2048 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 125008 keys | 2048 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 124975 keys | 2048 slots | 0 slaves.
172.31.5.31:6379 (da230fc3...) -> 124998 keys | 2048 slots | 0 slaves.
[OK] 1000000 keys in 8 masters.
61.04 keys per slot on average.
 
total slots: 16384
0.5M keys written successfully

[34m******* write , 500000 completed ******* [0m 

------------------------------------------------------------------

[34m******* resize , 3 *******[0m

{ clusterSize: 8 }
[33m### REBALANCING CLUSTER ON 172.31.5.106:6379 ###
[0m
> redis-cli --cluster rebalance 172.31.5.106:6379 --cluster-use-empty-masters | grep -i Rebalancing
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 124999 keys | 2048 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 124937 keys | 2048 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 125001 keys | 2048 slots | 0 slaves.
172.31.5.106:6379 (79b25185...) -> 124994 keys | 2048 slots | 0 slaves.
172.31.5.19:6379 (e04d781f...) -> 125088 keys | 2048 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 125008 keys | 2048 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 124975 keys | 2048 slots | 0 slaves.
172.31.5.31:6379 (da230fc3...) -> 124998 keys | 2048 slots | 0 slaves.
[OK] 1000000 keys in 8 masters.
61.04 keys per slot on average.
 
total slots: 16384
*** No rebalancing needed! All nodes are within the 2.00% threshold.


{ distribution: [ 683, 683, 682 ] }
[33m### RESHARDING FROM 172.31.5.106 TO 172.31.5.90 ###
[0m
{ reshardFrom: '172.31.5.106', reshardTo: '172.31.5.90', slots: 683 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 166716 keys | 2731 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 124937 keys | 2048 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 125001 keys | 2048 slots | 0 slaves.
172.31.5.106:6379 (79b25185...) -> 83277 keys | 1365 slots | 0 slaves.
172.31.5.19:6379 (e04d781f...) -> 125088 keys | 2048 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 125008 keys | 2048 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 124975 keys | 2048 slots | 0 slaves.
172.31.5.31:6379 (da230fc3...) -> 124998 keys | 2048 slots | 0 slaves.
[OK] 1000000 keys in 8 masters.
61.04 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.106 TO 172.31.5.123 ###
[0m
{ reshardFrom: '172.31.5.106', reshardTo: '172.31.5.123', slots: 683 }
assertion error.
 {
  keys1: 1000000,
  keys2: 874992,
  keys: 0,
  slots1: 16384,
  slots2: 16384,
  nodes1: 8,
  nodes2: 8,
  nodes: 0
}
precheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 166716 keys | 2731 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 124937 keys | 2048 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 125001 keys | 2048 slots | 0 slaves.
172.31.5.106:6379 (79b25185...) -> 83277 keys | 1365 slots | 0 slaves.
172.31.5.19:6379 (e04d781f...) -> 125088 keys | 2048 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 125008 keys | 2048 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 124975 keys | 2048 slots | 0 slaves.
172.31.5.31:6379 (da230fc3...) -> 124998 keys | 2048 slots | 0 slaves.
[OK] 1000000 keys in 8 masters.
61.04 keys per slot on average.

postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 166716 keys | 2731 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 124937 keys | 2048 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 166712 keys | 2731 slots | 0 slaves.
172.31.5.106:6379 (79b25185...) -> 41566 keys | 682 slots | 0 slaves.
172.31.5.19:6379 (e04d781f...) -> 125088 keys | 2048 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 0 keys | 2048 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 124975 keys | 2048 slots | 0 slaves.
172.31.5.31:6379 (da230fc3...) -> 124998 keys | 2048 slots | 0 slaves.
[OK] 874992 keys in 8 masters.
53.41 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.106 TO 172.31.5.101 ###
[0m
{ reshardFrom: '172.31.5.106', reshardTo: '172.31.5.101', slots: 682 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 166716 keys | 2731 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 124937 keys | 2048 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 166712 keys | 2731 slots | 0 slaves.
172.31.5.19:6379 (e04d781f...) -> 125088 keys | 2048 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 0 keys | 2048 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 166541 keys | 2730 slots | 1 slaves.
172.31.5.31:6379 (da230fc3...) -> 124998 keys | 2048 slots | 0 slaves.
[OK] 874992 keys in 7 masters.
53.41 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### REMOVING 172.31.5.106:6379 FROM CLUSTER ###
[0m
> redis-cli --cluster del-node 172.31.5.106:6379 79b25185725faeb75a9733e3bf65ad57bcd0e662
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 166716 keys | 2731 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 124937 keys | 2048 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 166712 keys | 2731 slots | 0 slaves.
172.31.5.19:6379 (e04d781f...) -> 125088 keys | 2048 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 0 keys | 2048 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 166541 keys | 2730 slots | 0 slaves.
172.31.5.31:6379 (da230fc3...) -> 124998 keys | 2048 slots | 0 slaves.
[OK] 874992 keys in 7 masters.
53.41 keys per slot on average.
 
total slots: 16384
Removing node 79b25185725faeb75a9733e3bf65ad57bcd0e662 from cluster 172.31.5.106:6379
Sending CLUSTER FORGET messages to the cluster...
Sending CLUSTER RESET SOFT to the deleted node.
{ distribution: [ 683, 683, 682 ] }
[33m### RESHARDING FROM 172.31.5.31 TO 172.31.5.123 ###
[0m
{ reshardFrom: '172.31.5.31', reshardTo: '172.31.5.123', slots: 683 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 166716 keys | 2731 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 124937 keys | 2048 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 208410 keys | 3414 slots | 0 slaves.
172.31.5.19:6379 (e04d781f...) -> 125088 keys | 2048 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 0 keys | 2048 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 166541 keys | 2730 slots | 0 slaves.
172.31.5.31:6379 (da230fc3...) -> 83300 keys | 1365 slots | 0 slaves.
[OK] 874992 keys in 7 masters.
53.41 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.31 TO 172.31.5.101 ###
[0m
{ reshardFrom: '172.31.5.31', reshardTo: '172.31.5.101', slots: 683 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 166716 keys | 2731 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 124937 keys | 2048 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 208410 keys | 3414 slots | 0 slaves.
172.31.5.19:6379 (e04d781f...) -> 125088 keys | 2048 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 0 keys | 2048 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 208207 keys | 3413 slots | 0 slaves.
172.31.5.31:6379 (da230fc3...) -> 41634 keys | 682 slots | 0 slaves.
[OK] 874992 keys in 7 masters.
53.41 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.31 TO 172.31.5.90 ###
[0m
{ reshardFrom: '172.31.5.31', reshardTo: '172.31.5.90', slots: 682 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 208350 keys | 3413 slots | 1 slaves.
172.31.5.254:6379 (6c6bab51...) -> 124937 keys | 2048 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 208410 keys | 3414 slots | 0 slaves.
172.31.5.19:6379 (e04d781f...) -> 125088 keys | 2048 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 0 keys | 2048 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 208207 keys | 3413 slots | 0 slaves.
[OK] 874992 keys in 6 masters.
53.41 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### REMOVING 172.31.5.31:6379 FROM CLUSTER ###
[0m
> redis-cli --cluster del-node 172.31.5.31:6379 da230fc3b5e5589500aa4278419cdba3a008ea1d
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 208350 keys | 3413 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 124937 keys | 2048 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 208410 keys | 3414 slots | 0 slaves.
172.31.5.19:6379 (e04d781f...) -> 125088 keys | 2048 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 0 keys | 2048 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 208207 keys | 3413 slots | 0 slaves.
[OK] 874992 keys in 6 masters.
53.41 keys per slot on average.
 
total slots: 16384
Removing node da230fc3b5e5589500aa4278419cdba3a008ea1d from cluster 172.31.5.31:6379
Sending CLUSTER FORGET messages to the cluster...
Sending CLUSTER RESET SOFT to the deleted node.
{ distribution: [ 683, 683, 682 ] }
[33m### RESHARDING FROM 172.31.5.19 TO 172.31.5.101 ###
[0m
{ reshardFrom: '172.31.5.19', reshardTo: '172.31.5.101', slots: 683 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 208350 keys | 3413 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 124937 keys | 2048 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 208410 keys | 3414 slots | 0 slaves.
172.31.5.19:6379 (e04d781f...) -> 83403 keys | 1365 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 0 keys | 2048 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 249892 keys | 4096 slots | 0 slaves.
[OK] 874992 keys in 6 masters.
53.41 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.19 TO 172.31.5.90 ###
[0m
{ reshardFrom: '172.31.5.19', reshardTo: '172.31.5.90', slots: 683 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 250102 keys | 4096 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 124937 keys | 2048 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 208410 keys | 3414 slots | 0 slaves.
172.31.5.19:6379 (e04d781f...) -> 41651 keys | 682 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 0 keys | 2048 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 249892 keys | 4096 slots | 0 slaves.
[OK] 874992 keys in 6 masters.
53.41 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.19 TO 172.31.5.123 ###
[0m
{ reshardFrom: '172.31.5.19', reshardTo: '172.31.5.123', slots: 682 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 250102 keys | 4096 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 124937 keys | 2048 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 250061 keys | 4096 slots | 1 slaves.
172.31.5.162:6379 (74d3fe21...) -> 0 keys | 2048 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 249892 keys | 4096 slots | 0 slaves.
[OK] 874992 keys in 5 masters.
53.41 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### REMOVING 172.31.5.19:6379 FROM CLUSTER ###
[0m
> redis-cli --cluster del-node 172.31.5.19:6379 e04d781f16cfbd7cc4cfebdcdf4d70181cd789a0
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 250102 keys | 4096 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 124937 keys | 2048 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 250061 keys | 4096 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 0 keys | 2048 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 249892 keys | 4096 slots | 0 slaves.
[OK] 874992 keys in 5 masters.
53.41 keys per slot on average.
 
total slots: 16384
Removing node e04d781f16cfbd7cc4cfebdcdf4d70181cd789a0 from cluster 172.31.5.19:6379
Sending CLUSTER FORGET messages to the cluster...
Sending CLUSTER RESET SOFT to the deleted node.
{ distribution: [ 683, 683, 682 ] }
[33m### RESHARDING FROM 172.31.5.254 TO 172.31.5.90 ###
[0m
{ reshardFrom: '172.31.5.254', reshardTo: '172.31.5.90', slots: 683 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 291742 keys | 4779 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 83297 keys | 1365 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 250061 keys | 4096 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 0 keys | 2048 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 249892 keys | 4096 slots | 0 slaves.
[OK] 874992 keys in 5 masters.
53.41 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.254 TO 172.31.5.123 ###
[0m
{ reshardFrom: '172.31.5.254', reshardTo: '172.31.5.123', slots: 683 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 291742 keys | 4779 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 41576 keys | 682 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 291782 keys | 4779 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 0 keys | 2048 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 249892 keys | 4096 slots | 0 slaves.
[OK] 874992 keys in 5 masters.
53.41 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.254 TO 172.31.5.101 ###
[0m
{ reshardFrom: '172.31.5.254', reshardTo: '172.31.5.101', slots: 682 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 291742 keys | 4779 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 291782 keys | 4779 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 0 keys | 2048 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 291468 keys | 4778 slots | 1 slaves.
[OK] 874992 keys in 4 masters.
53.41 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### REMOVING 172.31.5.254:6379 FROM CLUSTER ###
[0m
> redis-cli --cluster del-node 172.31.5.254:6379 6c6bab513b449851a04f6d1f658e5738dce6a12f
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 291742 keys | 4779 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 291782 keys | 4779 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 0 keys | 2048 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 291468 keys | 4778 slots | 0 slaves.
[OK] 874992 keys in 4 masters.
53.41 keys per slot on average.
 
total slots: 16384
Removing node 6c6bab513b449851a04f6d1f658e5738dce6a12f from cluster 172.31.5.254:6379
Sending CLUSTER FORGET messages to the cluster...
Sending CLUSTER RESET SOFT to the deleted node.
{ distribution: [ 683, 683, 682 ] }
[33m### RESHARDING FROM 172.31.5.162 TO 172.31.5.123 ###
[0m
{ reshardFrom: '172.31.5.162', reshardTo: '172.31.5.123', slots: 683 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 291742 keys | 4779 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 291782 keys | 5462 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 0 keys | 1365 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 291468 keys | 4778 slots | 0 slaves.
[OK] 874992 keys in 4 masters.
53.41 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.162 TO 172.31.5.101 ###
[0m
{ reshardFrom: '172.31.5.162', reshardTo: '172.31.5.101', slots: 683 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 291742 keys | 4779 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 291782 keys | 5462 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 0 keys | 682 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 291468 keys | 5461 slots | 0 slaves.
[OK] 874992 keys in 4 masters.
53.41 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.162 TO 172.31.5.90 ###
[0m
{ reshardFrom: '172.31.5.162', reshardTo: '172.31.5.90', slots: 682 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 291742 keys | 5461 slots | 1 slaves.
172.31.5.123:6379 (24ea1433...) -> 291782 keys | 5462 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 291468 keys | 5461 slots | 0 slaves.
[OK] 874992 keys in 3 masters.
53.41 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### REMOVING 172.31.5.162:6379 FROM CLUSTER ###
[0m
> redis-cli --cluster del-node 172.31.5.162:6379 74d3fe212c5b4038d230cbfd1fe15f7cdc06ae2a
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 291742 keys | 5461 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 291782 keys | 5462 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 291468 keys | 5461 slots | 0 slaves.
[OK] 874992 keys in 3 masters.
53.41 keys per slot on average.
 
total slots: 16384
Removing node 74d3fe212c5b4038d230cbfd1fe15f7cdc06ae2a from cluster 172.31.5.162:6379
Sending CLUSTER FORGET messages to the cluster...
Sending CLUSTER RESET SOFT to the deleted node.
[33m### REBALANCING CLUSTER ON 172.31.5.90:6379 ###
[0m
> redis-cli --cluster rebalance 172.31.5.90:6379 --cluster-use-empty-masters | grep -i Rebalancing
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 291742 keys | 5461 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 291782 keys | 5462 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 291468 keys | 5461 slots | 0 slaves.
[OK] 874992 keys in 3 masters.
53.41 keys per slot on average.
 
total slots: 16384
*** No rebalancing needed! All nodes are within the 2.00% threshold.


waiting... 65 64 63 62 61 60 59 58 57 56 55 54 53 52 51 50 49 48 47 46 45 44 43 42 41 40 39 38 37 36 35 34 33 32 31 30 29 28 27 26 25 24 23 22 21 20 19 18 17 16 15 14 13 12 11 10 9 8 7 6 5 4 3 2 1 



[34m******* resize , 3 completed ******* [0m 

------------------------------------------------------------------

[34m******* write , 500000 *******[0m

[33m### WRITING 500000 KEYS ###
[0m
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 458436 keys | 5461 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 458428 keys | 5462 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 458128 keys | 5461 slots | 0 slaves.
[OK] 1374992 keys in 3 masters.
83.92 keys per slot on average.
 
total slots: 16384
0.5M keys written successfully

[34m******* write , 500000 completed ******* [0m 

------------------------------------------------------------------

[34m******* resize , 8 *******[0m

{ clusterSize: 3 }
[33m### ADDING 172.31.5.162:6379 NODE TO CLUSTER ###
[0m
> redis-cli --cluster add-node 172.31.5.162:6379 172.31.5.90:6379 | awk '{ gsub(/[[0-9;]*m/, ""); print }'
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 458436 keys | 5461 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 458428 keys | 5462 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 458128 keys | 5461 slots | 0 slaves.
[OK] 1374992 keys in 4 masters.
83.92 keys per slot on average.
 
total slots: 16384
node added successfully
waiting... 2 1 


[33m### ADDING 172.31.5.254:6379 NODE TO CLUSTER ###
[0m
> redis-cli --cluster add-node 172.31.5.254:6379 172.31.5.90:6379 | awk '{ gsub(/[[0-9;]*m/, ""); print }'
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 458436 keys | 5461 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 458428 keys | 5462 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 458128 keys | 5461 slots | 0 slaves.
[OK] 1374992 keys in 5 masters.
83.92 keys per slot on average.
 
total slots: 16384
node added successfully
waiting... 2 1 


[33m### ADDING 172.31.5.19:6379 NODE TO CLUSTER ###
[0m
> redis-cli --cluster add-node 172.31.5.19:6379 172.31.5.90:6379 | awk '{ gsub(/[[0-9;]*m/, ""); print }'
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 458436 keys | 5461 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 458428 keys | 5462 slots | 0 slaves.
172.31.5.19:6379 (e04d781f...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 458128 keys | 5461 slots | 0 slaves.
[OK] 1374992 keys in 6 masters.
83.92 keys per slot on average.
 
total slots: 16384
node added successfully
waiting... 2 1 


[33m### ADDING 172.31.5.31:6379 NODE TO CLUSTER ###
[0m
> redis-cli --cluster add-node 172.31.5.31:6379 172.31.5.90:6379 | awk '{ gsub(/[[0-9;]*m/, ""); print }'
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 458436 keys | 5461 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 458428 keys | 5462 slots | 0 slaves.
172.31.5.19:6379 (e04d781f...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 458128 keys | 5461 slots | 0 slaves.
172.31.5.31:6379 (da230fc3...) -> 0 keys | 0 slots | 0 slaves.
[OK] 1374992 keys in 7 masters.
83.92 keys per slot on average.
 
total slots: 16384
node added successfully
waiting... 2 1 


[33m### ADDING 172.31.5.106:6379 NODE TO CLUSTER ###
[0m
> redis-cli --cluster add-node 172.31.5.106:6379 172.31.5.90:6379 | awk '{ gsub(/[[0-9;]*m/, ""); print }'
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 458436 keys | 5461 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 458428 keys | 5462 slots | 0 slaves.
172.31.5.106:6379 (79b25185...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.19:6379 (e04d781f...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 458128 keys | 5461 slots | 0 slaves.
172.31.5.31:6379 (da230fc3...) -> 0 keys | 0 slots | 0 slaves.
[OK] 1374992 keys in 8 masters.
83.92 keys per slot on average.
 
total slots: 16384
node added successfully
waiting... 2 1 


waiting... 10 9 8 7 6 5 4 3 2 1 


[33m### REBALANCING CLUSTER ON 172.31.5.162:6379 ###
[0m
> redis-cli --cluster rebalance 172.31.5.162:6379 --cluster-use-empty-masters | grep -i Rebalancing
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 187515 keys | 2048 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 145876 keys | 2048 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 187485 keys | 2048 slots | 0 slaves.
172.31.5.106:6379 (79b25185...) -> 187570 keys | 2048 slots | 0 slaves.
172.31.5.19:6379 (e04d781f...) -> 187402 keys | 2048 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 145860 keys | 2048 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 187492 keys | 2048 slots | 0 slaves.
172.31.5.31:6379 (da230fc3...) -> 145792 keys | 2048 slots | 0 slaves.
[OK] 1374992 keys in 8 masters.
83.92 keys per slot on average.
 
total slots: 16384
>>> Rebalancing across 8 nodes. Total weight = 8.00



[34m******* resize , 8 completed ******* [0m 

------------------------------------------------------------------

[34m******* write , 500000 *******[0m

[33m### WRITING 500000 KEYS ###
[0m
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 250013 keys | 2048 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 208334 keys | 2048 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 249986 keys | 2048 slots | 0 slaves.
172.31.5.106:6379 (79b25185...) -> 250076 keys | 2048 slots | 0 slaves.
172.31.5.19:6379 (e04d781f...) -> 249885 keys | 2048 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 208330 keys | 2048 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 249999 keys | 2048 slots | 0 slaves.
172.31.5.31:6379 (da230fc3...) -> 208369 keys | 2048 slots | 0 slaves.
[OK] 1874992 keys in 8 masters.
114.44 keys per slot on average.
 
total slots: 16384
0.5M keys written successfully

[34m******* write , 500000 completed ******* [0m 

------------------------------------------------------------------

[34m******* resize , 4 *******[0m

{ clusterSize: 8 }
[33m### REBALANCING CLUSTER ON 172.31.5.106:6379 ###
[0m
> redis-cli --cluster rebalance 172.31.5.106:6379 --cluster-use-empty-masters | grep -i Rebalancing
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 250013 keys | 2048 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 208334 keys | 2048 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 249986 keys | 2048 slots | 0 slaves.
172.31.5.106:6379 (79b25185...) -> 250076 keys | 2048 slots | 0 slaves.
172.31.5.19:6379 (e04d781f...) -> 249885 keys | 2048 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 208330 keys | 2048 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 249999 keys | 2048 slots | 0 slaves.
172.31.5.31:6379 (da230fc3...) -> 208369 keys | 2048 slots | 0 slaves.
[OK] 1874992 keys in 8 masters.
114.44 keys per slot on average.
 
total slots: 16384
*** No rebalancing needed! All nodes are within the 2.00% threshold.


{ distribution: [ 512, 512, 512, 512 ] }
[33m### RESHARDING FROM 172.31.5.106 TO 172.31.5.90 ###
[0m
{ reshardFrom: '172.31.5.106', reshardTo: '172.31.5.90', slots: 512 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 312510 keys | 2560 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 208334 keys | 2048 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 249986 keys | 2048 slots | 0 slaves.
172.31.5.106:6379 (79b25185...) -> 187579 keys | 1536 slots | 0 slaves.
172.31.5.19:6379 (e04d781f...) -> 249885 keys | 2048 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 208330 keys | 2048 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 249999 keys | 2048 slots | 0 slaves.
172.31.5.31:6379 (da230fc3...) -> 208369 keys | 2048 slots | 0 slaves.
[OK] 1874992 keys in 8 masters.
114.44 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.106 TO 172.31.5.123 ###
[0m
{ reshardFrom: '172.31.5.106', reshardTo: '172.31.5.123', slots: 512 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 312510 keys | 2560 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 208334 keys | 2048 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 312553 keys | 2560 slots | 0 slaves.
172.31.5.106:6379 (79b25185...) -> 125012 keys | 1024 slots | 0 slaves.
172.31.5.19:6379 (e04d781f...) -> 249885 keys | 2048 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 208330 keys | 2048 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 249999 keys | 2048 slots | 0 slaves.
172.31.5.31:6379 (da230fc3...) -> 208369 keys | 2048 slots | 0 slaves.
[OK] 1874992 keys in 8 masters.
114.44 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.106 TO 172.31.5.101 ###
[0m
{ reshardFrom: '172.31.5.106', reshardTo: '172.31.5.101', slots: 512 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 312510 keys | 2560 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 208334 keys | 2048 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 312553 keys | 2560 slots | 0 slaves.
172.31.5.106:6379 (79b25185...) -> 62470 keys | 512 slots | 0 slaves.
172.31.5.19:6379 (e04d781f...) -> 249885 keys | 2048 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 208330 keys | 2048 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 312541 keys | 2560 slots | 0 slaves.
172.31.5.31:6379 (da230fc3...) -> 208369 keys | 2048 slots | 0 slaves.
[OK] 1874992 keys in 8 masters.
114.44 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.106 TO 172.31.5.162 ###
[0m
{ reshardFrom: '172.31.5.106', reshardTo: '172.31.5.162', slots: 512 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 312510 keys | 2560 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 208334 keys | 2048 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 312553 keys | 2560 slots | 0 slaves.
172.31.5.19:6379 (e04d781f...) -> 249885 keys | 2048 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 270800 keys | 2560 slots | 1 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 312541 keys | 2560 slots | 0 slaves.
172.31.5.31:6379 (da230fc3...) -> 208369 keys | 2048 slots | 0 slaves.
[OK] 1874992 keys in 7 masters.
114.44 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### REMOVING 172.31.5.106:6379 FROM CLUSTER ###
[0m
> redis-cli --cluster del-node 172.31.5.106:6379 79b25185725faeb75a9733e3bf65ad57bcd0e662
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 312510 keys | 2560 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 208334 keys | 2048 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 312553 keys | 2560 slots | 0 slaves.
172.31.5.19:6379 (e04d781f...) -> 249885 keys | 2048 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 270800 keys | 2560 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 312541 keys | 2560 slots | 0 slaves.
172.31.5.31:6379 (da230fc3...) -> 208369 keys | 2048 slots | 0 slaves.
[OK] 1874992 keys in 7 masters.
114.44 keys per slot on average.
 
total slots: 16384
Removing node 79b25185725faeb75a9733e3bf65ad57bcd0e662 from cluster 172.31.5.106:6379
Sending CLUSTER FORGET messages to the cluster...
Sending CLUSTER RESET SOFT to the deleted node.
{ distribution: [ 512, 512, 512, 512 ] }
[33m### RESHARDING FROM 172.31.5.31 TO 172.31.5.123 ###
[0m
{ reshardFrom: '172.31.5.31', reshardTo: '172.31.5.123', slots: 512 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 312510 keys | 2560 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 208334 keys | 2048 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 343807 keys | 3072 slots | 0 slaves.
172.31.5.19:6379 (e04d781f...) -> 249885 keys | 2048 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 270800 keys | 2560 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 312541 keys | 2560 slots | 0 slaves.
172.31.5.31:6379 (da230fc3...) -> 177115 keys | 1536 slots | 0 slaves.
[OK] 1874992 keys in 7 masters.
114.44 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.31 TO 172.31.5.101 ###
[0m
{ reshardFrom: '172.31.5.31', reshardTo: '172.31.5.101', slots: 512 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 312510 keys | 2560 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 208334 keys | 2048 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 343807 keys | 3072 slots | 0 slaves.
172.31.5.19:6379 (e04d781f...) -> 249885 keys | 2048 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 270800 keys | 2560 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 364548 keys | 3072 slots | 0 slaves.
172.31.5.31:6379 (da230fc3...) -> 125108 keys | 1024 slots | 0 slaves.
[OK] 1874992 keys in 7 masters.
114.44 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.31 TO 172.31.5.162 ###
[0m
{ reshardFrom: '172.31.5.31', reshardTo: '172.31.5.162', slots: 512 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 312510 keys | 2560 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 208334 keys | 2048 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 343807 keys | 3072 slots | 0 slaves.
172.31.5.19:6379 (e04d781f...) -> 249885 keys | 2048 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 333383 keys | 3072 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 364548 keys | 3072 slots | 0 slaves.
172.31.5.31:6379 (da230fc3...) -> 62525 keys | 512 slots | 0 slaves.
[OK] 1874992 keys in 7 masters.
114.44 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.31 TO 172.31.5.90 ###
[0m
{ reshardFrom: '172.31.5.31', reshardTo: '172.31.5.90', slots: 512 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 375035 keys | 3072 slots | 1 slaves.
172.31.5.254:6379 (6c6bab51...) -> 208334 keys | 2048 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 343807 keys | 3072 slots | 0 slaves.
172.31.5.19:6379 (e04d781f...) -> 249885 keys | 2048 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 333383 keys | 3072 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 364548 keys | 3072 slots | 0 slaves.
[OK] 1874992 keys in 6 masters.
114.44 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### REMOVING 172.31.5.31:6379 FROM CLUSTER ###
[0m
> redis-cli --cluster del-node 172.31.5.31:6379 da230fc3b5e5589500aa4278419cdba3a008ea1d
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 375035 keys | 3072 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 208334 keys | 2048 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 343807 keys | 3072 slots | 0 slaves.
172.31.5.19:6379 (e04d781f...) -> 249885 keys | 2048 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 333383 keys | 3072 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 364548 keys | 3072 slots | 0 slaves.
[OK] 1874992 keys in 6 masters.
114.44 keys per slot on average.
 
total slots: 16384
Removing node da230fc3b5e5589500aa4278419cdba3a008ea1d from cluster 172.31.5.31:6379
Sending CLUSTER FORGET messages to the cluster...
Sending CLUSTER RESET SOFT to the deleted node.
{ distribution: [ 512, 512, 512, 512 ] }
[33m### RESHARDING FROM 172.31.5.19 TO 172.31.5.101 ###
[0m
{ reshardFrom: '172.31.5.19', reshardTo: '172.31.5.101', slots: 512 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 375035 keys | 3072 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 208334 keys | 2048 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 343807 keys | 3072 slots | 0 slaves.
172.31.5.19:6379 (e04d781f...) -> 187398 keys | 1536 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 333383 keys | 3072 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 427035 keys | 3584 slots | 0 slaves.
[OK] 1874992 keys in 6 masters.
114.44 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.19 TO 172.31.5.162 ###
[0m
{ reshardFrom: '172.31.5.19', reshardTo: '172.31.5.162', slots: 512 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 375035 keys | 3072 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 208334 keys | 2048 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 343807 keys | 3072 slots | 0 slaves.
172.31.5.19:6379 (e04d781f...) -> 124928 keys | 1024 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 395853 keys | 3584 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 427035 keys | 3584 slots | 0 slaves.
[OK] 1874992 keys in 6 masters.
114.44 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.19 TO 172.31.5.90 ###
[0m
{ reshardFrom: '172.31.5.19', reshardTo: '172.31.5.90', slots: 512 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 437584 keys | 3584 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 208334 keys | 2048 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 343807 keys | 3072 slots | 0 slaves.
172.31.5.19:6379 (e04d781f...) -> 62379 keys | 512 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 395853 keys | 3584 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 427035 keys | 3584 slots | 0 slaves.
[OK] 1874992 keys in 6 masters.
114.44 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.19 TO 172.31.5.123 ###
[0m
{ reshardFrom: '172.31.5.19', reshardTo: '172.31.5.123', slots: 512 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 437584 keys | 3584 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 208334 keys | 2048 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 406186 keys | 3584 slots | 1 slaves.
172.31.5.162:6379 (74d3fe21...) -> 395853 keys | 3584 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 427035 keys | 3584 slots | 0 slaves.
[OK] 1874992 keys in 5 masters.
114.44 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### REMOVING 172.31.5.19:6379 FROM CLUSTER ###
[0m
> redis-cli --cluster del-node 172.31.5.19:6379 e04d781f16cfbd7cc4cfebdcdf4d70181cd789a0
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 437584 keys | 3584 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 208334 keys | 2048 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 406186 keys | 3584 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 395853 keys | 3584 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 427035 keys | 3584 slots | 0 slaves.
[OK] 1874992 keys in 5 masters.
114.44 keys per slot on average.
 
total slots: 16384
Removing node e04d781f16cfbd7cc4cfebdcdf4d70181cd789a0 from cluster 172.31.5.19:6379
Sending CLUSTER FORGET messages to the cluster...
Sending CLUSTER RESET SOFT to the deleted node.
{ distribution: [ 512, 512, 512, 512 ] }
[33m### RESHARDING FROM 172.31.5.254 TO 172.31.5.162 ###
[0m
{ reshardFrom: '172.31.5.254', reshardTo: '172.31.5.162', slots: 512 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 437584 keys | 3584 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 145896 keys | 1536 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 406186 keys | 3584 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 458291 keys | 4096 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 427035 keys | 3584 slots | 0 slaves.
[OK] 1874992 keys in 5 masters.
114.44 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.254 TO 172.31.5.90 ###
[0m
{ reshardFrom: '172.31.5.254', reshardTo: '172.31.5.90', slots: 512 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 479287 keys | 4096 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 104193 keys | 1024 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 406186 keys | 3584 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 458291 keys | 4096 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 427035 keys | 3584 slots | 0 slaves.
[OK] 1874992 keys in 5 masters.
114.44 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.254 TO 172.31.5.123 ###
[0m
{ reshardFrom: '172.31.5.254', reshardTo: '172.31.5.123', slots: 512 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 479287 keys | 4096 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 62526 keys | 512 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 447853 keys | 4096 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 458291 keys | 4096 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 427035 keys | 3584 slots | 0 slaves.
[OK] 1874992 keys in 5 masters.
114.44 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.254 TO 172.31.5.101 ###
[0m
{ reshardFrom: '172.31.5.254', reshardTo: '172.31.5.101', slots: 512 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 479287 keys | 4096 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 447853 keys | 4096 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 458291 keys | 4096 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 489561 keys | 4096 slots | 1 slaves.
[OK] 1874992 keys in 4 masters.
114.44 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### REMOVING 172.31.5.254:6379 FROM CLUSTER ###
[0m
> redis-cli --cluster del-node 172.31.5.254:6379 6c6bab513b449851a04f6d1f658e5738dce6a12f
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 479287 keys | 4096 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 447853 keys | 4096 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 458291 keys | 4096 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 489561 keys | 4096 slots | 0 slaves.
[OK] 1874992 keys in 4 masters.
114.44 keys per slot on average.
 
total slots: 16384
Removing node 6c6bab513b449851a04f6d1f658e5738dce6a12f from cluster 172.31.5.254:6379
Sending CLUSTER FORGET messages to the cluster...
Sending CLUSTER RESET SOFT to the deleted node.
[33m### REBALANCING CLUSTER ON 172.31.5.90:6379 ###
[0m
> redis-cli --cluster rebalance 172.31.5.90:6379 --cluster-use-empty-masters | grep -i Rebalancing
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 479287 keys | 4096 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 447853 keys | 4096 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 458291 keys | 4096 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 489561 keys | 4096 slots | 0 slaves.
[OK] 1874992 keys in 4 masters.
114.44 keys per slot on average.
 
total slots: 16384
*** No rebalancing needed! All nodes are within the 2.00% threshold.


waiting... 65 64 63 62 61 60 59 58 57 56 55 54 53 52 51 50 49 48 47 46 45 44 43 42 41 40 39 38 37 36 35 34 33 32 31 30 29 28 27 26 25 24 23 22 21 20 19 18 17 16 15 14 13 12 11 10 9 8 7 6 5 4 3 2 1 



[34m******* resize , 4 completed ******* [0m 

------------------------------------------------------------------

[34m******* write , 500000 *******[0m

[33m### WRITING 500000 KEYS ###
[0m
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 604420 keys | 4096 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 572757 keys | 4096 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 583249 keys | 4096 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 614566 keys | 4096 slots | 0 slaves.
[OK] 2374992 keys in 4 masters.
144.96 keys per slot on average.
 
total slots: 16384
0.5M keys written successfully

[34m******* write , 500000 completed ******* [0m 

------------------------------------------------------------------

[34m******* resize , 8 *******[0m

{ clusterSize: 4 }
[33m### ADDING 172.31.5.254:6379 NODE TO CLUSTER ###
[0m
> redis-cli --cluster add-node 172.31.5.254:6379 172.31.5.90:6379 | awk '{ gsub(/[[0-9;]*m/, ""); print }'
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 604420 keys | 4096 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 572757 keys | 4096 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 583249 keys | 4096 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 614566 keys | 4096 slots | 0 slaves.
[OK] 2374992 keys in 5 masters.
144.96 keys per slot on average.
 
total slots: 16384
node added successfully
waiting... 2 1 


[33m### ADDING 172.31.5.19:6379 NODE TO CLUSTER ###
[0m
> redis-cli --cluster add-node 172.31.5.19:6379 172.31.5.90:6379 | awk '{ gsub(/[[0-9;]*m/, ""); print }'
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 604420 keys | 4096 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 572757 keys | 4096 slots | 0 slaves.
172.31.5.19:6379 (e04d781f...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 583249 keys | 4096 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 614566 keys | 4096 slots | 0 slaves.
[OK] 2374992 keys in 6 masters.
144.96 keys per slot on average.
 
total slots: 16384
node added successfully
waiting... 2 1 


[33m### ADDING 172.31.5.31:6379 NODE TO CLUSTER ###
[0m
> redis-cli --cluster add-node 172.31.5.31:6379 172.31.5.90:6379 | awk '{ gsub(/[[0-9;]*m/, ""); print }'
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 604420 keys | 4096 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 572757 keys | 4096 slots | 0 slaves.
172.31.5.19:6379 (e04d781f...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 583249 keys | 4096 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 614566 keys | 4096 slots | 0 slaves.
172.31.5.31:6379 (da230fc3...) -> 0 keys | 0 slots | 0 slaves.
[OK] 2374992 keys in 7 masters.
144.96 keys per slot on average.
 
total slots: 16384
node added successfully
waiting... 2 1 


[33m### ADDING 172.31.5.106:6379 NODE TO CLUSTER ###
[0m
> redis-cli --cluster add-node 172.31.5.106:6379 172.31.5.90:6379 | awk '{ gsub(/[[0-9;]*m/, ""); print }'
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 604420 keys | 4096 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 572757 keys | 4096 slots | 0 slaves.
172.31.5.106:6379 (79b25185...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.19:6379 (e04d781f...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 583249 keys | 4096 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 614566 keys | 4096 slots | 0 slaves.
172.31.5.31:6379 (da230fc3...) -> 0 keys | 0 slots | 0 slaves.
[OK] 2374992 keys in 8 masters.
144.96 keys per slot on average.
 
total slots: 16384
node added successfully
waiting... 2 1 


waiting... 10 9 8 7 6 5 4 3 2 1 


[33m### REBALANCING CLUSTER ON 172.31.5.254:6379 ###
[0m
> redis-cli --cluster rebalance 172.31.5.254:6379 --cluster-use-empty-masters | grep -i Rebalancing
assertion error.
 {
  keys1: 2374992,
  keys2: 2271256,
  keys: 0,
  slots1: 16384,
  slots2: 16384,
  nodes1: 8,
  nodes2: 8,
  nodes: 0
}
precheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 604420 keys | 4096 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 572757 keys | 4096 slots | 0 slaves.
172.31.5.106:6379 (79b25185...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.19:6379 (e04d781f...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 583249 keys | 4096 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 614566 keys | 4096 slots | 0 slaves.
172.31.5.31:6379 (da230fc3...) -> 0 keys | 0 slots | 0 slaves.
[OK] 2374992 keys in 8 masters.
144.96 keys per slot on average.

postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 312527 keys | 2048 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 291893 keys | 2048 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 312471 keys | 2048 slots | 0 slaves.
172.31.5.106:6379 (79b25185...) -> 156550 keys | 2048 slots | 0 slaves.
172.31.5.19:6379 (e04d781f...) -> 270760 keys | 2048 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 312489 keys | 2048 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 312493 keys | 2048 slots | 0 slaves.
172.31.5.31:6379 (da230fc3...) -> 302073 keys | 2048 slots | 0 slaves.
[OK] 2271256 keys in 8 masters.
138.63 keys per slot on average.
 
total slots: 16384
>>> Rebalancing across 8 nodes. Total weight = 8.00



[34m******* resize , 8 completed ******* [0m 

------------------------------------------------------------------

[34m******* write , 500000 *******[0m

[33m### WRITING 500000 KEYS ###
[0m
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 375030 keys | 2048 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 354339 keys | 2048 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 374968 keys | 2048 slots | 0 slaves.
172.31.5.106:6379 (79b25185...) -> 218961 keys | 2048 slots | 0 slaves.
172.31.5.19:6379 (e04d781f...) -> 333333 keys | 2048 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 374949 keys | 2048 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 374990 keys | 2048 slots | 0 slaves.
172.31.5.31:6379 (da230fc3...) -> 364686 keys | 2048 slots | 0 slaves.
[OK] 2771256 keys in 8 masters.
169.14 keys per slot on average.
 
total slots: 16384
0.5M keys written successfully

[34m******* write , 500000 completed ******* [0m 

------------------------------------------------------------------

[34m******* resize , 5 *******[0m

{ clusterSize: 8 }
[33m### REBALANCING CLUSTER ON 172.31.5.106:6379 ###
[0m
> redis-cli --cluster rebalance 172.31.5.106:6379 --cluster-use-empty-masters | grep -i Rebalancing
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 375030 keys | 2048 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 354339 keys | 2048 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 374968 keys | 2048 slots | 0 slaves.
172.31.5.106:6379 (79b25185...) -> 218961 keys | 2048 slots | 0 slaves.
172.31.5.19:6379 (e04d781f...) -> 333333 keys | 2048 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 374949 keys | 2048 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 374990 keys | 2048 slots | 0 slaves.
172.31.5.31:6379 (da230fc3...) -> 364686 keys | 2048 slots | 0 slaves.
[OK] 2771256 keys in 8 masters.
169.14 keys per slot on average.
 
total slots: 16384
*** No rebalancing needed! All nodes are within the 2.00% threshold.


{ distribution: [ 410, 410, 410, 409, 409 ] }
[33m### RESHARDING FROM 172.31.5.106 TO 172.31.5.90 ###
[0m
{ reshardFrom: '172.31.5.106', reshardTo: '172.31.5.90', slots: 410 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 387494 keys | 2458 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 354339 keys | 2048 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 374968 keys | 2048 slots | 0 slaves.
172.31.5.106:6379 (79b25185...) -> 206497 keys | 1638 slots | 0 slaves.
172.31.5.19:6379 (e04d781f...) -> 333333 keys | 2048 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 374949 keys | 2048 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 374990 keys | 2048 slots | 0 slaves.
172.31.5.31:6379 (da230fc3...) -> 364686 keys | 2048 slots | 0 slaves.
[OK] 2771256 keys in 8 masters.
169.14 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.106 TO 172.31.5.123 ###
[0m
{ reshardFrom: '172.31.5.106', reshardTo: '172.31.5.123', slots: 410 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 387494 keys | 2458 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 354339 keys | 2048 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 387467 keys | 2458 slots | 0 slaves.
172.31.5.106:6379 (79b25185...) -> 193998 keys | 1228 slots | 0 slaves.
172.31.5.19:6379 (e04d781f...) -> 333333 keys | 2048 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 374949 keys | 2048 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 374990 keys | 2048 slots | 0 slaves.
172.31.5.31:6379 (da230fc3...) -> 364686 keys | 2048 slots | 0 slaves.
[OK] 2771256 keys in 8 masters.
169.14 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.106 TO 172.31.5.101 ###
[0m
{ reshardFrom: '172.31.5.106', reshardTo: '172.31.5.101', slots: 410 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 387494 keys | 2458 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 354339 keys | 2048 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 387467 keys | 2458 slots | 0 slaves.
172.31.5.106:6379 (79b25185...) -> 149660 keys | 818 slots | 0 slaves.
172.31.5.19:6379 (e04d781f...) -> 333333 keys | 2048 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 374949 keys | 2048 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 419328 keys | 2458 slots | 0 slaves.
172.31.5.31:6379 (da230fc3...) -> 364686 keys | 2048 slots | 0 slaves.
[OK] 2771256 keys in 8 masters.
169.14 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.106 TO 172.31.5.162 ###
[0m
{ reshardFrom: '172.31.5.106', reshardTo: '172.31.5.162', slots: 409 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 387494 keys | 2458 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 354339 keys | 2048 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 387467 keys | 2458 slots | 0 slaves.
172.31.5.106:6379 (79b25185...) -> 74832 keys | 409 slots | 0 slaves.
172.31.5.19:6379 (e04d781f...) -> 333333 keys | 2048 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 449777 keys | 2457 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 419328 keys | 2458 slots | 0 slaves.
172.31.5.31:6379 (da230fc3...) -> 364686 keys | 2048 slots | 0 slaves.
[OK] 2771256 keys in 8 masters.
169.14 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.106 TO 172.31.5.254 ###
[0m
{ reshardFrom: '172.31.5.106', reshardTo: '172.31.5.254', slots: 409 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 387494 keys | 2458 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 429171 keys | 2457 slots | 1 slaves.
172.31.5.123:6379 (24ea1433...) -> 387467 keys | 2458 slots | 0 slaves.
172.31.5.19:6379 (e04d781f...) -> 333333 keys | 2048 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 449777 keys | 2457 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 419328 keys | 2458 slots | 0 slaves.
172.31.5.31:6379 (da230fc3...) -> 364686 keys | 2048 slots | 0 slaves.
[OK] 2771256 keys in 7 masters.
169.14 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### REMOVING 172.31.5.106:6379 FROM CLUSTER ###
[0m
> redis-cli --cluster del-node 172.31.5.106:6379 79b25185725faeb75a9733e3bf65ad57bcd0e662
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 387494 keys | 2458 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 429171 keys | 2457 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 387467 keys | 2458 slots | 0 slaves.
172.31.5.19:6379 (e04d781f...) -> 333333 keys | 2048 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 449777 keys | 2457 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 419328 keys | 2458 slots | 0 slaves.
172.31.5.31:6379 (da230fc3...) -> 364686 keys | 2048 slots | 0 slaves.
[OK] 2771256 keys in 7 masters.
169.14 keys per slot on average.
 
total slots: 16384
Removing node 79b25185725faeb75a9733e3bf65ad57bcd0e662 from cluster 172.31.5.106:6379
Sending CLUSTER FORGET messages to the cluster...
Sending CLUSTER RESET SOFT to the deleted node.
{ distribution: [ 410, 410, 410, 409, 409 ] }
[33m### RESHARDING FROM 172.31.5.31 TO 172.31.5.123 ###
[0m
{ reshardFrom: '172.31.5.31', reshardTo: '172.31.5.123', slots: 410 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 387494 keys | 2458 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 429171 keys | 2457 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 452236 keys | 2868 slots | 0 slaves.
172.31.5.19:6379 (e04d781f...) -> 333333 keys | 2048 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 449777 keys | 2457 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 419328 keys | 2458 slots | 0 slaves.
172.31.5.31:6379 (da230fc3...) -> 299917 keys | 1638 slots | 0 slaves.
[OK] 2771256 keys in 7 masters.
169.14 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.31 TO 172.31.5.101 ###
[0m
{ reshardFrom: '172.31.5.31', reshardTo: '172.31.5.101', slots: 410 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 387494 keys | 2458 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 429171 keys | 2457 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 452236 keys | 2868 slots | 0 slaves.
172.31.5.19:6379 (e04d781f...) -> 333333 keys | 2048 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 449777 keys | 2457 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 494345 keys | 2868 slots | 0 slaves.
172.31.5.31:6379 (da230fc3...) -> 224900 keys | 1228 slots | 0 slaves.
[OK] 2771256 keys in 7 masters.
169.14 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.31 TO 172.31.5.162 ###
[0m
{ reshardFrom: '172.31.5.31', reshardTo: '172.31.5.162', slots: 410 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 387494 keys | 2458 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 429171 keys | 2457 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 452236 keys | 2868 slots | 0 slaves.
172.31.5.19:6379 (e04d781f...) -> 333333 keys | 2048 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 524894 keys | 2867 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 494345 keys | 2868 slots | 0 slaves.
172.31.5.31:6379 (da230fc3...) -> 149783 keys | 818 slots | 0 slaves.
[OK] 2771256 keys in 7 masters.
169.14 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.31 TO 172.31.5.254 ###
[0m
{ reshardFrom: '172.31.5.31', reshardTo: '172.31.5.254', slots: 409 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 387494 keys | 2458 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 504051 keys | 2866 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 452236 keys | 2868 slots | 0 slaves.
172.31.5.19:6379 (e04d781f...) -> 333333 keys | 2048 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 524894 keys | 2867 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 494345 keys | 2868 slots | 0 slaves.
172.31.5.31:6379 (da230fc3...) -> 74903 keys | 409 slots | 0 slaves.
[OK] 2771256 keys in 7 masters.
169.14 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.31 TO 172.31.5.90 ###
[0m
{ reshardFrom: '172.31.5.31', reshardTo: '172.31.5.90', slots: 409 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 462397 keys | 2867 slots | 1 slaves.
172.31.5.254:6379 (6c6bab51...) -> 504051 keys | 2866 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 452236 keys | 2868 slots | 0 slaves.
172.31.5.19:6379 (e04d781f...) -> 333333 keys | 2048 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 524894 keys | 2867 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 494345 keys | 2868 slots | 0 slaves.
[OK] 2771256 keys in 6 masters.
169.14 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### REMOVING 172.31.5.31:6379 FROM CLUSTER ###
[0m
> redis-cli --cluster del-node 172.31.5.31:6379 da230fc3b5e5589500aa4278419cdba3a008ea1d
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 462397 keys | 2867 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 504051 keys | 2866 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 452236 keys | 2868 slots | 0 slaves.
172.31.5.19:6379 (e04d781f...) -> 333333 keys | 2048 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 524894 keys | 2867 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 494345 keys | 2868 slots | 0 slaves.
[OK] 2771256 keys in 6 masters.
169.14 keys per slot on average.
 
total slots: 16384
Removing node da230fc3b5e5589500aa4278419cdba3a008ea1d from cluster 172.31.5.31:6379
Sending CLUSTER FORGET messages to the cluster...
Sending CLUSTER RESET SOFT to the deleted node.
{ distribution: [ 410, 410, 410, 409, 409 ] }
[33m### RESHARDING FROM 172.31.5.19 TO 172.31.5.101 ###
[0m
{ reshardFrom: '172.31.5.19', reshardTo: '172.31.5.101', slots: 410 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 462397 keys | 2867 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 504051 keys | 2866 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 452236 keys | 2868 slots | 0 slaves.
172.31.5.19:6379 (e04d781f...) -> 283211 keys | 1638 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 524894 keys | 2867 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 544467 keys | 3278 slots | 0 slaves.
[OK] 2771256 keys in 6 masters.
169.14 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.19 TO 172.31.5.162 ###
[0m
{ reshardFrom: '172.31.5.19', reshardTo: '172.31.5.162', slots: 410 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 462397 keys | 2867 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 504051 keys | 2866 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 452236 keys | 2868 slots | 0 slaves.
172.31.5.19:6379 (e04d781f...) -> 224851 keys | 1228 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 583254 keys | 3277 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 544467 keys | 3278 slots | 0 slaves.
[OK] 2771256 keys in 6 masters.
169.14 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.19 TO 172.31.5.254 ###
[0m
{ reshardFrom: '172.31.5.19', reshardTo: '172.31.5.254', slots: 410 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 462397 keys | 2867 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 579127 keys | 3276 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 452236 keys | 2868 slots | 0 slaves.
172.31.5.19:6379 (e04d781f...) -> 149775 keys | 818 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 583254 keys | 3277 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 544467 keys | 3278 slots | 0 slaves.
[OK] 2771256 keys in 6 masters.
169.14 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.19 TO 172.31.5.90 ###
[0m
{ reshardFrom: '172.31.5.19', reshardTo: '172.31.5.90', slots: 409 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 537270 keys | 3276 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 579127 keys | 3276 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 452236 keys | 2868 slots | 0 slaves.
172.31.5.19:6379 (e04d781f...) -> 74902 keys | 409 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 583254 keys | 3277 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 544467 keys | 3278 slots | 0 slaves.
[OK] 2771256 keys in 6 masters.
169.14 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.19 TO 172.31.5.123 ###
[0m
{ reshardFrom: '172.31.5.19', reshardTo: '172.31.5.123', slots: 409 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 537270 keys | 3276 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 579127 keys | 3276 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 527138 keys | 3277 slots | 1 slaves.
172.31.5.162:6379 (74d3fe21...) -> 583254 keys | 3277 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 544467 keys | 3278 slots | 0 slaves.
[OK] 2771256 keys in 5 masters.
169.14 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### REMOVING 172.31.5.19:6379 FROM CLUSTER ###
[0m
> redis-cli --cluster del-node 172.31.5.19:6379 e04d781f16cfbd7cc4cfebdcdf4d70181cd789a0
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 537270 keys | 3276 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 579127 keys | 3276 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 527138 keys | 3277 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 583254 keys | 3277 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 544467 keys | 3278 slots | 0 slaves.
[OK] 2771256 keys in 5 masters.
169.14 keys per slot on average.
 
total slots: 16384
Removing node e04d781f16cfbd7cc4cfebdcdf4d70181cd789a0 from cluster 172.31.5.19:6379
Sending CLUSTER FORGET messages to the cluster...
Sending CLUSTER RESET SOFT to the deleted node.
[33m### REBALANCING CLUSTER ON 172.31.5.90:6379 ###
[0m
> redis-cli --cluster rebalance 172.31.5.90:6379 --cluster-use-empty-masters | grep -i Rebalancing
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 537270 keys | 3276 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 579127 keys | 3276 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 527138 keys | 3277 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 583254 keys | 3277 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 544467 keys | 3278 slots | 0 slaves.
[OK] 2771256 keys in 5 masters.
169.14 keys per slot on average.
 
total slots: 16384
*** No rebalancing needed! All nodes are within the 2.00% threshold.


waiting... 65 64 63 62 61 60 59 58 57 56 55 54 53 52 51 50 49 48 47 46 45 44 43 42 41 40 39 38 37 36 35 34 33 32 31 30 29 28 27 26 25 24 23 22 21 20 19 18 17 16 15 14 13 12 11 10 9 8 7 6 5 4 3 2 1 



[34m******* resize , 5 completed ******* [0m 

------------------------------------------------------------------

[34m******* write , 500000 *******[0m

[33m### WRITING 500000 KEYS ###
[0m
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 637122 keys | 3276 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 679116 keys | 3276 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 627363 keys | 3277 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 683079 keys | 3277 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 644576 keys | 3278 slots | 0 slaves.
[OK] 3271256 keys in 5 masters.
199.66 keys per slot on average.
 
total slots: 16384
0.5M keys written successfully

[34m******* write , 500000 completed ******* [0m 

------------------------------------------------------------------

[34m******* resize , 8 *******[0m

{ clusterSize: 5 }
[33m### ADDING 172.31.5.19:6379 NODE TO CLUSTER ###
[0m
> redis-cli --cluster add-node 172.31.5.19:6379 172.31.5.90:6379 | awk '{ gsub(/[[0-9;]*m/, ""); print }'
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 637122 keys | 3276 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 679116 keys | 3276 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 627363 keys | 3277 slots | 0 slaves.
172.31.5.19:6379 (e04d781f...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 683079 keys | 3277 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 644576 keys | 3278 slots | 0 slaves.
[OK] 3271256 keys in 6 masters.
199.66 keys per slot on average.
 
total slots: 16384
node added successfully
waiting... 2 1 


[33m### ADDING 172.31.5.31:6379 NODE TO CLUSTER ###
[0m
> redis-cli --cluster add-node 172.31.5.31:6379 172.31.5.90:6379 | awk '{ gsub(/[[0-9;]*m/, ""); print }'
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 637122 keys | 3276 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 679116 keys | 3276 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 627363 keys | 3277 slots | 0 slaves.
172.31.5.19:6379 (e04d781f...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 683079 keys | 3277 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 644576 keys | 3278 slots | 0 slaves.
172.31.5.31:6379 (da230fc3...) -> 0 keys | 0 slots | 0 slaves.
[OK] 3271256 keys in 7 masters.
199.66 keys per slot on average.
 
total slots: 16384
node added successfully
waiting... 2 1 


[33m### ADDING 172.31.5.106:6379 NODE TO CLUSTER ###
[0m
> redis-cli --cluster add-node 172.31.5.106:6379 172.31.5.90:6379 | awk '{ gsub(/[[0-9;]*m/, ""); print }'
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 637122 keys | 3276 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 679116 keys | 3276 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 627363 keys | 3277 slots | 0 slaves.
172.31.5.106:6379 (79b25185...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.19:6379 (e04d781f...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 683079 keys | 3277 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 644576 keys | 3278 slots | 0 slaves.
172.31.5.31:6379 (da230fc3...) -> 0 keys | 0 slots | 0 slaves.
[OK] 3271256 keys in 8 masters.
199.66 keys per slot on average.
 
total slots: 16384
node added successfully
waiting... 2 1 


waiting... 10 9 8 7 6 5 4 3 2 1 


[33m### REBALANCING CLUSTER ON 172.31.5.19:6379 ###
[0m
> redis-cli --cluster rebalance 172.31.5.19:6379 --cluster-use-empty-masters | grep -i Rebalancing
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 437511 keys | 2048 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 424939 keys | 2048 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 437488 keys | 2048 slots | 0 slaves.
172.31.5.106:6379 (79b25185...) -> 364965 keys | 2048 slots | 0 slaves.
172.31.5.19:6379 (e04d781f...) -> 364902 keys | 2048 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 437358 keys | 2048 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 437518 keys | 2048 slots | 0 slaves.
172.31.5.31:6379 (da230fc3...) -> 366575 keys | 2048 slots | 0 slaves.
[OK] 3271256 keys in 8 masters.
199.66 keys per slot on average.
 
total slots: 16384
>>> Rebalancing across 8 nodes. Total weight = 8.00



[34m******* resize , 8 completed ******* [0m 

------------------------------------------------------------------

[34m******* write , 500000 *******[0m

[33m### WRITING 500000 KEYS ###
[0m
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 500019 keys | 2048 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 487465 keys | 2048 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 499980 keys | 2048 slots | 0 slaves.
172.31.5.106:6379 (79b25185...) -> 427507 keys | 2048 slots | 0 slaves.
172.31.5.19:6379 (e04d781f...) -> 427418 keys | 2048 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 499807 keys | 2048 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 500023 keys | 2048 slots | 0 slaves.
172.31.5.31:6379 (da230fc3...) -> 429037 keys | 2048 slots | 0 slaves.
[OK] 3771256 keys in 8 masters.
230.18 keys per slot on average.
 
total slots: 16384
0.5M keys written successfully

[34m******* write , 500000 completed ******* [0m 

------------------------------------------------------------------

[34m******* resize , 6 *******[0m

{ clusterSize: 8 }
[33m### REBALANCING CLUSTER ON 172.31.5.106:6379 ###
[0m
> redis-cli --cluster rebalance 172.31.5.106:6379 --cluster-use-empty-masters | grep -i Rebalancing
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 500019 keys | 2048 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 487465 keys | 2048 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 499980 keys | 2048 slots | 0 slaves.
172.31.5.106:6379 (79b25185...) -> 427507 keys | 2048 slots | 0 slaves.
172.31.5.19:6379 (e04d781f...) -> 427418 keys | 2048 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 499807 keys | 2048 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 500023 keys | 2048 slots | 0 slaves.
172.31.5.31:6379 (da230fc3...) -> 429037 keys | 2048 slots | 0 slaves.
[OK] 3771256 keys in 8 masters.
230.18 keys per slot on average.
 
total slots: 16384
*** No rebalancing needed! All nodes are within the 2.00% threshold.


{ distribution: [ 342, 342, 341, 341, 341, 341 ] }
[33m### RESHARDING FROM 172.31.5.106 TO 172.31.5.90 ###
[0m
{ reshardFrom: '172.31.5.106', reshardTo: '172.31.5.90', slots: 342 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 583469 keys | 2390 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 487465 keys | 2048 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 499980 keys | 2048 slots | 0 slaves.
172.31.5.106:6379 (79b25185...) -> 344057 keys | 1706 slots | 0 slaves.
172.31.5.19:6379 (e04d781f...) -> 427418 keys | 2048 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 499807 keys | 2048 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 500023 keys | 2048 slots | 0 slaves.
172.31.5.31:6379 (da230fc3...) -> 429037 keys | 2048 slots | 0 slaves.
[OK] 3771256 keys in 8 masters.
230.18 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.106 TO 172.31.5.123 ###
[0m
{ reshardFrom: '172.31.5.106', reshardTo: '172.31.5.123', slots: 342 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 583469 keys | 2390 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 487465 keys | 2048 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 568212 keys | 2390 slots | 0 slaves.
172.31.5.106:6379 (79b25185...) -> 275825 keys | 1364 slots | 0 slaves.
172.31.5.19:6379 (e04d781f...) -> 427418 keys | 2048 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 499807 keys | 2048 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 500023 keys | 2048 slots | 0 slaves.
172.31.5.31:6379 (da230fc3...) -> 429037 keys | 2048 slots | 0 slaves.
[OK] 3771256 keys in 8 masters.
230.18 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.106 TO 172.31.5.101 ###
[0m
{ reshardFrom: '172.31.5.106', reshardTo: '172.31.5.101', slots: 341 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 583469 keys | 2390 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 487465 keys | 2048 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 568212 keys | 2390 slots | 0 slaves.
172.31.5.106:6379 (79b25185...) -> 228926 keys | 1023 slots | 0 slaves.
172.31.5.19:6379 (e04d781f...) -> 427418 keys | 2048 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 499807 keys | 2048 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 546922 keys | 2389 slots | 0 slaves.
172.31.5.31:6379 (da230fc3...) -> 429037 keys | 2048 slots | 0 slaves.
[OK] 3771256 keys in 8 masters.
230.18 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.106 TO 172.31.5.162 ###
[0m
{ reshardFrom: '172.31.5.106', reshardTo: '172.31.5.162', slots: 341 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 583469 keys | 2390 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 487465 keys | 2048 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 568212 keys | 2390 slots | 0 slaves.
172.31.5.106:6379 (79b25185...) -> 166853 keys | 682 slots | 0 slaves.
172.31.5.19:6379 (e04d781f...) -> 427418 keys | 2048 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 561880 keys | 2389 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 546922 keys | 2389 slots | 0 slaves.
172.31.5.31:6379 (da230fc3...) -> 429037 keys | 2048 slots | 0 slaves.
[OK] 3771256 keys in 8 masters.
230.18 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.106 TO 172.31.5.254 ###
[0m
{ reshardFrom: '172.31.5.106', reshardTo: '172.31.5.254', slots: 341 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 583469 keys | 2390 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 571046 keys | 2389 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 568212 keys | 2390 slots | 0 slaves.
172.31.5.106:6379 (79b25185...) -> 83272 keys | 341 slots | 0 slaves.
172.31.5.19:6379 (e04d781f...) -> 427418 keys | 2048 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 561880 keys | 2389 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 546922 keys | 2389 slots | 0 slaves.
172.31.5.31:6379 (da230fc3...) -> 429037 keys | 2048 slots | 0 slaves.
[OK] 3771256 keys in 8 masters.
230.18 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.106 TO 172.31.5.19 ###
[0m
{ reshardFrom: '172.31.5.106', reshardTo: '172.31.5.19', slots: 341 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 583469 keys | 2390 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 571046 keys | 2389 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 568212 keys | 2390 slots | 0 slaves.
172.31.5.19:6379 (e04d781f...) -> 510690 keys | 2389 slots | 1 slaves.
172.31.5.162:6379 (74d3fe21...) -> 561880 keys | 2389 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 546922 keys | 2389 slots | 0 slaves.
172.31.5.31:6379 (da230fc3...) -> 429037 keys | 2048 slots | 0 slaves.
[OK] 3771256 keys in 7 masters.
230.18 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### REMOVING 172.31.5.106:6379 FROM CLUSTER ###
[0m
> redis-cli --cluster del-node 172.31.5.106:6379 79b25185725faeb75a9733e3bf65ad57bcd0e662
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 583469 keys | 2390 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 571046 keys | 2389 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 568212 keys | 2390 slots | 0 slaves.
172.31.5.19:6379 (e04d781f...) -> 510690 keys | 2389 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 561880 keys | 2389 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 546922 keys | 2389 slots | 0 slaves.
172.31.5.31:6379 (da230fc3...) -> 429037 keys | 2048 slots | 0 slaves.
[OK] 3771256 keys in 7 masters.
230.18 keys per slot on average.
 
total slots: 16384
Removing node 79b25185725faeb75a9733e3bf65ad57bcd0e662 from cluster 172.31.5.106:6379
Sending CLUSTER FORGET messages to the cluster...
Sending CLUSTER RESET SOFT to the deleted node.
{ distribution: [ 342, 342, 341, 341, 341, 341 ] }
[33m### RESHARDING FROM 172.31.5.31 TO 172.31.5.123 ###
[0m
{ reshardFrom: '172.31.5.31', reshardTo: '172.31.5.123', slots: 342 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 583469 keys | 2390 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 571046 keys | 2389 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 651865 keys | 2732 slots | 0 slaves.
172.31.5.19:6379 (e04d781f...) -> 510690 keys | 2389 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 561880 keys | 2389 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 546922 keys | 2389 slots | 0 slaves.
172.31.5.31:6379 (da230fc3...) -> 345384 keys | 1706 slots | 0 slaves.
[OK] 3771256 keys in 7 masters.
230.18 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.31 TO 172.31.5.101 ###
[0m
{ reshardFrom: '172.31.5.31', reshardTo: '172.31.5.101', slots: 342 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 583469 keys | 2390 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 571046 keys | 2389 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 651865 keys | 2732 slots | 0 slaves.
172.31.5.19:6379 (e04d781f...) -> 510690 keys | 2389 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 561880 keys | 2389 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 615210 keys | 2731 slots | 0 slaves.
172.31.5.31:6379 (da230fc3...) -> 277096 keys | 1364 slots | 0 slaves.
[OK] 3771256 keys in 7 masters.
230.18 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.31 TO 172.31.5.162 ###
[0m
{ reshardFrom: '172.31.5.31', reshardTo: '172.31.5.162', slots: 341 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 583469 keys | 2390 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 571046 keys | 2389 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 651865 keys | 2732 slots | 0 slaves.
172.31.5.19:6379 (e04d781f...) -> 510690 keys | 2389 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 634135 keys | 2730 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 615210 keys | 2731 slots | 0 slaves.
172.31.5.31:6379 (da230fc3...) -> 204841 keys | 1023 slots | 0 slaves.
[OK] 3771256 keys in 7 masters.
230.18 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.31 TO 172.31.5.254 ###
[0m
{ reshardFrom: '172.31.5.31', reshardTo: '172.31.5.254', slots: 341 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 583469 keys | 2390 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 638712 keys | 2730 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 651865 keys | 2732 slots | 0 slaves.
172.31.5.19:6379 (e04d781f...) -> 510690 keys | 2389 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 634135 keys | 2730 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 615210 keys | 2731 slots | 0 slaves.
172.31.5.31:6379 (da230fc3...) -> 137175 keys | 682 slots | 0 slaves.
[OK] 3771256 keys in 7 masters.
230.18 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.31 TO 172.31.5.19 ###
[0m
{ reshardFrom: '172.31.5.31', reshardTo: '172.31.5.19', slots: 341 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 583469 keys | 2390 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 638712 keys | 2730 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 651865 keys | 2732 slots | 0 slaves.
172.31.5.19:6379 (e04d781f...) -> 564602 keys | 2730 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 634135 keys | 2730 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 615210 keys | 2731 slots | 0 slaves.
172.31.5.31:6379 (da230fc3...) -> 83263 keys | 341 slots | 0 slaves.
[OK] 3771256 keys in 7 masters.
230.18 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.31 TO 172.31.5.90 ###
[0m
{ reshardFrom: '172.31.5.31', reshardTo: '172.31.5.90', slots: 341 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 666732 keys | 2731 slots | 1 slaves.
172.31.5.254:6379 (6c6bab51...) -> 638712 keys | 2730 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 651865 keys | 2732 slots | 0 slaves.
172.31.5.19:6379 (e04d781f...) -> 564602 keys | 2730 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 634135 keys | 2730 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 615210 keys | 2731 slots | 0 slaves.
[OK] 3771256 keys in 6 masters.
230.18 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### REMOVING 172.31.5.31:6379 FROM CLUSTER ###
[0m
> redis-cli --cluster del-node 172.31.5.31:6379 da230fc3b5e5589500aa4278419cdba3a008ea1d
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 666732 keys | 2731 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 638712 keys | 2730 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 651865 keys | 2732 slots | 0 slaves.
172.31.5.19:6379 (e04d781f...) -> 564602 keys | 2730 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 634135 keys | 2730 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 615210 keys | 2731 slots | 0 slaves.
[OK] 3771256 keys in 6 masters.
230.18 keys per slot on average.
 
total slots: 16384
Removing node da230fc3b5e5589500aa4278419cdba3a008ea1d from cluster 172.31.5.31:6379
Sending CLUSTER FORGET messages to the cluster...
Sending CLUSTER RESET SOFT to the deleted node.
[33m### REBALANCING CLUSTER ON 172.31.5.90:6379 ###
[0m
> redis-cli --cluster rebalance 172.31.5.90:6379 --cluster-use-empty-masters | grep -i Rebalancing
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 666732 keys | 2731 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 638712 keys | 2730 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 651865 keys | 2732 slots | 0 slaves.
172.31.5.19:6379 (e04d781f...) -> 564602 keys | 2730 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 634135 keys | 2730 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 615210 keys | 2731 slots | 0 slaves.
[OK] 3771256 keys in 6 masters.
230.18 keys per slot on average.
 
total slots: 16384
*** No rebalancing needed! All nodes are within the 2.00% threshold.


waiting... 65 64 63 62 61 60 59 58 57 56 55 54 53 52 51 50 49 48 47 46 45 44 43 42 41 40 39 38 37 36 35 34 33 32 31 30 29 28 27 26 25 24 23 22 21 20 19 18 17 16 15 14 13 12 11 10 9 8 7 6 5 4 3 2 1 



[34m******* resize , 6 completed ******* [0m 

------------------------------------------------------------------

[34m******* write , 500000 *******[0m

[33m### WRITING 500000 KEYS ###
[0m
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 750127 keys | 2731 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 721925 keys | 2730 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 735204 keys | 2732 slots | 0 slaves.
172.31.5.19:6379 (e04d781f...) -> 647951 keys | 2730 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 717486 keys | 2730 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 698563 keys | 2731 slots | 0 slaves.
[OK] 4271256 keys in 6 masters.
260.70 keys per slot on average.
 
total slots: 16384
0.5M keys written successfully

[34m******* write , 500000 completed ******* [0m 

------------------------------------------------------------------

[34m******* resize , 8 *******[0m

{ clusterSize: 6 }
[33m### ADDING 172.31.5.31:6379 NODE TO CLUSTER ###
[0m
> redis-cli --cluster add-node 172.31.5.31:6379 172.31.5.90:6379 | awk '{ gsub(/[[0-9;]*m/, ""); print }'
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 750127 keys | 2731 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 721925 keys | 2730 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 735204 keys | 2732 slots | 0 slaves.
172.31.5.19:6379 (e04d781f...) -> 647951 keys | 2730 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 717486 keys | 2730 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 698563 keys | 2731 slots | 0 slaves.
172.31.5.31:6379 (da230fc3...) -> 0 keys | 0 slots | 0 slaves.
[OK] 4271256 keys in 7 masters.
260.70 keys per slot on average.
 
total slots: 16384
node added successfully
waiting... 2 1 


[33m### ADDING 172.31.5.106:6379 NODE TO CLUSTER ###
[0m
> redis-cli --cluster add-node 172.31.5.106:6379 172.31.5.90:6379 | awk '{ gsub(/[[0-9;]*m/, ""); print }'
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 750127 keys | 2731 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 721925 keys | 2730 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 735204 keys | 2732 slots | 0 slaves.
172.31.5.106:6379 (79b25185...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.19:6379 (e04d781f...) -> 647951 keys | 2730 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 717486 keys | 2730 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 698563 keys | 2731 slots | 0 slaves.
172.31.5.31:6379 (da230fc3...) -> 0 keys | 0 slots | 0 slaves.
[OK] 4271256 keys in 8 masters.
260.70 keys per slot on average.
 
total slots: 16384
node added successfully
waiting... 2 1 


waiting... 10 9 8 7 6 5 4 3 2 1 


[33m### REBALANCING CLUSTER ON 172.31.5.31:6379 ###
[0m
> redis-cli --cluster rebalance 172.31.5.31:6379 --cluster-use-empty-masters | grep -i Rebalancing
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 562510 keys | 2048 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 562626 keys | 2048 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 562489 keys | 2048 slots | 0 slaves.
172.31.5.106:6379 (79b25185...) -> 460700 keys | 2048 slots | 0 slaves.
172.31.5.19:6379 (e04d781f...) -> 502110 keys | 2048 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 562354 keys | 2048 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 562506 keys | 2048 slots | 0 slaves.
172.31.5.31:6379 (da230fc3...) -> 495961 keys | 2048 slots | 0 slaves.
[OK] 4271256 keys in 8 masters.
260.70 keys per slot on average.
 
total slots: 16384
>>> Rebalancing across 8 nodes. Total weight = 8.00



[34m******* resize , 8 completed ******* [0m 

------------------------------------------------------------------

[34m******* write , 500000 *******[0m

[33m### WRITING 500000 KEYS ###
[0m
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 625028 keys | 2048 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 625026 keys | 2048 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 624971 keys | 2048 slots | 0 slaves.
172.31.5.106:6379 (79b25185...) -> 523111 keys | 2048 slots | 0 slaves.
172.31.5.19:6379 (e04d781f...) -> 564757 keys | 2048 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 624958 keys | 2048 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 625023 keys | 2048 slots | 0 slaves.
172.31.5.31:6379 (da230fc3...) -> 558382 keys | 2048 slots | 0 slaves.
[OK] 4771256 keys in 8 masters.
291.21 keys per slot on average.
 
total slots: 16384
0.5M keys written successfully

[34m******* write , 500000 completed ******* [0m 

------------------------------------------------------------------

[34m******* resize , 7 *******[0m

{ clusterSize: 8 }
[33m### REBALANCING CLUSTER ON 172.31.5.106:6379 ###
[0m
> redis-cli --cluster rebalance 172.31.5.106:6379 --cluster-use-empty-masters | grep -i Rebalancing
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 625028 keys | 2048 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 625026 keys | 2048 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 624971 keys | 2048 slots | 0 slaves.
172.31.5.106:6379 (79b25185...) -> 523111 keys | 2048 slots | 0 slaves.
172.31.5.19:6379 (e04d781f...) -> 564757 keys | 2048 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 624958 keys | 2048 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 625023 keys | 2048 slots | 0 slaves.
172.31.5.31:6379 (da230fc3...) -> 558382 keys | 2048 slots | 0 slaves.
[OK] 4771256 keys in 8 masters.
291.21 keys per slot on average.
 
total slots: 16384
*** No rebalancing needed! All nodes are within the 2.00% threshold.


{ distribution: [
    293, 293, 293,
    293, 292, 292,
    292
  ] }
[33m### RESHARDING FROM 172.31.5.106 TO 172.31.5.90 ###
[0m
{ reshardFrom: '172.31.5.106', reshardTo: '172.31.5.90', slots: 293 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 696652 keys | 2341 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 625026 keys | 2048 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 624971 keys | 2048 slots | 0 slaves.
172.31.5.106:6379 (79b25185...) -> 451487 keys | 1755 slots | 0 slaves.
172.31.5.19:6379 (e04d781f...) -> 564757 keys | 2048 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 624958 keys | 2048 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 625023 keys | 2048 slots | 0 slaves.
172.31.5.31:6379 (da230fc3...) -> 558382 keys | 2048 slots | 0 slaves.
[OK] 4771256 keys in 8 masters.
291.21 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.106 TO 172.31.5.123 ###
[0m
{ reshardFrom: '172.31.5.106', reshardTo: '172.31.5.123', slots: 293 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 696652 keys | 2341 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 625026 keys | 2048 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 696593 keys | 2341 slots | 0 slaves.
172.31.5.106:6379 (79b25185...) -> 379865 keys | 1462 slots | 0 slaves.
172.31.5.19:6379 (e04d781f...) -> 564757 keys | 2048 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 624958 keys | 2048 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 625023 keys | 2048 slots | 0 slaves.
172.31.5.31:6379 (da230fc3...) -> 558382 keys | 2048 slots | 0 slaves.
[OK] 4771256 keys in 8 masters.
291.21 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.106 TO 172.31.5.101 ###
[0m
{ reshardFrom: '172.31.5.106', reshardTo: '172.31.5.101', slots: 293 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 696652 keys | 2341 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 625026 keys | 2048 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 696593 keys | 2341 slots | 0 slaves.
172.31.5.106:6379 (79b25185...) -> 307502 keys | 1169 slots | 0 slaves.
172.31.5.19:6379 (e04d781f...) -> 564757 keys | 2048 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 624958 keys | 2048 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 697386 keys | 2341 slots | 0 slaves.
172.31.5.31:6379 (da230fc3...) -> 558382 keys | 2048 slots | 0 slaves.
[OK] 4771256 keys in 8 masters.
291.21 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.106 TO 172.31.5.162 ###
[0m
{ reshardFrom: '172.31.5.106', reshardTo: '172.31.5.162', slots: 293 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 696652 keys | 2341 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 625026 keys | 2048 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 696593 keys | 2341 slots | 0 slaves.
172.31.5.106:6379 (79b25185...) -> 217973 keys | 876 slots | 0 slaves.
172.31.5.19:6379 (e04d781f...) -> 564757 keys | 2048 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 714487 keys | 2341 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 697386 keys | 2341 slots | 0 slaves.
172.31.5.31:6379 (da230fc3...) -> 558382 keys | 2048 slots | 0 slaves.
[OK] 4771256 keys in 8 masters.
291.21 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.106 TO 172.31.5.254 ###
[0m
{ reshardFrom: '172.31.5.106', reshardTo: '172.31.5.254', slots: 292 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 696652 keys | 2341 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 692398 keys | 2340 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 696593 keys | 2341 slots | 0 slaves.
172.31.5.106:6379 (79b25185...) -> 150601 keys | 584 slots | 0 slaves.
172.31.5.19:6379 (e04d781f...) -> 564757 keys | 2048 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 714487 keys | 2341 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 697386 keys | 2341 slots | 0 slaves.
172.31.5.31:6379 (da230fc3...) -> 558382 keys | 2048 slots | 0 slaves.
[OK] 4771256 keys in 8 masters.
291.21 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.106 TO 172.31.5.19 ###
[0m
{ reshardFrom: '172.31.5.106', reshardTo: '172.31.5.19', slots: 292 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 696652 keys | 2341 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 692398 keys | 2340 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 696593 keys | 2341 slots | 0 slaves.
172.31.5.106:6379 (79b25185...) -> 89221 keys | 292 slots | 0 slaves.
172.31.5.19:6379 (e04d781f...) -> 626137 keys | 2340 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 714487 keys | 2341 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 697386 keys | 2341 slots | 0 slaves.
172.31.5.31:6379 (da230fc3...) -> 558382 keys | 2048 slots | 0 slaves.
[OK] 4771256 keys in 8 masters.
291.21 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.106 TO 172.31.5.31 ###
[0m
{ reshardFrom: '172.31.5.106', reshardTo: '172.31.5.31', slots: 292 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 696652 keys | 2341 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 692398 keys | 2340 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 696593 keys | 2341 slots | 0 slaves.
172.31.5.19:6379 (e04d781f...) -> 626137 keys | 2340 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 714487 keys | 2341 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 697386 keys | 2341 slots | 0 slaves.
172.31.5.31:6379 (da230fc3...) -> 647603 keys | 2340 slots | 1 slaves.
[OK] 4771256 keys in 7 masters.
291.21 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### REMOVING 172.31.5.106:6379 FROM CLUSTER ###
[0m
> redis-cli --cluster del-node 172.31.5.106:6379 79b25185725faeb75a9733e3bf65ad57bcd0e662
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 696652 keys | 2341 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 692398 keys | 2340 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 696593 keys | 2341 slots | 0 slaves.
172.31.5.19:6379 (e04d781f...) -> 626137 keys | 2340 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 714487 keys | 2341 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 697386 keys | 2341 slots | 0 slaves.
172.31.5.31:6379 (da230fc3...) -> 647603 keys | 2340 slots | 0 slaves.
[OK] 4771256 keys in 7 masters.
291.21 keys per slot on average.
 
total slots: 16384
Removing node 79b25185725faeb75a9733e3bf65ad57bcd0e662 from cluster 172.31.5.106:6379
Sending CLUSTER FORGET messages to the cluster...
Sending CLUSTER RESET SOFT to the deleted node.
[33m### REBALANCING CLUSTER ON 172.31.5.90:6379 ###
[0m
> redis-cli --cluster rebalance 172.31.5.90:6379 --cluster-use-empty-masters | grep -i Rebalancing
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 696652 keys | 2341 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 692398 keys | 2340 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 696593 keys | 2341 slots | 0 slaves.
172.31.5.19:6379 (e04d781f...) -> 626137 keys | 2340 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 714487 keys | 2341 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 697386 keys | 2341 slots | 0 slaves.
172.31.5.31:6379 (da230fc3...) -> 647603 keys | 2340 slots | 0 slaves.
[OK] 4771256 keys in 7 masters.
291.21 keys per slot on average.
 
total slots: 16384
*** No rebalancing needed! All nodes are within the 2.00% threshold.


waiting... 65 64 63 62 61 60 59 58 57 56 55 54 53 52 51 50 49 48 47 46 45 44 43 42 41 40 39 38 37 36 35 34 33 32 31 30 29 28 27 26 25 24 23 22 21 20 19 18 17 16 15 14 13 12 11 10 9 8 7 6 5 4 3 2 1 



[34m******* resize , 7 completed ******* [0m 

------------------------------------------------------------------

[34m******* write , 500000 *******[0m

[33m### WRITING 500000 KEYS ###
[0m
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 768200 keys | 2341 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 763830 keys | 2340 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 768028 keys | 2341 slots | 0 slaves.
172.31.5.19:6379 (e04d781f...) -> 697432 keys | 2340 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 785908 keys | 2341 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 768790 keys | 2341 slots | 0 slaves.
172.31.5.31:6379 (da230fc3...) -> 719068 keys | 2340 slots | 0 slaves.
[OK] 5271256 keys in 7 masters.
321.73 keys per slot on average.
 
total slots: 16384
0.5M keys written successfully

[34m******* write , 500000 completed ******* [0m 

------------------------------------------------------------------

[34m******* resize , 3 *******[0m

{ clusterSize: 7 }
[33m### REBALANCING CLUSTER ON 172.31.5.31:6379 ###
[0m
> redis-cli --cluster rebalance 172.31.5.31:6379 --cluster-use-empty-masters | grep -i Rebalancing
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 768200 keys | 2341 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 763830 keys | 2340 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 768028 keys | 2341 slots | 0 slaves.
172.31.5.19:6379 (e04d781f...) -> 697432 keys | 2340 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 785908 keys | 2341 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 768790 keys | 2341 slots | 0 slaves.
172.31.5.31:6379 (da230fc3...) -> 719068 keys | 2340 slots | 0 slaves.
[OK] 5271256 keys in 7 masters.
321.73 keys per slot on average.
 
total slots: 16384
*** No rebalancing needed! All nodes are within the 2.00% threshold.


{ distribution: [ 780, 780, 780 ] }
[33m### RESHARDING FROM 172.31.5.31 TO 172.31.5.90 ###
[0m
{ reshardFrom: '172.31.5.31', reshardTo: '172.31.5.90', slots: 780 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 1030241 keys | 3121 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 763830 keys | 2340 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 768028 keys | 2341 slots | 0 slaves.
172.31.5.19:6379 (e04d781f...) -> 697432 keys | 2340 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 785908 keys | 2341 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 768790 keys | 2341 slots | 0 slaves.
172.31.5.31:6379 (da230fc3...) -> 457027 keys | 1560 slots | 0 slaves.
[OK] 5271256 keys in 7 masters.
321.73 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.31 TO 172.31.5.123 ###
[0m
{ reshardFrom: '172.31.5.31', reshardTo: '172.31.5.123', slots: 780 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 1030241 keys | 3121 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 763830 keys | 2340 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 971968 keys | 3121 slots | 0 slaves.
172.31.5.19:6379 (e04d781f...) -> 697432 keys | 2340 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 785908 keys | 2341 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 768790 keys | 2341 slots | 0 slaves.
172.31.5.31:6379 (da230fc3...) -> 253087 keys | 780 slots | 0 slaves.
[OK] 5271256 keys in 7 masters.
321.73 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.31 TO 172.31.5.101 ###
[0m
{ reshardFrom: '172.31.5.31', reshardTo: '172.31.5.101', slots: 780 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 1030241 keys | 3121 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 763830 keys | 2340 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 971968 keys | 3121 slots | 0 slaves.
172.31.5.19:6379 (e04d781f...) -> 697432 keys | 2340 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 785908 keys | 2341 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 1021877 keys | 3121 slots | 1 slaves.
[OK] 5271256 keys in 6 masters.
321.73 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### REMOVING 172.31.5.31:6379 FROM CLUSTER ###
[0m
> redis-cli --cluster del-node 172.31.5.31:6379 da230fc3b5e5589500aa4278419cdba3a008ea1d
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 1030241 keys | 3121 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 763830 keys | 2340 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 971968 keys | 3121 slots | 0 slaves.
172.31.5.19:6379 (e04d781f...) -> 697432 keys | 2340 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 785908 keys | 2341 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 1021877 keys | 3121 slots | 0 slaves.
[OK] 5271256 keys in 6 masters.
321.73 keys per slot on average.
 
total slots: 16384
Removing node da230fc3b5e5589500aa4278419cdba3a008ea1d from cluster 172.31.5.31:6379
Sending CLUSTER FORGET messages to the cluster...
Sending CLUSTER RESET SOFT to the deleted node.
{ distribution: [ 780, 780, 780 ] }
[33m### RESHARDING FROM 172.31.5.19 TO 172.31.5.123 ###
[0m
{ reshardFrom: '172.31.5.19', reshardTo: '172.31.5.123', slots: 780 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 1030241 keys | 3121 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 763830 keys | 2340 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 1157934 keys | 3901 slots | 0 slaves.
172.31.5.19:6379 (e04d781f...) -> 511466 keys | 1560 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 785908 keys | 2341 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 1021877 keys | 3121 slots | 0 slaves.
[OK] 5271256 keys in 6 masters.
321.73 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.19 TO 172.31.5.101 ###
[0m
{ reshardFrom: '172.31.5.19', reshardTo: '172.31.5.101', slots: 780 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 1030241 keys | 3121 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 763830 keys | 2340 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 1157934 keys | 3901 slots | 0 slaves.
172.31.5.19:6379 (e04d781f...) -> 261997 keys | 780 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 785908 keys | 2341 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 1271346 keys | 3901 slots | 0 slaves.
[OK] 5271256 keys in 6 masters.
321.73 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.19 TO 172.31.5.90 ###
[0m
{ reshardFrom: '172.31.5.19', reshardTo: '172.31.5.90', slots: 780 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 1292238 keys | 3901 slots | 1 slaves.
172.31.5.254:6379 (6c6bab51...) -> 763830 keys | 2340 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 1157934 keys | 3901 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 785908 keys | 2341 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 1271346 keys | 3901 slots | 0 slaves.
[OK] 5271256 keys in 5 masters.
321.73 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### REMOVING 172.31.5.19:6379 FROM CLUSTER ###
[0m
> redis-cli --cluster del-node 172.31.5.19:6379 e04d781f16cfbd7cc4cfebdcdf4d70181cd789a0
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 1292238 keys | 3901 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 763830 keys | 2340 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 1157934 keys | 3901 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 785908 keys | 2341 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 1271346 keys | 3901 slots | 0 slaves.
[OK] 5271256 keys in 5 masters.
321.73 keys per slot on average.
 
total slots: 16384
Removing node e04d781f16cfbd7cc4cfebdcdf4d70181cd789a0 from cluster 172.31.5.19:6379
Sending CLUSTER FORGET messages to the cluster...
Sending CLUSTER RESET SOFT to the deleted node.
{ distribution: [ 780, 780, 780 ] }
[33m### RESHARDING FROM 172.31.5.254 TO 172.31.5.101 ###
[0m
{ reshardFrom: '172.31.5.254', reshardTo: '172.31.5.101', slots: 780 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 1292238 keys | 3901 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 523596 keys | 1560 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 1157934 keys | 3901 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 785908 keys | 2341 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 1511580 keys | 4681 slots | 0 slaves.
[OK] 5271256 keys in 5 masters.
321.73 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.254 TO 172.31.5.90 ###
[0m
{ reshardFrom: '172.31.5.254', reshardTo: '172.31.5.90', slots: 780 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 1553910 keys | 4681 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 261924 keys | 780 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 1157934 keys | 3901 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 785908 keys | 2341 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 1511580 keys | 4681 slots | 0 slaves.
[OK] 5271256 keys in 5 masters.
321.73 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.254 TO 172.31.5.123 ###
[0m
{ reshardFrom: '172.31.5.254', reshardTo: '172.31.5.123', slots: 780 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 1553910 keys | 4681 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 1419858 keys | 4681 slots | 1 slaves.
172.31.5.162:6379 (74d3fe21...) -> 785908 keys | 2341 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 1511580 keys | 4681 slots | 0 slaves.
[OK] 5271256 keys in 4 masters.
321.73 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### REMOVING 172.31.5.254:6379 FROM CLUSTER ###
[0m
> redis-cli --cluster del-node 172.31.5.254:6379 6c6bab513b449851a04f6d1f658e5738dce6a12f
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 1553910 keys | 4681 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 1419858 keys | 4681 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 785908 keys | 2341 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 1511580 keys | 4681 slots | 0 slaves.
[OK] 5271256 keys in 4 masters.
321.73 keys per slot on average.
 
total slots: 16384
Removing node 6c6bab513b449851a04f6d1f658e5738dce6a12f from cluster 172.31.5.254:6379
Sending CLUSTER FORGET messages to the cluster...
Sending CLUSTER RESET SOFT to the deleted node.
{ distribution: [ 781, 780, 780 ] }
[33m### RESHARDING FROM 172.31.5.162 TO 172.31.5.90 ###
[0m
{ reshardFrom: '172.31.5.162', reshardTo: '172.31.5.90', slots: 781 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 1816203 keys | 5462 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 1419858 keys | 4681 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 523615 keys | 1560 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 1511580 keys | 4681 slots | 0 slaves.
[OK] 5271256 keys in 4 masters.
321.73 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.162 TO 172.31.5.123 ###
[0m
{ reshardFrom: '172.31.5.162', reshardTo: '172.31.5.123', slots: 780 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 1816203 keys | 5462 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 1681710 keys | 5461 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 261763 keys | 780 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 1511580 keys | 4681 slots | 0 slaves.
[OK] 5271256 keys in 4 masters.
321.73 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.162 TO 172.31.5.101 ###
[0m
{ reshardFrom: '172.31.5.162', reshardTo: '172.31.5.101', slots: 780 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 1816203 keys | 5462 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 1681710 keys | 5461 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 1773343 keys | 5461 slots | 1 slaves.
[OK] 5271256 keys in 3 masters.
321.73 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### REMOVING 172.31.5.162:6379 FROM CLUSTER ###
[0m
> redis-cli --cluster del-node 172.31.5.162:6379 74d3fe212c5b4038d230cbfd1fe15f7cdc06ae2a
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 1816203 keys | 5462 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 1681710 keys | 5461 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 1773343 keys | 5461 slots | 0 slaves.
[OK] 5271256 keys in 3 masters.
321.73 keys per slot on average.
 
total slots: 16384
Removing node 74d3fe212c5b4038d230cbfd1fe15f7cdc06ae2a from cluster 172.31.5.162:6379
Sending CLUSTER FORGET messages to the cluster...
Sending CLUSTER RESET SOFT to the deleted node.
[33m### REBALANCING CLUSTER ON 172.31.5.90:6379 ###
[0m
> redis-cli --cluster rebalance 172.31.5.90:6379 --cluster-use-empty-masters | grep -i Rebalancing
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 1816203 keys | 5462 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 1681710 keys | 5461 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 1773343 keys | 5461 slots | 0 slaves.
[OK] 5271256 keys in 3 masters.
321.73 keys per slot on average.
 
total slots: 16384
*** No rebalancing needed! All nodes are within the 2.00% threshold.


waiting... 65 64 63 62 61 60 59 58 57 56 55 54 53 52 51 50 49 48 47 46 45 44 43 42 41 40 39 38 37 36 35 34 33 32 31 30 29 28 27 26 25 24 23 22 21 20 19 18 17 16 15 14 13 12 11 10 9 8 7 6 5 4 3 2 1 



[34m******* resize , 3 completed ******* [0m 

------------------------------------------------------------------

[34m******* write , 500000 *******[0m

[33m### WRITING 500000 KEYS ###
[0m
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 1982745 keys | 5462 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 1848466 keys | 5461 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 1940045 keys | 5461 slots | 0 slaves.
[OK] 5771256 keys in 3 masters.
352.25 keys per slot on average.
 
total slots: 16384
0.5M keys written successfully

[34m******* write , 500000 completed ******* [0m 

------------------------------------------------------------------

[34m******* resize , 7 *******[0m

{ clusterSize: 3 }
[33m### ADDING 172.31.5.162:6379 NODE TO CLUSTER ###
[0m
> redis-cli --cluster add-node 172.31.5.162:6379 172.31.5.90:6379 | awk '{ gsub(/[[0-9;]*m/, ""); print }'
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 1982745 keys | 5462 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 1848466 keys | 5461 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 1940045 keys | 5461 slots | 0 slaves.
[OK] 5771256 keys in 4 masters.
352.25 keys per slot on average.
 
total slots: 16384
node added successfully
waiting... 2 1 


[33m### ADDING 172.31.5.254:6379 NODE TO CLUSTER ###
[0m
> redis-cli --cluster add-node 172.31.5.254:6379 172.31.5.90:6379 | awk '{ gsub(/[[0-9;]*m/, ""); print }'
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 1982745 keys | 5462 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 1848466 keys | 5461 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 1940045 keys | 5461 slots | 0 slaves.
[OK] 5771256 keys in 5 masters.
352.25 keys per slot on average.
 
total slots: 16384
node added successfully
waiting... 2 1 


[33m### ADDING 172.31.5.19:6379 NODE TO CLUSTER ###
[0m
> redis-cli --cluster add-node 172.31.5.19:6379 172.31.5.90:6379 | awk '{ gsub(/[[0-9;]*m/, ""); print }'
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 1982745 keys | 5462 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 1848466 keys | 5461 slots | 0 slaves.
172.31.5.19:6379 (e04d781f...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 1940045 keys | 5461 slots | 0 slaves.
[OK] 5771256 keys in 6 masters.
352.25 keys per slot on average.
 
total slots: 16384
node added successfully
waiting... 2 1 


[33m### ADDING 172.31.5.31:6379 NODE TO CLUSTER ###
[0m
> redis-cli --cluster add-node 172.31.5.31:6379 172.31.5.90:6379 | awk '{ gsub(/[[0-9;]*m/, ""); print }'
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 1982745 keys | 5462 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 1848466 keys | 5461 slots | 0 slaves.
172.31.5.19:6379 (e04d781f...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 1940045 keys | 5461 slots | 0 slaves.
172.31.5.31:6379 (da230fc3...) -> 0 keys | 0 slots | 0 slaves.
[OK] 5771256 keys in 7 masters.
352.25 keys per slot on average.
 
total slots: 16384
node added successfully
waiting... 2 1 


waiting... 10 9 8 7 6 5 4 3 2 1 


[33m### REBALANCING CLUSTER ON 172.31.5.162:6379 ###
[0m
> redis-cli --cluster rebalance 172.31.5.162:6379 --cluster-use-empty-masters | grep -i Rebalancing
assertion error.
 {
  keys1: 5771256,
  keys2: 3853266,
  keys: 0,
  slots1: 16384,
  slots2: 16384,
  nodes1: 7,
  nodes2: 7,
  nodes: 0
}
precheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 1982745 keys | 5462 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 1848466 keys | 5461 slots | 0 slaves.
172.31.5.19:6379 (e04d781f...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 1940045 keys | 5461 slots | 0 slaves.
172.31.5.31:6379 (da230fc3...) -> 0 keys | 0 slots | 0 slaves.
[OK] 5771256 keys in 7 masters.
352.25 keys per slot on average.

postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 857005 keys | 2340 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 747595 keys | 2341 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 856940 keys | 2340 slots | 0 slaves.
172.31.5.19:6379 (e04d781f...) -> 0 keys | 2341 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 839779 keys | 2341 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 0 keys | 2340 slots | 0 slaves.
172.31.5.31:6379 (da230fc3...) -> 551947 keys | 2341 slots | 0 slaves.
[OK] 3853266 keys in 7 masters.
235.18 keys per slot on average.
 
total slots: 16384
>>> Rebalancing across 7 nodes. Total weight = 7.00



[34m******* resize , 7 completed ******* [0m 

------------------------------------------------------------------

[34m******* write , 500000 *******[0m

[33m### WRITING 500000 KEYS ###
[0m
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 928371 keys | 2340 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 819067 keys | 2341 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 928391 keys | 2340 slots | 0 slaves.
172.31.5.19:6379 (e04d781f...) -> 71434 keys | 2341 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 911311 keys | 2341 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 71384 keys | 2340 slots | 0 slaves.
172.31.5.31:6379 (da230fc3...) -> 623308 keys | 2341 slots | 0 slaves.
[OK] 4353266 keys in 7 masters.
265.70 keys per slot on average.
 
total slots: 16384
0.5M keys written successfully

[34m******* write , 500000 completed ******* [0m 

------------------------------------------------------------------

[34m******* resize , 4 *******[0m

{ clusterSize: 7 }
[33m### REBALANCING CLUSTER ON 172.31.5.31:6379 ###
[0m
> redis-cli --cluster rebalance 172.31.5.31:6379 --cluster-use-empty-masters | grep -i Rebalancing
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 928371 keys | 2340 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 819067 keys | 2341 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 928391 keys | 2340 slots | 0 slaves.
172.31.5.19:6379 (e04d781f...) -> 71434 keys | 2341 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 911311 keys | 2341 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 71384 keys | 2340 slots | 0 slaves.
172.31.5.31:6379 (da230fc3...) -> 623308 keys | 2341 slots | 0 slaves.
[OK] 4353266 keys in 7 masters.
265.70 keys per slot on average.
 
total slots: 16384
*** No rebalancing needed! All nodes are within the 2.00% threshold.


{ distribution: [ 586, 585, 585, 585 ] }
[33m### RESHARDING FROM 172.31.5.31 TO 172.31.5.90 ###
[0m
{ reshardFrom: '172.31.5.31', reshardTo: '172.31.5.90', slots: 586 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 968279 keys | 2926 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 819067 keys | 2341 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 928391 keys | 2340 slots | 0 slaves.
172.31.5.19:6379 (e04d781f...) -> 71434 keys | 2341 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 911311 keys | 2341 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 71384 keys | 2340 slots | 0 slaves.
172.31.5.31:6379 (da230fc3...) -> 583400 keys | 1755 slots | 0 slaves.
[OK] 4353266 keys in 7 masters.
265.70 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.31 TO 172.31.5.123 ###
[0m
{ reshardFrom: '172.31.5.31', reshardTo: '172.31.5.123', slots: 585 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 968279 keys | 2926 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 819067 keys | 2341 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 1047756 keys | 2925 slots | 0 slaves.
172.31.5.19:6379 (e04d781f...) -> 71434 keys | 2341 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 911311 keys | 2341 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 71384 keys | 2340 slots | 0 slaves.
172.31.5.31:6379 (da230fc3...) -> 464035 keys | 1170 slots | 0 slaves.
[OK] 4353266 keys in 7 masters.
265.70 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.31 TO 172.31.5.101 ###
[0m
{ reshardFrom: '172.31.5.31', reshardTo: '172.31.5.101', slots: 585 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 968279 keys | 2926 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 819067 keys | 2341 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 1047756 keys | 2925 slots | 0 slaves.
172.31.5.19:6379 (e04d781f...) -> 71434 keys | 2341 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 911311 keys | 2341 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 303309 keys | 2925 slots | 0 slaves.
172.31.5.31:6379 (da230fc3...) -> 232110 keys | 585 slots | 0 slaves.
[OK] 4353266 keys in 7 masters.
265.70 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.31 TO 172.31.5.162 ###
[0m
{ reshardFrom: '172.31.5.31', reshardTo: '172.31.5.162', slots: 585 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 968279 keys | 2926 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 819067 keys | 2341 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 1047756 keys | 2925 slots | 0 slaves.
172.31.5.19:6379 (e04d781f...) -> 71434 keys | 2341 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 1143421 keys | 2926 slots | 1 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 303309 keys | 2925 slots | 0 slaves.
[OK] 4353266 keys in 6 masters.
265.70 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### REMOVING 172.31.5.31:6379 FROM CLUSTER ###
[0m
> redis-cli --cluster del-node 172.31.5.31:6379 da230fc3b5e5589500aa4278419cdba3a008ea1d
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 968279 keys | 2926 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 819067 keys | 2341 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 1047756 keys | 2925 slots | 0 slaves.
172.31.5.19:6379 (e04d781f...) -> 71434 keys | 2341 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 1143421 keys | 2926 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 303309 keys | 2925 slots | 0 slaves.
[OK] 4353266 keys in 6 masters.
265.70 keys per slot on average.
 
total slots: 16384
Removing node da230fc3b5e5589500aa4278419cdba3a008ea1d from cluster 172.31.5.31:6379
Sending CLUSTER FORGET messages to the cluster...
Sending CLUSTER RESET SOFT to the deleted node.
{ distribution: [ 586, 585, 585, 585 ] }
[33m### RESHARDING FROM 172.31.5.19 TO 172.31.5.123 ###
[0m
{ reshardFrom: '172.31.5.19', reshardTo: '172.31.5.123', slots: 586 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 968279 keys | 2926 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 819067 keys | 2341 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 1065663 keys | 3511 slots | 0 slaves.
172.31.5.19:6379 (e04d781f...) -> 53527 keys | 1755 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 1143421 keys | 2926 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 303309 keys | 2925 slots | 0 slaves.
[OK] 4353266 keys in 6 masters.
265.70 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.19 TO 172.31.5.101 ###
[0m
{ reshardFrom: '172.31.5.19', reshardTo: '172.31.5.101', slots: 585 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 968279 keys | 2926 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 819067 keys | 2341 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 1065663 keys | 3511 slots | 0 slaves.
172.31.5.19:6379 (e04d781f...) -> 35715 keys | 1170 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 1143421 keys | 2926 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 321121 keys | 3510 slots | 0 slaves.
[OK] 4353266 keys in 6 masters.
265.70 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.19 TO 172.31.5.162 ###
[0m
{ reshardFrom: '172.31.5.19', reshardTo: '172.31.5.162', slots: 585 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 968279 keys | 2926 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 819067 keys | 2341 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 1065663 keys | 3511 slots | 0 slaves.
172.31.5.19:6379 (e04d781f...) -> 17826 keys | 585 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 1161310 keys | 3511 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 321121 keys | 3510 slots | 0 slaves.
[OK] 4353266 keys in 6 masters.
265.70 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.19 TO 172.31.5.90 ###
[0m
{ reshardFrom: '172.31.5.19', reshardTo: '172.31.5.90', slots: 585 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 986105 keys | 3511 slots | 1 slaves.
172.31.5.254:6379 (6c6bab51...) -> 819067 keys | 2341 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 1065663 keys | 3511 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 1161310 keys | 3511 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 321121 keys | 3510 slots | 0 slaves.
[OK] 4353266 keys in 5 masters.
265.70 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### REMOVING 172.31.5.19:6379 FROM CLUSTER ###
[0m
> redis-cli --cluster del-node 172.31.5.19:6379 e04d781f16cfbd7cc4cfebdcdf4d70181cd789a0
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 986105 keys | 3511 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 819067 keys | 2341 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 1065663 keys | 3511 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 1161310 keys | 3511 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 321121 keys | 3510 slots | 0 slaves.
[OK] 4353266 keys in 5 masters.
265.70 keys per slot on average.
 
total slots: 16384
Removing node e04d781f16cfbd7cc4cfebdcdf4d70181cd789a0 from cluster 172.31.5.19:6379
Sending CLUSTER FORGET messages to the cluster...
Sending CLUSTER RESET SOFT to the deleted node.
{ distribution: [ 586, 585, 585, 585 ] }
[33m### RESHARDING FROM 172.31.5.254 TO 172.31.5.101 ###
[0m
{ reshardFrom: '172.31.5.254', reshardTo: '172.31.5.101', slots: 586 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 986105 keys | 3511 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 604643 keys | 1755 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 1065663 keys | 3511 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 1161310 keys | 3511 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 535545 keys | 4096 slots | 0 slaves.
[OK] 4353266 keys in 5 masters.
265.70 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.254 TO 172.31.5.162 ###
[0m
{ reshardFrom: '172.31.5.254', reshardTo: '172.31.5.162', slots: 585 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 986105 keys | 3511 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 426102 keys | 1170 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 1065663 keys | 3511 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 1339851 keys | 4096 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 535545 keys | 4096 slots | 0 slaves.
[OK] 4353266 keys in 5 masters.
265.70 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.254 TO 172.31.5.90 ###
[0m
{ reshardFrom: '172.31.5.254', reshardTo: '172.31.5.90', slots: 585 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 1180211 keys | 4096 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 231996 keys | 585 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 1065663 keys | 3511 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 1339851 keys | 4096 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 535545 keys | 4096 slots | 0 slaves.
[OK] 4353266 keys in 5 masters.
265.70 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.254 TO 172.31.5.123 ###
[0m
{ reshardFrom: '172.31.5.254', reshardTo: '172.31.5.123', slots: 585 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 1180211 keys | 4096 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 1297659 keys | 4096 slots | 1 slaves.
172.31.5.162:6379 (74d3fe21...) -> 1339851 keys | 4096 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 535545 keys | 4096 slots | 0 slaves.
[OK] 4353266 keys in 4 masters.
265.70 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### REMOVING 172.31.5.254:6379 FROM CLUSTER ###
[0m
> redis-cli --cluster del-node 172.31.5.254:6379 6c6bab513b449851a04f6d1f658e5738dce6a12f
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 1180211 keys | 4096 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 1297659 keys | 4096 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 1339851 keys | 4096 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 535545 keys | 4096 slots | 0 slaves.
[OK] 4353266 keys in 4 masters.
265.70 keys per slot on average.
 
total slots: 16384
Removing node 6c6bab513b449851a04f6d1f658e5738dce6a12f from cluster 172.31.5.254:6379
Sending CLUSTER FORGET messages to the cluster...
Sending CLUSTER RESET SOFT to the deleted node.
[33m### REBALANCING CLUSTER ON 172.31.5.90:6379 ###
[0m
> redis-cli --cluster rebalance 172.31.5.90:6379 --cluster-use-empty-masters | grep -i Rebalancing
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 1180211 keys | 4096 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 1297659 keys | 4096 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 1339851 keys | 4096 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 535545 keys | 4096 slots | 0 slaves.
[OK] 4353266 keys in 4 masters.
265.70 keys per slot on average.
 
total slots: 16384
*** No rebalancing needed! All nodes are within the 2.00% threshold.


waiting... 65 64 63 62 61 60 59 58 57 56 55 54 53 52 51 50 49 48 47 46 45 44 43 42 41 40 39 38 37 36 35 34 33 32 31 30 29 28 27 26 25 24 23 22 21 20 19 18 17 16 15 14 13 12 11 10 9 8 7 6 5 4 3 2 1 



[34m******* resize , 4 completed ******* [0m 

------------------------------------------------------------------

[34m******* write , 500000 *******[0m

[33m### WRITING 500000 KEYS ###
[0m
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 1305162 keys | 4096 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 1422682 keys | 4096 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 1464960 keys | 4096 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 660462 keys | 4096 slots | 0 slaves.
[OK] 4853266 keys in 4 masters.
296.22 keys per slot on average.
 
total slots: 16384
0.5M keys written successfully

[34m******* write , 500000 completed ******* [0m 

------------------------------------------------------------------

[34m******* resize , 7 *******[0m

{ clusterSize: 4 }
[33m### ADDING 172.31.5.254:6379 NODE TO CLUSTER ###
[0m
> redis-cli --cluster add-node 172.31.5.254:6379 172.31.5.90:6379 | awk '{ gsub(/[[0-9;]*m/, ""); print }'
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 1305162 keys | 4096 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 1422682 keys | 4096 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 1464960 keys | 4096 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 660462 keys | 4096 slots | 0 slaves.
[OK] 4853266 keys in 5 masters.
296.22 keys per slot on average.
 
total slots: 16384
node added successfully
waiting... 2 1 


[33m### ADDING 172.31.5.19:6379 NODE TO CLUSTER ###
[0m
> redis-cli --cluster add-node 172.31.5.19:6379 172.31.5.90:6379 | awk '{ gsub(/[[0-9;]*m/, ""); print }'
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 1305162 keys | 4096 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 1422682 keys | 4096 slots | 0 slaves.
172.31.5.19:6379 (e04d781f...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 1464960 keys | 4096 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 660462 keys | 4096 slots | 0 slaves.
[OK] 4853266 keys in 6 masters.
296.22 keys per slot on average.
 
total slots: 16384
node added successfully
waiting... 2 1 


[33m### ADDING 172.31.5.31:6379 NODE TO CLUSTER ###
[0m
> redis-cli --cluster add-node 172.31.5.31:6379 172.31.5.90:6379 | awk '{ gsub(/[[0-9;]*m/, ""); print }'
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 1305162 keys | 4096 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 1422682 keys | 4096 slots | 0 slaves.
172.31.5.19:6379 (e04d781f...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 1464960 keys | 4096 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 660462 keys | 4096 slots | 0 slaves.
172.31.5.31:6379 (da230fc3...) -> 0 keys | 0 slots | 0 slaves.
[OK] 4853266 keys in 7 masters.
296.22 keys per slot on average.
 
total slots: 16384
node added successfully
waiting... 2 1 


waiting... 10 9 8 7 6 5 4 3 2 1 


[33m### REBALANCING CLUSTER ON 172.31.5.254:6379 ###
[0m
> redis-cli --cluster rebalance 172.31.5.254:6379 --cluster-use-empty-masters | grep -i Rebalancing
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 892820 keys | 2340 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 644632 keys | 2342 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 999849 keys | 2340 slots | 0 slaves.
172.31.5.19:6379 (e04d781f...) -> 655177 keys | 2341 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 755858 keys | 2340 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 142788 keys | 2340 slots | 0 slaves.
172.31.5.31:6379 (da230fc3...) -> 762142 keys | 2341 slots | 0 slaves.
[OK] 4853266 keys in 7 masters.
296.22 keys per slot on average.
 
total slots: 16384
>>> Rebalancing across 7 nodes. Total weight = 7.00



[34m******* resize , 7 completed ******* [0m 

------------------------------------------------------------------

[34m******* write , 500000 *******[0m

[33m### WRITING 500000 KEYS ###
[0m
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 964231 keys | 2340 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 716132 keys | 2342 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 1071207 keys | 2340 slots | 0 slaves.
172.31.5.19:6379 (e04d781f...) -> 726567 keys | 2341 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 827293 keys | 2340 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 214203 keys | 2340 slots | 0 slaves.
172.31.5.31:6379 (da230fc3...) -> 833633 keys | 2341 slots | 0 slaves.
[OK] 5353266 keys in 7 masters.
326.74 keys per slot on average.
 
total slots: 16384
0.5M keys written successfully

[34m******* write , 500000 completed ******* [0m 

------------------------------------------------------------------

[34m******* resize , 5 *******[0m

{ clusterSize: 7 }
[33m### REBALANCING CLUSTER ON 172.31.5.31:6379 ###
[0m
> redis-cli --cluster rebalance 172.31.5.31:6379 --cluster-use-empty-masters | grep -i Rebalancing
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 964231 keys | 2340 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 716132 keys | 2342 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 1071207 keys | 2340 slots | 0 slaves.
172.31.5.19:6379 (e04d781f...) -> 726567 keys | 2341 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 827293 keys | 2340 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 214203 keys | 2340 slots | 0 slaves.
172.31.5.31:6379 (da230fc3...) -> 833633 keys | 2341 slots | 0 slaves.
[OK] 5353266 keys in 7 masters.
326.74 keys per slot on average.
 
total slots: 16384
*** No rebalancing needed! All nodes are within the 2.00% threshold.


{ distribution: [ 469, 468, 468, 468, 468 ] }
[33m### RESHARDING FROM 172.31.5.31 TO 172.31.5.90 ###
[0m
{ reshardFrom: '172.31.5.31', reshardTo: '172.31.5.90', slots: 469 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 1161216 keys | 2809 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 716132 keys | 2342 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 1071207 keys | 2340 slots | 0 slaves.
172.31.5.19:6379 (e04d781f...) -> 726567 keys | 2341 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 827293 keys | 2340 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 214203 keys | 2340 slots | 0 slaves.
172.31.5.31:6379 (da230fc3...) -> 636648 keys | 1872 slots | 0 slaves.
[OK] 5353266 keys in 7 masters.
326.74 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.31 TO 172.31.5.123 ###
[0m
{ reshardFrom: '172.31.5.31', reshardTo: '172.31.5.123', slots: 468 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 1161216 keys | 2809 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 716132 keys | 2342 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 1285449 keys | 2808 slots | 0 slaves.
172.31.5.19:6379 (e04d781f...) -> 726567 keys | 2341 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 827293 keys | 2340 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 214203 keys | 2340 slots | 0 slaves.
172.31.5.31:6379 (da230fc3...) -> 422406 keys | 1404 slots | 0 slaves.
[OK] 5353266 keys in 7 masters.
326.74 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.31 TO 172.31.5.101 ###
[0m
{ reshardFrom: '172.31.5.31', reshardTo: '172.31.5.101', slots: 468 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 1161216 keys | 2809 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 716132 keys | 2342 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 1285449 keys | 2808 slots | 0 slaves.
172.31.5.19:6379 (e04d781f...) -> 726567 keys | 2341 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 827293 keys | 2340 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 336860 keys | 2808 slots | 0 slaves.
172.31.5.31:6379 (da230fc3...) -> 299749 keys | 936 slots | 0 slaves.
[OK] 5353266 keys in 7 masters.
326.74 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.31 TO 172.31.5.162 ###
[0m
{ reshardFrom: '172.31.5.31', reshardTo: '172.31.5.162', slots: 468 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 1161216 keys | 2809 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 716132 keys | 2342 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 1285449 keys | 2808 slots | 0 slaves.
172.31.5.19:6379 (e04d781f...) -> 726567 keys | 2341 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 912963 keys | 2808 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 336860 keys | 2808 slots | 0 slaves.
172.31.5.31:6379 (da230fc3...) -> 214079 keys | 468 slots | 0 slaves.
[OK] 5353266 keys in 7 masters.
326.74 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.31 TO 172.31.5.254 ###
[0m
{ reshardFrom: '172.31.5.31', reshardTo: '172.31.5.254', slots: 468 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 1161216 keys | 2809 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 930211 keys | 2810 slots | 1 slaves.
172.31.5.123:6379 (24ea1433...) -> 1285449 keys | 2808 slots | 0 slaves.
172.31.5.19:6379 (e04d781f...) -> 726567 keys | 2341 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 912963 keys | 2808 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 336860 keys | 2808 slots | 0 slaves.
[OK] 5353266 keys in 6 masters.
326.74 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### REMOVING 172.31.5.31:6379 FROM CLUSTER ###
[0m
> redis-cli --cluster del-node 172.31.5.31:6379 da230fc3b5e5589500aa4278419cdba3a008ea1d
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 1161216 keys | 2809 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 930211 keys | 2810 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 1285449 keys | 2808 slots | 0 slaves.
172.31.5.19:6379 (e04d781f...) -> 726567 keys | 2341 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 912963 keys | 2808 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 336860 keys | 2808 slots | 0 slaves.
[OK] 5353266 keys in 6 masters.
326.74 keys per slot on average.
 
total slots: 16384
Removing node da230fc3b5e5589500aa4278419cdba3a008ea1d from cluster 172.31.5.31:6379
Sending CLUSTER FORGET messages to the cluster...
Sending CLUSTER RESET SOFT to the deleted node.
{ distribution: [ 469, 468, 468, 468, 468 ] }
[33m### RESHARDING FROM 172.31.5.19 TO 172.31.5.123 ###
[0m
{ reshardFrom: '172.31.5.19', reshardTo: '172.31.5.123', slots: 469 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 1161216 keys | 2809 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 930211 keys | 2810 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 1491274 keys | 3277 slots | 0 slaves.
172.31.5.19:6379 (e04d781f...) -> 520742 keys | 1872 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 912963 keys | 2808 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 336860 keys | 2808 slots | 0 slaves.
[OK] 5353266 keys in 6 masters.
326.74 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.19 TO 172.31.5.101 ###
[0m
{ reshardFrom: '172.31.5.19', reshardTo: '172.31.5.101', slots: 468 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 1161216 keys | 2809 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 930211 keys | 2810 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 1491274 keys | 3277 slots | 0 slaves.
172.31.5.19:6379 (e04d781f...) -> 397255 keys | 1404 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 912963 keys | 2808 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 460347 keys | 3276 slots | 0 slaves.
[OK] 5353266 keys in 6 masters.
326.74 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.19 TO 172.31.5.162 ###
[0m
{ reshardFrom: '172.31.5.19', reshardTo: '172.31.5.162', slots: 468 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 1161216 keys | 2809 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 930211 keys | 2810 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 1491274 keys | 3277 slots | 0 slaves.
172.31.5.19:6379 (e04d781f...) -> 335819 keys | 936 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 974399 keys | 3276 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 460347 keys | 3276 slots | 0 slaves.
[OK] 5353266 keys in 6 masters.
326.74 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.19 TO 172.31.5.254 ###
[0m
{ reshardFrom: '172.31.5.19', reshardTo: '172.31.5.254', slots: 468 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 1161216 keys | 2809 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 1051898 keys | 3278 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 1491274 keys | 3277 slots | 0 slaves.
172.31.5.19:6379 (e04d781f...) -> 214132 keys | 468 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 974399 keys | 3276 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 460347 keys | 3276 slots | 0 slaves.
[OK] 5353266 keys in 6 masters.
326.74 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.19 TO 172.31.5.90 ###
[0m
{ reshardFrom: '172.31.5.19', reshardTo: '172.31.5.90', slots: 468 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 1375348 keys | 3277 slots | 1 slaves.
172.31.5.254:6379 (6c6bab51...) -> 1051898 keys | 3278 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 1491274 keys | 3277 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 974399 keys | 3276 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 460347 keys | 3276 slots | 0 slaves.
[OK] 5353266 keys in 5 masters.
326.74 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### REMOVING 172.31.5.19:6379 FROM CLUSTER ###
[0m
> redis-cli --cluster del-node 172.31.5.19:6379 e04d781f16cfbd7cc4cfebdcdf4d70181cd789a0
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 1375348 keys | 3277 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 1051898 keys | 3278 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 1491274 keys | 3277 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 974399 keys | 3276 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 460347 keys | 3276 slots | 0 slaves.
[OK] 5353266 keys in 5 masters.
326.74 keys per slot on average.
 
total slots: 16384
Removing node e04d781f16cfbd7cc4cfebdcdf4d70181cd789a0 from cluster 172.31.5.19:6379
Sending CLUSTER FORGET messages to the cluster...
Sending CLUSTER RESET SOFT to the deleted node.
[33m### REBALANCING CLUSTER ON 172.31.5.90:6379 ###
[0m
> redis-cli --cluster rebalance 172.31.5.90:6379 --cluster-use-empty-masters | grep -i Rebalancing
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 1375348 keys | 3277 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 1051898 keys | 3278 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 1491274 keys | 3277 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 974399 keys | 3276 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 460347 keys | 3276 slots | 0 slaves.
[OK] 5353266 keys in 5 masters.
326.74 keys per slot on average.
 
total slots: 16384
*** No rebalancing needed! All nodes are within the 2.00% threshold.


waiting... 65 64 63 62 61 60 59 58 57 56 55 54 53 52 51 50 49 48 47 46 45 44 43 42 41 40 39 38 37 36 35 34 33 32 31 30 29 28 27 26 25 24 23 22 21 20 19 18 17 16 15 14 13 12 11 10 9 8 7 6 5 4 3 2 1 



[34m******* resize , 5 completed ******* [0m 

------------------------------------------------------------------

[34m******* write , 500000 *******[0m

[33m### WRITING 500000 KEYS ###
[0m
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 1475323 keys | 3277 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 1151809 keys | 3278 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 1591355 keys | 3277 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 1074435 keys | 3276 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 560344 keys | 3276 slots | 0 slaves.
[OK] 5853266 keys in 5 masters.
357.26 keys per slot on average.
 
total slots: 16384
0.5M keys written successfully

[34m******* write , 500000 completed ******* [0m 

------------------------------------------------------------------

[34m******* resize , 7 *******[0m

{ clusterSize: 5 }
[33m### ADDING 172.31.5.19:6379 NODE TO CLUSTER ###
[0m
> redis-cli --cluster add-node 172.31.5.19:6379 172.31.5.90:6379 | awk '{ gsub(/[[0-9;]*m/, ""); print }'
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 1475323 keys | 3277 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 1151809 keys | 3278 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 1591355 keys | 3277 slots | 0 slaves.
172.31.5.19:6379 (e04d781f...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 1074435 keys | 3276 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 560344 keys | 3276 slots | 0 slaves.
[OK] 5853266 keys in 6 masters.
357.26 keys per slot on average.
 
total slots: 16384
node added successfully
waiting... 2 1 


[33m### ADDING 172.31.5.31:6379 NODE TO CLUSTER ###
[0m
> redis-cli --cluster add-node 172.31.5.31:6379 172.31.5.90:6379 | awk '{ gsub(/[[0-9;]*m/, ""); print }'
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 1475323 keys | 3277 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 1151809 keys | 3278 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 1591355 keys | 3277 slots | 0 slaves.
172.31.5.19:6379 (e04d781f...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 1074435 keys | 3276 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 560344 keys | 3276 slots | 0 slaves.
172.31.5.31:6379 (da230fc3...) -> 0 keys | 0 slots | 0 slaves.
[OK] 5853266 keys in 7 masters.
357.26 keys per slot on average.
 
total slots: 16384
node added successfully
waiting... 2 1 


waiting... 10 9 8 7 6 5 4 3 2 1 


[33m### REBALANCING CLUSTER ON 172.31.5.19:6379 ###
[0m
> redis-cli --cluster rebalance 172.31.5.19:6379 --cluster-use-empty-masters | grep -i Rebalancing
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 1035618 keys | 2340 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 818813 keys | 2340 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 1142641 keys | 2340 slots | 0 slaves.
172.31.5.19:6379 (e04d781f...) -> 992061 keys | 2342 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 899948 keys | 2340 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 285632 keys | 2340 slots | 0 slaves.
172.31.5.31:6379 (da230fc3...) -> 678553 keys | 2342 slots | 0 slaves.
[OK] 5853266 keys in 7 masters.
357.26 keys per slot on average.
 
total slots: 16384
>>> Rebalancing across 7 nodes. Total weight = 7.00



[34m******* resize , 7 completed ******* [0m 

------------------------------------------------------------------

[34m******* write , 500000 *******[0m

[33m### WRITING 500000 KEYS ###
[0m
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 1107024 keys | 2340 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 890299 keys | 2340 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 1214072 keys | 2340 slots | 0 slaves.
172.31.5.19:6379 (e04d781f...) -> 1063534 keys | 2342 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 971322 keys | 2340 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 357056 keys | 2340 slots | 0 slaves.
172.31.5.31:6379 (da230fc3...) -> 749959 keys | 2342 slots | 0 slaves.
[OK] 6353266 keys in 7 masters.
387.77 keys per slot on average.
 
total slots: 16384
0.5M keys written successfully

[34m******* write , 500000 completed ******* [0m 

------------------------------------------------------------------

[34m******* resize , 6 *******[0m

{ clusterSize: 7 }
[33m### REBALANCING CLUSTER ON 172.31.5.31:6379 ###
[0m
> redis-cli --cluster rebalance 172.31.5.31:6379 --cluster-use-empty-masters | grep -i Rebalancing
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 1107024 keys | 2340 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 890299 keys | 2340 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 1214072 keys | 2340 slots | 0 slaves.
172.31.5.19:6379 (e04d781f...) -> 1063534 keys | 2342 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 971322 keys | 2340 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 357056 keys | 2340 slots | 0 slaves.
172.31.5.31:6379 (da230fc3...) -> 749959 keys | 2342 slots | 0 slaves.
[OK] 6353266 keys in 7 masters.
387.77 keys per slot on average.
 
total slots: 16384
*** No rebalancing needed! All nodes are within the 2.00% threshold.


{ distribution: [ 391, 391, 390, 390, 390, 390 ] }
[33m### RESHARDING FROM 172.31.5.31 TO 172.31.5.90 ###
[0m
{ reshardFrom: '172.31.5.31', reshardTo: '172.31.5.90', slots: 391 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 1289253 keys | 2731 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 890299 keys | 2340 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 1214072 keys | 2340 slots | 0 slaves.
172.31.5.19:6379 (e04d781f...) -> 1063534 keys | 2342 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 971322 keys | 2340 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 357056 keys | 2340 slots | 0 slaves.
172.31.5.31:6379 (da230fc3...) -> 567730 keys | 1951 slots | 0 slaves.
[OK] 6353266 keys in 7 masters.
387.77 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.31 TO 172.31.5.123 ###
[0m
{ reshardFrom: '172.31.5.31', reshardTo: '172.31.5.123', slots: 391 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 1289253 keys | 2731 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 890299 keys | 2340 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 1329055 keys | 2731 slots | 0 slaves.
172.31.5.19:6379 (e04d781f...) -> 1063534 keys | 2342 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 971322 keys | 2340 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 357056 keys | 2340 slots | 0 slaves.
172.31.5.31:6379 (da230fc3...) -> 452747 keys | 1560 slots | 0 slaves.
[OK] 6353266 keys in 7 masters.
387.77 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.31 TO 172.31.5.101 ###
[0m
{ reshardFrom: '172.31.5.31', reshardTo: '172.31.5.101', slots: 390 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 1289253 keys | 2731 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 890299 keys | 2340 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 1329055 keys | 2731 slots | 0 slaves.
172.31.5.19:6379 (e04d781f...) -> 1063534 keys | 2342 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 971322 keys | 2340 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 460035 keys | 2730 slots | 0 slaves.
172.31.5.31:6379 (da230fc3...) -> 349768 keys | 1170 slots | 0 slaves.
[OK] 6353266 keys in 7 masters.
387.77 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.31 TO 172.31.5.162 ###
[0m
{ reshardFrom: '172.31.5.31', reshardTo: '172.31.5.162', slots: 390 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 1289253 keys | 2731 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 890299 keys | 2340 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 1329055 keys | 2731 slots | 0 slaves.
172.31.5.19:6379 (e04d781f...) -> 1063534 keys | 2342 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 1030915 keys | 2730 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 460035 keys | 2730 slots | 0 slaves.
172.31.5.31:6379 (da230fc3...) -> 290175 keys | 780 slots | 0 slaves.
[OK] 6353266 keys in 7 masters.
387.77 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.31 TO 172.31.5.254 ###
[0m
{ reshardFrom: '172.31.5.31', reshardTo: '172.31.5.254', slots: 390 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 1289253 keys | 2731 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 978343 keys | 2730 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 1329055 keys | 2731 slots | 0 slaves.
172.31.5.19:6379 (e04d781f...) -> 1063534 keys | 2342 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 1030915 keys | 2730 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 460035 keys | 2730 slots | 0 slaves.
172.31.5.31:6379 (da230fc3...) -> 202131 keys | 390 slots | 0 slaves.
[OK] 6353266 keys in 7 masters.
387.77 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.31 TO 172.31.5.19 ###
[0m
{ reshardFrom: '172.31.5.31', reshardTo: '172.31.5.19', slots: 390 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 1289253 keys | 2731 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 978343 keys | 2730 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 1329055 keys | 2731 slots | 0 slaves.
172.31.5.19:6379 (e04d781f...) -> 1265665 keys | 2732 slots | 1 slaves.
172.31.5.162:6379 (74d3fe21...) -> 1030915 keys | 2730 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 460035 keys | 2730 slots | 0 slaves.
[OK] 6353266 keys in 6 masters.
387.77 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### REMOVING 172.31.5.31:6379 FROM CLUSTER ###
[0m
> redis-cli --cluster del-node 172.31.5.31:6379 da230fc3b5e5589500aa4278419cdba3a008ea1d
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 1289253 keys | 2731 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 978343 keys | 2730 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 1329055 keys | 2731 slots | 0 slaves.
172.31.5.19:6379 (e04d781f...) -> 1265665 keys | 2732 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 1030915 keys | 2730 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 460035 keys | 2730 slots | 0 slaves.
[OK] 6353266 keys in 6 masters.
387.77 keys per slot on average.
 
total slots: 16384
Removing node da230fc3b5e5589500aa4278419cdba3a008ea1d from cluster 172.31.5.31:6379
Sending CLUSTER FORGET messages to the cluster...
Sending CLUSTER RESET SOFT to the deleted node.
[33m### REBALANCING CLUSTER ON 172.31.5.90:6379 ###
[0m
> redis-cli --cluster rebalance 172.31.5.90:6379 --cluster-use-empty-masters | grep -i Rebalancing
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 1289253 keys | 2731 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 978343 keys | 2730 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 1329055 keys | 2731 slots | 0 slaves.
172.31.5.19:6379 (e04d781f...) -> 1265665 keys | 2732 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 1030915 keys | 2730 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 460035 keys | 2730 slots | 0 slaves.
[OK] 6353266 keys in 6 masters.
387.77 keys per slot on average.
 
total slots: 16384
*** No rebalancing needed! All nodes are within the 2.00% threshold.


waiting... 65 64 63 62 61 60 59 58 57 56 55 54 53 52 51 50 49 48 47 46 45 44 43 42 41 40 39 38 37 36 35 34 33 32 31 30 29 28 27 26 25 24 23 22 21 20 19 18 17 16 15 14 13 12 11 10 9 8 7 6 5 4 3 2 1 



[34m******* resize , 6 completed ******* [0m 

------------------------------------------------------------------

[34m******* write , 500000 *******[0m

[33m### WRITING 500000 KEYS ###
[0m
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 1372580 keys | 2731 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 1061718 keys | 2730 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 1412474 keys | 2731 slots | 0 slaves.
172.31.5.19:6379 (e04d781f...) -> 1349055 keys | 2732 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 1114235 keys | 2730 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 543204 keys | 2730 slots | 0 slaves.
[OK] 6853266 keys in 6 masters.
418.29 keys per slot on average.
 
total slots: 16384
0.5M keys written successfully

[34m******* write , 500000 completed ******* [0m 

------------------------------------------------------------------

[34m******* resize , 3 *******[0m

{ clusterSize: 6 }
[33m### REBALANCING CLUSTER ON 172.31.5.19:6379 ###
[0m
> redis-cli --cluster rebalance 172.31.5.19:6379 --cluster-use-empty-masters | grep -i Rebalancing
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 1372580 keys | 2731 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 1061718 keys | 2730 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 1412474 keys | 2731 slots | 0 slaves.
172.31.5.19:6379 (e04d781f...) -> 1349055 keys | 2732 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 1114235 keys | 2730 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 543204 keys | 2730 slots | 0 slaves.
[OK] 6853266 keys in 6 masters.
418.29 keys per slot on average.
 
total slots: 16384
*** No rebalancing needed! All nodes are within the 2.00% threshold.


{ distribution: [ 911, 911, 910 ] }
[33m### RESHARDING FROM 172.31.5.19 TO 172.31.5.90 ###
[0m
{ reshardFrom: '172.31.5.19', reshardTo: '172.31.5.90', slots: 911 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 1824323 keys | 3642 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 1061718 keys | 2730 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 1412474 keys | 2731 slots | 0 slaves.
172.31.5.19:6379 (e04d781f...) -> 897312 keys | 1821 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 1114235 keys | 2730 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 543204 keys | 2730 slots | 0 slaves.
[OK] 6853266 keys in 6 masters.
418.29 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.19 TO 172.31.5.123 ###
[0m
{ reshardFrom: '172.31.5.19', reshardTo: '172.31.5.123', slots: 911 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 1824323 keys | 3642 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 1061718 keys | 2730 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 1850241 keys | 3642 slots | 0 slaves.
172.31.5.19:6379 (e04d781f...) -> 459545 keys | 910 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 1114235 keys | 2730 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 543204 keys | 2730 slots | 0 slaves.
[OK] 6853266 keys in 6 masters.
418.29 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.19 TO 172.31.5.101 ###
[0m
{ reshardFrom: '172.31.5.19', reshardTo: '172.31.5.101', slots: 910 }
assertion error.
 {
  keys1: 6853266,
  keys2: 6252412,
  keys: 0,
  slots1: 16384,
  slots2: 16384,
  nodes1: 6,
  nodes2: 5,
  nodes: -1
}
precheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 1824323 keys | 3642 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 1061718 keys | 2730 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 1850241 keys | 3642 slots | 0 slaves.
172.31.5.19:6379 (e04d781f...) -> 459545 keys | 910 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 1114235 keys | 2730 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 543204 keys | 2730 slots | 0 slaves.
[OK] 6853266 keys in 6 masters.
418.29 keys per slot on average.

postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 1824323 keys | 3642 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 1061718 keys | 2730 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 1850241 keys | 3642 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 1114235 keys | 2730 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 401895 keys | 3640 slots | 1 slaves.
[OK] 6252412 keys in 5 masters.
381.62 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### REMOVING 172.31.5.19:6379 FROM CLUSTER ###
[0m
> redis-cli --cluster del-node 172.31.5.19:6379 e04d781f16cfbd7cc4cfebdcdf4d70181cd789a0
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 1824323 keys | 3642 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 1061718 keys | 2730 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 1850241 keys | 3642 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 1114235 keys | 2730 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 401895 keys | 3640 slots | 0 slaves.
[OK] 6252412 keys in 5 masters.
381.62 keys per slot on average.
 
total slots: 16384
Removing node e04d781f16cfbd7cc4cfebdcdf4d70181cd789a0 from cluster 172.31.5.19:6379
Sending CLUSTER FORGET messages to the cluster...
Sending CLUSTER RESET SOFT to the deleted node.
{ distribution: [ 910, 910, 910 ] }
[33m### RESHARDING FROM 172.31.5.254 TO 172.31.5.123 ###
[0m
{ reshardFrom: '172.31.5.254', reshardTo: '172.31.5.123', slots: 910 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 1824323 keys | 3642 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 790579 keys | 1820 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 2121380 keys | 4552 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 1114235 keys | 2730 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 401895 keys | 3640 slots | 0 slaves.
[OK] 6252412 keys in 5 masters.
381.62 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.254 TO 172.31.5.101 ###
[0m
{ reshardFrom: '172.31.5.254', reshardTo: '172.31.5.101', slots: 910 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 1824323 keys | 3642 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 392583 keys | 910 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 2121380 keys | 4552 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 1114235 keys | 2730 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 799891 keys | 4550 slots | 0 slaves.
[OK] 6252412 keys in 5 masters.
381.62 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.254 TO 172.31.5.90 ###
[0m
{ reshardFrom: '172.31.5.254', reshardTo: '172.31.5.90', slots: 910 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 2216906 keys | 4552 slots | 1 slaves.
172.31.5.123:6379 (24ea1433...) -> 2121380 keys | 4552 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 1114235 keys | 2730 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 799891 keys | 4550 slots | 0 slaves.
[OK] 6252412 keys in 4 masters.
381.62 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### REMOVING 172.31.5.254:6379 FROM CLUSTER ###
[0m
> redis-cli --cluster del-node 172.31.5.254:6379 6c6bab513b449851a04f6d1f658e5738dce6a12f
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 2216906 keys | 4552 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 2121380 keys | 4552 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 1114235 keys | 2730 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 799891 keys | 4550 slots | 0 slaves.
[OK] 6252412 keys in 4 masters.
381.62 keys per slot on average.
 
total slots: 16384
Removing node 6c6bab513b449851a04f6d1f658e5738dce6a12f from cluster 172.31.5.254:6379
Sending CLUSTER FORGET messages to the cluster...
Sending CLUSTER RESET SOFT to the deleted node.
{ distribution: [ 910, 910, 910 ] }
[33m### RESHARDING FROM 172.31.5.162 TO 172.31.5.101 ###
[0m
{ reshardFrom: '172.31.5.162', reshardTo: '172.31.5.101', slots: 910 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 2216906 keys | 4552 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 2121380 keys | 4552 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 806885 keys | 1820 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 1107241 keys | 5460 slots | 0 slaves.
[OK] 6252412 keys in 4 masters.
381.62 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.162 TO 172.31.5.90 ###
[0m
{ reshardFrom: '172.31.5.162', reshardTo: '172.31.5.90', slots: 910 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 2663395 keys | 5462 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 2121380 keys | 4552 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 360396 keys | 910 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 1107241 keys | 5460 slots | 0 slaves.
[OK] 6252412 keys in 4 masters.
381.62 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.162 TO 172.31.5.123 ###
[0m
{ reshardFrom: '172.31.5.162', reshardTo: '172.31.5.123', slots: 910 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 2663395 keys | 5462 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 2481776 keys | 5462 slots | 1 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 1107241 keys | 5460 slots | 0 slaves.
[OK] 6252412 keys in 3 masters.
381.62 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### REMOVING 172.31.5.162:6379 FROM CLUSTER ###
[0m
> redis-cli --cluster del-node 172.31.5.162:6379 74d3fe212c5b4038d230cbfd1fe15f7cdc06ae2a
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 2663395 keys | 5462 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 2481776 keys | 5462 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 1107241 keys | 5460 slots | 0 slaves.
[OK] 6252412 keys in 3 masters.
381.62 keys per slot on average.
 
total slots: 16384
Removing node 74d3fe212c5b4038d230cbfd1fe15f7cdc06ae2a from cluster 172.31.5.162:6379
Sending CLUSTER FORGET messages to the cluster...
Sending CLUSTER RESET SOFT to the deleted node.
[33m### REBALANCING CLUSTER ON 172.31.5.90:6379 ###
[0m
> redis-cli --cluster rebalance 172.31.5.90:6379 --cluster-use-empty-masters | grep -i Rebalancing
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 2663395 keys | 5462 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 2481776 keys | 5462 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 1107241 keys | 5460 slots | 0 slaves.
[OK] 6252412 keys in 3 masters.
381.62 keys per slot on average.
 
total slots: 16384
*** No rebalancing needed! All nodes are within the 2.00% threshold.


waiting... 65 64 63 62 61 60 59 58 57 56 55 54 53 52 51 50 49 48 47 46 45 44 43 42 41 40 39 38 37 36 35 34 33 32 31 30 29 28 27 26 25 24 23 22 21 20 19 18 17 16 15 14 13 12 11 10 9 8 7 6 5 4 3 2 1 



[34m******* resize , 3 completed ******* [0m 

------------------------------------------------------------------

[34m******* write , 500000 *******[0m

[33m### WRITING 500000 KEYS ###
[0m
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 2830091 keys | 5462 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 2648499 keys | 5462 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 1273822 keys | 5460 slots | 0 slaves.
[OK] 6752412 keys in 3 masters.
412.13 keys per slot on average.
 
total slots: 16384
0.5M keys written successfully

[34m******* write , 500000 completed ******* [0m 

------------------------------------------------------------------

[34m******* resize , 6 *******[0m

{ clusterSize: 3 }
[33m### ADDING 172.31.5.162:6379 NODE TO CLUSTER ###
[0m
> redis-cli --cluster add-node 172.31.5.162:6379 172.31.5.90:6379 | awk '{ gsub(/[[0-9;]*m/, ""); print }'
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 2830091 keys | 5462 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 2648499 keys | 5462 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 1273822 keys | 5460 slots | 0 slaves.
[OK] 6752412 keys in 4 masters.
412.13 keys per slot on average.
 
total slots: 16384
node added successfully
waiting... 2 1 


[33m### ADDING 172.31.5.254:6379 NODE TO CLUSTER ###
[0m
> redis-cli --cluster add-node 172.31.5.254:6379 172.31.5.90:6379 | awk '{ gsub(/[[0-9;]*m/, ""); print }'
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 2830091 keys | 5462 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 2648499 keys | 5462 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 1273822 keys | 5460 slots | 0 slaves.
[OK] 6752412 keys in 5 masters.
412.13 keys per slot on average.
 
total slots: 16384
node added successfully
waiting... 2 1 


[33m### ADDING 172.31.5.19:6379 NODE TO CLUSTER ###
[0m
> redis-cli --cluster add-node 172.31.5.19:6379 172.31.5.90:6379 | awk '{ gsub(/[[0-9;]*m/, ""); print }'
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 2830091 keys | 5462 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 2648499 keys | 5462 slots | 0 slaves.
172.31.5.19:6379 (e04d781f...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 1273822 keys | 5460 slots | 0 slaves.
[OK] 6752412 keys in 6 masters.
412.13 keys per slot on average.
 
total slots: 16384
node added successfully
waiting... 2 1 


waiting... 10 9 8 7 6 5 4 3 2 1 


[33m### REBALANCING CLUSTER ON 172.31.5.162:6379 ###
[0m
> redis-cli --cluster rebalance 172.31.5.162:6379 --cluster-use-empty-masters | grep -i Rebalancing
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 1368748 keys | 2730 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 1064783 keys | 2731 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 1583144 keys | 2730 slots | 0 slaves.
172.31.5.19:6379 (e04d781f...) -> 977165 keys | 2731 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 1461343 keys | 2732 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 297229 keys | 2730 slots | 0 slaves.
[OK] 6752412 keys in 6 masters.
412.13 keys per slot on average.
 
total slots: 16384
>>> Rebalancing across 6 nodes. Total weight = 6.00



[34m******* resize , 6 completed ******* [0m 

------------------------------------------------------------------

[34m******* write , 500000 *******[0m

[33m### WRITING 500000 KEYS ###
[0m
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 1452016 keys | 2730 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 1148120 keys | 2731 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 1666590 keys | 2730 slots | 0 slaves.
172.31.5.19:6379 (e04d781f...) -> 1060521 keys | 2731 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 1544725 keys | 2732 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 380440 keys | 2730 slots | 0 slaves.
[OK] 7252412 keys in 6 masters.
442.65 keys per slot on average.
 
total slots: 16384
0.5M keys written successfully

[34m******* write , 500000 completed ******* [0m 

------------------------------------------------------------------

[34m******* resize , 4 *******[0m

{ clusterSize: 6 }
[33m### REBALANCING CLUSTER ON 172.31.5.19:6379 ###
[0m
> redis-cli --cluster rebalance 172.31.5.19:6379 --cluster-use-empty-masters | grep -i Rebalancing
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 1452016 keys | 2730 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 1148120 keys | 2731 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 1666590 keys | 2730 slots | 0 slaves.
172.31.5.19:6379 (e04d781f...) -> 1060521 keys | 2731 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 1544725 keys | 2732 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 380440 keys | 2730 slots | 0 slaves.
[OK] 7252412 keys in 6 masters.
442.65 keys per slot on average.
 
total slots: 16384
*** No rebalancing needed! All nodes are within the 2.00% threshold.


{ distribution: [ 683, 683, 683, 682 ] }
[33m### RESHARDING FROM 172.31.5.19 TO 172.31.5.90 ###
[0m
{ reshardFrom: '172.31.5.19', reshardTo: '172.31.5.90', slots: 683 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 1681672 keys | 3413 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 1148120 keys | 2731 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 1666590 keys | 2730 slots | 0 slaves.
172.31.5.19:6379 (e04d781f...) -> 830865 keys | 2048 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 1544725 keys | 2732 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 380440 keys | 2730 slots | 0 slaves.
[OK] 7252412 keys in 6 masters.
442.65 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.19 TO 172.31.5.123 ###
[0m
{ reshardFrom: '172.31.5.19', reshardTo: '172.31.5.123', slots: 683 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 1681672 keys | 3413 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 1148120 keys | 2731 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 1791813 keys | 3413 slots | 0 slaves.
172.31.5.19:6379 (e04d781f...) -> 705642 keys | 1365 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 1544725 keys | 2732 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 380440 keys | 2730 slots | 0 slaves.
[OK] 7252412 keys in 6 masters.
442.65 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.19 TO 172.31.5.101 ###
[0m
{ reshardFrom: '172.31.5.19', reshardTo: '172.31.5.101', slots: 683 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 1681672 keys | 3413 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 1148120 keys | 2731 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 1791813 keys | 3413 slots | 0 slaves.
172.31.5.19:6379 (e04d781f...) -> 416281 keys | 682 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 1544725 keys | 2732 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 669801 keys | 3413 slots | 0 slaves.
[OK] 7252412 keys in 6 masters.
442.65 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.19 TO 172.31.5.162 ###
[0m
{ reshardFrom: '172.31.5.19', reshardTo: '172.31.5.162', slots: 682 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 1681672 keys | 3413 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 1148120 keys | 2731 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 1791813 keys | 3413 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 1961006 keys | 3414 slots | 1 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 669801 keys | 3413 slots | 0 slaves.
[OK] 7252412 keys in 5 masters.
442.65 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### REMOVING 172.31.5.19:6379 FROM CLUSTER ###
[0m
> redis-cli --cluster del-node 172.31.5.19:6379 e04d781f16cfbd7cc4cfebdcdf4d70181cd789a0
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 1681672 keys | 3413 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 1148120 keys | 2731 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 1791813 keys | 3413 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 1961006 keys | 3414 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 669801 keys | 3413 slots | 0 slaves.
[OK] 7252412 keys in 5 masters.
442.65 keys per slot on average.
 
total slots: 16384
Removing node e04d781f16cfbd7cc4cfebdcdf4d70181cd789a0 from cluster 172.31.5.19:6379
Sending CLUSTER FORGET messages to the cluster...
Sending CLUSTER RESET SOFT to the deleted node.
{ distribution: [ 683, 683, 683, 682 ] }
[33m### RESHARDING FROM 172.31.5.254 TO 172.31.5.123 ###
[0m
{ reshardFrom: '172.31.5.254', reshardTo: '172.31.5.123', slots: 683 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 1681672 keys | 3413 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 731321 keys | 2048 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 2208612 keys | 4096 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 1961006 keys | 3414 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 669801 keys | 3413 slots | 0 slaves.
[OK] 7252412 keys in 5 masters.
442.65 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.254 TO 172.31.5.101 ###
[0m
{ reshardFrom: '172.31.5.254', reshardTo: '172.31.5.101', slots: 683 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 1681672 keys | 3413 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 474331 keys | 1365 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 2208612 keys | 4096 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 1961006 keys | 3414 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 926791 keys | 4096 slots | 0 slaves.
[OK] 7252412 keys in 5 masters.
442.65 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.254 TO 172.31.5.162 ###
[0m
{ reshardFrom: '172.31.5.254', reshardTo: '172.31.5.162', slots: 683 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 1681672 keys | 3413 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 217036 keys | 682 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 2208612 keys | 4096 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 2218301 keys | 4097 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 926791 keys | 4096 slots | 0 slaves.
[OK] 7252412 keys in 5 masters.
442.65 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.254 TO 172.31.5.90 ###
[0m
{ reshardFrom: '172.31.5.254', reshardTo: '172.31.5.90', slots: 682 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 1898708 keys | 4095 slots | 1 slaves.
172.31.5.123:6379 (24ea1433...) -> 2208612 keys | 4096 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 2218301 keys | 4097 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 926791 keys | 4096 slots | 0 slaves.
[OK] 7252412 keys in 4 masters.
442.65 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### REMOVING 172.31.5.254:6379 FROM CLUSTER ###
[0m
> redis-cli --cluster del-node 172.31.5.254:6379 6c6bab513b449851a04f6d1f658e5738dce6a12f
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 1898708 keys | 4095 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 2208612 keys | 4096 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 2218301 keys | 4097 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 926791 keys | 4096 slots | 0 slaves.
[OK] 7252412 keys in 4 masters.
442.65 keys per slot on average.
 
total slots: 16384
Removing node 6c6bab513b449851a04f6d1f658e5738dce6a12f from cluster 172.31.5.254:6379
Sending CLUSTER FORGET messages to the cluster...
Sending CLUSTER RESET SOFT to the deleted node.
[33m### REBALANCING CLUSTER ON 172.31.5.90:6379 ###
[0m
> redis-cli --cluster rebalance 172.31.5.90:6379 --cluster-use-empty-masters | grep -i Rebalancing
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 1898708 keys | 4095 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 2208612 keys | 4096 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 2218301 keys | 4097 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 926791 keys | 4096 slots | 0 slaves.
[OK] 7252412 keys in 4 masters.
442.65 keys per slot on average.
 
total slots: 16384
*** No rebalancing needed! All nodes are within the 2.00% threshold.


waiting... 65 64 63 62 61 60 59 58 57 56 55 54 53 52 51 50 49 48 47 46 45 44 43 42 41 40 39 38 37 36 35 34 33 32 31 30 29 28 27 26 25 24 23 22 21 20 19 18 17 16 15 14 13 12 11 10 9 8 7 6 5 4 3 2 1 



[34m******* resize , 4 completed ******* [0m 

------------------------------------------------------------------

[34m******* write , 500000 *******[0m

[33m### WRITING 500000 KEYS ###
[0m
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 2023672 keys | 4095 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 2333517 keys | 4096 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 2343340 keys | 4097 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 1051883 keys | 4096 slots | 0 slaves.
[OK] 7752412 keys in 4 masters.
473.17 keys per slot on average.
 
total slots: 16384
0.5M keys written successfully

[34m******* write , 500000 completed ******* [0m 

------------------------------------------------------------------

[34m******* resize , 6 *******[0m

{ clusterSize: 4 }
[33m### ADDING 172.31.5.254:6379 NODE TO CLUSTER ###
[0m
> redis-cli --cluster add-node 172.31.5.254:6379 172.31.5.90:6379 | awk '{ gsub(/[[0-9;]*m/, ""); print }'
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 2023672 keys | 4095 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 2333517 keys | 4096 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 2343340 keys | 4097 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 1051883 keys | 4096 slots | 0 slaves.
[OK] 7752412 keys in 5 masters.
473.17 keys per slot on average.
 
total slots: 16384
node added successfully
waiting... 2 1 


[33m### ADDING 172.31.5.19:6379 NODE TO CLUSTER ###
[0m
> redis-cli --cluster add-node 172.31.5.19:6379 172.31.5.90:6379 | awk '{ gsub(/[[0-9;]*m/, ""); print }'
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 2023672 keys | 4095 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 2333517 keys | 4096 slots | 0 slaves.
172.31.5.19:6379 (e04d781f...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 2343340 keys | 4097 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 1051883 keys | 4096 slots | 0 slaves.
[OK] 7752412 keys in 6 masters.
473.17 keys per slot on average.
 
total slots: 16384
node added successfully
waiting... 2 1 


waiting... 10 9 8 7 6 5 4 3 2 1 


[33m### REBALANCING CLUSTER ON 172.31.5.254:6379 ###
[0m
> redis-cli --cluster rebalance 172.31.5.254:6379 --cluster-use-empty-masters | grep -i Rebalancing
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 1517880 keys | 2730 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 1374131 keys | 2732 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 1749822 keys | 2730 slots | 0 slaves.
172.31.5.19:6379 (e04d781f...) -> 1090141 keys | 2732 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 1556605 keys | 2730 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 463833 keys | 2730 slots | 0 slaves.
[OK] 7752412 keys in 6 masters.
473.17 keys per slot on average.
 
total slots: 16384
>>> Rebalancing across 6 nodes. Total weight = 6.00



[34m******* resize , 6 completed ******* [0m 

------------------------------------------------------------------

[34m******* write , 500000 *******[0m

[33m### WRITING 500000 KEYS ###
[0m
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 1601207 keys | 2730 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 1457522 keys | 2732 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 1833058 keys | 2730 slots | 0 slaves.
172.31.5.19:6379 (e04d781f...) -> 1173431 keys | 2732 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 1639985 keys | 2730 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 547209 keys | 2730 slots | 0 slaves.
[OK] 8252412 keys in 6 masters.
503.69 keys per slot on average.
 
total slots: 16384
0.5M keys written successfully

[34m******* write , 500000 completed ******* [0m 

------------------------------------------------------------------

[34m******* resize , 5 *******[0m

{ clusterSize: 6 }
[33m### REBALANCING CLUSTER ON 172.31.5.19:6379 ###
[0m
> redis-cli --cluster rebalance 172.31.5.19:6379 --cluster-use-empty-masters | grep -i Rebalancing
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 1601207 keys | 2730 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 1457522 keys | 2732 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 1833058 keys | 2730 slots | 0 slaves.
172.31.5.19:6379 (e04d781f...) -> 1173431 keys | 2732 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 1639985 keys | 2730 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 547209 keys | 2730 slots | 0 slaves.
[OK] 8252412 keys in 6 masters.
503.69 keys per slot on average.
 
total slots: 16384
*** No rebalancing needed! All nodes are within the 2.00% threshold.


{ distribution: [ 547, 547, 546, 546, 546 ] }
[33m### RESHARDING FROM 172.31.5.19 TO 172.31.5.90 ###
[0m
{ reshardFrom: '172.31.5.19', reshardTo: '172.31.5.90', slots: 547 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 1968518 keys | 3277 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 1457522 keys | 2732 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 1833058 keys | 2730 slots | 0 slaves.
172.31.5.19:6379 (e04d781f...) -> 806120 keys | 2185 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 1639985 keys | 2730 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 547209 keys | 2730 slots | 0 slaves.
[OK] 8252412 keys in 6 masters.
503.69 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.19 TO 172.31.5.123 ###
[0m
{ reshardFrom: '172.31.5.19', reshardTo: '172.31.5.123', slots: 547 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 1968518 keys | 3277 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 1457522 keys | 2732 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 2124019 keys | 3277 slots | 0 slaves.
172.31.5.19:6379 (e04d781f...) -> 515159 keys | 1638 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 1639985 keys | 2730 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 547209 keys | 2730 slots | 0 slaves.
[OK] 8252412 keys in 6 masters.
503.69 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.19 TO 172.31.5.101 ###
[0m
{ reshardFrom: '172.31.5.19', reshardTo: '172.31.5.101', slots: 546 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 1968518 keys | 3277 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 1457522 keys | 2732 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 2124019 keys | 3277 slots | 0 slaves.
172.31.5.19:6379 (e04d781f...) -> 401696 keys | 1092 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 1639985 keys | 2730 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 660672 keys | 3276 slots | 0 slaves.
[OK] 8252412 keys in 6 masters.
503.69 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.19 TO 172.31.5.162 ###
[0m
{ reshardFrom: '172.31.5.19', reshardTo: '172.31.5.162', slots: 546 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 1968518 keys | 3277 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 1457522 keys | 2732 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 2124019 keys | 3277 slots | 0 slaves.
172.31.5.19:6379 (e04d781f...) -> 235003 keys | 546 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 1806678 keys | 3276 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 660672 keys | 3276 slots | 0 slaves.
[OK] 8252412 keys in 6 masters.
503.69 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.19 TO 172.31.5.254 ###
[0m
{ reshardFrom: '172.31.5.19', reshardTo: '172.31.5.254', slots: 546 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 1968518 keys | 3277 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 1692525 keys | 3278 slots | 1 slaves.
172.31.5.123:6379 (24ea1433...) -> 2124019 keys | 3277 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 1806678 keys | 3276 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 660672 keys | 3276 slots | 0 slaves.
[OK] 8252412 keys in 5 masters.
503.69 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### REMOVING 172.31.5.19:6379 FROM CLUSTER ###
[0m
> redis-cli --cluster del-node 172.31.5.19:6379 e04d781f16cfbd7cc4cfebdcdf4d70181cd789a0
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 1968518 keys | 3277 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 1692525 keys | 3278 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 2124019 keys | 3277 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 1806678 keys | 3276 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 660672 keys | 3276 slots | 0 slaves.
[OK] 8252412 keys in 5 masters.
503.69 keys per slot on average.
 
total slots: 16384
Removing node e04d781f16cfbd7cc4cfebdcdf4d70181cd789a0 from cluster 172.31.5.19:6379
Sending CLUSTER FORGET messages to the cluster...
Sending CLUSTER RESET SOFT to the deleted node.
[33m### REBALANCING CLUSTER ON 172.31.5.90:6379 ###
[0m
> redis-cli --cluster rebalance 172.31.5.90:6379 --cluster-use-empty-masters | grep -i Rebalancing
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 1968518 keys | 3277 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 1692525 keys | 3278 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 2124019 keys | 3277 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 1806678 keys | 3276 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 660672 keys | 3276 slots | 0 slaves.
[OK] 8252412 keys in 5 masters.
503.69 keys per slot on average.
 
total slots: 16384
*** No rebalancing needed! All nodes are within the 2.00% threshold.


waiting... 65 64 63 62 61 60 59 58 57 56 55 54 53 52 51 50 49 48 47 46 45 44 43 42 41 40 39 38 37 36 35 34 33 32 31 30 29 28 27 26 25 24 23 22 21 20 19 18 17 16 15 14 13 12 11 10 9 8 7 6 5 4 3 2 1 



[34m******* resize , 5 completed ******* [0m 

------------------------------------------------------------------

[34m******* write , 500000 *******[0m

[33m### WRITING 500000 KEYS ###
[0m
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 2068423 keys | 3277 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 1792614 keys | 3278 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 2223961 keys | 3277 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 1906656 keys | 3276 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 760758 keys | 3276 slots | 0 slaves.
[OK] 8752412 keys in 5 masters.
534.20 keys per slot on average.
 
total slots: 16384
0.5M keys written successfully

[34m******* write , 500000 completed ******* [0m 

------------------------------------------------------------------

[34m******* resize , 3 *******[0m

{ clusterSize: 5 }
[33m### REBALANCING CLUSTER ON 172.31.5.254:6379 ###
[0m
> redis-cli --cluster rebalance 172.31.5.254:6379 --cluster-use-empty-masters | grep -i Rebalancing
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 2068423 keys | 3277 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 1792614 keys | 3278 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 2223961 keys | 3277 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 1906656 keys | 3276 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 760758 keys | 3276 slots | 0 slaves.
[OK] 8752412 keys in 5 masters.
534.20 keys per slot on average.
 
total slots: 16384
*** No rebalancing needed! All nodes are within the 2.00% threshold.


{ distribution: [ 1093, 1093, 1092 ] }
[33m### RESHARDING FROM 172.31.5.254 TO 172.31.5.90 ###
[0m
{ reshardFrom: '172.31.5.254', reshardTo: '172.31.5.90', slots: 1093 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 2787033 keys | 4370 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 1074004 keys | 2185 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 2223961 keys | 3277 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 1906656 keys | 3276 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 760758 keys | 3276 slots | 0 slaves.
[OK] 8752412 keys in 5 masters.
534.20 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.254 TO 172.31.5.123 ###
[0m
{ reshardFrom: '172.31.5.254', reshardTo: '172.31.5.123', slots: 1093 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 2787033 keys | 4370 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 557088 keys | 1092 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 2740877 keys | 4370 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 1906656 keys | 3276 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 760758 keys | 3276 slots | 0 slaves.
[OK] 8752412 keys in 5 masters.
534.20 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.254 TO 172.31.5.101 ###
[0m
{ reshardFrom: '172.31.5.254', reshardTo: '172.31.5.101', slots: 1092 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 2787033 keys | 4370 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 2740877 keys | 4370 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 1906656 keys | 3276 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 1317846 keys | 4368 slots | 1 slaves.
[OK] 8752412 keys in 4 masters.
534.20 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### REMOVING 172.31.5.254:6379 FROM CLUSTER ###
[0m
> redis-cli --cluster del-node 172.31.5.254:6379 6c6bab513b449851a04f6d1f658e5738dce6a12f
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 2787033 keys | 4370 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 2740877 keys | 4370 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 1906656 keys | 3276 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 1317846 keys | 4368 slots | 0 slaves.
[OK] 8752412 keys in 4 masters.
534.20 keys per slot on average.
 
total slots: 16384
Removing node 6c6bab513b449851a04f6d1f658e5738dce6a12f from cluster 172.31.5.254:6379
Sending CLUSTER FORGET messages to the cluster...
Sending CLUSTER RESET SOFT to the deleted node.
{ distribution: [ 1092, 1092, 1092 ] }
[33m### RESHARDING FROM 172.31.5.162 TO 172.31.5.123 ###
[0m
{ reshardFrom: '172.31.5.162', reshardTo: '172.31.5.123', slots: 1092 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 2787033 keys | 4370 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 3194209 keys | 5462 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 1453324 keys | 2184 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 1317846 keys | 4368 slots | 0 slaves.
[OK] 8752412 keys in 4 masters.
534.20 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.162 TO 172.31.5.101 ###
[0m
{ reshardFrom: '172.31.5.162', reshardTo: '172.31.5.101', slots: 1092 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 2787033 keys | 4370 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 3194209 keys | 5462 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 713210 keys | 1092 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 2057960 keys | 5460 slots | 0 slaves.
[OK] 8752412 keys in 4 masters.
534.20 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.162 TO 172.31.5.90 ###
[0m
{ reshardFrom: '172.31.5.162', reshardTo: '172.31.5.90', slots: 1092 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 3500243 keys | 5462 slots | 1 slaves.
172.31.5.123:6379 (24ea1433...) -> 3194209 keys | 5462 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 2057960 keys | 5460 slots | 0 slaves.
[OK] 8752412 keys in 3 masters.
534.20 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### REMOVING 172.31.5.162:6379 FROM CLUSTER ###
[0m
> redis-cli --cluster del-node 172.31.5.162:6379 74d3fe212c5b4038d230cbfd1fe15f7cdc06ae2a
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 3500243 keys | 5462 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 3194209 keys | 5462 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 2057960 keys | 5460 slots | 0 slaves.
[OK] 8752412 keys in 3 masters.
534.20 keys per slot on average.
 
total slots: 16384
Removing node 74d3fe212c5b4038d230cbfd1fe15f7cdc06ae2a from cluster 172.31.5.162:6379
Sending CLUSTER FORGET messages to the cluster...
Sending CLUSTER RESET SOFT to the deleted node.
[33m### REBALANCING CLUSTER ON 172.31.5.90:6379 ###
[0m
> redis-cli --cluster rebalance 172.31.5.90:6379 --cluster-use-empty-masters | grep -i Rebalancing
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 3500243 keys | 5462 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 3194209 keys | 5462 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 2057960 keys | 5460 slots | 0 slaves.
[OK] 8752412 keys in 3 masters.
534.20 keys per slot on average.
 
total slots: 16384
*** No rebalancing needed! All nodes are within the 2.00% threshold.


waiting... 65 64 63 62 61 60 59 58 57 56 55 54 53 52 51 50 49 48 47 46 45 44 43 42 41 40 39 38 37 36 35 34 33 32 31 30 29 28 27 26 25 24 23 22 21 20 19 18 17 16 15 14 13 12 11 10 9 8 7 6 5 4 3 2 1 



[34m******* resize , 3 completed ******* [0m 

------------------------------------------------------------------

[34m******* write , 500000 *******[0m

[33m### WRITING 500000 KEYS ###
[0m
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 3666963 keys | 5462 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 3360990 keys | 5462 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 2224459 keys | 5460 slots | 0 slaves.
[OK] 9252412 keys in 3 masters.
564.72 keys per slot on average.
 
total slots: 16384
0.5M keys written successfully

[34m******* write , 500000 completed ******* [0m 

------------------------------------------------------------------

[34m******* resize , 5 *******[0m

{ clusterSize: 3 }
[33m### ADDING 172.31.5.162:6379 NODE TO CLUSTER ###
[0m
> redis-cli --cluster add-node 172.31.5.162:6379 172.31.5.90:6379 | awk '{ gsub(/[[0-9;]*m/, ""); print }'
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 3666963 keys | 5462 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 3360990 keys | 5462 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 2224459 keys | 5460 slots | 0 slaves.
[OK] 9252412 keys in 4 masters.
564.72 keys per slot on average.
 
total slots: 16384
node added successfully
waiting... 2 1 


[33m### ADDING 172.31.5.254:6379 NODE TO CLUSTER ###
[0m
> redis-cli --cluster add-node 172.31.5.254:6379 172.31.5.90:6379 | awk '{ gsub(/[[0-9;]*m/, ""); print }'
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 3666963 keys | 5462 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 3360990 keys | 5462 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 2224459 keys | 5460 slots | 0 slaves.
[OK] 9252412 keys in 5 masters.
564.72 keys per slot on average.
 
total slots: 16384
node added successfully
waiting... 2 1 


waiting... 10 9 8 7 6 5 4 3 2 1 


[33m### REBALANCING CLUSTER ON 172.31.5.162:6379 ###
[0m
> redis-cli --cluster rebalance 172.31.5.162:6379 --cluster-use-empty-masters | grep -i Rebalancing
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 2130082 keys | 3276 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 1798545 keys | 3278 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 2199713 keys | 3276 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 2132255 keys | 3278 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 991817 keys | 3276 slots | 0 slaves.
[OK] 9252412 keys in 5 masters.
564.72 keys per slot on average.
 
total slots: 16384
>>> Rebalancing across 5 nodes. Total weight = 5.00



[34m******* resize , 5 completed ******* [0m 

------------------------------------------------------------------

[34m******* write , 500000 *******[0m

[33m### WRITING 500000 KEYS ###
[0m
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 2230053 keys | 3276 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 1898486 keys | 3278 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 2299615 keys | 3276 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 2232371 keys | 3278 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 1091887 keys | 3276 slots | 0 slaves.
[OK] 9752412 keys in 5 masters.
595.24 keys per slot on average.
 
total slots: 16384
0.5M keys written successfully

[34m******* write , 500000 completed ******* [0m 

------------------------------------------------------------------

[34m******* resize , 4 *******[0m

{ clusterSize: 5 }
[33m### REBALANCING CLUSTER ON 172.31.5.254:6379 ###
[0m
> redis-cli --cluster rebalance 172.31.5.254:6379 --cluster-use-empty-masters | grep -i Rebalancing
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 2230053 keys | 3276 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 1898486 keys | 3278 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 2299615 keys | 3276 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 2232371 keys | 3278 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 1091887 keys | 3276 slots | 0 slaves.
[OK] 9752412 keys in 5 masters.
595.24 keys per slot on average.
 
total slots: 16384
*** No rebalancing needed! All nodes are within the 2.00% threshold.


{ distribution: [ 820, 820, 819, 819 ] }
[33m### RESHARDING FROM 172.31.5.254 TO 172.31.5.90 ###
[0m
{ reshardFrom: '172.31.5.254', reshardTo: '172.31.5.90', slots: 820 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 2693477 keys | 4096 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 1435062 keys | 2458 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 2299615 keys | 3276 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 2232371 keys | 3278 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 1091887 keys | 3276 slots | 0 slaves.
[OK] 9752412 keys in 5 masters.
595.24 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.254 TO 172.31.5.123 ###
[0m
{ reshardFrom: '172.31.5.254', reshardTo: '172.31.5.123', slots: 820 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 2693477 keys | 4096 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 1135853 keys | 1638 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 2598824 keys | 4096 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 2232371 keys | 3278 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 1091887 keys | 3276 slots | 0 slaves.
[OK] 9752412 keys in 5 masters.
595.24 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.254 TO 172.31.5.101 ###
[0m
{ reshardFrom: '172.31.5.254', reshardTo: '172.31.5.101', slots: 819 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 2693477 keys | 4096 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 624835 keys | 819 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 2598824 keys | 4096 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 2232371 keys | 3278 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 1602905 keys | 4095 slots | 0 slaves.
[OK] 9752412 keys in 5 masters.
595.24 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.254 TO 172.31.5.162 ###
[0m
{ reshardFrom: '172.31.5.254', reshardTo: '172.31.5.162', slots: 819 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 2693477 keys | 4096 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 2598824 keys | 4096 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 2857206 keys | 4097 slots | 1 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 1602905 keys | 4095 slots | 0 slaves.
[OK] 9752412 keys in 4 masters.
595.24 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### REMOVING 172.31.5.254:6379 FROM CLUSTER ###
[0m
> redis-cli --cluster del-node 172.31.5.254:6379 6c6bab513b449851a04f6d1f658e5738dce6a12f
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 2693477 keys | 4096 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 2598824 keys | 4096 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 2857206 keys | 4097 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 1602905 keys | 4095 slots | 0 slaves.
[OK] 9752412 keys in 4 masters.
595.24 keys per slot on average.
 
total slots: 16384
Removing node 6c6bab513b449851a04f6d1f658e5738dce6a12f from cluster 172.31.5.254:6379
Sending CLUSTER FORGET messages to the cluster...
Sending CLUSTER RESET SOFT to the deleted node.
[33m### REBALANCING CLUSTER ON 172.31.5.90:6379 ###
[0m
> redis-cli --cluster rebalance 172.31.5.90:6379 --cluster-use-empty-masters | grep -i Rebalancing
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 2693477 keys | 4096 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 2598824 keys | 4096 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 2857206 keys | 4097 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 1602905 keys | 4095 slots | 0 slaves.
[OK] 9752412 keys in 4 masters.
595.24 keys per slot on average.
 
total slots: 16384
*** No rebalancing needed! All nodes are within the 2.00% threshold.


waiting... 65 64 63 62 61 60 59 58 57 56 55 54 53 52 51 50 49 48 47 46 45 44 43 42 41 40 39 38 37 36 35 34 33 32 31 30 29 28 27 26 25 24 23 22 21 20 19 18 17 16 15 14 13 12 11 10 9 8 7 6 5 4 3 2 1 



[34m******* resize , 4 completed ******* [0m 

------------------------------------------------------------------

[34m******* write , 500000 *******[0m

[33m### WRITING 500000 KEYS ###
[0m
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 2818447 keys | 4096 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 2723825 keys | 4096 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 2982257 keys | 4097 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 1727883 keys | 4095 slots | 0 slaves.
[OK] 10252412 keys in 4 masters.
625.76 keys per slot on average.
 
total slots: 16384
0.5M keys written successfully

[34m******* write , 500000 completed ******* [0m 

------------------------------------------------------------------

[34m******* resize , 3 *******[0m

{ clusterSize: 4 }
[33m### REBALANCING CLUSTER ON 172.31.5.162:6379 ###
[0m
> redis-cli --cluster rebalance 172.31.5.162:6379 --cluster-use-empty-masters | grep -i Rebalancing
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 2818447 keys | 4096 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 2723825 keys | 4096 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 2982257 keys | 4097 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 1727883 keys | 4095 slots | 0 slaves.
[OK] 10252412 keys in 4 masters.
625.76 keys per slot on average.
 
total slots: 16384
*** No rebalancing needed! All nodes are within the 2.00% threshold.


{ distribution: [ 1366, 1366, 1365 ] }
[33m### RESHARDING FROM 172.31.5.162 TO 172.31.5.90 ###
[0m
{ reshardFrom: '172.31.5.162', reshardTo: '172.31.5.90', slots: 1366 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 3853566 keys | 5462 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 2723825 keys | 4096 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 1947138 keys | 2731 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 1727883 keys | 4095 slots | 0 slaves.
[OK] 10252412 keys in 4 masters.
625.76 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.162 TO 172.31.5.123 ###
[0m
{ reshardFrom: '172.31.5.162', reshardTo: '172.31.5.123', slots: 1366 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 3853566 keys | 5462 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 3603533 keys | 5462 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 1067430 keys | 1365 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 1727883 keys | 4095 slots | 0 slaves.
[OK] 10252412 keys in 4 masters.
625.76 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.162 TO 172.31.5.101 ###
[0m
{ reshardFrom: '172.31.5.162', reshardTo: '172.31.5.101', slots: 1365 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 3853566 keys | 5462 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 3603533 keys | 5462 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 2795313 keys | 5460 slots | 1 slaves.
[OK] 10252412 keys in 3 masters.
625.76 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### REMOVING 172.31.5.162:6379 FROM CLUSTER ###
[0m
> redis-cli --cluster del-node 172.31.5.162:6379 74d3fe212c5b4038d230cbfd1fe15f7cdc06ae2a
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 3853566 keys | 5462 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 3603533 keys | 5462 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 2795313 keys | 5460 slots | 0 slaves.
[OK] 10252412 keys in 3 masters.
625.76 keys per slot on average.
 
total slots: 16384
Removing node 74d3fe212c5b4038d230cbfd1fe15f7cdc06ae2a from cluster 172.31.5.162:6379
Sending CLUSTER FORGET messages to the cluster...
Sending CLUSTER RESET SOFT to the deleted node.
[33m### REBALANCING CLUSTER ON 172.31.5.90:6379 ###
[0m
> redis-cli --cluster rebalance 172.31.5.90:6379 --cluster-use-empty-masters | grep -i Rebalancing
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 3853566 keys | 5462 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 3603533 keys | 5462 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 2795313 keys | 5460 slots | 0 slaves.
[OK] 10252412 keys in 3 masters.
625.76 keys per slot on average.
 
total slots: 16384
*** No rebalancing needed! All nodes are within the 2.00% threshold.


waiting... 65 64 63 62 61 60 59 58 57 56 55 54 53 52 51 50 49 48 47 46 45 44 43 42 41 40 39 38 37 36 35 34 33 32 31 30 29 28 27 26 25 24 23 22 21 20 19 18 17 16 15 14 13 12 11 10 9 8 7 6 5 4 3 2 1 



[34m******* resize , 3 completed ******* [0m 

------------------------------------------------------------------

[34m******* write , 500000 *******[0m

[33m### WRITING 500000 KEYS ###
[0m
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 4020200 keys | 5462 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 3770203 keys | 5462 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 2962009 keys | 5460 slots | 0 slaves.
[OK] 10752412 keys in 3 masters.
656.28 keys per slot on average.
 
total slots: 16384
0.5M keys written successfully

[34m******* write , 500000 completed ******* [0m 

------------------------------------------------------------------

[34m******* resize , 4 *******[0m

{ clusterSize: 3 }
[33m### ADDING 172.31.5.162:6379 NODE TO CLUSTER ###
[0m
> redis-cli --cluster add-node 172.31.5.162:6379 172.31.5.90:6379 | awk '{ gsub(/[[0-9;]*m/, ""); print }'
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 4020200 keys | 5462 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 3770203 keys | 5462 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 2962009 keys | 5460 slots | 0 slaves.
[OK] 10752412 keys in 4 masters.
656.28 keys per slot on average.
 
total slots: 16384
node added successfully
waiting... 2 1 


waiting... 10 9 8 7 6 5 4 3 2 1 


[33m### REBALANCING CLUSTER ON 172.31.5.162:6379 ###
[0m
> redis-cli --cluster rebalance 172.31.5.162:6379 --cluster-use-empty-masters | grep -i Rebalancing
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 2943432 keys | 4096 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 2848784 keys | 4096 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 3008102 keys | 4096 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 1952094 keys | 4096 slots | 0 slaves.
[OK] 10752412 keys in 4 masters.
656.28 keys per slot on average.
 
total slots: 16384
>>> Rebalancing across 4 nodes. Total weight = 4.00



[34m******* resize , 4 completed ******* [0m 

------------------------------------------------------------------

[34m******* write , 500000 *******[0m

[33m### WRITING 500000 KEYS ###
[0m
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 3068505 keys | 4096 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 2973819 keys | 4096 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 3133161 keys | 4096 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 2076927 keys | 4096 slots | 0 slaves.
[OK] 11252412 keys in 4 masters.
686.79 keys per slot on average.
 
total slots: 16384
0.5M keys written successfully

[34m******* write , 500000 completed ******* [0m 

------------------------------------------------------------------

[34m******* resize , 5 *******[0m

{ clusterSize: 4 }
[33m### ADDING 172.31.5.254:6379 NODE TO CLUSTER ###
[0m
> redis-cli --cluster add-node 172.31.5.254:6379 172.31.5.90:6379 | awk '{ gsub(/[[0-9;]*m/, ""); print }'
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 3068505 keys | 4096 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 2973819 keys | 4096 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 3133161 keys | 4096 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 2076927 keys | 4096 slots | 0 slaves.
[OK] 11252412 keys in 5 masters.
686.79 keys per slot on average.
 
total slots: 16384
node added successfully
waiting... 2 1 


waiting... 10 9 8 7 6 5 4 3 2 1 


[33m### REBALANCING CLUSTER ON 172.31.5.254:6379 ###
[0m
> redis-cli --cluster rebalance 172.31.5.254:6379 --cluster-use-empty-masters | grep -i Rebalancing
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 2529992 keys | 3276 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 2249959 keys | 3280 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 2599630 keys | 3276 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 2481198 keys | 3276 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 1391633 keys | 3276 slots | 0 slaves.
[OK] 11252412 keys in 5 masters.
686.79 keys per slot on average.
 
total slots: 16384
>>> Rebalancing across 5 nodes. Total weight = 5.00



[34m******* resize , 5 completed ******* [0m 

------------------------------------------------------------------

[34m******* write , 500000 *******[0m

[33m### WRITING 500000 KEYS ###
[0m
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 2629971 keys | 3276 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 2350039 keys | 3280 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 2699506 keys | 3276 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 2581189 keys | 3276 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 1491707 keys | 3276 slots | 0 slaves.
[OK] 11752412 keys in 5 masters.
717.31 keys per slot on average.
 
total slots: 16384
0.5M keys written successfully

[34m******* write , 500000 completed ******* [0m 

------------------------------------------------------------------

[34m******* resize , 6 *******[0m

{ clusterSize: 5 }
[33m### ADDING 172.31.5.19:6379 NODE TO CLUSTER ###
[0m
> redis-cli --cluster add-node 172.31.5.19:6379 172.31.5.90:6379 | awk '{ gsub(/[[0-9;]*m/, ""); print }'
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 2629971 keys | 3276 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 2350039 keys | 3280 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 2699506 keys | 3276 slots | 0 slaves.
172.31.5.19:6379 (e04d781f...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 2581189 keys | 3276 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 1491707 keys | 3276 slots | 0 slaves.
[OK] 11752412 keys in 6 masters.
717.31 keys per slot on average.
 
total slots: 16384
node added successfully
waiting... 2 1 


waiting... 10 9 8 7 6 5 4 3 2 1 


[33m### REBALANCING CLUSTER ON 172.31.5.19:6379 ###
[0m
> redis-cli --cluster rebalance 172.31.5.19:6379 --cluster-use-empty-masters | grep -i Rebalancing
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 2184745 keys | 2730 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 1896715 keys | 2730 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 2416152 keys | 2730 slots | 0 slaves.
172.31.5.19:6379 (e04d781f...) -> 2098230 keys | 2734 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 2097964 keys | 2730 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 1058606 keys | 2730 slots | 0 slaves.
[OK] 11752412 keys in 6 masters.
717.31 keys per slot on average.
 
total slots: 16384
>>> Rebalancing across 6 nodes. Total weight = 6.00



[34m******* resize , 6 completed ******* [0m 

------------------------------------------------------------------

[34m******* write , 500000 *******[0m

[33m### WRITING 500000 KEYS ###
[0m
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 2268054 keys | 2730 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 1980164 keys | 2730 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 2499385 keys | 2730 slots | 0 slaves.
172.31.5.19:6379 (e04d781f...) -> 2181576 keys | 2734 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 2181237 keys | 2730 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 1141996 keys | 2730 slots | 0 slaves.
[OK] 12252412 keys in 6 masters.
747.83 keys per slot on average.
 
total slots: 16384
0.5M keys written successfully

[34m******* write , 500000 completed ******* [0m 

------------------------------------------------------------------

[34m******* resize , 7 *******[0m

{ clusterSize: 6 }
[33m### ADDING 172.31.5.31:6379 NODE TO CLUSTER ###
[0m
> redis-cli --cluster add-node 172.31.5.31:6379 172.31.5.90:6379 | awk '{ gsub(/[[0-9;]*m/, ""); print }'
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 2268054 keys | 2730 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 1980164 keys | 2730 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 2499385 keys | 2730 slots | 0 slaves.
172.31.5.19:6379 (e04d781f...) -> 2181576 keys | 2734 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 2181237 keys | 2730 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 1141996 keys | 2730 slots | 0 slaves.
172.31.5.31:6379 (da230fc3...) -> 0 keys | 0 slots | 0 slaves.
[OK] 12252412 keys in 7 masters.
747.83 keys per slot on average.
 
total slots: 16384
node added successfully
waiting... 2 1 


waiting... 10 9 8 7 6 5 4 3 2 1 


[33m### REBALANCING CLUSTER ON 172.31.5.31:6379 ###
[0m
> redis-cli --cluster rebalance 172.31.5.31:6379 --cluster-use-empty-masters | grep -i Rebalancing
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 2035520 keys | 2340 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 1661755 keys | 2340 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 2142333 keys | 2340 slots | 0 slaves.
172.31.5.19:6379 (e04d781f...) -> 1844940 keys | 2340 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 1824217 keys | 2340 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 856856 keys | 2340 slots | 0 slaves.
172.31.5.31:6379 (da230fc3...) -> 1886791 keys | 2344 slots | 0 slaves.
[OK] 12252412 keys in 7 masters.
747.83 keys per slot on average.
 
total slots: 16384
>>> Rebalancing across 7 nodes. Total weight = 7.00



[34m******* resize , 7 completed ******* [0m 

------------------------------------------------------------------

[34m******* write , 500000 *******[0m

[33m### WRITING 500000 KEYS ###
[0m
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 2106955 keys | 2340 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 1733162 keys | 2340 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 2213718 keys | 2340 slots | 0 slaves.
172.31.5.19:6379 (e04d781f...) -> 1916359 keys | 2340 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 1895602 keys | 2340 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 928262 keys | 2340 slots | 0 slaves.
172.31.5.31:6379 (da230fc3...) -> 1958354 keys | 2344 slots | 0 slaves.
[OK] 12752412 keys in 7 masters.
778.35 keys per slot on average.
 
total slots: 16384
0.5M keys written successfully

[34m******* write , 500000 completed ******* [0m 

------------------------------------------------------------------

[34m******* resize , 8 *******[0m

{ clusterSize: 7 }
[33m### ADDING 172.31.5.106:6379 NODE TO CLUSTER ###
[0m
> redis-cli --cluster add-node 172.31.5.106:6379 172.31.5.90:6379 | awk '{ gsub(/[[0-9;]*m/, ""); print }'
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 2106955 keys | 2340 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 1733162 keys | 2340 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 2213718 keys | 2340 slots | 0 slaves.
172.31.5.106:6379 (79b25185...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.19:6379 (e04d781f...) -> 1916359 keys | 2340 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 1895602 keys | 2340 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 928262 keys | 2340 slots | 0 slaves.
172.31.5.31:6379 (da230fc3...) -> 1958354 keys | 2344 slots | 0 slaves.
[OK] 12752412 keys in 8 masters.
778.35 keys per slot on average.
 
total slots: 16384
node added successfully
waiting... 2 1 


waiting... 10 9 8 7 6 5 4 3 2 1 


[33m### REBALANCING CLUSTER ON 172.31.5.106:6379 ###
[0m
> redis-cli --cluster rebalance 172.31.5.106:6379 --cluster-use-empty-masters | grep -i Rebalancing
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 1937532 keys | 2048 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 1501451 keys | 2048 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 1937465 keys | 2048 slots | 0 slaves.
172.31.5.106:6379 (79b25185...) -> 1533395 keys | 2048 slots | 0 slaves.
172.31.5.19:6379 (e04d781f...) -> 1649504 keys | 2048 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 1684036 keys | 2048 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 812555 keys | 2048 slots | 0 slaves.
172.31.5.31:6379 (da230fc3...) -> 1696474 keys | 2048 slots | 0 slaves.
[OK] 12752412 keys in 8 masters.
778.35 keys per slot on average.
 
total slots: 16384
>>> Rebalancing across 8 nodes. Total weight = 8.00



[34m******* resize , 8 completed ******* [0m 

------------------------------------------------------------------

[34m******* write , 500000 *******[0m

[33m### WRITING 500000 KEYS ###
[0m
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.90:6379 ###
[0m172.31.5.90:6379 (a094ad6a...) -> 2000045 keys | 2048 slots | 0 slaves.
172.31.5.254:6379 (6c6bab51...) -> 1564003 keys | 2048 slots | 0 slaves.
172.31.5.123:6379 (24ea1433...) -> 1999953 keys | 2048 slots | 0 slaves.
172.31.5.106:6379 (79b25185...) -> 1595838 keys | 2048 slots | 0 slaves.
172.31.5.19:6379 (e04d781f...) -> 1712014 keys | 2048 slots | 0 slaves.
172.31.5.162:6379 (74d3fe21...) -> 1746620 keys | 2048 slots | 0 slaves.
172.31.5.101:6379 (f2a2f48e...) -> 875063 keys | 2048 slots | 0 slaves.
172.31.5.31:6379 (da230fc3...) -> 1758876 keys | 2048 slots | 0 slaves.
[OK] 13252412 keys in 8 masters.
808.86 keys per slot on average.
 
total slots: 16384
0.5M keys written successfully

[34m******* write , 500000 completed ******* [0m 

Time Taken: 12135.866 seconds...

---DONE---
