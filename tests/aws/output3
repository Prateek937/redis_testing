cluster Size: 1
------------------------------------------------------------------

[34m******* init  *******[0m

[33m### CREATING CLUSTER OF 3 NODES  172.31.5.192:6379 172.31.5.72:6379 172.31.5.142:6379 ###
[0m
> redis-cli --cluster create  172.31.5.192:6379 172.31.5.72:6379 172.31.5.142:6379 --cluster-replicas 0 --cluster-yes | grep OK | awk '{ gsub(/[[0-9;]*m/, ""); print }'
assertion error.
 {
  keys1: 0,
  keys2: 0,
  keys: 0,
  slots1: 0,
  slots2: 16384,
  nodes1: 1,
  nodes2: 3,
  nodes: 2
}
precheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 0 keys | 0 slots | 0 slaves.
[OK] 0 keys in 1 masters.
0.00 keys per slot on average.

postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 0 keys | 5461 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 0 keys | 5462 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 0 keys | 5461 slots | 0 slaves.
[OK] 0 keys in 3 masters.
0.00 keys per slot on average.
 
total slots: 16384
cluster created successfully

[34m******* init  completed ******* [0m 

------------------------------------------------------------------

[34m******* write , 500000 *******[0m

[33m### WRITING 500000 KEYS ###
[0m
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 166706 keys | 5461 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 166616 keys | 5462 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 166678 keys | 5461 slots | 0 slaves.
[OK] 500000 keys in 3 masters.
30.52 keys per slot on average.
 
total slots: 16384
0.5M keys written successfully

[34m******* write , 500000 completed ******* [0m 

------------------------------------------------------------------

[34m******* resize , 8 *******[0m

{ clusterSize: 3 }
[33m### ADDING 172.31.5.9:6379 NODE TO CLUSTER ###
[0m
> redis-cli --cluster add-node 172.31.5.9:6379 172.31.5.192:6379 | awk '{ gsub(/[[0-9;]*m/, ""); print }'
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 166706 keys | 5461 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 166616 keys | 5462 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 166678 keys | 5461 slots | 0 slaves.
[OK] 500000 keys in 4 masters.
30.52 keys per slot on average.
 
total slots: 16384
node added successfully
waiting... 2 1 


[33m### ADDING 172.31.5.120:6379 NODE TO CLUSTER ###
[0m
> redis-cli --cluster add-node 172.31.5.120:6379 172.31.5.192:6379 | awk '{ gsub(/[[0-9;]*m/, ""); print }'
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 166706 keys | 5461 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 166678 keys | 5461 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 166616 keys | 5462 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 0 keys | 0 slots | 0 slaves.
[OK] 500000 keys in 5 masters.
30.52 keys per slot on average.
 
total slots: 16384
node added successfully
waiting... 2 1 


[33m### ADDING 172.31.5.69:6379 NODE TO CLUSTER ###
[0m
> redis-cli --cluster add-node 172.31.5.69:6379 172.31.5.192:6379 | awk '{ gsub(/[[0-9;]*m/, ""); print }'
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 166706 keys | 5461 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 166678 keys | 5461 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 166616 keys | 5462 slots | 0 slaves.
172.31.5.69:6379 (c767ab28...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 0 keys | 0 slots | 0 slaves.
[OK] 500000 keys in 6 masters.
30.52 keys per slot on average.
 
total slots: 16384
node added successfully
waiting... 2 1 


[33m### ADDING 172.31.5.56:6379 NODE TO CLUSTER ###
[0m
> redis-cli --cluster add-node 172.31.5.56:6379 172.31.5.192:6379 | awk '{ gsub(/[[0-9;]*m/, ""); print }'
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 166706 keys | 5461 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 166678 keys | 5461 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 166616 keys | 5462 slots | 0 slaves.
172.31.5.56:6379 (234e48dd...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.69:6379 (c767ab28...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 0 keys | 0 slots | 0 slaves.
[OK] 500000 keys in 7 masters.
30.52 keys per slot on average.
 
total slots: 16384
node added successfully
waiting... 2 1 


[33m### ADDING 172.31.5.226:6379 NODE TO CLUSTER ###
[0m
> redis-cli --cluster add-node 172.31.5.226:6379 172.31.5.192:6379 | awk '{ gsub(/[[0-9;]*m/, ""); print }'
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 166706 keys | 5461 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 166678 keys | 5461 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 166616 keys | 5462 slots | 0 slaves.
172.31.5.226:6379 (1115b088...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.56:6379 (234e48dd...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.69:6379 (c767ab28...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 0 keys | 0 slots | 0 slaves.
[OK] 500000 keys in 8 masters.
30.52 keys per slot on average.
 
total slots: 16384
node added successfully
waiting... 2 1 


waiting... 10 9 8 7 6 5 4 3 2 1 


[33m### REBALANCING CLUSTER ON 172.31.5.9:6379 ###
[0m
> redis-cli --cluster rebalance 172.31.5.9:6379 --cluster-use-empty-masters | grep -i Rebalancing
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 62486 keys | 2048 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 62518 keys | 2048 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 62474 keys | 2048 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 62534 keys | 2048 slots | 0 slaves.
172.31.5.226:6379 (1115b088...) -> 62487 keys | 2048 slots | 0 slaves.
172.31.5.56:6379 (234e48dd...) -> 62600 keys | 2048 slots | 0 slaves.
172.31.5.69:6379 (c767ab28...) -> 62392 keys | 2048 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 62509 keys | 2048 slots | 0 slaves.
[OK] 500000 keys in 8 masters.
30.52 keys per slot on average.
 
total slots: 16384
>>> Rebalancing across 8 nodes. Total weight = 8.00



[34m******* resize , 8 completed ******* [0m 

------------------------------------------------------------------

[34m******* write , 500000 *******[0m

[33m### WRITING 500000 KEYS ###
[0m
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 124976 keys | 2048 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 125011 keys | 2048 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 124994 keys | 2048 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 125024 keys | 2048 slots | 0 slaves.
172.31.5.226:6379 (1115b088...) -> 124972 keys | 2048 slots | 0 slaves.
172.31.5.56:6379 (234e48dd...) -> 125171 keys | 2048 slots | 0 slaves.
172.31.5.69:6379 (c767ab28...) -> 124811 keys | 2048 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 125041 keys | 2048 slots | 0 slaves.
[OK] 1000000 keys in 8 masters.
61.04 keys per slot on average.
 
total slots: 16384
0.5M keys written successfully

[34m******* write , 500000 completed ******* [0m 

------------------------------------------------------------------

[34m******* resize , 3 *******[0m

{ clusterSize: 8 }
[33m### REBALANCING CLUSTER ON 172.31.5.226:6379 ###
[0m
> redis-cli --cluster rebalance 172.31.5.226:6379 --cluster-use-empty-masters | grep -i Rebalancing
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 124976 keys | 2048 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 125011 keys | 2048 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 124994 keys | 2048 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 125024 keys | 2048 slots | 0 slaves.
172.31.5.226:6379 (1115b088...) -> 124972 keys | 2048 slots | 0 slaves.
172.31.5.56:6379 (234e48dd...) -> 125171 keys | 2048 slots | 0 slaves.
172.31.5.69:6379 (c767ab28...) -> 124811 keys | 2048 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 125041 keys | 2048 slots | 0 slaves.
[OK] 1000000 keys in 8 masters.
61.04 keys per slot on average.
 
total slots: 16384
*** No rebalancing needed! All nodes are within the 2.00% threshold.


{ distribution: [ 683, 683, 682 ] }
[33m### RESHARDING FROM 172.31.5.226 TO 172.31.5.192 ###
[0m
{ reshardFrom: '172.31.5.226', reshardTo: '172.31.5.192', slots: 683 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 166719 keys | 2731 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 125011 keys | 2048 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 124994 keys | 2048 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 125024 keys | 2048 slots | 0 slaves.
172.31.5.226:6379 (1115b088...) -> 83229 keys | 1365 slots | 0 slaves.
172.31.5.56:6379 (234e48dd...) -> 125171 keys | 2048 slots | 0 slaves.
172.31.5.69:6379 (c767ab28...) -> 124811 keys | 2048 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 125041 keys | 2048 slots | 0 slaves.
[OK] 1000000 keys in 8 masters.
61.04 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.226 TO 172.31.5.72 ###
[0m
{ reshardFrom: '172.31.5.226', reshardTo: '172.31.5.72', slots: 683 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 166719 keys | 2731 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 125011 keys | 2048 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 124994 keys | 2048 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 166620 keys | 2731 slots | 0 slaves.
172.31.5.226:6379 (1115b088...) -> 41633 keys | 682 slots | 0 slaves.
172.31.5.56:6379 (234e48dd...) -> 125171 keys | 2048 slots | 0 slaves.
172.31.5.69:6379 (c767ab28...) -> 124811 keys | 2048 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 125041 keys | 2048 slots | 0 slaves.
[OK] 1000000 keys in 8 masters.
61.04 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.226 TO 172.31.5.142 ###
[0m
{ reshardFrom: '172.31.5.226', reshardTo: '172.31.5.142', slots: 682 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 166719 keys | 2731 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 125011 keys | 2048 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 166627 keys | 2730 slots | 1 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 166620 keys | 2731 slots | 0 slaves.
172.31.5.56:6379 (234e48dd...) -> 125171 keys | 2048 slots | 0 slaves.
172.31.5.69:6379 (c767ab28...) -> 124811 keys | 2048 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 125041 keys | 2048 slots | 0 slaves.
[OK] 1000000 keys in 7 masters.
61.04 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### REMOVING 172.31.5.226:6379 FROM CLUSTER ###
[0m
> redis-cli --cluster del-node 172.31.5.226:6379 1115b08851797fa0d86d6dcf38b8d86974fdc686
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 166719 keys | 2731 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 125011 keys | 2048 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 166627 keys | 2730 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 166620 keys | 2731 slots | 0 slaves.
172.31.5.56:6379 (234e48dd...) -> 125171 keys | 2048 slots | 0 slaves.
172.31.5.69:6379 (c767ab28...) -> 124811 keys | 2048 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 125041 keys | 2048 slots | 0 slaves.
[OK] 1000000 keys in 7 masters.
61.04 keys per slot on average.
 
total slots: 16384
Removing node 1115b08851797fa0d86d6dcf38b8d86974fdc686 from cluster 172.31.5.226:6379
Sending CLUSTER FORGET messages to the cluster...
Sending CLUSTER RESET SOFT to the deleted node.
{ distribution: [ 683, 683, 682 ] }
[33m### RESHARDING FROM 172.31.5.56 TO 172.31.5.72 ###
[0m
{ reshardFrom: '172.31.5.56', reshardTo: '172.31.5.72', slots: 683 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 166719 keys | 2731 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 125011 keys | 2048 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 166627 keys | 2730 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 208349 keys | 3414 slots | 0 slaves.
172.31.5.56:6379 (234e48dd...) -> 83442 keys | 1365 slots | 0 slaves.
172.31.5.69:6379 (c767ab28...) -> 124811 keys | 2048 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 125041 keys | 2048 slots | 0 slaves.
[OK] 1000000 keys in 7 masters.
61.04 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.56 TO 172.31.5.142 ###
[0m
{ reshardFrom: '172.31.5.56', reshardTo: '172.31.5.142', slots: 683 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 166719 keys | 2731 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 125011 keys | 2048 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 208361 keys | 3413 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 208349 keys | 3414 slots | 0 slaves.
172.31.5.56:6379 (234e48dd...) -> 41708 keys | 682 slots | 0 slaves.
172.31.5.69:6379 (c767ab28...) -> 124811 keys | 2048 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 125041 keys | 2048 slots | 0 slaves.
[OK] 1000000 keys in 7 masters.
61.04 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.56 TO 172.31.5.192 ###
[0m
{ reshardFrom: '172.31.5.56', reshardTo: '172.31.5.192', slots: 682 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 208427 keys | 3413 slots | 1 slaves.
172.31.5.120:6379 (9ca261e7...) -> 125011 keys | 2048 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 208361 keys | 3413 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 208349 keys | 3414 slots | 0 slaves.
172.31.5.69:6379 (c767ab28...) -> 124811 keys | 2048 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 125041 keys | 2048 slots | 0 slaves.
[OK] 1000000 keys in 6 masters.
61.04 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### REMOVING 172.31.5.56:6379 FROM CLUSTER ###
[0m
> redis-cli --cluster del-node 172.31.5.56:6379 234e48dd8ec12ce323c6ae15e58211ab6cff76c4
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 208427 keys | 3413 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 125011 keys | 2048 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 208361 keys | 3413 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 208349 keys | 3414 slots | 0 slaves.
172.31.5.69:6379 (c767ab28...) -> 124811 keys | 2048 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 125041 keys | 2048 slots | 0 slaves.
[OK] 1000000 keys in 6 masters.
61.04 keys per slot on average.
 
total slots: 16384
Removing node 234e48dd8ec12ce323c6ae15e58211ab6cff76c4 from cluster 172.31.5.56:6379
Sending CLUSTER FORGET messages to the cluster...
Sending CLUSTER RESET SOFT to the deleted node.
{ distribution: [ 683, 683, 682 ] }
[33m### RESHARDING FROM 172.31.5.69 TO 172.31.5.142 ###
[0m
{ reshardFrom: '172.31.5.69', reshardTo: '172.31.5.142', slots: 683 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 208427 keys | 3413 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 125011 keys | 2048 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 249940 keys | 4096 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 208349 keys | 3414 slots | 0 slaves.
172.31.5.69:6379 (c767ab28...) -> 83232 keys | 1365 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 125041 keys | 2048 slots | 0 slaves.
[OK] 1000000 keys in 6 masters.
61.04 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.69 TO 172.31.5.192 ###
[0m
{ reshardFrom: '172.31.5.69', reshardTo: '172.31.5.192', slots: 683 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 249996 keys | 4096 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 125011 keys | 2048 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 249940 keys | 4096 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 208349 keys | 3414 slots | 0 slaves.
172.31.5.69:6379 (c767ab28...) -> 41663 keys | 682 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 125041 keys | 2048 slots | 0 slaves.
[OK] 1000000 keys in 6 masters.
61.04 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.69 TO 172.31.5.72 ###
[0m
{ reshardFrom: '172.31.5.69', reshardTo: '172.31.5.72', slots: 682 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 249996 keys | 4096 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 125011 keys | 2048 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 249940 keys | 4096 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 250012 keys | 4096 slots | 1 slaves.
172.31.5.9:6379 (a4f97e81...) -> 125041 keys | 2048 slots | 0 slaves.
[OK] 1000000 keys in 5 masters.
61.04 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### REMOVING 172.31.5.69:6379 FROM CLUSTER ###
[0m
> redis-cli --cluster del-node 172.31.5.69:6379 c767ab28fe1051fc42e029246c44c11abb50fc85
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 249996 keys | 4096 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 125011 keys | 2048 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 249940 keys | 4096 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 250012 keys | 4096 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 125041 keys | 2048 slots | 0 slaves.
[OK] 1000000 keys in 5 masters.
61.04 keys per slot on average.
 
total slots: 16384
Removing node c767ab28fe1051fc42e029246c44c11abb50fc85 from cluster 172.31.5.69:6379
Sending CLUSTER FORGET messages to the cluster...
Sending CLUSTER RESET SOFT to the deleted node.
{ distribution: [ 683, 683, 682 ] }
[33m### RESHARDING FROM 172.31.5.120 TO 172.31.5.192 ###
[0m
{ reshardFrom: '172.31.5.120', reshardTo: '172.31.5.192', slots: 683 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 291606 keys | 4779 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 83401 keys | 1365 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 249940 keys | 4096 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 250012 keys | 4096 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 125041 keys | 2048 slots | 0 slaves.
[OK] 1000000 keys in 5 masters.
61.04 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.120 TO 172.31.5.72 ###
[0m
{ reshardFrom: '172.31.5.120', reshardTo: '172.31.5.72', slots: 683 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 291606 keys | 4779 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 41648 keys | 682 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 249940 keys | 4096 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 291765 keys | 4779 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 125041 keys | 2048 slots | 0 slaves.
[OK] 1000000 keys in 5 masters.
61.04 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.120 TO 172.31.5.142 ###
[0m
{ reshardFrom: '172.31.5.120', reshardTo: '172.31.5.142', slots: 682 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 291606 keys | 4779 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 291588 keys | 4778 slots | 1 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 291765 keys | 4779 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 125041 keys | 2048 slots | 0 slaves.
[OK] 1000000 keys in 4 masters.
61.04 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### REMOVING 172.31.5.120:6379 FROM CLUSTER ###
[0m
> redis-cli --cluster del-node 172.31.5.120:6379 9ca261e70d34be19b2cda07304fb0a02fcec6a94
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 291606 keys | 4779 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 291588 keys | 4778 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 291765 keys | 4779 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 125041 keys | 2048 slots | 0 slaves.
[OK] 1000000 keys in 4 masters.
61.04 keys per slot on average.
 
total slots: 16384
Removing node 9ca261e70d34be19b2cda07304fb0a02fcec6a94 from cluster 172.31.5.120:6379
Sending CLUSTER FORGET messages to the cluster...
Sending CLUSTER RESET SOFT to the deleted node.
{ distribution: [ 683, 683, 682 ] }
[33m### RESHARDING FROM 172.31.5.9 TO 172.31.5.72 ###
[0m
{ reshardFrom: '172.31.5.9', reshardTo: '172.31.5.72', slots: 683 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 291606 keys | 4779 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 291588 keys | 4778 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 333389 keys | 5462 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 83417 keys | 1365 slots | 0 slaves.
[OK] 1000000 keys in 4 masters.
61.04 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.9 TO 172.31.5.142 ###
[0m
{ reshardFrom: '172.31.5.9', reshardTo: '172.31.5.142', slots: 683 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 291606 keys | 4779 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 333340 keys | 5461 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 333389 keys | 5462 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 41665 keys | 682 slots | 0 slaves.
[OK] 1000000 keys in 4 masters.
61.04 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.9 TO 172.31.5.192 ###
[0m
{ reshardFrom: '172.31.5.9', reshardTo: '172.31.5.192', slots: 682 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 333271 keys | 5461 slots | 1 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 333340 keys | 5461 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 333389 keys | 5462 slots | 0 slaves.
[OK] 1000000 keys in 3 masters.
61.04 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### REMOVING 172.31.5.9:6379 FROM CLUSTER ###
[0m
> redis-cli --cluster del-node 172.31.5.9:6379 a4f97e8143f27f4282a37484971dbedd141f3ba9
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 333271 keys | 5461 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 333340 keys | 5461 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 333389 keys | 5462 slots | 0 slaves.
[OK] 1000000 keys in 3 masters.
61.04 keys per slot on average.
 
total slots: 16384
Removing node a4f97e8143f27f4282a37484971dbedd141f3ba9 from cluster 172.31.5.9:6379
Sending CLUSTER FORGET messages to the cluster...
Sending CLUSTER RESET SOFT to the deleted node.
[33m### REBALANCING CLUSTER ON 172.31.5.192:6379 ###
[0m
> redis-cli --cluster rebalance 172.31.5.192:6379 --cluster-use-empty-masters | grep -i Rebalancing
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 333271 keys | 5461 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 333340 keys | 5461 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 333389 keys | 5462 slots | 0 slaves.
[OK] 1000000 keys in 3 masters.
61.04 keys per slot on average.
 
total slots: 16384
*** No rebalancing needed! All nodes are within the 2.00% threshold.


waiting... 65 64 63 62 61 60 59 58 57 56 55 54 53 52 51 50 49 48 47 46 45 44 43 42 41 40 39 38 37 36 35 34 33 32 31 30 29 28 27 26 25 24 23 22 21 20 19 18 17 16 15 14 13 12 11 10 9 8 7 6 5 4 3 2 1 



[34m******* resize , 3 completed ******* [0m 

------------------------------------------------------------------

[34m******* write , 500000 *******[0m

[33m### WRITING 500000 KEYS ###
[0m
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 499913 keys | 5461 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 500022 keys | 5461 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 500065 keys | 5462 slots | 0 slaves.
[OK] 1500000 keys in 3 masters.
91.55 keys per slot on average.
 
total slots: 16384
0.5M keys written successfully

[34m******* write , 500000 completed ******* [0m 

------------------------------------------------------------------

[34m******* resize , 8 *******[0m

{ clusterSize: 3 }
[33m### ADDING 172.31.5.9:6379 NODE TO CLUSTER ###
[0m
> redis-cli --cluster add-node 172.31.5.9:6379 172.31.5.192:6379 | awk '{ gsub(/[[0-9;]*m/, ""); print }'
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 499913 keys | 5461 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 500022 keys | 5461 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 500065 keys | 5462 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 0 keys | 0 slots | 0 slaves.
[OK] 1500000 keys in 4 masters.
91.55 keys per slot on average.
 
total slots: 16384
node added successfully
waiting... 2 1 


[33m### ADDING 172.31.5.120:6379 NODE TO CLUSTER ###
[0m
> redis-cli --cluster add-node 172.31.5.120:6379 172.31.5.192:6379 | awk '{ gsub(/[[0-9;]*m/, ""); print }'
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 499913 keys | 5461 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 500022 keys | 5461 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 500065 keys | 5462 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 0 keys | 0 slots | 0 slaves.
[OK] 1500000 keys in 5 masters.
91.55 keys per slot on average.
 
total slots: 16384
node added successfully
waiting... 2 1 


[33m### ADDING 172.31.5.69:6379 NODE TO CLUSTER ###
[0m
> redis-cli --cluster add-node 172.31.5.69:6379 172.31.5.192:6379 | awk '{ gsub(/[[0-9;]*m/, ""); print }'
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 499913 keys | 5461 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 500022 keys | 5461 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 500065 keys | 5462 slots | 0 slaves.
172.31.5.69:6379 (c767ab28...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 0 keys | 0 slots | 0 slaves.
[OK] 1500000 keys in 6 masters.
91.55 keys per slot on average.
 
total slots: 16384
node added successfully
waiting... 2 1 


[33m### ADDING 172.31.5.56:6379 NODE TO CLUSTER ###
[0m
> redis-cli --cluster add-node 172.31.5.56:6379 172.31.5.192:6379 | awk '{ gsub(/[[0-9;]*m/, ""); print }'
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 499913 keys | 5461 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 500022 keys | 5461 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 500065 keys | 5462 slots | 0 slaves.
172.31.5.56:6379 (234e48dd...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.69:6379 (c767ab28...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 0 keys | 0 slots | 0 slaves.
[OK] 1500000 keys in 7 masters.
91.55 keys per slot on average.
 
total slots: 16384
node added successfully
waiting... 2 1 


[33m### ADDING 172.31.5.226:6379 NODE TO CLUSTER ###
[0m
> redis-cli --cluster add-node 172.31.5.226:6379 172.31.5.192:6379 | awk '{ gsub(/[[0-9;]*m/, ""); print }'
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 499913 keys | 5461 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 500022 keys | 5461 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 500065 keys | 5462 slots | 0 slaves.
172.31.5.226:6379 (1115b088...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.56:6379 (234e48dd...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.69:6379 (c767ab28...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 0 keys | 0 slots | 0 slaves.
[OK] 1500000 keys in 8 masters.
91.55 keys per slot on average.
 
total slots: 16384
node added successfully
waiting... 2 1 


waiting... 10 9 8 7 6 5 4 3 2 1 


[33m### REBALANCING CLUSTER ON 172.31.5.9:6379 ###
[0m
> redis-cli --cluster rebalance 172.31.5.9:6379 --cluster-use-empty-masters | grep -i Rebalancing
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 187545 keys | 2048 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 187641 keys | 2048 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 187509 keys | 2048 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 187280 keys | 2048 slots | 0 slaves.
172.31.5.226:6379 (1115b088...) -> 187492 keys | 2048 slots | 0 slaves.
172.31.5.56:6379 (234e48dd...) -> 187263 keys | 2048 slots | 0 slaves.
172.31.5.69:6379 (c767ab28...) -> 187721 keys | 2048 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 187549 keys | 2048 slots | 0 slaves.
[OK] 1500000 keys in 8 masters.
91.55 keys per slot on average.
 
total slots: 16384
>>> Rebalancing across 8 nodes. Total weight = 8.00



[34m******* resize , 8 completed ******* [0m 

------------------------------------------------------------------

[34m******* write , 500000 *******[0m

[33m### WRITING 500000 KEYS ###
[0m
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 249974 keys | 2048 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 250049 keys | 2048 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 250006 keys | 2048 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 249995 keys | 2048 slots | 0 slaves.
172.31.5.226:6379 (1115b088...) -> 249961 keys | 2048 slots | 0 slaves.
172.31.5.56:6379 (234e48dd...) -> 249907 keys | 2048 slots | 0 slaves.
172.31.5.69:6379 (c767ab28...) -> 250118 keys | 2048 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 249990 keys | 2048 slots | 0 slaves.
[OK] 2000000 keys in 8 masters.
122.07 keys per slot on average.
 
total slots: 16384
0.5M keys written successfully

[34m******* write , 500000 completed ******* [0m 

------------------------------------------------------------------

[34m******* resize , 4 *******[0m

{ clusterSize: 8 }
[33m### REBALANCING CLUSTER ON 172.31.5.226:6379 ###
[0m
> redis-cli --cluster rebalance 172.31.5.226:6379 --cluster-use-empty-masters | grep -i Rebalancing
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 249974 keys | 2048 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 250049 keys | 2048 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 250006 keys | 2048 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 249995 keys | 2048 slots | 0 slaves.
172.31.5.226:6379 (1115b088...) -> 249961 keys | 2048 slots | 0 slaves.
172.31.5.56:6379 (234e48dd...) -> 249907 keys | 2048 slots | 0 slaves.
172.31.5.69:6379 (c767ab28...) -> 250118 keys | 2048 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 249990 keys | 2048 slots | 0 slaves.
[OK] 2000000 keys in 8 masters.
122.07 keys per slot on average.
 
total slots: 16384
*** No rebalancing needed! All nodes are within the 2.00% threshold.


{ distribution: [ 512, 512, 512, 512 ] }
[33m### RESHARDING FROM 172.31.5.226 TO 172.31.5.192 ###
[0m
{ reshardFrom: '172.31.5.226', reshardTo: '172.31.5.192', slots: 512 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 312482 keys | 2560 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 250049 keys | 2048 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 250006 keys | 2048 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 249995 keys | 2048 slots | 0 slaves.
172.31.5.226:6379 (1115b088...) -> 187453 keys | 1536 slots | 0 slaves.
172.31.5.56:6379 (234e48dd...) -> 249907 keys | 2048 slots | 0 slaves.
172.31.5.69:6379 (c767ab28...) -> 250118 keys | 2048 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 249990 keys | 2048 slots | 0 slaves.
[OK] 2000000 keys in 8 masters.
122.07 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.226 TO 172.31.5.72 ###
[0m
{ reshardFrom: '172.31.5.226', reshardTo: '172.31.5.72', slots: 512 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 312482 keys | 2560 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 250049 keys | 2048 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 250006 keys | 2048 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 312557 keys | 2560 slots | 0 slaves.
172.31.5.226:6379 (1115b088...) -> 124891 keys | 1024 slots | 0 slaves.
172.31.5.56:6379 (234e48dd...) -> 249907 keys | 2048 slots | 0 slaves.
172.31.5.69:6379 (c767ab28...) -> 250118 keys | 2048 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 249990 keys | 2048 slots | 0 slaves.
[OK] 2000000 keys in 8 masters.
122.07 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.226 TO 172.31.5.142 ###
[0m
{ reshardFrom: '172.31.5.226', reshardTo: '172.31.5.142', slots: 512 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 312482 keys | 2560 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 250049 keys | 2048 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 312429 keys | 2560 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 312557 keys | 2560 slots | 0 slaves.
172.31.5.226:6379 (1115b088...) -> 62468 keys | 512 slots | 0 slaves.
172.31.5.56:6379 (234e48dd...) -> 249907 keys | 2048 slots | 0 slaves.
172.31.5.69:6379 (c767ab28...) -> 250118 keys | 2048 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 249990 keys | 2048 slots | 0 slaves.
[OK] 2000000 keys in 8 masters.
122.07 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.226 TO 172.31.5.9 ###
[0m
{ reshardFrom: '172.31.5.226', reshardTo: '172.31.5.9', slots: 512 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 312482 keys | 2560 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 250049 keys | 2048 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 312429 keys | 2560 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 312557 keys | 2560 slots | 0 slaves.
172.31.5.56:6379 (234e48dd...) -> 249907 keys | 2048 slots | 0 slaves.
172.31.5.69:6379 (c767ab28...) -> 250118 keys | 2048 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 312458 keys | 2560 slots | 1 slaves.
[OK] 2000000 keys in 7 masters.
122.07 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### REMOVING 172.31.5.226:6379 FROM CLUSTER ###
[0m
> redis-cli --cluster del-node 172.31.5.226:6379 1115b08851797fa0d86d6dcf38b8d86974fdc686
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 312482 keys | 2560 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 250049 keys | 2048 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 312429 keys | 2560 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 312557 keys | 2560 slots | 0 slaves.
172.31.5.56:6379 (234e48dd...) -> 249907 keys | 2048 slots | 0 slaves.
172.31.5.69:6379 (c767ab28...) -> 250118 keys | 2048 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 312458 keys | 2560 slots | 0 slaves.
[OK] 2000000 keys in 7 masters.
122.07 keys per slot on average.
 
total slots: 16384
Removing node 1115b08851797fa0d86d6dcf38b8d86974fdc686 from cluster 172.31.5.226:6379
Sending CLUSTER FORGET messages to the cluster...
Sending CLUSTER RESET SOFT to the deleted node.
{ distribution: [ 512, 512, 512, 512 ] }
[33m### RESHARDING FROM 172.31.5.56 TO 172.31.5.72 ###
[0m
{ reshardFrom: '172.31.5.56', reshardTo: '172.31.5.72', slots: 512 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 312482 keys | 2560 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 250049 keys | 2048 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 312429 keys | 2560 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 375006 keys | 3072 slots | 0 slaves.
172.31.5.56:6379 (234e48dd...) -> 187458 keys | 1536 slots | 0 slaves.
172.31.5.69:6379 (c767ab28...) -> 250118 keys | 2048 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 312458 keys | 2560 slots | 0 slaves.
[OK] 2000000 keys in 7 masters.
122.07 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.56 TO 172.31.5.142 ###
[0m
{ reshardFrom: '172.31.5.56', reshardTo: '172.31.5.142', slots: 512 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 312482 keys | 2560 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 250049 keys | 2048 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 374964 keys | 3072 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 375006 keys | 3072 slots | 0 slaves.
172.31.5.56:6379 (234e48dd...) -> 124923 keys | 1024 slots | 0 slaves.
172.31.5.69:6379 (c767ab28...) -> 250118 keys | 2048 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 312458 keys | 2560 slots | 0 slaves.
[OK] 2000000 keys in 7 masters.
122.07 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.56 TO 172.31.5.9 ###
[0m
{ reshardFrom: '172.31.5.56', reshardTo: '172.31.5.9', slots: 512 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 312482 keys | 2560 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 250049 keys | 2048 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 374964 keys | 3072 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 375006 keys | 3072 slots | 0 slaves.
172.31.5.56:6379 (234e48dd...) -> 62497 keys | 512 slots | 0 slaves.
172.31.5.69:6379 (c767ab28...) -> 250118 keys | 2048 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 374884 keys | 3072 slots | 0 slaves.
[OK] 2000000 keys in 7 masters.
122.07 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.56 TO 172.31.5.192 ###
[0m
{ reshardFrom: '172.31.5.56', reshardTo: '172.31.5.192', slots: 512 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 374979 keys | 3072 slots | 1 slaves.
172.31.5.120:6379 (9ca261e7...) -> 250049 keys | 2048 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 374964 keys | 3072 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 375006 keys | 3072 slots | 0 slaves.
172.31.5.69:6379 (c767ab28...) -> 250118 keys | 2048 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 374884 keys | 3072 slots | 0 slaves.
[OK] 2000000 keys in 6 masters.
122.07 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### REMOVING 172.31.5.56:6379 FROM CLUSTER ###
[0m
> redis-cli --cluster del-node 172.31.5.56:6379 234e48dd8ec12ce323c6ae15e58211ab6cff76c4
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 374979 keys | 3072 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 250049 keys | 2048 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 374964 keys | 3072 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 375006 keys | 3072 slots | 0 slaves.
172.31.5.69:6379 (c767ab28...) -> 250118 keys | 2048 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 374884 keys | 3072 slots | 0 slaves.
[OK] 2000000 keys in 6 masters.
122.07 keys per slot on average.
 
total slots: 16384
Removing node 234e48dd8ec12ce323c6ae15e58211ab6cff76c4 from cluster 172.31.5.56:6379
Sending CLUSTER FORGET messages to the cluster...
Sending CLUSTER RESET SOFT to the deleted node.
{ distribution: [ 512, 512, 512, 512 ] }
[33m### RESHARDING FROM 172.31.5.69 TO 172.31.5.142 ###
[0m
{ reshardFrom: '172.31.5.69', reshardTo: '172.31.5.142', slots: 512 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 374979 keys | 3072 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 250049 keys | 2048 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 437469 keys | 3584 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 375006 keys | 3072 slots | 0 slaves.
172.31.5.69:6379 (c767ab28...) -> 187613 keys | 1536 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 374884 keys | 3072 slots | 0 slaves.
[OK] 2000000 keys in 6 masters.
122.07 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.69 TO 172.31.5.9 ###
[0m
{ reshardFrom: '172.31.5.69', reshardTo: '172.31.5.9', slots: 512 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 374979 keys | 3072 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 250049 keys | 2048 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 437469 keys | 3584 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 375006 keys | 3072 slots | 0 slaves.
172.31.5.69:6379 (c767ab28...) -> 125000 keys | 1024 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 437497 keys | 3584 slots | 0 slaves.
[OK] 2000000 keys in 6 masters.
122.07 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.69 TO 172.31.5.192 ###
[0m
{ reshardFrom: '172.31.5.69', reshardTo: '172.31.5.192', slots: 512 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 437453 keys | 3584 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 250049 keys | 2048 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 437469 keys | 3584 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 375006 keys | 3072 slots | 0 slaves.
172.31.5.69:6379 (c767ab28...) -> 62526 keys | 512 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 437497 keys | 3584 slots | 0 slaves.
[OK] 2000000 keys in 6 masters.
122.07 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.69 TO 172.31.5.72 ###
[0m
{ reshardFrom: '172.31.5.69', reshardTo: '172.31.5.72', slots: 512 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 437453 keys | 3584 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 250049 keys | 2048 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 437469 keys | 3584 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 437532 keys | 3584 slots | 1 slaves.
172.31.5.9:6379 (a4f97e81...) -> 437497 keys | 3584 slots | 0 slaves.
[OK] 2000000 keys in 5 masters.
122.07 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### REMOVING 172.31.5.69:6379 FROM CLUSTER ###
[0m
> redis-cli --cluster del-node 172.31.5.69:6379 c767ab28fe1051fc42e029246c44c11abb50fc85
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 437453 keys | 3584 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 250049 keys | 2048 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 437469 keys | 3584 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 437532 keys | 3584 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 437497 keys | 3584 slots | 0 slaves.
[OK] 2000000 keys in 5 masters.
122.07 keys per slot on average.
 
total slots: 16384
Removing node c767ab28fe1051fc42e029246c44c11abb50fc85 from cluster 172.31.5.69:6379
Sending CLUSTER FORGET messages to the cluster...
Sending CLUSTER RESET SOFT to the deleted node.
{ distribution: [ 512, 512, 512, 512 ] }
[33m### RESHARDING FROM 172.31.5.120 TO 172.31.5.9 ###
[0m
{ reshardFrom: '172.31.5.120', reshardTo: '172.31.5.9', slots: 512 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 437453 keys | 3584 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 187544 keys | 1536 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 437469 keys | 3584 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 437532 keys | 3584 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 500002 keys | 4096 slots | 0 slaves.
[OK] 2000000 keys in 5 masters.
122.07 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.120 TO 172.31.5.192 ###
[0m
{ reshardFrom: '172.31.5.120', reshardTo: '172.31.5.192', slots: 512 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 499943 keys | 4096 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 125054 keys | 1024 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 437469 keys | 3584 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 437532 keys | 3584 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 500002 keys | 4096 slots | 0 slaves.
[OK] 2000000 keys in 5 masters.
122.07 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.120 TO 172.31.5.72 ###
[0m
{ reshardFrom: '172.31.5.120', reshardTo: '172.31.5.72', slots: 512 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 499943 keys | 4096 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 62580 keys | 512 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 437469 keys | 3584 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 500006 keys | 4096 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 500002 keys | 4096 slots | 0 slaves.
[OK] 2000000 keys in 5 masters.
122.07 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.120 TO 172.31.5.142 ###
[0m
{ reshardFrom: '172.31.5.120', reshardTo: '172.31.5.142', slots: 512 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 499943 keys | 4096 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 500049 keys | 4096 slots | 1 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 500006 keys | 4096 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 500002 keys | 4096 slots | 0 slaves.
[OK] 2000000 keys in 4 masters.
122.07 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### REMOVING 172.31.5.120:6379 FROM CLUSTER ###
[0m
> redis-cli --cluster del-node 172.31.5.120:6379 9ca261e70d34be19b2cda07304fb0a02fcec6a94
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 499943 keys | 4096 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 500049 keys | 4096 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 500006 keys | 4096 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 500002 keys | 4096 slots | 0 slaves.
[OK] 2000000 keys in 4 masters.
122.07 keys per slot on average.
 
total slots: 16384
Removing node 9ca261e70d34be19b2cda07304fb0a02fcec6a94 from cluster 172.31.5.120:6379
Sending CLUSTER FORGET messages to the cluster...
Sending CLUSTER RESET SOFT to the deleted node.
[33m### REBALANCING CLUSTER ON 172.31.5.192:6379 ###
[0m
> redis-cli --cluster rebalance 172.31.5.192:6379 --cluster-use-empty-masters | grep -i Rebalancing
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 499943 keys | 4096 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 500049 keys | 4096 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 500006 keys | 4096 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 500002 keys | 4096 slots | 0 slaves.
[OK] 2000000 keys in 4 masters.
122.07 keys per slot on average.
 
total slots: 16384
*** No rebalancing needed! All nodes are within the 2.00% threshold.


waiting... 65 64 63 62 61 60 59 58 57 56 55 54 53 52 51 50 49 48 47 46 45 44 43 42 41 40 39 38 37 36 35 34 33 32 31 30 29 28 27 26 25 24 23 22 21 20 19 18 17 16 15 14 13 12 11 10 9 8 7 6 5 4 3 2 1 



[34m******* resize , 4 completed ******* [0m 

------------------------------------------------------------------

[34m******* write , 500000 *******[0m

[33m### WRITING 500000 KEYS ###
[0m
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 624867 keys | 4096 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 625046 keys | 4096 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 625042 keys | 4096 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 625045 keys | 4096 slots | 0 slaves.
[OK] 2500000 keys in 4 masters.
152.59 keys per slot on average.
 
total slots: 16384
0.5M keys written successfully

[34m******* write , 500000 completed ******* [0m 

------------------------------------------------------------------

[34m******* resize , 8 *******[0m

{ clusterSize: 4 }
[33m### ADDING 172.31.5.120:6379 NODE TO CLUSTER ###
[0m
> redis-cli --cluster add-node 172.31.5.120:6379 172.31.5.192:6379 | awk '{ gsub(/[[0-9;]*m/, ""); print }'
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 624867 keys | 4096 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 625046 keys | 4096 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 625042 keys | 4096 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 625045 keys | 4096 slots | 0 slaves.
[OK] 2500000 keys in 5 masters.
152.59 keys per slot on average.
 
total slots: 16384
node added successfully
waiting... 2 1 


[33m### ADDING 172.31.5.69:6379 NODE TO CLUSTER ###
[0m
> redis-cli --cluster add-node 172.31.5.69:6379 172.31.5.192:6379 | awk '{ gsub(/[[0-9;]*m/, ""); print }'
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 624867 keys | 4096 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 625046 keys | 4096 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 625042 keys | 4096 slots | 0 slaves.
172.31.5.69:6379 (c767ab28...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 625045 keys | 4096 slots | 0 slaves.
[OK] 2500000 keys in 6 masters.
152.59 keys per slot on average.
 
total slots: 16384
node added successfully
waiting... 2 1 


[33m### ADDING 172.31.5.56:6379 NODE TO CLUSTER ###
[0m
> redis-cli --cluster add-node 172.31.5.56:6379 172.31.5.192:6379 | awk '{ gsub(/[[0-9;]*m/, ""); print }'
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 624867 keys | 4096 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 625046 keys | 4096 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 625042 keys | 4096 slots | 0 slaves.
172.31.5.56:6379 (234e48dd...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.69:6379 (c767ab28...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 625045 keys | 4096 slots | 0 slaves.
[OK] 2500000 keys in 7 masters.
152.59 keys per slot on average.
 
total slots: 16384
node added successfully
waiting... 2 1 


[33m### ADDING 172.31.5.226:6379 NODE TO CLUSTER ###
[0m
> redis-cli --cluster add-node 172.31.5.226:6379 172.31.5.192:6379 | awk '{ gsub(/[[0-9;]*m/, ""); print }'
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 624867 keys | 4096 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 625046 keys | 4096 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 625042 keys | 4096 slots | 0 slaves.
172.31.5.226:6379 (1115b088...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.56:6379 (234e48dd...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.69:6379 (c767ab28...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 625045 keys | 4096 slots | 0 slaves.
[OK] 2500000 keys in 8 masters.
152.59 keys per slot on average.
 
total slots: 16384
node added successfully
waiting... 2 1 


waiting... 10 9 8 7 6 5 4 3 2 1 


[33m### REBALANCING CLUSTER ON 172.31.5.120:6379 ###
[0m
> redis-cli --cluster rebalance 172.31.5.120:6379 --cluster-use-empty-masters | grep -i Rebalancing
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 312607 keys | 2048 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 312604 keys | 2048 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 312516 keys | 2048 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 312425 keys | 2048 slots | 0 slaves.
172.31.5.226:6379 (1115b088...) -> 312260 keys | 2048 slots | 0 slaves.
172.31.5.56:6379 (234e48dd...) -> 312530 keys | 2048 slots | 0 slaves.
172.31.5.69:6379 (c767ab28...) -> 312617 keys | 2048 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 312441 keys | 2048 slots | 0 slaves.
[OK] 2500000 keys in 8 masters.
152.59 keys per slot on average.
 
total slots: 16384
>>> Rebalancing across 8 nodes. Total weight = 8.00



[34m******* resize , 8 completed ******* [0m 

------------------------------------------------------------------

[34m******* write , 500000 *******[0m

[33m### WRITING 500000 KEYS ###
[0m
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 375198 keys | 2048 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 375262 keys | 2048 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 375023 keys | 2048 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 374751 keys | 2048 slots | 0 slaves.
172.31.5.226:6379 (1115b088...) -> 374404 keys | 2048 slots | 0 slaves.
172.31.5.56:6379 (234e48dd...) -> 375035 keys | 2048 slots | 0 slaves.
172.31.5.69:6379 (c767ab28...) -> 375338 keys | 2048 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 374989 keys | 2048 slots | 0 slaves.
[OK] 3000000 keys in 8 masters.
183.11 keys per slot on average.
 
total slots: 16384
0.5M keys written successfully

[34m******* write , 500000 completed ******* [0m 

------------------------------------------------------------------

[34m******* resize , 5 *******[0m

{ clusterSize: 8 }
[33m### REBALANCING CLUSTER ON 172.31.5.226:6379 ###
[0m
> redis-cli --cluster rebalance 172.31.5.226:6379 --cluster-use-empty-masters | grep -i Rebalancing
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 375198 keys | 2048 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 375262 keys | 2048 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 375023 keys | 2048 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 374751 keys | 2048 slots | 0 slaves.
172.31.5.226:6379 (1115b088...) -> 374404 keys | 2048 slots | 0 slaves.
172.31.5.56:6379 (234e48dd...) -> 375035 keys | 2048 slots | 0 slaves.
172.31.5.69:6379 (c767ab28...) -> 375338 keys | 2048 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 374989 keys | 2048 slots | 0 slaves.
[OK] 3000000 keys in 8 masters.
183.11 keys per slot on average.
 
total slots: 16384
*** No rebalancing needed! All nodes are within the 2.00% threshold.


{ distribution: [ 410, 410, 410, 409, 409 ] }
[33m### RESHARDING FROM 172.31.5.226 TO 172.31.5.192 ###
[0m
{ reshardFrom: '172.31.5.226', reshardTo: '172.31.5.192', slots: 410 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 450230 keys | 2458 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 375262 keys | 2048 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 375023 keys | 2048 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 374751 keys | 2048 slots | 0 slaves.
172.31.5.226:6379 (1115b088...) -> 299372 keys | 1638 slots | 0 slaves.
172.31.5.56:6379 (234e48dd...) -> 375035 keys | 2048 slots | 0 slaves.
172.31.5.69:6379 (c767ab28...) -> 375338 keys | 2048 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 374989 keys | 2048 slots | 0 slaves.
[OK] 3000000 keys in 8 masters.
183.11 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.226 TO 172.31.5.72 ###
[0m
{ reshardFrom: '172.31.5.226', reshardTo: '172.31.5.72', slots: 410 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 450230 keys | 2458 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 375262 keys | 2048 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 375023 keys | 2048 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 449676 keys | 2458 slots | 0 slaves.
172.31.5.226:6379 (1115b088...) -> 224447 keys | 1228 slots | 0 slaves.
172.31.5.56:6379 (234e48dd...) -> 375035 keys | 2048 slots | 0 slaves.
172.31.5.69:6379 (c767ab28...) -> 375338 keys | 2048 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 374989 keys | 2048 slots | 0 slaves.
[OK] 3000000 keys in 8 masters.
183.11 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.226 TO 172.31.5.142 ###
[0m
{ reshardFrom: '172.31.5.226', reshardTo: '172.31.5.142', slots: 410 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 450230 keys | 2458 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 375262 keys | 2048 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 449969 keys | 2458 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 449676 keys | 2458 slots | 0 slaves.
172.31.5.226:6379 (1115b088...) -> 149501 keys | 818 slots | 0 slaves.
172.31.5.56:6379 (234e48dd...) -> 375035 keys | 2048 slots | 0 slaves.
172.31.5.69:6379 (c767ab28...) -> 375338 keys | 2048 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 374989 keys | 2048 slots | 0 slaves.
[OK] 3000000 keys in 8 masters.
183.11 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.226 TO 172.31.5.9 ###
[0m
{ reshardFrom: '172.31.5.226', reshardTo: '172.31.5.9', slots: 409 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 450230 keys | 2458 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 375262 keys | 2048 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 449969 keys | 2458 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 449676 keys | 2458 slots | 0 slaves.
172.31.5.226:6379 (1115b088...) -> 74719 keys | 409 slots | 0 slaves.
172.31.5.56:6379 (234e48dd...) -> 375035 keys | 2048 slots | 0 slaves.
172.31.5.69:6379 (c767ab28...) -> 375338 keys | 2048 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 449771 keys | 2457 slots | 0 slaves.
[OK] 3000000 keys in 8 masters.
183.11 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.226 TO 172.31.5.120 ###
[0m
{ reshardFrom: '172.31.5.226', reshardTo: '172.31.5.120', slots: 409 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 450230 keys | 2458 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 449981 keys | 2457 slots | 1 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 449969 keys | 2458 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 449676 keys | 2458 slots | 0 slaves.
172.31.5.56:6379 (234e48dd...) -> 375035 keys | 2048 slots | 0 slaves.
172.31.5.69:6379 (c767ab28...) -> 375338 keys | 2048 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 449771 keys | 2457 slots | 0 slaves.
[OK] 3000000 keys in 7 masters.
183.11 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### REMOVING 172.31.5.226:6379 FROM CLUSTER ###
[0m
> redis-cli --cluster del-node 172.31.5.226:6379 1115b08851797fa0d86d6dcf38b8d86974fdc686
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 450230 keys | 2458 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 449981 keys | 2457 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 449969 keys | 2458 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 449676 keys | 2458 slots | 0 slaves.
172.31.5.56:6379 (234e48dd...) -> 375035 keys | 2048 slots | 0 slaves.
172.31.5.69:6379 (c767ab28...) -> 375338 keys | 2048 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 449771 keys | 2457 slots | 0 slaves.
[OK] 3000000 keys in 7 masters.
183.11 keys per slot on average.
 
total slots: 16384
Removing node 1115b08851797fa0d86d6dcf38b8d86974fdc686 from cluster 172.31.5.226:6379
Sending CLUSTER FORGET messages to the cluster...
Sending CLUSTER RESET SOFT to the deleted node.
{ distribution: [ 410, 410, 410, 409, 409 ] }
[33m### RESHARDING FROM 172.31.5.56 TO 172.31.5.72 ###
[0m
{ reshardFrom: '172.31.5.56', reshardTo: '172.31.5.72', slots: 410 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 450230 keys | 2458 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 449981 keys | 2457 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 449969 keys | 2458 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 524663 keys | 2868 slots | 0 slaves.
172.31.5.56:6379 (234e48dd...) -> 300048 keys | 1638 slots | 0 slaves.
172.31.5.69:6379 (c767ab28...) -> 375338 keys | 2048 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 449771 keys | 2457 slots | 0 slaves.
[OK] 3000000 keys in 7 masters.
183.11 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.56 TO 172.31.5.142 ###
[0m
{ reshardFrom: '172.31.5.56', reshardTo: '172.31.5.142', slots: 410 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 450230 keys | 2458 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 449981 keys | 2457 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 525121 keys | 2868 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 524663 keys | 2868 slots | 0 slaves.
172.31.5.56:6379 (234e48dd...) -> 224896 keys | 1228 slots | 0 slaves.
172.31.5.69:6379 (c767ab28...) -> 375338 keys | 2048 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 449771 keys | 2457 slots | 0 slaves.
[OK] 3000000 keys in 7 masters.
183.11 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.56 TO 172.31.5.9 ###
[0m
{ reshardFrom: '172.31.5.56', reshardTo: '172.31.5.9', slots: 410 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 450230 keys | 2458 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 449981 keys | 2457 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 525121 keys | 2868 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 524663 keys | 2868 slots | 0 slaves.
172.31.5.56:6379 (234e48dd...) -> 149918 keys | 818 slots | 0 slaves.
172.31.5.69:6379 (c767ab28...) -> 375338 keys | 2048 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 524749 keys | 2867 slots | 0 slaves.
[OK] 3000000 keys in 7 masters.
183.11 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.56 TO 172.31.5.120 ###
[0m
{ reshardFrom: '172.31.5.56', reshardTo: '172.31.5.120', slots: 409 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 450230 keys | 2458 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 524860 keys | 2866 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 525121 keys | 2868 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 524663 keys | 2868 slots | 0 slaves.
172.31.5.56:6379 (234e48dd...) -> 75039 keys | 409 slots | 0 slaves.
172.31.5.69:6379 (c767ab28...) -> 375338 keys | 2048 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 524749 keys | 2867 slots | 0 slaves.
[OK] 3000000 keys in 7 masters.
183.11 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.56 TO 172.31.5.192 ###
[0m
{ reshardFrom: '172.31.5.56', reshardTo: '172.31.5.192', slots: 409 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 525269 keys | 2867 slots | 1 slaves.
172.31.5.120:6379 (9ca261e7...) -> 524860 keys | 2866 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 525121 keys | 2868 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 524663 keys | 2868 slots | 0 slaves.
172.31.5.69:6379 (c767ab28...) -> 375338 keys | 2048 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 524749 keys | 2867 slots | 0 slaves.
[OK] 3000000 keys in 6 masters.
183.11 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### REMOVING 172.31.5.56:6379 FROM CLUSTER ###
[0m
> redis-cli --cluster del-node 172.31.5.56:6379 234e48dd8ec12ce323c6ae15e58211ab6cff76c4
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 525269 keys | 2867 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 524860 keys | 2866 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 525121 keys | 2868 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 524663 keys | 2868 slots | 0 slaves.
172.31.5.69:6379 (c767ab28...) -> 375338 keys | 2048 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 524749 keys | 2867 slots | 0 slaves.
[OK] 3000000 keys in 6 masters.
183.11 keys per slot on average.
 
total slots: 16384
Removing node 234e48dd8ec12ce323c6ae15e58211ab6cff76c4 from cluster 172.31.5.56:6379
Sending CLUSTER FORGET messages to the cluster...
Sending CLUSTER RESET SOFT to the deleted node.
{ distribution: [ 410, 410, 410, 409, 409 ] }
[33m### RESHARDING FROM 172.31.5.69 TO 172.31.5.142 ###
[0m
{ reshardFrom: '172.31.5.69', reshardTo: '172.31.5.142', slots: 410 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 525269 keys | 2867 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 524860 keys | 2866 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 600126 keys | 3278 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 524663 keys | 2868 slots | 0 slaves.
172.31.5.69:6379 (c767ab28...) -> 300333 keys | 1638 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 524749 keys | 2867 slots | 0 slaves.
[OK] 3000000 keys in 6 masters.
183.11 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.69 TO 172.31.5.9 ###
[0m
{ reshardFrom: '172.31.5.69', reshardTo: '172.31.5.9', slots: 410 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 525269 keys | 2867 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 524860 keys | 2866 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 600126 keys | 3278 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 524663 keys | 2868 slots | 0 slaves.
172.31.5.69:6379 (c767ab28...) -> 225220 keys | 1228 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 599862 keys | 3277 slots | 0 slaves.
[OK] 3000000 keys in 6 masters.
183.11 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.69 TO 172.31.5.120 ###
[0m
{ reshardFrom: '172.31.5.69', reshardTo: '172.31.5.120', slots: 410 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 525269 keys | 2867 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 600129 keys | 3276 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 600126 keys | 3278 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 524663 keys | 2868 slots | 0 slaves.
172.31.5.69:6379 (c767ab28...) -> 149951 keys | 818 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 599862 keys | 3277 slots | 0 slaves.
[OK] 3000000 keys in 6 masters.
183.11 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.69 TO 172.31.5.192 ###
[0m
{ reshardFrom: '172.31.5.69', reshardTo: '172.31.5.192', slots: 409 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 600126 keys | 3276 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 600129 keys | 3276 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 600126 keys | 3278 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 524663 keys | 2868 slots | 0 slaves.
172.31.5.69:6379 (c767ab28...) -> 75094 keys | 409 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 599862 keys | 3277 slots | 0 slaves.
[OK] 3000000 keys in 6 masters.
183.11 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.69 TO 172.31.5.72 ###
[0m
{ reshardFrom: '172.31.5.69', reshardTo: '172.31.5.72', slots: 409 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 600126 keys | 3276 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 600129 keys | 3276 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 600126 keys | 3278 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 599757 keys | 3277 slots | 1 slaves.
172.31.5.9:6379 (a4f97e81...) -> 599862 keys | 3277 slots | 0 slaves.
[OK] 3000000 keys in 5 masters.
183.11 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### REMOVING 172.31.5.69:6379 FROM CLUSTER ###
[0m
> redis-cli --cluster del-node 172.31.5.69:6379 c767ab28fe1051fc42e029246c44c11abb50fc85
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 600126 keys | 3276 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 600129 keys | 3276 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 600126 keys | 3278 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 599757 keys | 3277 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 599862 keys | 3277 slots | 0 slaves.
[OK] 3000000 keys in 5 masters.
183.11 keys per slot on average.
 
total slots: 16384
Removing node c767ab28fe1051fc42e029246c44c11abb50fc85 from cluster 172.31.5.69:6379
Sending CLUSTER FORGET messages to the cluster...
Sending CLUSTER RESET SOFT to the deleted node.
[33m### REBALANCING CLUSTER ON 172.31.5.192:6379 ###
[0m
> redis-cli --cluster rebalance 172.31.5.192:6379 --cluster-use-empty-masters | grep -i Rebalancing
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 600126 keys | 3276 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 600129 keys | 3276 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 600126 keys | 3278 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 599757 keys | 3277 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 599862 keys | 3277 slots | 0 slaves.
[OK] 3000000 keys in 5 masters.
183.11 keys per slot on average.
 
total slots: 16384
*** No rebalancing needed! All nodes are within the 2.00% threshold.


waiting... 65 64 63 62 61 60 59 58 57 56 55 54 53 52 51 50 49 48 47 46 45 44 43 42 41 40 39 38 37 36 35 34 33 32 31 30 29 28 27 26 25 24 23 22 21 20 19 18 17 16 15 14 13 12 11 10 9 8 7 6 5 4 3 2 1 



[34m******* resize , 5 completed ******* [0m 

------------------------------------------------------------------

[34m******* write , 500000 *******[0m

[33m### WRITING 500000 KEYS ###
[0m
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 699984 keys | 3276 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 699914 keys | 3276 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 700276 keys | 3278 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 699935 keys | 3277 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 699891 keys | 3277 slots | 0 slaves.
[OK] 3500000 keys in 5 masters.
213.62 keys per slot on average.
 
total slots: 16384
0.5M keys written successfully

[34m******* write , 500000 completed ******* [0m 

------------------------------------------------------------------

[34m******* resize , 8 *******[0m

{ clusterSize: 5 }
[33m### ADDING 172.31.5.69:6379 NODE TO CLUSTER ###
[0m
> redis-cli --cluster add-node 172.31.5.69:6379 172.31.5.192:6379 | awk '{ gsub(/[[0-9;]*m/, ""); print }'
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 699984 keys | 3276 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 699914 keys | 3276 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 700276 keys | 3278 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 699935 keys | 3277 slots | 0 slaves.
172.31.5.69:6379 (c767ab28...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 699891 keys | 3277 slots | 0 slaves.
[OK] 3500000 keys in 6 masters.
213.62 keys per slot on average.
 
total slots: 16384
node added successfully
waiting... 2 1 


[33m### ADDING 172.31.5.56:6379 NODE TO CLUSTER ###
[0m
> redis-cli --cluster add-node 172.31.5.56:6379 172.31.5.192:6379 | awk '{ gsub(/[[0-9;]*m/, ""); print }'
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 699984 keys | 3276 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 699914 keys | 3276 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 700276 keys | 3278 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 699935 keys | 3277 slots | 0 slaves.
172.31.5.56:6379 (234e48dd...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.69:6379 (c767ab28...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 699891 keys | 3277 slots | 0 slaves.
[OK] 3500000 keys in 7 masters.
213.62 keys per slot on average.
 
total slots: 16384
node added successfully
waiting... 2 1 


[33m### ADDING 172.31.5.226:6379 NODE TO CLUSTER ###
[0m
> redis-cli --cluster add-node 172.31.5.226:6379 172.31.5.192:6379 | awk '{ gsub(/[[0-9;]*m/, ""); print }'
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 699984 keys | 3276 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 699914 keys | 3276 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 700276 keys | 3278 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 699935 keys | 3277 slots | 0 slaves.
172.31.5.226:6379 (1115b088...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.56:6379 (234e48dd...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.69:6379 (c767ab28...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 699891 keys | 3277 slots | 0 slaves.
[OK] 3500000 keys in 8 masters.
213.62 keys per slot on average.
 
total slots: 16384
node added successfully
waiting... 2 1 


waiting... 10 9 8 7 6 5 4 3 2 1 


[33m### REBALANCING CLUSTER ON 172.31.5.69:6379 ###
[0m
> redis-cli --cluster rebalance 172.31.5.69:6379 --cluster-use-empty-masters | grep -i Rebalancing
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 437600 keys | 2048 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 437521 keys | 2048 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 437544 keys | 2048 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 437409 keys | 2048 slots | 0 slaves.
172.31.5.226:6379 (1115b088...) -> 437542 keys | 2048 slots | 0 slaves.
172.31.5.56:6379 (234e48dd...) -> 437578 keys | 2048 slots | 0 slaves.
172.31.5.69:6379 (c767ab28...) -> 437432 keys | 2048 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 437374 keys | 2048 slots | 0 slaves.
[OK] 3500000 keys in 8 masters.
213.62 keys per slot on average.
 
total slots: 16384
>>> Rebalancing across 8 nodes. Total weight = 8.00



[34m******* resize , 8 completed ******* [0m 

------------------------------------------------------------------

[34m******* write , 500000 *******[0m

[33m### WRITING 500000 KEYS ###
[0m
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 500172 keys | 2048 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 500041 keys | 2048 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 500064 keys | 2048 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 499837 keys | 2048 slots | 0 slaves.
172.31.5.226:6379 (1115b088...) -> 500052 keys | 2048 slots | 0 slaves.
172.31.5.56:6379 (234e48dd...) -> 500136 keys | 2048 slots | 0 slaves.
172.31.5.69:6379 (c767ab28...) -> 499862 keys | 2048 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 499836 keys | 2048 slots | 0 slaves.
[OK] 4000000 keys in 8 masters.
244.14 keys per slot on average.
 
total slots: 16384
0.5M keys written successfully

[34m******* write , 500000 completed ******* [0m 

------------------------------------------------------------------

[34m******* resize , 6 *******[0m

{ clusterSize: 8 }
[33m### REBALANCING CLUSTER ON 172.31.5.226:6379 ###
[0m
> redis-cli --cluster rebalance 172.31.5.226:6379 --cluster-use-empty-masters | grep -i Rebalancing
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 500172 keys | 2048 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 500041 keys | 2048 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 500064 keys | 2048 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 499837 keys | 2048 slots | 0 slaves.
172.31.5.226:6379 (1115b088...) -> 500052 keys | 2048 slots | 0 slaves.
172.31.5.56:6379 (234e48dd...) -> 500136 keys | 2048 slots | 0 slaves.
172.31.5.69:6379 (c767ab28...) -> 499862 keys | 2048 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 499836 keys | 2048 slots | 0 slaves.
[OK] 4000000 keys in 8 masters.
244.14 keys per slot on average.
 
total slots: 16384
*** No rebalancing needed! All nodes are within the 2.00% threshold.


{ distribution: [ 342, 342, 341, 341, 341, 341 ] }
[33m### RESHARDING FROM 172.31.5.226 TO 172.31.5.192 ###
[0m
{ reshardFrom: '172.31.5.226', reshardTo: '172.31.5.192', slots: 342 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 583665 keys | 2390 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 500041 keys | 2048 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 500064 keys | 2048 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 499837 keys | 2048 slots | 0 slaves.
172.31.5.226:6379 (1115b088...) -> 416559 keys | 1706 slots | 0 slaves.
172.31.5.56:6379 (234e48dd...) -> 500136 keys | 2048 slots | 0 slaves.
172.31.5.69:6379 (c767ab28...) -> 499862 keys | 2048 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 499836 keys | 2048 slots | 0 slaves.
[OK] 4000000 keys in 8 masters.
244.14 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.226 TO 172.31.5.72 ###
[0m
{ reshardFrom: '172.31.5.226', reshardTo: '172.31.5.72', slots: 342 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 583665 keys | 2390 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 500041 keys | 2048 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 500064 keys | 2048 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 583321 keys | 2390 slots | 0 slaves.
172.31.5.226:6379 (1115b088...) -> 333075 keys | 1364 slots | 0 slaves.
172.31.5.56:6379 (234e48dd...) -> 500136 keys | 2048 slots | 0 slaves.
172.31.5.69:6379 (c767ab28...) -> 499862 keys | 2048 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 499836 keys | 2048 slots | 0 slaves.
[OK] 4000000 keys in 8 masters.
244.14 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.226 TO 172.31.5.142 ###
[0m
{ reshardFrom: '172.31.5.226', reshardTo: '172.31.5.142', slots: 341 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 583665 keys | 2390 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 500041 keys | 2048 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 583299 keys | 2389 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 583321 keys | 2390 slots | 0 slaves.
172.31.5.226:6379 (1115b088...) -> 249840 keys | 1023 slots | 0 slaves.
172.31.5.56:6379 (234e48dd...) -> 500136 keys | 2048 slots | 0 slaves.
172.31.5.69:6379 (c767ab28...) -> 499862 keys | 2048 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 499836 keys | 2048 slots | 0 slaves.
[OK] 4000000 keys in 8 masters.
244.14 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.226 TO 172.31.5.9 ###
[0m
{ reshardFrom: '172.31.5.226', reshardTo: '172.31.5.9', slots: 341 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 583665 keys | 2390 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 500041 keys | 2048 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 583299 keys | 2389 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 583321 keys | 2390 slots | 0 slaves.
172.31.5.226:6379 (1115b088...) -> 166664 keys | 682 slots | 0 slaves.
172.31.5.56:6379 (234e48dd...) -> 500136 keys | 2048 slots | 0 slaves.
172.31.5.69:6379 (c767ab28...) -> 499862 keys | 2048 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 583012 keys | 2389 slots | 0 slaves.
[OK] 4000000 keys in 8 masters.
244.14 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.226 TO 172.31.5.120 ###
[0m
{ reshardFrom: '172.31.5.226', reshardTo: '172.31.5.120', slots: 341 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 583665 keys | 2390 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 583301 keys | 2389 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 583299 keys | 2389 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 583321 keys | 2390 slots | 0 slaves.
172.31.5.226:6379 (1115b088...) -> 83404 keys | 341 slots | 0 slaves.
172.31.5.56:6379 (234e48dd...) -> 500136 keys | 2048 slots | 0 slaves.
172.31.5.69:6379 (c767ab28...) -> 499862 keys | 2048 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 583012 keys | 2389 slots | 0 slaves.
[OK] 4000000 keys in 8 masters.
244.14 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.226 TO 172.31.5.69 ###
[0m
{ reshardFrom: '172.31.5.226', reshardTo: '172.31.5.69', slots: 341 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 583665 keys | 2390 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 583301 keys | 2389 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 583299 keys | 2389 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 583321 keys | 2390 slots | 0 slaves.
172.31.5.56:6379 (234e48dd...) -> 500136 keys | 2048 slots | 0 slaves.
172.31.5.69:6379 (c767ab28...) -> 583266 keys | 2389 slots | 1 slaves.
172.31.5.9:6379 (a4f97e81...) -> 583012 keys | 2389 slots | 0 slaves.
[OK] 4000000 keys in 7 masters.
244.14 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### REMOVING 172.31.5.226:6379 FROM CLUSTER ###
[0m
> redis-cli --cluster del-node 172.31.5.226:6379 1115b08851797fa0d86d6dcf38b8d86974fdc686
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 583665 keys | 2390 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 583301 keys | 2389 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 583299 keys | 2389 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 583321 keys | 2390 slots | 0 slaves.
172.31.5.56:6379 (234e48dd...) -> 500136 keys | 2048 slots | 0 slaves.
172.31.5.69:6379 (c767ab28...) -> 583266 keys | 2389 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 583012 keys | 2389 slots | 0 slaves.
[OK] 4000000 keys in 7 masters.
244.14 keys per slot on average.
 
total slots: 16384
Removing node 1115b08851797fa0d86d6dcf38b8d86974fdc686 from cluster 172.31.5.226:6379
Sending CLUSTER FORGET messages to the cluster...
Sending CLUSTER RESET SOFT to the deleted node.
{ distribution: [ 342, 342, 341, 341, 341, 341 ] }
[33m### RESHARDING FROM 172.31.5.56 TO 172.31.5.72 ###
[0m
{ reshardFrom: '172.31.5.56', reshardTo: '172.31.5.72', slots: 342 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 583665 keys | 2390 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 583301 keys | 2389 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 583299 keys | 2389 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 666850 keys | 2732 slots | 0 slaves.
172.31.5.56:6379 (234e48dd...) -> 416607 keys | 1706 slots | 0 slaves.
172.31.5.69:6379 (c767ab28...) -> 583266 keys | 2389 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 583012 keys | 2389 slots | 0 slaves.
[OK] 4000000 keys in 7 masters.
244.14 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.56 TO 172.31.5.142 ###
[0m
{ reshardFrom: '172.31.5.56', reshardTo: '172.31.5.142', slots: 342 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 583665 keys | 2390 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 583301 keys | 2389 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 666707 keys | 2731 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 666850 keys | 2732 slots | 0 slaves.
172.31.5.56:6379 (234e48dd...) -> 333199 keys | 1364 slots | 0 slaves.
172.31.5.69:6379 (c767ab28...) -> 583266 keys | 2389 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 583012 keys | 2389 slots | 0 slaves.
[OK] 4000000 keys in 7 masters.
244.14 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.56 TO 172.31.5.9 ###
[0m
{ reshardFrom: '172.31.5.56', reshardTo: '172.31.5.9', slots: 341 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 583665 keys | 2390 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 583301 keys | 2389 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 666707 keys | 2731 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 666850 keys | 2732 slots | 0 slaves.
172.31.5.56:6379 (234e48dd...) -> 249784 keys | 1023 slots | 0 slaves.
172.31.5.69:6379 (c767ab28...) -> 583266 keys | 2389 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 666427 keys | 2730 slots | 0 slaves.
[OK] 4000000 keys in 7 masters.
244.14 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.56 TO 172.31.5.120 ###
[0m
{ reshardFrom: '172.31.5.56', reshardTo: '172.31.5.120', slots: 341 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 583665 keys | 2390 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 666582 keys | 2730 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 666707 keys | 2731 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 666850 keys | 2732 slots | 0 slaves.
172.31.5.56:6379 (234e48dd...) -> 166503 keys | 682 slots | 0 slaves.
172.31.5.69:6379 (c767ab28...) -> 583266 keys | 2389 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 666427 keys | 2730 slots | 0 slaves.
[OK] 4000000 keys in 7 masters.
244.14 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.56 TO 172.31.5.69 ###
[0m
{ reshardFrom: '172.31.5.56', reshardTo: '172.31.5.69', slots: 341 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 583665 keys | 2390 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 666582 keys | 2730 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 666707 keys | 2731 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 666850 keys | 2732 slots | 0 slaves.
172.31.5.56:6379 (234e48dd...) -> 83271 keys | 341 slots | 0 slaves.
172.31.5.69:6379 (c767ab28...) -> 666498 keys | 2730 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 666427 keys | 2730 slots | 0 slaves.
[OK] 4000000 keys in 7 masters.
244.14 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.56 TO 172.31.5.192 ###
[0m
{ reshardFrom: '172.31.5.56', reshardTo: '172.31.5.192', slots: 341 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 666936 keys | 2731 slots | 1 slaves.
172.31.5.120:6379 (9ca261e7...) -> 666582 keys | 2730 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 666707 keys | 2731 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 666850 keys | 2732 slots | 0 slaves.
172.31.5.69:6379 (c767ab28...) -> 666498 keys | 2730 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 666427 keys | 2730 slots | 0 slaves.
[OK] 4000000 keys in 6 masters.
244.14 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### REMOVING 172.31.5.56:6379 FROM CLUSTER ###
[0m
> redis-cli --cluster del-node 172.31.5.56:6379 234e48dd8ec12ce323c6ae15e58211ab6cff76c4
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 666936 keys | 2731 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 666582 keys | 2730 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 666707 keys | 2731 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 666850 keys | 2732 slots | 0 slaves.
172.31.5.69:6379 (c767ab28...) -> 666498 keys | 2730 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 666427 keys | 2730 slots | 0 slaves.
[OK] 4000000 keys in 6 masters.
244.14 keys per slot on average.
 
total slots: 16384
Removing node 234e48dd8ec12ce323c6ae15e58211ab6cff76c4 from cluster 172.31.5.56:6379
Sending CLUSTER FORGET messages to the cluster...
Sending CLUSTER RESET SOFT to the deleted node.
[33m### REBALANCING CLUSTER ON 172.31.5.192:6379 ###
[0m
> redis-cli --cluster rebalance 172.31.5.192:6379 --cluster-use-empty-masters | grep -i Rebalancing
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 666936 keys | 2731 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 666582 keys | 2730 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 666707 keys | 2731 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 666850 keys | 2732 slots | 0 slaves.
172.31.5.69:6379 (c767ab28...) -> 666498 keys | 2730 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 666427 keys | 2730 slots | 0 slaves.
[OK] 4000000 keys in 6 masters.
244.14 keys per slot on average.
 
total slots: 16384
*** No rebalancing needed! All nodes are within the 2.00% threshold.


waiting... 65 64 63 62 61 60 59 58 57 56 55 54 53 52 51 50 49 48 47 46 45 44 43 42 41 40 39 38 37 36 35 34 33 32 31 30 29 28 27 26 25 24 23 22 21 20 19 18 17 16 15 14 13 12 11 10 9 8 7 6 5 4 3 2 1 



[34m******* resize , 6 completed ******* [0m 

------------------------------------------------------------------

[34m******* write , 500000 *******[0m

[33m### WRITING 500000 KEYS ###
[0m
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 750389 keys | 2731 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 749974 keys | 2730 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 750081 keys | 2731 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 750030 keys | 2732 slots | 0 slaves.
172.31.5.69:6379 (c767ab28...) -> 749852 keys | 2730 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 749674 keys | 2730 slots | 0 slaves.
[OK] 4500000 keys in 6 masters.
274.66 keys per slot on average.
 
total slots: 16384
0.5M keys written successfully

[34m******* write , 500000 completed ******* [0m 

------------------------------------------------------------------

[34m******* resize , 8 *******[0m

{ clusterSize: 6 }
[33m### ADDING 172.31.5.56:6379 NODE TO CLUSTER ###
[0m
> redis-cli --cluster add-node 172.31.5.56:6379 172.31.5.192:6379 | awk '{ gsub(/[[0-9;]*m/, ""); print }'
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 750389 keys | 2731 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 749974 keys | 2730 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 750081 keys | 2731 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 750030 keys | 2732 slots | 0 slaves.
172.31.5.56:6379 (234e48dd...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.69:6379 (c767ab28...) -> 749852 keys | 2730 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 749674 keys | 2730 slots | 0 slaves.
[OK] 4500000 keys in 7 masters.
274.66 keys per slot on average.
 
total slots: 16384
node added successfully
waiting... 2 1 


[33m### ADDING 172.31.5.226:6379 NODE TO CLUSTER ###
[0m
> redis-cli --cluster add-node 172.31.5.226:6379 172.31.5.192:6379 | awk '{ gsub(/[[0-9;]*m/, ""); print }'
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 750389 keys | 2731 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 749974 keys | 2730 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 750081 keys | 2731 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 750030 keys | 2732 slots | 0 slaves.
172.31.5.226:6379 (1115b088...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.56:6379 (234e48dd...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.69:6379 (c767ab28...) -> 749852 keys | 2730 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 749674 keys | 2730 slots | 0 slaves.
[OK] 4500000 keys in 8 masters.
274.66 keys per slot on average.
 
total slots: 16384
node added successfully
waiting... 2 1 


waiting... 10 9 8 7 6 5 4 3 2 1 


[33m### REBALANCING CLUSTER ON 172.31.5.56:6379 ###
[0m
> redis-cli --cluster rebalance 172.31.5.56:6379 --cluster-use-empty-masters | grep -i Rebalancing
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 562803 keys | 2048 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 562670 keys | 2048 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 562591 keys | 2048 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 562149 keys | 2048 slots | 0 slaves.
172.31.5.226:6379 (1115b088...) -> 562543 keys | 2048 slots | 0 slaves.
172.31.5.56:6379 (234e48dd...) -> 562393 keys | 2048 slots | 0 slaves.
172.31.5.69:6379 (c767ab28...) -> 562662 keys | 2048 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 562189 keys | 2048 slots | 0 slaves.
[OK] 4500000 keys in 8 masters.
274.66 keys per slot on average.
 
total slots: 16384
>>> Rebalancing across 8 nodes. Total weight = 8.00



[34m******* resize , 8 completed ******* [0m 

------------------------------------------------------------------

[34m******* write , 500000 *******[0m

[33m### WRITING 500000 KEYS ###
[0m
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 625272 keys | 2048 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 625129 keys | 2048 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 625078 keys | 2048 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 624657 keys | 2048 slots | 0 slaves.
172.31.5.226:6379 (1115b088...) -> 624971 keys | 2048 slots | 0 slaves.
172.31.5.56:6379 (234e48dd...) -> 624881 keys | 2048 slots | 0 slaves.
172.31.5.69:6379 (c767ab28...) -> 625213 keys | 2048 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 624799 keys | 2048 slots | 0 slaves.
[OK] 5000000 keys in 8 masters.
305.18 keys per slot on average.
 
total slots: 16384
0.5M keys written successfully

[34m******* write , 500000 completed ******* [0m 

------------------------------------------------------------------

[34m******* resize , 7 *******[0m

{ clusterSize: 8 }
[33m### REBALANCING CLUSTER ON 172.31.5.226:6379 ###
[0m
> redis-cli --cluster rebalance 172.31.5.226:6379 --cluster-use-empty-masters | grep -i Rebalancing
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 625272 keys | 2048 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 625129 keys | 2048 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 625078 keys | 2048 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 624657 keys | 2048 slots | 0 slaves.
172.31.5.226:6379 (1115b088...) -> 624971 keys | 2048 slots | 0 slaves.
172.31.5.56:6379 (234e48dd...) -> 624881 keys | 2048 slots | 0 slaves.
172.31.5.69:6379 (c767ab28...) -> 625213 keys | 2048 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 624799 keys | 2048 slots | 0 slaves.
[OK] 5000000 keys in 8 masters.
305.18 keys per slot on average.
 
total slots: 16384
*** No rebalancing needed! All nodes are within the 2.00% threshold.


{ distribution: [
    293, 293, 293,
    293, 292, 292,
    292
  ] }
[33m### RESHARDING FROM 172.31.5.226 TO 172.31.5.192 ###
[0m
{ reshardFrom: '172.31.5.226', reshardTo: '172.31.5.192', slots: 293 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 714797 keys | 2341 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 625129 keys | 2048 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 625078 keys | 2048 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 624657 keys | 2048 slots | 0 slaves.
172.31.5.226:6379 (1115b088...) -> 535446 keys | 1755 slots | 0 slaves.
172.31.5.56:6379 (234e48dd...) -> 624881 keys | 2048 slots | 0 slaves.
172.31.5.69:6379 (c767ab28...) -> 625213 keys | 2048 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 624799 keys | 2048 slots | 0 slaves.
[OK] 5000000 keys in 8 masters.
305.18 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.226 TO 172.31.5.72 ###
[0m
{ reshardFrom: '172.31.5.226', reshardTo: '172.31.5.72', slots: 293 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 714797 keys | 2341 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 625129 keys | 2048 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 625078 keys | 2048 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 714124 keys | 2341 slots | 0 slaves.
172.31.5.226:6379 (1115b088...) -> 445979 keys | 1462 slots | 0 slaves.
172.31.5.56:6379 (234e48dd...) -> 624881 keys | 2048 slots | 0 slaves.
172.31.5.69:6379 (c767ab28...) -> 625213 keys | 2048 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 624799 keys | 2048 slots | 0 slaves.
[OK] 5000000 keys in 8 masters.
305.18 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.226 TO 172.31.5.142 ###
[0m
{ reshardFrom: '172.31.5.226', reshardTo: '172.31.5.142', slots: 293 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 714797 keys | 2341 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 625129 keys | 2048 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 714316 keys | 2341 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 714124 keys | 2341 slots | 0 slaves.
172.31.5.226:6379 (1115b088...) -> 356741 keys | 1169 slots | 0 slaves.
172.31.5.56:6379 (234e48dd...) -> 624881 keys | 2048 slots | 0 slaves.
172.31.5.69:6379 (c767ab28...) -> 625213 keys | 2048 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 624799 keys | 2048 slots | 0 slaves.
[OK] 5000000 keys in 8 masters.
305.18 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.226 TO 172.31.5.9 ###
[0m
{ reshardFrom: '172.31.5.226', reshardTo: '172.31.5.9', slots: 293 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 714797 keys | 2341 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 625129 keys | 2048 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 714316 keys | 2341 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 714124 keys | 2341 slots | 0 slaves.
172.31.5.226:6379 (1115b088...) -> 267085 keys | 876 slots | 0 slaves.
172.31.5.56:6379 (234e48dd...) -> 624881 keys | 2048 slots | 0 slaves.
172.31.5.69:6379 (c767ab28...) -> 625213 keys | 2048 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 714455 keys | 2341 slots | 0 slaves.
[OK] 5000000 keys in 8 masters.
305.18 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.226 TO 172.31.5.120 ###
[0m
{ reshardFrom: '172.31.5.226', reshardTo: '172.31.5.120', slots: 292 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 714797 keys | 2341 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 714184 keys | 2340 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 714316 keys | 2341 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 714124 keys | 2341 slots | 0 slaves.
172.31.5.226:6379 (1115b088...) -> 178030 keys | 584 slots | 0 slaves.
172.31.5.56:6379 (234e48dd...) -> 624881 keys | 2048 slots | 0 slaves.
172.31.5.69:6379 (c767ab28...) -> 625213 keys | 2048 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 714455 keys | 2341 slots | 0 slaves.
[OK] 5000000 keys in 8 masters.
305.18 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.226 TO 172.31.5.69 ###
[0m
{ reshardFrom: '172.31.5.226', reshardTo: '172.31.5.69', slots: 292 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 714797 keys | 2341 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 714184 keys | 2340 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 714316 keys | 2341 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 714124 keys | 2341 slots | 0 slaves.
172.31.5.226:6379 (1115b088...) -> 89051 keys | 292 slots | 0 slaves.
172.31.5.56:6379 (234e48dd...) -> 624881 keys | 2048 slots | 0 slaves.
172.31.5.69:6379 (c767ab28...) -> 714192 keys | 2340 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 714455 keys | 2341 slots | 0 slaves.
[OK] 5000000 keys in 8 masters.
305.18 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.226 TO 172.31.5.56 ###
[0m
{ reshardFrom: '172.31.5.226', reshardTo: '172.31.5.56', slots: 292 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 714797 keys | 2341 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 714184 keys | 2340 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 714316 keys | 2341 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 714124 keys | 2341 slots | 0 slaves.
172.31.5.56:6379 (234e48dd...) -> 713932 keys | 2340 slots | 1 slaves.
172.31.5.69:6379 (c767ab28...) -> 714192 keys | 2340 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 714455 keys | 2341 slots | 0 slaves.
[OK] 5000000 keys in 7 masters.
305.18 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### REMOVING 172.31.5.226:6379 FROM CLUSTER ###
[0m
> redis-cli --cluster del-node 172.31.5.226:6379 1115b08851797fa0d86d6dcf38b8d86974fdc686
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 714797 keys | 2341 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 714184 keys | 2340 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 714316 keys | 2341 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 714124 keys | 2341 slots | 0 slaves.
172.31.5.56:6379 (234e48dd...) -> 713932 keys | 2340 slots | 0 slaves.
172.31.5.69:6379 (c767ab28...) -> 714192 keys | 2340 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 714455 keys | 2341 slots | 0 slaves.
[OK] 5000000 keys in 7 masters.
305.18 keys per slot on average.
 
total slots: 16384
Removing node 1115b08851797fa0d86d6dcf38b8d86974fdc686 from cluster 172.31.5.226:6379
Sending CLUSTER FORGET messages to the cluster...
Sending CLUSTER RESET SOFT to the deleted node.
[33m### REBALANCING CLUSTER ON 172.31.5.192:6379 ###
[0m
> redis-cli --cluster rebalance 172.31.5.192:6379 --cluster-use-empty-masters | grep -i Rebalancing
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 714797 keys | 2341 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 714184 keys | 2340 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 714316 keys | 2341 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 714124 keys | 2341 slots | 0 slaves.
172.31.5.56:6379 (234e48dd...) -> 713932 keys | 2340 slots | 0 slaves.
172.31.5.69:6379 (c767ab28...) -> 714192 keys | 2340 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 714455 keys | 2341 slots | 0 slaves.
[OK] 5000000 keys in 7 masters.
305.18 keys per slot on average.
 
total slots: 16384
*** No rebalancing needed! All nodes are within the 2.00% threshold.


waiting... 65 64 63 62 61 60 59 58 57 56 55 54 53 52 51 50 49 48 47 46 45 44 43 42 41 40 39 38 37 36 35 34 33 32 31 30 29 28 27 26 25 24 23 22 21 20 19 18 17 16 15 14 13 12 11 10 9 8 7 6 5 4 3 2 1 



[34m******* resize , 7 completed ******* [0m 

------------------------------------------------------------------

[34m******* write , 500000 *******[0m

[33m### WRITING 500000 KEYS ###
[0m
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 786159 keys | 2341 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 785469 keys | 2340 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 785780 keys | 2341 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 785606 keys | 2341 slots | 0 slaves.
172.31.5.56:6379 (234e48dd...) -> 785306 keys | 2340 slots | 0 slaves.
172.31.5.69:6379 (c767ab28...) -> 785739 keys | 2340 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 785941 keys | 2341 slots | 0 slaves.
[OK] 5500000 keys in 7 masters.
335.69 keys per slot on average.
 
total slots: 16384
0.5M keys written successfully

[34m******* write , 500000 completed ******* [0m 

------------------------------------------------------------------

[34m******* resize , 3 *******[0m

{ clusterSize: 7 }
[33m### REBALANCING CLUSTER ON 172.31.5.56:6379 ###
[0m
> redis-cli --cluster rebalance 172.31.5.56:6379 --cluster-use-empty-masters | grep -i Rebalancing
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 786159 keys | 2341 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 785469 keys | 2340 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 785780 keys | 2341 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 785606 keys | 2341 slots | 0 slaves.
172.31.5.56:6379 (234e48dd...) -> 785306 keys | 2340 slots | 0 slaves.
172.31.5.69:6379 (c767ab28...) -> 785739 keys | 2340 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 785941 keys | 2341 slots | 0 slaves.
[OK] 5500000 keys in 7 masters.
335.69 keys per slot on average.
 
total slots: 16384
*** No rebalancing needed! All nodes are within the 2.00% threshold.


{ distribution: [ 780, 780, 780 ] }
[33m### RESHARDING FROM 172.31.5.56 TO 172.31.5.192 ###
[0m
{ reshardFrom: '172.31.5.56', reshardTo: '172.31.5.192', slots: 780 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 1047934 keys | 3121 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 785469 keys | 2340 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 785780 keys | 2341 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 785606 keys | 2341 slots | 0 slaves.
172.31.5.56:6379 (234e48dd...) -> 523531 keys | 1560 slots | 0 slaves.
172.31.5.69:6379 (c767ab28...) -> 785739 keys | 2340 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 785941 keys | 2341 slots | 0 slaves.
[OK] 5500000 keys in 7 masters.
335.69 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.56 TO 172.31.5.72 ###
[0m
{ reshardFrom: '172.31.5.56', reshardTo: '172.31.5.72', slots: 780 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 1047934 keys | 3121 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 785469 keys | 2340 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 785780 keys | 2341 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 1047378 keys | 3121 slots | 0 slaves.
172.31.5.56:6379 (234e48dd...) -> 261759 keys | 780 slots | 0 slaves.
172.31.5.69:6379 (c767ab28...) -> 785739 keys | 2340 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 785941 keys | 2341 slots | 0 slaves.
[OK] 5500000 keys in 7 masters.
335.69 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.56 TO 172.31.5.142 ###
[0m
{ reshardFrom: '172.31.5.56', reshardTo: '172.31.5.142', slots: 780 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 1047934 keys | 3121 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 785469 keys | 2340 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 1047539 keys | 3121 slots | 1 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 1047378 keys | 3121 slots | 0 slaves.
172.31.5.69:6379 (c767ab28...) -> 785739 keys | 2340 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 785941 keys | 2341 slots | 0 slaves.
[OK] 5500000 keys in 6 masters.
335.69 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### REMOVING 172.31.5.56:6379 FROM CLUSTER ###
[0m
> redis-cli --cluster del-node 172.31.5.56:6379 234e48dd8ec12ce323c6ae15e58211ab6cff76c4
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 1047934 keys | 3121 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 785469 keys | 2340 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 1047539 keys | 3121 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 1047378 keys | 3121 slots | 0 slaves.
172.31.5.69:6379 (c767ab28...) -> 785739 keys | 2340 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 785941 keys | 2341 slots | 0 slaves.
[OK] 5500000 keys in 6 masters.
335.69 keys per slot on average.
 
total slots: 16384
Removing node 234e48dd8ec12ce323c6ae15e58211ab6cff76c4 from cluster 172.31.5.56:6379
Sending CLUSTER FORGET messages to the cluster...
Sending CLUSTER RESET SOFT to the deleted node.
{ distribution: [ 780, 780, 780 ] }
[33m### RESHARDING FROM 172.31.5.69 TO 172.31.5.72 ###
[0m
{ reshardFrom: '172.31.5.69', reshardTo: '172.31.5.72', slots: 780 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 1047934 keys | 3121 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 785469 keys | 2340 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 1047539 keys | 3121 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 1309187 keys | 3901 slots | 0 slaves.
172.31.5.69:6379 (c767ab28...) -> 523930 keys | 1560 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 785941 keys | 2341 slots | 0 slaves.
[OK] 5500000 keys in 6 masters.
335.69 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.69 TO 172.31.5.142 ###
[0m
{ reshardFrom: '172.31.5.69', reshardTo: '172.31.5.142', slots: 780 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 1047934 keys | 3121 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 785469 keys | 2340 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 1309469 keys | 3901 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 1309187 keys | 3901 slots | 0 slaves.
172.31.5.69:6379 (c767ab28...) -> 262000 keys | 780 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 785941 keys | 2341 slots | 0 slaves.
[OK] 5500000 keys in 6 masters.
335.69 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.69 TO 172.31.5.192 ###
[0m
{ reshardFrom: '172.31.5.69', reshardTo: '172.31.5.192', slots: 780 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 1309934 keys | 3901 slots | 1 slaves.
172.31.5.120:6379 (9ca261e7...) -> 785469 keys | 2340 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 1309469 keys | 3901 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 1309187 keys | 3901 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 785941 keys | 2341 slots | 0 slaves.
[OK] 5500000 keys in 5 masters.
335.69 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### REMOVING 172.31.5.69:6379 FROM CLUSTER ###
[0m
> redis-cli --cluster del-node 172.31.5.69:6379 c767ab28fe1051fc42e029246c44c11abb50fc85
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 1309934 keys | 3901 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 785469 keys | 2340 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 1309469 keys | 3901 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 1309187 keys | 3901 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 785941 keys | 2341 slots | 0 slaves.
[OK] 5500000 keys in 5 masters.
335.69 keys per slot on average.
 
total slots: 16384
Removing node c767ab28fe1051fc42e029246c44c11abb50fc85 from cluster 172.31.5.69:6379
Sending CLUSTER FORGET messages to the cluster...
Sending CLUSTER RESET SOFT to the deleted node.
{ distribution: [ 780, 780, 780 ] }
[33m### RESHARDING FROM 172.31.5.120 TO 172.31.5.142 ###
[0m
{ reshardFrom: '172.31.5.120', reshardTo: '172.31.5.142', slots: 780 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 1309934 keys | 3901 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 523631 keys | 1560 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 1571307 keys | 4681 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 1309187 keys | 3901 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 785941 keys | 2341 slots | 0 slaves.
[OK] 5500000 keys in 5 masters.
335.69 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.120 TO 172.31.5.192 ###
[0m
{ reshardFrom: '172.31.5.120', reshardTo: '172.31.5.192', slots: 780 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 1571854 keys | 4681 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 261711 keys | 780 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 1571307 keys | 4681 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 1309187 keys | 3901 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 785941 keys | 2341 slots | 0 slaves.
[OK] 5500000 keys in 5 masters.
335.69 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.120 TO 172.31.5.72 ###
[0m
{ reshardFrom: '172.31.5.120', reshardTo: '172.31.5.72', slots: 780 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 1571854 keys | 4681 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 1571307 keys | 4681 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 1570898 keys | 4681 slots | 1 slaves.
172.31.5.9:6379 (a4f97e81...) -> 785941 keys | 2341 slots | 0 slaves.
[OK] 5500000 keys in 4 masters.
335.69 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### REMOVING 172.31.5.120:6379 FROM CLUSTER ###
[0m
> redis-cli --cluster del-node 172.31.5.120:6379 9ca261e70d34be19b2cda07304fb0a02fcec6a94
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 1571854 keys | 4681 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 1571307 keys | 4681 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 1570898 keys | 4681 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 785941 keys | 2341 slots | 0 slaves.
[OK] 5500000 keys in 4 masters.
335.69 keys per slot on average.
 
total slots: 16384
Removing node 9ca261e70d34be19b2cda07304fb0a02fcec6a94 from cluster 172.31.5.120:6379
Sending CLUSTER FORGET messages to the cluster...
Sending CLUSTER RESET SOFT to the deleted node.
{ distribution: [ 781, 780, 780 ] }
[33m### RESHARDING FROM 172.31.5.9 TO 172.31.5.192 ###
[0m
{ reshardFrom: '172.31.5.9', reshardTo: '172.31.5.192', slots: 781 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 1834230 keys | 5462 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 1571307 keys | 4681 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 1570898 keys | 4681 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 523565 keys | 1560 slots | 0 slaves.
[OK] 5500000 keys in 4 masters.
335.69 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.9 TO 172.31.5.72 ###
[0m
{ reshardFrom: '172.31.5.9', reshardTo: '172.31.5.72', slots: 780 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 1834230 keys | 5462 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 1571307 keys | 4681 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 1832466 keys | 5461 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 261997 keys | 780 slots | 0 slaves.
[OK] 5500000 keys in 4 masters.
335.69 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.9 TO 172.31.5.142 ###
[0m
{ reshardFrom: '172.31.5.9', reshardTo: '172.31.5.142', slots: 780 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 1834230 keys | 5462 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 1833304 keys | 5461 slots | 1 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 1832466 keys | 5461 slots | 0 slaves.
[OK] 5500000 keys in 3 masters.
335.69 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### REMOVING 172.31.5.9:6379 FROM CLUSTER ###
[0m
> redis-cli --cluster del-node 172.31.5.9:6379 a4f97e8143f27f4282a37484971dbedd141f3ba9
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 1834230 keys | 5462 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 1833304 keys | 5461 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 1832466 keys | 5461 slots | 0 slaves.
[OK] 5500000 keys in 3 masters.
335.69 keys per slot on average.
 
total slots: 16384
Removing node a4f97e8143f27f4282a37484971dbedd141f3ba9 from cluster 172.31.5.9:6379
Sending CLUSTER FORGET messages to the cluster...
Sending CLUSTER RESET SOFT to the deleted node.
[33m### REBALANCING CLUSTER ON 172.31.5.192:6379 ###
[0m
> redis-cli --cluster rebalance 172.31.5.192:6379 --cluster-use-empty-masters | grep -i Rebalancing
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 1834230 keys | 5462 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 1833304 keys | 5461 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 1832466 keys | 5461 slots | 0 slaves.
[OK] 5500000 keys in 3 masters.
335.69 keys per slot on average.
 
total slots: 16384
*** No rebalancing needed! All nodes are within the 2.00% threshold.


waiting... 65 64 63 62 61 60 59 58 57 56 55 54 53 52 51 50 49 48 47 46 45 44 43 42 41 40 39 38 37 36 35 34 33 32 31 30 29 28 27 26 25 24 23 22 21 20 19 18 17 16 15 14 13 12 11 10 9 8 7 6 5 4 3 2 1 



[34m******* resize , 3 completed ******* [0m 

------------------------------------------------------------------

[34m******* write , 500000 *******[0m

[33m### WRITING 500000 KEYS ###
[0m
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 2001132 keys | 5462 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 1999980 keys | 5461 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 1998888 keys | 5461 slots | 0 slaves.
[OK] 6000000 keys in 3 masters.
366.21 keys per slot on average.
 
total slots: 16384
0.5M keys written successfully

[34m******* write , 500000 completed ******* [0m 

------------------------------------------------------------------

[34m******* resize , 7 *******[0m

{ clusterSize: 3 }
[33m### ADDING 172.31.5.9:6379 NODE TO CLUSTER ###
[0m
> redis-cli --cluster add-node 172.31.5.9:6379 172.31.5.192:6379 | awk '{ gsub(/[[0-9;]*m/, ""); print }'
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 2001132 keys | 5462 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 1999980 keys | 5461 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 1998888 keys | 5461 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 0 keys | 0 slots | 0 slaves.
[OK] 6000000 keys in 4 masters.
366.21 keys per slot on average.
 
total slots: 16384
node added successfully
waiting... 2 1 


[33m### ADDING 172.31.5.120:6379 NODE TO CLUSTER ###
[0m
> redis-cli --cluster add-node 172.31.5.120:6379 172.31.5.192:6379 | awk '{ gsub(/[[0-9;]*m/, ""); print }'
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 2001132 keys | 5462 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 1999980 keys | 5461 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 1998888 keys | 5461 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 0 keys | 0 slots | 0 slaves.
[OK] 6000000 keys in 5 masters.
366.21 keys per slot on average.
 
total slots: 16384
node added successfully
waiting... 2 1 


[33m### ADDING 172.31.5.69:6379 NODE TO CLUSTER ###
[0m
> redis-cli --cluster add-node 172.31.5.69:6379 172.31.5.192:6379 | awk '{ gsub(/[[0-9;]*m/, ""); print }'
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 2001132 keys | 5462 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 1999980 keys | 5461 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 1998888 keys | 5461 slots | 0 slaves.
172.31.5.69:6379 (c767ab28...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 0 keys | 0 slots | 0 slaves.
[OK] 6000000 keys in 6 masters.
366.21 keys per slot on average.
 
total slots: 16384
node added successfully
waiting... 2 1 


[33m### ADDING 172.31.5.56:6379 NODE TO CLUSTER ###
[0m
> redis-cli --cluster add-node 172.31.5.56:6379 172.31.5.192:6379 | awk '{ gsub(/[[0-9;]*m/, ""); print }'
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 2001132 keys | 5462 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 1999980 keys | 5461 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 1998888 keys | 5461 slots | 0 slaves.
172.31.5.56:6379 (234e48dd...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.69:6379 (c767ab28...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 0 keys | 0 slots | 0 slaves.
[OK] 6000000 keys in 7 masters.
366.21 keys per slot on average.
 
total slots: 16384
node added successfully
waiting... 2 1 


waiting... 10 9 8 7 6 5 4 3 2 1 


[33m### REBALANCING CLUSTER ON 172.31.5.9:6379 ###
[0m
> redis-cli --cluster rebalance 172.31.5.9:6379 --cluster-use-empty-masters | grep -i Rebalancing
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 857454 keys | 2340 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 856795 keys | 2341 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 856996 keys | 2340 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 856469 keys | 2340 slots | 0 slaves.
172.31.5.56:6379 (234e48dd...) -> 857472 keys | 2341 slots | 0 slaves.
172.31.5.69:6379 (c767ab28...) -> 857117 keys | 2341 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 857697 keys | 2341 slots | 0 slaves.
[OK] 6000000 keys in 7 masters.
366.21 keys per slot on average.
 
total slots: 16384
>>> Rebalancing across 7 nodes. Total weight = 7.00



[34m******* resize , 7 completed ******* [0m 

------------------------------------------------------------------

[34m******* write , 500000 *******[0m

[33m### WRITING 500000 KEYS ###
[0m
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 928808 keys | 2340 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 928300 keys | 2341 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 928398 keys | 2340 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 927941 keys | 2340 slots | 0 slaves.
172.31.5.56:6379 (234e48dd...) -> 928963 keys | 2341 slots | 0 slaves.
172.31.5.69:6379 (c767ab28...) -> 928554 keys | 2341 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 929036 keys | 2341 slots | 0 slaves.
[OK] 6500000 keys in 7 masters.
396.73 keys per slot on average.
 
total slots: 16384
0.5M keys written successfully

[34m******* write , 500000 completed ******* [0m 

------------------------------------------------------------------

[34m******* resize , 4 *******[0m

{ clusterSize: 7 }
[33m### REBALANCING CLUSTER ON 172.31.5.56:6379 ###
[0m
> redis-cli --cluster rebalance 172.31.5.56:6379 --cluster-use-empty-masters | grep -i Rebalancing
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 928808 keys | 2340 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 928300 keys | 2341 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 928398 keys | 2340 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 927941 keys | 2340 slots | 0 slaves.
172.31.5.56:6379 (234e48dd...) -> 928963 keys | 2341 slots | 0 slaves.
172.31.5.69:6379 (c767ab28...) -> 928554 keys | 2341 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 929036 keys | 2341 slots | 0 slaves.
[OK] 6500000 keys in 7 masters.
396.73 keys per slot on average.
 
total slots: 16384
*** No rebalancing needed! All nodes are within the 2.00% threshold.


{ distribution: [ 586, 585, 585, 585 ] }
[33m### RESHARDING FROM 172.31.5.56 TO 172.31.5.192 ###
[0m
{ reshardFrom: '172.31.5.56', reshardTo: '172.31.5.192', slots: 586 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 1161257 keys | 2926 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 928300 keys | 2341 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 928398 keys | 2340 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 927941 keys | 2340 slots | 0 slaves.
172.31.5.56:6379 (234e48dd...) -> 696514 keys | 1755 slots | 0 slaves.
172.31.5.69:6379 (c767ab28...) -> 928554 keys | 2341 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 929036 keys | 2341 slots | 0 slaves.
[OK] 6500000 keys in 7 masters.
396.73 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.56 TO 172.31.5.72 ###
[0m
{ reshardFrom: '172.31.5.56', reshardTo: '172.31.5.72', slots: 585 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 1161257 keys | 2926 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 928300 keys | 2341 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 928398 keys | 2340 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 1160069 keys | 2925 slots | 0 slaves.
172.31.5.56:6379 (234e48dd...) -> 464386 keys | 1170 slots | 0 slaves.
172.31.5.69:6379 (c767ab28...) -> 928554 keys | 2341 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 929036 keys | 2341 slots | 0 slaves.
[OK] 6500000 keys in 7 masters.
396.73 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.56 TO 172.31.5.142 ###
[0m
{ reshardFrom: '172.31.5.56', reshardTo: '172.31.5.142', slots: 585 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 1161257 keys | 2926 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 928300 keys | 2341 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 1160644 keys | 2925 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 1160069 keys | 2925 slots | 0 slaves.
172.31.5.56:6379 (234e48dd...) -> 232140 keys | 585 slots | 0 slaves.
172.31.5.69:6379 (c767ab28...) -> 928554 keys | 2341 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 929036 keys | 2341 slots | 0 slaves.
[OK] 6500000 keys in 7 masters.
396.73 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.56 TO 172.31.5.9 ###
[0m
{ reshardFrom: '172.31.5.56', reshardTo: '172.31.5.9', slots: 585 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 1161257 keys | 2926 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 928300 keys | 2341 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 1160644 keys | 2925 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 1160069 keys | 2925 slots | 0 slaves.
172.31.5.69:6379 (c767ab28...) -> 928554 keys | 2341 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 1161176 keys | 2926 slots | 1 slaves.
[OK] 6500000 keys in 6 masters.
396.73 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### REMOVING 172.31.5.56:6379 FROM CLUSTER ###
[0m
> redis-cli --cluster del-node 172.31.5.56:6379 234e48dd8ec12ce323c6ae15e58211ab6cff76c4
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 1161257 keys | 2926 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 928300 keys | 2341 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 1160644 keys | 2925 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 1160069 keys | 2925 slots | 0 slaves.
172.31.5.69:6379 (c767ab28...) -> 928554 keys | 2341 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 1161176 keys | 2926 slots | 0 slaves.
[OK] 6500000 keys in 6 masters.
396.73 keys per slot on average.
 
total slots: 16384
Removing node 234e48dd8ec12ce323c6ae15e58211ab6cff76c4 from cluster 172.31.5.56:6379
Sending CLUSTER FORGET messages to the cluster...
Sending CLUSTER RESET SOFT to the deleted node.
{ distribution: [ 586, 585, 585, 585 ] }
[33m### RESHARDING FROM 172.31.5.69 TO 172.31.5.72 ###
[0m
{ reshardFrom: '172.31.5.69', reshardTo: '172.31.5.72', slots: 586 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 1161257 keys | 2926 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 928300 keys | 2341 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 1160644 keys | 2925 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 1392337 keys | 3511 slots | 0 slaves.
172.31.5.69:6379 (c767ab28...) -> 696286 keys | 1755 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 1161176 keys | 2926 slots | 0 slaves.
[OK] 6500000 keys in 6 masters.
396.73 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.69 TO 172.31.5.142 ###
[0m
{ reshardFrom: '172.31.5.69', reshardTo: '172.31.5.142', slots: 585 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 1161257 keys | 2926 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 928300 keys | 2341 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 1392870 keys | 3510 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 1392337 keys | 3511 slots | 0 slaves.
172.31.5.69:6379 (c767ab28...) -> 464060 keys | 1170 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 1161176 keys | 2926 slots | 0 slaves.
[OK] 6500000 keys in 6 masters.
396.73 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.69 TO 172.31.5.9 ###
[0m
{ reshardFrom: '172.31.5.69', reshardTo: '172.31.5.9', slots: 585 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 1161257 keys | 2926 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 928300 keys | 2341 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 1392870 keys | 3510 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 1392337 keys | 3511 slots | 0 slaves.
172.31.5.69:6379 (c767ab28...) -> 232046 keys | 585 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 1393190 keys | 3511 slots | 0 slaves.
[OK] 6500000 keys in 6 masters.
396.73 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.69 TO 172.31.5.192 ###
[0m
{ reshardFrom: '172.31.5.69', reshardTo: '172.31.5.192', slots: 585 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 1393303 keys | 3511 slots | 1 slaves.
172.31.5.120:6379 (9ca261e7...) -> 928300 keys | 2341 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 1392870 keys | 3510 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 1392337 keys | 3511 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 1393190 keys | 3511 slots | 0 slaves.
[OK] 6500000 keys in 5 masters.
396.73 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### REMOVING 172.31.5.69:6379 FROM CLUSTER ###
[0m
> redis-cli --cluster del-node 172.31.5.69:6379 c767ab28fe1051fc42e029246c44c11abb50fc85
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 1393303 keys | 3511 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 928300 keys | 2341 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 1392870 keys | 3510 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 1392337 keys | 3511 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 1393190 keys | 3511 slots | 0 slaves.
[OK] 6500000 keys in 5 masters.
396.73 keys per slot on average.
 
total slots: 16384
Removing node c767ab28fe1051fc42e029246c44c11abb50fc85 from cluster 172.31.5.69:6379
Sending CLUSTER FORGET messages to the cluster...
Sending CLUSTER RESET SOFT to the deleted node.
{ distribution: [ 586, 585, 585, 585 ] }
[33m### RESHARDING FROM 172.31.5.120 TO 172.31.5.142 ###
[0m
{ reshardFrom: '172.31.5.120', reshardTo: '172.31.5.142', slots: 586 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 1393303 keys | 3511 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 695804 keys | 1755 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 1625366 keys | 4096 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 1392337 keys | 3511 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 1393190 keys | 3511 slots | 0 slaves.
[OK] 6500000 keys in 5 masters.
396.73 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.120 TO 172.31.5.9 ###
[0m
{ reshardFrom: '172.31.5.120', reshardTo: '172.31.5.9', slots: 585 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 1393303 keys | 3511 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 463855 keys | 1170 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 1625366 keys | 4096 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 1392337 keys | 3511 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 1625139 keys | 4096 slots | 0 slaves.
[OK] 6500000 keys in 5 masters.
396.73 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.120 TO 172.31.5.192 ###
[0m
{ reshardFrom: '172.31.5.120', reshardTo: '172.31.5.192', slots: 585 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 1625259 keys | 4096 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 231899 keys | 585 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 1625366 keys | 4096 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 1392337 keys | 3511 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 1625139 keys | 4096 slots | 0 slaves.
[OK] 6500000 keys in 5 masters.
396.73 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.120 TO 172.31.5.72 ###
[0m
{ reshardFrom: '172.31.5.120', reshardTo: '172.31.5.72', slots: 585 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 1625259 keys | 4096 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 1625366 keys | 4096 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 1624236 keys | 4096 slots | 1 slaves.
172.31.5.9:6379 (a4f97e81...) -> 1625139 keys | 4096 slots | 0 slaves.
[OK] 6500000 keys in 4 masters.
396.73 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### REMOVING 172.31.5.120:6379 FROM CLUSTER ###
[0m
> redis-cli --cluster del-node 172.31.5.120:6379 9ca261e70d34be19b2cda07304fb0a02fcec6a94
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 1625259 keys | 4096 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 1625366 keys | 4096 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 1624236 keys | 4096 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 1625139 keys | 4096 slots | 0 slaves.
[OK] 6500000 keys in 4 masters.
396.73 keys per slot on average.
 
total slots: 16384
Removing node 9ca261e70d34be19b2cda07304fb0a02fcec6a94 from cluster 172.31.5.120:6379
Sending CLUSTER FORGET messages to the cluster...
Sending CLUSTER RESET SOFT to the deleted node.
[33m### REBALANCING CLUSTER ON 172.31.5.192:6379 ###
[0m
> redis-cli --cluster rebalance 172.31.5.192:6379 --cluster-use-empty-masters | grep -i Rebalancing
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 1625259 keys | 4096 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 1625366 keys | 4096 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 1624236 keys | 4096 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 1625139 keys | 4096 slots | 0 slaves.
[OK] 6500000 keys in 4 masters.
396.73 keys per slot on average.
 
total slots: 16384
*** No rebalancing needed! All nodes are within the 2.00% threshold.


waiting... 65 64 63 62 61 60 59 58 57 56 55 54 53 52 51 50 49 48 47 46 45 44 43 42 41 40 39 38 37 36 35 34 33 32 31 30 29 28 27 26 25 24 23 22 21 20 19 18 17 16 15 14 13 12 11 10 9 8 7 6 5 4 3 2 1 



[34m******* resize , 4 completed ******* [0m 

------------------------------------------------------------------

[34m******* write , 500000 *******[0m

[33m### WRITING 500000 KEYS ###
[0m
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 1750263 keys | 4096 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 1750427 keys | 4096 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 1749037 keys | 4096 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 1750273 keys | 4096 slots | 0 slaves.
[OK] 7000000 keys in 4 masters.
427.25 keys per slot on average.
 
total slots: 16384
0.5M keys written successfully

[34m******* write , 500000 completed ******* [0m 

------------------------------------------------------------------

[34m******* resize , 7 *******[0m

{ clusterSize: 4 }
[33m### ADDING 172.31.5.120:6379 NODE TO CLUSTER ###
[0m
> redis-cli --cluster add-node 172.31.5.120:6379 172.31.5.192:6379 | awk '{ gsub(/[[0-9;]*m/, ""); print }'
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 1750263 keys | 4096 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 1750427 keys | 4096 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 1749037 keys | 4096 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 1750273 keys | 4096 slots | 0 slaves.
[OK] 7000000 keys in 5 masters.
427.25 keys per slot on average.
 
total slots: 16384
node added successfully
waiting... 2 1 


[33m### ADDING 172.31.5.69:6379 NODE TO CLUSTER ###
[0m
> redis-cli --cluster add-node 172.31.5.69:6379 172.31.5.192:6379 | awk '{ gsub(/[[0-9;]*m/, ""); print }'
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 1750263 keys | 4096 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 1750427 keys | 4096 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 1749037 keys | 4096 slots | 0 slaves.
172.31.5.69:6379 (c767ab28...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 1750273 keys | 4096 slots | 0 slaves.
[OK] 7000000 keys in 6 masters.
427.25 keys per slot on average.
 
total slots: 16384
node added successfully
waiting... 2 1 


[33m### ADDING 172.31.5.56:6379 NODE TO CLUSTER ###
[0m
> redis-cli --cluster add-node 172.31.5.56:6379 172.31.5.192:6379 | awk '{ gsub(/[[0-9;]*m/, ""); print }'
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 1750263 keys | 4096 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 1750427 keys | 4096 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 1749037 keys | 4096 slots | 0 slaves.
172.31.5.56:6379 (234e48dd...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.69:6379 (c767ab28...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 1750273 keys | 4096 slots | 0 slaves.
[OK] 7000000 keys in 7 masters.
427.25 keys per slot on average.
 
total slots: 16384
node added successfully
waiting... 2 1 


waiting... 10 9 8 7 6 5 4 3 2 1 


[33m### REBALANCING CLUSTER ON 172.31.5.120:6379 ###
[0m
> redis-cli --cluster rebalance 172.31.5.120:6379 --cluster-use-empty-masters | grep -i Rebalancing
assertion error.
 {
  keys1: 7000000,
  keys2: 4768641,
  keys: 0,
  slots1: 16384,
  slots2: 16384,
  nodes1: 7,
  nodes2: 7,
  nodes: 0
}
precheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 1750263 keys | 4096 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 1750427 keys | 4096 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 1749037 keys | 4096 slots | 0 slaves.
172.31.5.56:6379 (234e48dd...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.69:6379 (c767ab28...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 1750273 keys | 4096 slots | 0 slaves.
[OK] 7000000 keys in 7 masters.
427.25 keys per slot on average.

postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 1000336 keys | 2340 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 820189 keys | 2342 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 0 keys | 2340 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 999269 keys | 2340 slots | 0 slaves.
172.31.5.56:6379 (234e48dd...) -> 1000071 keys | 2341 slots | 0 slaves.
172.31.5.69:6379 (c767ab28...) -> 948776 keys | 2341 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 0 keys | 2340 slots | 0 slaves.
[OK] 4768641 keys in 7 masters.
291.05 keys per slot on average.
 
total slots: 16384
>>> Rebalancing across 7 nodes. Total weight = 7.00



[34m******* resize , 7 completed ******* [0m 

------------------------------------------------------------------

[34m******* write , 500000 *******[0m

[33m### WRITING 500000 KEYS ###
[0m
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 1071853 keys | 2340 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 891764 keys | 2342 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 71398 keys | 2340 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 1070606 keys | 2340 slots | 0 slaves.
172.31.5.56:6379 (234e48dd...) -> 1071466 keys | 2341 slots | 0 slaves.
172.31.5.69:6379 (c767ab28...) -> 1020145 keys | 2341 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 71409 keys | 2340 slots | 0 slaves.
[OK] 5268641 keys in 7 masters.
321.57 keys per slot on average.
 
total slots: 16384
0.5M keys written successfully

[34m******* write , 500000 completed ******* [0m 

------------------------------------------------------------------

[34m******* resize , 5 *******[0m

{ clusterSize: 7 }
[33m### REBALANCING CLUSTER ON 172.31.5.56:6379 ###
[0m
> redis-cli --cluster rebalance 172.31.5.56:6379 --cluster-use-empty-masters | grep -i Rebalancing
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 1071853 keys | 2340 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 891764 keys | 2342 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 71398 keys | 2340 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 1070606 keys | 2340 slots | 0 slaves.
172.31.5.56:6379 (234e48dd...) -> 1071466 keys | 2341 slots | 0 slaves.
172.31.5.69:6379 (c767ab28...) -> 1020145 keys | 2341 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 71409 keys | 2340 slots | 0 slaves.
[OK] 5268641 keys in 7 masters.
321.57 keys per slot on average.
 
total slots: 16384
*** No rebalancing needed! All nodes are within the 2.00% threshold.


{ distribution: [ 469, 468, 468, 468, 468 ] }
[33m### RESHARDING FROM 172.31.5.56 TO 172.31.5.192 ###
[0m
{ reshardFrom: '172.31.5.56', reshardTo: '172.31.5.192', slots: 469 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 1286453 keys | 2809 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 891764 keys | 2342 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 71398 keys | 2340 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 1070606 keys | 2340 slots | 0 slaves.
172.31.5.56:6379 (234e48dd...) -> 856866 keys | 1872 slots | 0 slaves.
172.31.5.69:6379 (c767ab28...) -> 1020145 keys | 2341 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 71409 keys | 2340 slots | 0 slaves.
[OK] 5268641 keys in 7 masters.
321.57 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.56 TO 172.31.5.72 ###
[0m
{ reshardFrom: '172.31.5.56', reshardTo: '172.31.5.72', slots: 468 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 1286453 keys | 2809 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 891764 keys | 2342 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 71398 keys | 2340 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 1284957 keys | 2808 slots | 0 slaves.
172.31.5.56:6379 (234e48dd...) -> 642515 keys | 1404 slots | 0 slaves.
172.31.5.69:6379 (c767ab28...) -> 1020145 keys | 2341 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 71409 keys | 2340 slots | 0 slaves.
[OK] 5268641 keys in 7 masters.
321.57 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.56 TO 172.31.5.142 ###
[0m
{ reshardFrom: '172.31.5.56', reshardTo: '172.31.5.142', slots: 468 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 1286453 keys | 2809 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 891764 keys | 2342 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 285566 keys | 2808 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 1284957 keys | 2808 slots | 0 slaves.
172.31.5.56:6379 (234e48dd...) -> 428347 keys | 936 slots | 0 slaves.
172.31.5.69:6379 (c767ab28...) -> 1020145 keys | 2341 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 71409 keys | 2340 slots | 0 slaves.
[OK] 5268641 keys in 7 masters.
321.57 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.56 TO 172.31.5.9 ###
[0m
{ reshardFrom: '172.31.5.56', reshardTo: '172.31.5.9', slots: 468 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 1286453 keys | 2809 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 891764 keys | 2342 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 285566 keys | 2808 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 1284957 keys | 2808 slots | 0 slaves.
172.31.5.56:6379 (234e48dd...) -> 214060 keys | 468 slots | 0 slaves.
172.31.5.69:6379 (c767ab28...) -> 1020145 keys | 2341 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 285696 keys | 2808 slots | 0 slaves.
[OK] 5268641 keys in 7 masters.
321.57 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.56 TO 172.31.5.120 ###
[0m
{ reshardFrom: '172.31.5.56', reshardTo: '172.31.5.120', slots: 468 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 1286453 keys | 2809 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 1105824 keys | 2810 slots | 1 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 285566 keys | 2808 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 1284957 keys | 2808 slots | 0 slaves.
172.31.5.69:6379 (c767ab28...) -> 1020145 keys | 2341 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 285696 keys | 2808 slots | 0 slaves.
[OK] 5268641 keys in 6 masters.
321.57 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### REMOVING 172.31.5.56:6379 FROM CLUSTER ###
[0m
> redis-cli --cluster del-node 172.31.5.56:6379 234e48dd8ec12ce323c6ae15e58211ab6cff76c4
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 1286453 keys | 2809 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 1105824 keys | 2810 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 285566 keys | 2808 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 1284957 keys | 2808 slots | 0 slaves.
172.31.5.69:6379 (c767ab28...) -> 1020145 keys | 2341 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 285696 keys | 2808 slots | 0 slaves.
[OK] 5268641 keys in 6 masters.
321.57 keys per slot on average.
 
total slots: 16384
Removing node 234e48dd8ec12ce323c6ae15e58211ab6cff76c4 from cluster 172.31.5.56:6379
Sending CLUSTER FORGET messages to the cluster...
Sending CLUSTER RESET SOFT to the deleted node.
{ distribution: [ 469, 468, 468, 468, 468 ] }
[33m### RESHARDING FROM 172.31.5.69 TO 172.31.5.72 ###
[0m
{ reshardFrom: '172.31.5.69', reshardTo: '172.31.5.72', slots: 469 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 1286453 keys | 2809 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 1105824 keys | 2810 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 285566 keys | 2808 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 1499350 keys | 3277 slots | 0 slaves.
172.31.5.69:6379 (c767ab28...) -> 805752 keys | 1872 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 285696 keys | 2808 slots | 0 slaves.
[OK] 5268641 keys in 6 masters.
321.57 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.69 TO 172.31.5.142 ###
[0m
{ reshardFrom: '172.31.5.69', reshardTo: '172.31.5.142', slots: 468 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 1286453 keys | 2809 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 1105824 keys | 2810 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 499689 keys | 3276 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 1499350 keys | 3277 slots | 0 slaves.
172.31.5.69:6379 (c767ab28...) -> 591629 keys | 1404 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 285696 keys | 2808 slots | 0 slaves.
[OK] 5268641 keys in 6 masters.
321.57 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.69 TO 172.31.5.9 ###
[0m
{ reshardFrom: '172.31.5.69', reshardTo: '172.31.5.9', slots: 468 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 1286453 keys | 2809 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 1105824 keys | 2810 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 499689 keys | 3276 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 1499350 keys | 3277 slots | 0 slaves.
172.31.5.69:6379 (c767ab28...) -> 377152 keys | 936 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 500173 keys | 3276 slots | 0 slaves.
[OK] 5268641 keys in 6 masters.
321.57 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.69 TO 172.31.5.120 ###
[0m
{ reshardFrom: '172.31.5.69', reshardTo: '172.31.5.120', slots: 468 }
assertion error.
 {
  keys1: 5268641,
  keys2: 4768953,
  keys: 0,
  slots1: 16384,
  slots2: 16384,
  nodes1: 6,
  nodes2: 6,
  nodes: 0
}
precheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 1286453 keys | 2809 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 1105824 keys | 2810 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 499689 keys | 3276 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 1499350 keys | 3277 slots | 0 slaves.
172.31.5.69:6379 (c767ab28...) -> 377152 keys | 936 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 500173 keys | 3276 slots | 0 slaves.
[OK] 5268641 keys in 6 masters.
321.57 keys per slot on average.

postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 1286453 keys | 2809 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 1271514 keys | 3278 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 1 keys | 3276 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 1499350 keys | 3277 slots | 0 slaves.
172.31.5.69:6379 (c767ab28...) -> 211462 keys | 468 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 500173 keys | 3276 slots | 0 slaves.
[OK] 4768953 keys in 6 masters.
291.07 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.69 TO 172.31.5.192 ###
[0m
{ reshardFrom: '172.31.5.69', reshardTo: '172.31.5.192', slots: 468 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 1497915 keys | 3277 slots | 1 slaves.
172.31.5.120:6379 (9ca261e7...) -> 1271514 keys | 3278 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 1 keys | 3276 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 1499350 keys | 3277 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 500173 keys | 3276 slots | 0 slaves.
[OK] 4768953 keys in 5 masters.
291.07 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### REMOVING 172.31.5.69:6379 FROM CLUSTER ###
[0m
> redis-cli --cluster del-node 172.31.5.69:6379 c767ab28fe1051fc42e029246c44c11abb50fc85
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 1497915 keys | 3277 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 1271514 keys | 3278 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 1 keys | 3276 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 1499350 keys | 3277 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 500173 keys | 3276 slots | 0 slaves.
[OK] 4768953 keys in 5 masters.
291.07 keys per slot on average.
 
total slots: 16384
Removing node c767ab28fe1051fc42e029246c44c11abb50fc85 from cluster 172.31.5.69:6379
Sending CLUSTER FORGET messages to the cluster...
Sending CLUSTER RESET SOFT to the deleted node.
[33m### REBALANCING CLUSTER ON 172.31.5.192:6379 ###
[0m
> redis-cli --cluster rebalance 172.31.5.192:6379 --cluster-use-empty-masters | grep -i Rebalancing
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 1497915 keys | 3277 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 1271514 keys | 3278 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 1 keys | 3276 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 1499350 keys | 3277 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 500173 keys | 3276 slots | 0 slaves.
[OK] 4768953 keys in 5 masters.
291.07 keys per slot on average.
 
total slots: 16384
*** No rebalancing needed! All nodes are within the 2.00% threshold.


waiting... 65 64 63 62 61 60 59 58 57 56 55 54 53 52 51 50 49 48 47 46 45 44 43 42 41 40 39 38 37 36 35 34 33 32 31 30 29 28 27 26 25 24 23 22 21 20 19 18 17 16 15 14 13 12 11 10 9 8 7 6 5 4 3 2 1 



[34m******* resize , 5 completed ******* [0m 

------------------------------------------------------------------

[34m******* write , 500000 *******[0m

[33m### WRITING 500000 KEYS ###
[0m
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 1597974 keys | 3277 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 1371570 keys | 3278 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 99978 keys | 3276 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 1599154 keys | 3277 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 600277 keys | 3276 slots | 0 slaves.
[OK] 5268953 keys in 5 masters.
321.59 keys per slot on average.
 
total slots: 16384
0.5M keys written successfully

[34m******* write , 500000 completed ******* [0m 

------------------------------------------------------------------

[34m******* resize , 7 *******[0m

{ clusterSize: 5 }
[33m### ADDING 172.31.5.69:6379 NODE TO CLUSTER ###
[0m
> redis-cli --cluster add-node 172.31.5.69:6379 172.31.5.192:6379 | awk '{ gsub(/[[0-9;]*m/, ""); print }'
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 1597974 keys | 3277 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 1371570 keys | 3278 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 99978 keys | 3276 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 1599154 keys | 3277 slots | 0 slaves.
172.31.5.69:6379 (c767ab28...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 600277 keys | 3276 slots | 0 slaves.
[OK] 5268953 keys in 6 masters.
321.59 keys per slot on average.
 
total slots: 16384
node added successfully
waiting... 2 1 


[33m### ADDING 172.31.5.56:6379 NODE TO CLUSTER ###
[0m
> redis-cli --cluster add-node 172.31.5.56:6379 172.31.5.192:6379 | awk '{ gsub(/[[0-9;]*m/, ""); print }'
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 1597974 keys | 3277 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 1371570 keys | 3278 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 99978 keys | 3276 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 1599154 keys | 3277 slots | 0 slaves.
172.31.5.56:6379 (234e48dd...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.69:6379 (c767ab28...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 600277 keys | 3276 slots | 0 slaves.
[OK] 5268953 keys in 7 masters.
321.59 keys per slot on average.
 
total slots: 16384
node added successfully
waiting... 2 1 


waiting... 10 9 8 7 6 5 4 3 2 1 


[33m### REBALANCING CLUSTER ON 172.31.5.69:6379 ###
[0m
> redis-cli --cluster rebalance 172.31.5.69:6379 --cluster-use-empty-masters | grep -i Rebalancing
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 1143468 keys | 2340 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 913685 keys | 2340 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 71448 keys | 2340 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 1141847 keys | 2340 slots | 0 slaves.
172.31.5.56:6379 (234e48dd...) -> 507597 keys | 2342 slots | 0 slaves.
172.31.5.69:6379 (c767ab28...) -> 1140101 keys | 2342 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 350807 keys | 2340 slots | 0 slaves.
[OK] 5268953 keys in 7 masters.
321.59 keys per slot on average.
 
total slots: 16384
>>> Rebalancing across 7 nodes. Total weight = 7.00



[34m******* resize , 7 completed ******* [0m 

------------------------------------------------------------------

[34m******* write , 500000 *******[0m

[33m### WRITING 500000 KEYS ###
[0m
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 1215100 keys | 2340 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 985128 keys | 2340 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 142898 keys | 2340 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 1213047 keys | 2340 slots | 0 slaves.
172.31.5.56:6379 (234e48dd...) -> 579036 keys | 2342 slots | 0 slaves.
172.31.5.69:6379 (c767ab28...) -> 1211339 keys | 2342 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 422405 keys | 2340 slots | 0 slaves.
[OK] 5768953 keys in 7 masters.
352.11 keys per slot on average.
 
total slots: 16384
0.5M keys written successfully

[34m******* write , 500000 completed ******* [0m 

------------------------------------------------------------------

[34m******* resize , 6 *******[0m

{ clusterSize: 7 }
[33m### REBALANCING CLUSTER ON 172.31.5.56:6379 ###
[0m
> redis-cli --cluster rebalance 172.31.5.56:6379 --cluster-use-empty-masters | grep -i Rebalancing
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 1215100 keys | 2340 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 985128 keys | 2340 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 142898 keys | 2340 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 1213047 keys | 2340 slots | 0 slaves.
172.31.5.56:6379 (234e48dd...) -> 579036 keys | 2342 slots | 0 slaves.
172.31.5.69:6379 (c767ab28...) -> 1211339 keys | 2342 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 422405 keys | 2340 slots | 0 slaves.
[OK] 5768953 keys in 7 masters.
352.11 keys per slot on average.
 
total slots: 16384
*** No rebalancing needed! All nodes are within the 2.00% threshold.


{ distribution: [ 391, 391, 390, 390, 390, 390 ] }
[33m### RESHARDING FROM 172.31.5.56 TO 172.31.5.192 ###
[0m
{ reshardFrom: '172.31.5.56', reshardTo: '172.31.5.192', slots: 391 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 1275812 keys | 2731 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 985128 keys | 2340 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 142898 keys | 2340 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 1213047 keys | 2340 slots | 0 slaves.
172.31.5.56:6379 (234e48dd...) -> 518324 keys | 1951 slots | 0 slaves.
172.31.5.69:6379 (c767ab28...) -> 1211339 keys | 2342 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 422405 keys | 2340 slots | 0 slaves.
[OK] 5768953 keys in 7 masters.
352.11 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.56 TO 172.31.5.72 ###
[0m
{ reshardFrom: '172.31.5.56', reshardTo: '172.31.5.72', slots: 391 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 1275812 keys | 2731 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 985128 keys | 2340 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 142898 keys | 2340 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 1374329 keys | 2731 slots | 0 slaves.
172.31.5.56:6379 (234e48dd...) -> 357042 keys | 1560 slots | 0 slaves.
172.31.5.69:6379 (c767ab28...) -> 1211339 keys | 2342 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 422405 keys | 2340 slots | 0 slaves.
[OK] 5768953 keys in 7 masters.
352.11 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.56 TO 172.31.5.142 ###
[0m
{ reshardFrom: '172.31.5.56', reshardTo: '172.31.5.142', slots: 390 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 1275812 keys | 2731 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 985128 keys | 2340 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 212571 keys | 2730 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 1374329 keys | 2731 slots | 0 slaves.
172.31.5.56:6379 (234e48dd...) -> 287369 keys | 1170 slots | 0 slaves.
172.31.5.69:6379 (c767ab28...) -> 1211339 keys | 2342 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 422405 keys | 2340 slots | 0 slaves.
[OK] 5768953 keys in 7 masters.
352.11 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.56 TO 172.31.5.9 ###
[0m
{ reshardFrom: '172.31.5.56', reshardTo: '172.31.5.9', slots: 390 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 1275812 keys | 2731 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 985128 keys | 2340 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 212571 keys | 2730 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 1374329 keys | 2731 slots | 0 slaves.
172.31.5.56:6379 (234e48dd...) -> 253604 keys | 780 slots | 0 slaves.
172.31.5.69:6379 (c767ab28...) -> 1211339 keys | 2342 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 456170 keys | 2730 slots | 0 slaves.
[OK] 5768953 keys in 7 masters.
352.11 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.56 TO 172.31.5.120 ###
[0m
{ reshardFrom: '172.31.5.56', reshardTo: '172.31.5.120', slots: 390 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 1275812 keys | 2731 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 1143574 keys | 2730 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 212571 keys | 2730 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 1374329 keys | 2731 slots | 0 slaves.
172.31.5.56:6379 (234e48dd...) -> 95158 keys | 390 slots | 0 slaves.
172.31.5.69:6379 (c767ab28...) -> 1211339 keys | 2342 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 456170 keys | 2730 slots | 0 slaves.
[OK] 5768953 keys in 7 masters.
352.11 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.56 TO 172.31.5.69 ###
[0m
{ reshardFrom: '172.31.5.56', reshardTo: '172.31.5.69', slots: 390 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 1275812 keys | 2731 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 1143574 keys | 2730 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 212571 keys | 2730 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 1374329 keys | 2731 slots | 0 slaves.
172.31.5.69:6379 (c767ab28...) -> 1306497 keys | 2732 slots | 1 slaves.
172.31.5.9:6379 (a4f97e81...) -> 456170 keys | 2730 slots | 0 slaves.
[OK] 5768953 keys in 6 masters.
352.11 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### REMOVING 172.31.5.56:6379 FROM CLUSTER ###
[0m
> redis-cli --cluster del-node 172.31.5.56:6379 234e48dd8ec12ce323c6ae15e58211ab6cff76c4
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 1275812 keys | 2731 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 1143574 keys | 2730 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 212571 keys | 2730 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 1374329 keys | 2731 slots | 0 slaves.
172.31.5.69:6379 (c767ab28...) -> 1306497 keys | 2732 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 456170 keys | 2730 slots | 0 slaves.
[OK] 5768953 keys in 6 masters.
352.11 keys per slot on average.
 
total slots: 16384
Removing node 234e48dd8ec12ce323c6ae15e58211ab6cff76c4 from cluster 172.31.5.56:6379
Sending CLUSTER FORGET messages to the cluster...
Sending CLUSTER RESET SOFT to the deleted node.
[33m### REBALANCING CLUSTER ON 172.31.5.192:6379 ###
[0m
> redis-cli --cluster rebalance 172.31.5.192:6379 --cluster-use-empty-masters | grep -i Rebalancing
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 1275812 keys | 2731 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 1143574 keys | 2730 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 212571 keys | 2730 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 1374329 keys | 2731 slots | 0 slaves.
172.31.5.69:6379 (c767ab28...) -> 1306497 keys | 2732 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 456170 keys | 2730 slots | 0 slaves.
[OK] 5768953 keys in 6 masters.
352.11 keys per slot on average.
 
total slots: 16384
*** No rebalancing needed! All nodes are within the 2.00% threshold.


waiting... 65 64 63 62 61 60 59 58 57 56 55 54 53 52 51 50 49 48 47 46 45 44 43 42 41 40 39 38 37 36 35 34 33 32 31 30 29 28 27 26 25 24 23 22 21 20 19 18 17 16 15 14 13 12 11 10 9 8 7 6 5 4 3 2 1 



[34m******* resize , 6 completed ******* [0m 

------------------------------------------------------------------

[34m******* write , 500000 *******[0m

[33m### WRITING 500000 KEYS ###
[0m
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 1359226 keys | 2731 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 1226959 keys | 2730 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 295973 keys | 2730 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 1457562 keys | 2731 slots | 0 slaves.
172.31.5.69:6379 (c767ab28...) -> 1389778 keys | 2732 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 539455 keys | 2730 slots | 0 slaves.
[OK] 6268953 keys in 6 masters.
382.63 keys per slot on average.
 
total slots: 16384
0.5M keys written successfully

[34m******* write , 500000 completed ******* [0m 

------------------------------------------------------------------

[34m******* resize , 3 *******[0m

{ clusterSize: 6 }
[33m### REBALANCING CLUSTER ON 172.31.5.69:6379 ###
[0m
> redis-cli --cluster rebalance 172.31.5.69:6379 --cluster-use-empty-masters | grep -i Rebalancing
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 1359226 keys | 2731 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 1226959 keys | 2730 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 295973 keys | 2730 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 1457562 keys | 2731 slots | 0 slaves.
172.31.5.69:6379 (c767ab28...) -> 1389778 keys | 2732 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 539455 keys | 2730 slots | 0 slaves.
[OK] 6268953 keys in 6 masters.
382.63 keys per slot on average.
 
total slots: 16384
*** No rebalancing needed! All nodes are within the 2.00% threshold.


{ distribution: [ 911, 911, 910 ] }
[33m### RESHARDING FROM 172.31.5.69 TO 172.31.5.192 ###
[0m
{ reshardFrom: '172.31.5.69', reshardTo: '172.31.5.192', slots: 911 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 1859694 keys | 3642 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 1226959 keys | 2730 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 295973 keys | 2730 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 1457562 keys | 2731 slots | 0 slaves.
172.31.5.69:6379 (c767ab28...) -> 889310 keys | 1821 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 539455 keys | 2730 slots | 0 slaves.
[OK] 6268953 keys in 6 masters.
382.63 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.69 TO 172.31.5.72 ###
[0m
{ reshardFrom: '172.31.5.69', reshardTo: '172.31.5.72', slots: 911 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 1859694 keys | 3642 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 1226959 keys | 2730 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 295973 keys | 2730 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 1957212 keys | 3642 slots | 0 slaves.
172.31.5.69:6379 (c767ab28...) -> 389660 keys | 910 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 539455 keys | 2730 slots | 0 slaves.
[OK] 6268953 keys in 6 masters.
382.63 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.69 TO 172.31.5.142 ###
[0m
{ reshardFrom: '172.31.5.69', reshardTo: '172.31.5.142', slots: 910 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 1859694 keys | 3642 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 1226959 keys | 2730 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 685633 keys | 3640 slots | 1 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 1957212 keys | 3642 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 539455 keys | 2730 slots | 0 slaves.
[OK] 6268953 keys in 5 masters.
382.63 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### REMOVING 172.31.5.69:6379 FROM CLUSTER ###
[0m
> redis-cli --cluster del-node 172.31.5.69:6379 c767ab28fe1051fc42e029246c44c11abb50fc85
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 1859694 keys | 3642 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 1226959 keys | 2730 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 685633 keys | 3640 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 1957212 keys | 3642 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 539455 keys | 2730 slots | 0 slaves.
[OK] 6268953 keys in 5 masters.
382.63 keys per slot on average.
 
total slots: 16384
Removing node c767ab28fe1051fc42e029246c44c11abb50fc85 from cluster 172.31.5.69:6379
Sending CLUSTER FORGET messages to the cluster...
Sending CLUSTER RESET SOFT to the deleted node.
{ distribution: [ 910, 910, 910 ] }
[33m### RESHARDING FROM 172.31.5.120 TO 172.31.5.72 ###
[0m
{ reshardFrom: '172.31.5.120', reshardTo: '172.31.5.72', slots: 910 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 1859694 keys | 3642 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 726389 keys | 1820 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 685633 keys | 3640 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 2457782 keys | 4552 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 539455 keys | 2730 slots | 0 slaves.
[OK] 6268953 keys in 5 masters.
382.63 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.120 TO 172.31.5.142 ###
[0m
{ reshardFrom: '172.31.5.120', reshardTo: '172.31.5.142', slots: 910 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 1859694 keys | 3642 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 450902 keys | 910 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 961120 keys | 4550 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 2457782 keys | 4552 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 539455 keys | 2730 slots | 0 slaves.
[OK] 6268953 keys in 5 masters.
382.63 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.120 TO 172.31.5.192 ###
[0m
{ reshardFrom: '172.31.5.120', reshardTo: '172.31.5.192', slots: 910 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 2310596 keys | 4552 slots | 1 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 961120 keys | 4550 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 2457782 keys | 4552 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 539455 keys | 2730 slots | 0 slaves.
[OK] 6268953 keys in 4 masters.
382.63 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### REMOVING 172.31.5.120:6379 FROM CLUSTER ###
[0m
> redis-cli --cluster del-node 172.31.5.120:6379 9ca261e70d34be19b2cda07304fb0a02fcec6a94
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 2310596 keys | 4552 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 961120 keys | 4550 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 2457782 keys | 4552 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 539455 keys | 2730 slots | 0 slaves.
[OK] 6268953 keys in 4 masters.
382.63 keys per slot on average.
 
total slots: 16384
Removing node 9ca261e70d34be19b2cda07304fb0a02fcec6a94 from cluster 172.31.5.120:6379
Sending CLUSTER FORGET messages to the cluster...
Sending CLUSTER RESET SOFT to the deleted node.
{ distribution: [ 910, 910, 910 ] }
[33m### RESHARDING FROM 172.31.5.9 TO 172.31.5.142 ###
[0m
{ reshardFrom: '172.31.5.9', reshardTo: '172.31.5.142', slots: 910 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 2310596 keys | 4552 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 1077510 keys | 5460 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 2457782 keys | 4552 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 423065 keys | 1820 slots | 0 slaves.
[OK] 6268953 keys in 4 masters.
382.63 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.9 TO 172.31.5.192 ###
[0m
{ reshardFrom: '172.31.5.9', reshardTo: '172.31.5.192', slots: 910 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 2483244 keys | 5462 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 1077510 keys | 5460 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 2457782 keys | 4552 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 250417 keys | 910 slots | 0 slaves.
[OK] 6268953 keys in 4 masters.
382.63 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.9 TO 172.31.5.72 ###
[0m
{ reshardFrom: '172.31.5.9', reshardTo: '172.31.5.72', slots: 910 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 2483244 keys | 5462 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 1077510 keys | 5460 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 2708199 keys | 5462 slots | 1 slaves.
[OK] 6268953 keys in 3 masters.
382.63 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### REMOVING 172.31.5.9:6379 FROM CLUSTER ###
[0m
> redis-cli --cluster del-node 172.31.5.9:6379 a4f97e8143f27f4282a37484971dbedd141f3ba9
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 2483244 keys | 5462 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 1077510 keys | 5460 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 2708199 keys | 5462 slots | 0 slaves.
[OK] 6268953 keys in 3 masters.
382.63 keys per slot on average.
 
total slots: 16384
Removing node a4f97e8143f27f4282a37484971dbedd141f3ba9 from cluster 172.31.5.9:6379
Sending CLUSTER FORGET messages to the cluster...
Sending CLUSTER RESET SOFT to the deleted node.
[33m### REBALANCING CLUSTER ON 172.31.5.192:6379 ###
[0m
> redis-cli --cluster rebalance 172.31.5.192:6379 --cluster-use-empty-masters | grep -i Rebalancing
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 2483244 keys | 5462 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 1077510 keys | 5460 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 2708199 keys | 5462 slots | 0 slaves.
[OK] 6268953 keys in 3 masters.
382.63 keys per slot on average.
 
total slots: 16384
*** No rebalancing needed! All nodes are within the 2.00% threshold.


waiting... 65 64 63 62 61 60 59 58 57 56 55 54 53 52 51 50 49 48 47 46 45 44 43 42 41 40 39 38 37 36 35 34 33 32 31 30 29 28 27 26 25 24 23 22 21 20 19 18 17 16 15 14 13 12 11 10 9 8 7 6 5 4 3 2 1 



[34m******* resize , 3 completed ******* [0m 

------------------------------------------------------------------

[34m******* write , 500000 *******[0m

[33m### WRITING 500000 KEYS ###
[0m
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 2650143 keys | 5462 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 1244192 keys | 5460 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 2874618 keys | 5462 slots | 0 slaves.
[OK] 6768953 keys in 3 masters.
413.14 keys per slot on average.
 
total slots: 16384
0.5M keys written successfully

[34m******* write , 500000 completed ******* [0m 

------------------------------------------------------------------

[34m******* resize , 6 *******[0m

{ clusterSize: 3 }
[33m### ADDING 172.31.5.9:6379 NODE TO CLUSTER ###
[0m
> redis-cli --cluster add-node 172.31.5.9:6379 172.31.5.192:6379 | awk '{ gsub(/[[0-9;]*m/, ""); print }'
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 2650143 keys | 5462 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 1244192 keys | 5460 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 2874618 keys | 5462 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 0 keys | 0 slots | 0 slaves.
[OK] 6768953 keys in 4 masters.
413.14 keys per slot on average.
 
total slots: 16384
node added successfully
waiting... 2 1 


[33m### ADDING 172.31.5.120:6379 NODE TO CLUSTER ###
[0m
> redis-cli --cluster add-node 172.31.5.120:6379 172.31.5.192:6379 | awk '{ gsub(/[[0-9;]*m/, ""); print }'
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 2650143 keys | 5462 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 1244192 keys | 5460 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 2874618 keys | 5462 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 0 keys | 0 slots | 0 slaves.
[OK] 6768953 keys in 5 masters.
413.14 keys per slot on average.
 
total slots: 16384
node added successfully
waiting... 2 1 


[33m### ADDING 172.31.5.69:6379 NODE TO CLUSTER ###
[0m
> redis-cli --cluster add-node 172.31.5.69:6379 172.31.5.192:6379 | awk '{ gsub(/[[0-9;]*m/, ""); print }'
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 2650143 keys | 5462 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 1244192 keys | 5460 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 2874618 keys | 5462 slots | 0 slaves.
172.31.5.69:6379 (c767ab28...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 0 keys | 0 slots | 0 slaves.
[OK] 6768953 keys in 6 masters.
413.14 keys per slot on average.
 
total slots: 16384
node added successfully
waiting... 2 1 


waiting... 10 9 8 7 6 5 4 3 2 1 


[33m### REBALANCING CLUSTER ON 172.31.5.9:6379 ###
[0m
> redis-cli --cluster rebalance 172.31.5.9:6379 --cluster-use-empty-masters | grep -i Rebalancing
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 1583766 keys | 2730 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 735854 keys | 2731 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 508971 keys | 2730 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 1415464 keys | 2730 slots | 0 slaves.
172.31.5.69:6379 (c767ab28...) -> 1065744 keys | 2731 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 1459154 keys | 2732 slots | 0 slaves.
[OK] 6768953 keys in 6 masters.
413.14 keys per slot on average.
 
total slots: 16384
>>> Rebalancing across 6 nodes. Total weight = 6.00



[34m******* resize , 6 completed ******* [0m 

------------------------------------------------------------------

[34m******* write , 500000 *******[0m

[33m### WRITING 500000 KEYS ###
[0m
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 1667139 keys | 2730 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 819210 keys | 2731 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 592217 keys | 2730 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 1498770 keys | 2730 slots | 0 slaves.
172.31.5.69:6379 (c767ab28...) -> 1149088 keys | 2731 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 1542529 keys | 2732 slots | 0 slaves.
[OK] 7268953 keys in 6 masters.
443.66 keys per slot on average.
 
total slots: 16384
0.5M keys written successfully

[34m******* write , 500000 completed ******* [0m 

------------------------------------------------------------------

[34m******* resize , 4 *******[0m

{ clusterSize: 6 }
[33m### REBALANCING CLUSTER ON 172.31.5.69:6379 ###
[0m
> redis-cli --cluster rebalance 172.31.5.69:6379 --cluster-use-empty-masters | grep -i Rebalancing
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 1667139 keys | 2730 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 819210 keys | 2731 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 592217 keys | 2730 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 1498770 keys | 2730 slots | 0 slaves.
172.31.5.69:6379 (c767ab28...) -> 1149088 keys | 2731 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 1542529 keys | 2732 slots | 0 slaves.
[OK] 7268953 keys in 6 masters.
443.66 keys per slot on average.
 
total slots: 16384
*** No rebalancing needed! All nodes are within the 2.00% threshold.


{ distribution: [ 683, 683, 683, 682 ] }
[33m### RESHARDING FROM 172.31.5.69 TO 172.31.5.192 ###
[0m
{ reshardFrom: '172.31.5.69', reshardTo: '172.31.5.192', slots: 683 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 2084349 keys | 3413 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 819210 keys | 2731 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 592217 keys | 2730 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 1498770 keys | 2730 slots | 0 slaves.
172.31.5.69:6379 (c767ab28...) -> 731878 keys | 2048 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 1542529 keys | 2732 slots | 0 slaves.
[OK] 7268953 keys in 6 masters.
443.66 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.69 TO 172.31.5.72 ###
[0m
{ reshardFrom: '172.31.5.69', reshardTo: '172.31.5.72', slots: 683 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 2084349 keys | 3413 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 819210 keys | 2731 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 592217 keys | 2730 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 1745859 keys | 3413 slots | 0 slaves.
172.31.5.69:6379 (c767ab28...) -> 484789 keys | 1365 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 1542529 keys | 2732 slots | 0 slaves.
[OK] 7268953 keys in 6 masters.
443.66 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.69 TO 172.31.5.142 ###
[0m
{ reshardFrom: '172.31.5.69', reshardTo: '172.31.5.142', slots: 683 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 2084349 keys | 3413 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 819210 keys | 2731 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 717596 keys | 3413 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 1745859 keys | 3413 slots | 0 slaves.
172.31.5.69:6379 (c767ab28...) -> 359410 keys | 682 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 1542529 keys | 2732 slots | 0 slaves.
[OK] 7268953 keys in 6 masters.
443.66 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.69 TO 172.31.5.9 ###
[0m
{ reshardFrom: '172.31.5.69', reshardTo: '172.31.5.9', slots: 682 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 2084349 keys | 3413 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 819210 keys | 2731 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 717596 keys | 3413 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 1745859 keys | 3413 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 1901939 keys | 3414 slots | 1 slaves.
[OK] 7268953 keys in 5 masters.
443.66 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### REMOVING 172.31.5.69:6379 FROM CLUSTER ###
[0m
> redis-cli --cluster del-node 172.31.5.69:6379 c767ab28fe1051fc42e029246c44c11abb50fc85
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 2084349 keys | 3413 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 819210 keys | 2731 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 717596 keys | 3413 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 1745859 keys | 3413 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 1901939 keys | 3414 slots | 0 slaves.
[OK] 7268953 keys in 5 masters.
443.66 keys per slot on average.
 
total slots: 16384
Removing node c767ab28fe1051fc42e029246c44c11abb50fc85 from cluster 172.31.5.69:6379
Sending CLUSTER FORGET messages to the cluster...
Sending CLUSTER RESET SOFT to the deleted node.
{ distribution: [ 683, 683, 683, 682 ] }
[33m### RESHARDING FROM 172.31.5.120 TO 172.31.5.72 ###
[0m
{ reshardFrom: '172.31.5.120', reshardTo: '172.31.5.72', slots: 683 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 2084349 keys | 3413 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 601611 keys | 2048 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 717596 keys | 3413 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 1963458 keys | 4096 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 1901939 keys | 3414 slots | 0 slaves.
[OK] 7268953 keys in 5 masters.
443.66 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.120 TO 172.31.5.142 ###
[0m
{ reshardFrom: '172.31.5.120', reshardTo: '172.31.5.142', slots: 683 }
assertion error.
 {
  keys1: 7268953,
  keys2: 5367015,
  keys: 0,
  slots1: 16384,
  slots2: 16384,
  nodes1: 5,
  nodes2: 5,
  nodes: 0
}
precheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 2084349 keys | 3413 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 601611 keys | 2048 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 717596 keys | 3413 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 1963458 keys | 4096 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 1901939 keys | 3414 slots | 0 slaves.
[OK] 7268953 keys in 5 masters.
443.66 keys per slot on average.

postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 2084349 keys | 3413 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 485446 keys | 1365 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 833761 keys | 4096 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 1963458 keys | 4096 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 1 keys | 3414 slots | 0 slaves.
[OK] 5367015 keys in 5 masters.
327.58 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.120 TO 172.31.5.9 ###
[0m
{ reshardFrom: '172.31.5.120', reshardTo: '172.31.5.9', slots: 683 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 2084349 keys | 3413 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 162208 keys | 682 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 833761 keys | 4096 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 1963458 keys | 4096 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 323239 keys | 4097 slots | 0 slaves.
[OK] 5367015 keys in 5 masters.
327.58 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.120 TO 172.31.5.192 ###
[0m
{ reshardFrom: '172.31.5.120', reshardTo: '172.31.5.192', slots: 682 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 2246557 keys | 4095 slots | 1 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 833761 keys | 4096 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 1963458 keys | 4096 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 323239 keys | 4097 slots | 0 slaves.
[OK] 5367015 keys in 4 masters.
327.58 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### REMOVING 172.31.5.120:6379 FROM CLUSTER ###
[0m
> redis-cli --cluster del-node 172.31.5.120:6379 9ca261e70d34be19b2cda07304fb0a02fcec6a94
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 2246557 keys | 4095 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 833761 keys | 4096 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 1963458 keys | 4096 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 323239 keys | 4097 slots | 0 slaves.
[OK] 5367015 keys in 4 masters.
327.58 keys per slot on average.
 
total slots: 16384
Removing node 9ca261e70d34be19b2cda07304fb0a02fcec6a94 from cluster 172.31.5.120:6379
Sending CLUSTER FORGET messages to the cluster...
Sending CLUSTER RESET SOFT to the deleted node.
[33m### REBALANCING CLUSTER ON 172.31.5.192:6379 ###
[0m
> redis-cli --cluster rebalance 172.31.5.192:6379 --cluster-use-empty-masters | grep -i Rebalancing
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 2246557 keys | 4095 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 833761 keys | 4096 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 1963458 keys | 4096 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 323239 keys | 4097 slots | 0 slaves.
[OK] 5367015 keys in 4 masters.
327.58 keys per slot on average.
 
total slots: 16384
*** No rebalancing needed! All nodes are within the 2.00% threshold.


waiting... 65 64 63 62 61 60 59 58 57 56 55 54 53 52 51 50 49 48 47 46 45 44 43 42 41 40 39 38 37 36 35 34 33 32 31 30 29 28 27 26 25 24 23 22 21 20 19 18 17 16 15 14 13 12 11 10 9 8 7 6 5 4 3 2 1 



[34m******* resize , 4 completed ******* [0m 

------------------------------------------------------------------

[34m******* write , 500000 *******[0m

[33m### WRITING 500000 KEYS ###
[0m
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 2371468 keys | 4095 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 958722 keys | 4096 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 2088500 keys | 4096 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 448325 keys | 4097 slots | 0 slaves.
[OK] 5867015 keys in 4 masters.
358.09 keys per slot on average.
 
total slots: 16384
0.5M keys written successfully

[34m******* write , 500000 completed ******* [0m 

------------------------------------------------------------------

[34m******* resize , 6 *******[0m

{ clusterSize: 4 }
[33m### ADDING 172.31.5.120:6379 NODE TO CLUSTER ###
[0m
> redis-cli --cluster add-node 172.31.5.120:6379 172.31.5.192:6379 | awk '{ gsub(/[[0-9;]*m/, ""); print }'
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 2371468 keys | 4095 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 958722 keys | 4096 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 2088500 keys | 4096 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 448325 keys | 4097 slots | 0 slaves.
[OK] 5867015 keys in 5 masters.
358.09 keys per slot on average.
 
total slots: 16384
node added successfully
waiting... 2 1 


[33m### ADDING 172.31.5.69:6379 NODE TO CLUSTER ###
[0m
> redis-cli --cluster add-node 172.31.5.69:6379 172.31.5.192:6379 | awk '{ gsub(/[[0-9;]*m/, ""); print }'
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 2371468 keys | 4095 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 958722 keys | 4096 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 2088500 keys | 4096 slots | 0 slaves.
172.31.5.69:6379 (c767ab28...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 448325 keys | 4097 slots | 0 slaves.
[OK] 5867015 keys in 6 masters.
358.09 keys per slot on average.
 
total slots: 16384
node added successfully
waiting... 2 1 


waiting... 10 9 8 7 6 5 4 3 2 1 


[33m### REBALANCING CLUSTER ON 172.31.5.120:6379 ###
[0m
> redis-cli --cluster rebalance 172.31.5.120:6379 --cluster-use-empty-masters | grep -i Rebalancing
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 1750450 keys | 2730 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 324679 keys | 2732 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 675533 keys | 2730 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 1582151 keys | 2730 slots | 0 slaves.
172.31.5.69:6379 (c767ab28...) -> 1127568 keys | 2732 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 406634 keys | 2730 slots | 0 slaves.
[OK] 5867015 keys in 6 masters.
358.09 keys per slot on average.
 
total slots: 16384
>>> Rebalancing across 6 nodes. Total weight = 6.00



[34m******* resize , 6 completed ******* [0m 

------------------------------------------------------------------

[34m******* write , 500000 *******[0m

[33m### WRITING 500000 KEYS ###
[0m
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 1833681 keys | 2730 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 407859 keys | 2732 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 758826 keys | 2730 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 1665602 keys | 2730 slots | 0 slaves.
172.31.5.69:6379 (c767ab28...) -> 1211005 keys | 2732 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 490042 keys | 2730 slots | 0 slaves.
[OK] 6367015 keys in 6 masters.
388.61 keys per slot on average.
 
total slots: 16384
0.5M keys written successfully

[34m******* write , 500000 completed ******* [0m 

------------------------------------------------------------------

[34m******* resize , 5 *******[0m

{ clusterSize: 6 }
[33m### REBALANCING CLUSTER ON 172.31.5.69:6379 ###
[0m
> redis-cli --cluster rebalance 172.31.5.69:6379 --cluster-use-empty-masters | grep -i Rebalancing
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 1833681 keys | 2730 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 407859 keys | 2732 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 758826 keys | 2730 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 1665602 keys | 2730 slots | 0 slaves.
172.31.5.69:6379 (c767ab28...) -> 1211005 keys | 2732 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 490042 keys | 2730 slots | 0 slaves.
[OK] 6367015 keys in 6 masters.
388.61 keys per slot on average.
 
total slots: 16384
*** No rebalancing needed! All nodes are within the 2.00% threshold.


{ distribution: [ 547, 547, 546, 546, 546 ] }
[33m### RESHARDING FROM 172.31.5.69 TO 172.31.5.192 ###
[0m
{ reshardFrom: '172.31.5.69', reshardTo: '172.31.5.192', slots: 547 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 2201408 keys | 3277 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 407859 keys | 2732 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 758826 keys | 2730 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 1665602 keys | 2730 slots | 0 slaves.
172.31.5.69:6379 (c767ab28...) -> 843278 keys | 2185 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 490042 keys | 2730 slots | 0 slaves.
[OK] 6367015 keys in 6 masters.
388.61 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.69 TO 172.31.5.72 ###
[0m
{ reshardFrom: '172.31.5.69', reshardTo: '172.31.5.72', slots: 547 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 2201408 keys | 3277 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 407859 keys | 2732 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 758826 keys | 2730 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 1983357 keys | 3277 slots | 0 slaves.
172.31.5.69:6379 (c767ab28...) -> 525523 keys | 1638 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 490042 keys | 2730 slots | 0 slaves.
[OK] 6367015 keys in 6 masters.
388.61 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.69 TO 172.31.5.142 ###
[0m
{ reshardFrom: '172.31.5.69', reshardTo: '172.31.5.142', slots: 546 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 2201408 keys | 3277 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 407859 keys | 2732 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 940640 keys | 3276 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 1983357 keys | 3277 slots | 0 slaves.
172.31.5.69:6379 (c767ab28...) -> 343709 keys | 1092 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 490042 keys | 2730 slots | 0 slaves.
[OK] 6367015 keys in 6 masters.
388.61 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.69 TO 172.31.5.9 ###
[0m
{ reshardFrom: '172.31.5.69', reshardTo: '172.31.5.9', slots: 546 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 2201408 keys | 3277 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 407859 keys | 2732 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 940640 keys | 3276 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 1983357 keys | 3277 slots | 0 slaves.
172.31.5.69:6379 (c767ab28...) -> 170688 keys | 546 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 663063 keys | 3276 slots | 0 slaves.
[OK] 6367015 keys in 6 masters.
388.61 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.69 TO 172.31.5.120 ###
[0m
{ reshardFrom: '172.31.5.69', reshardTo: '172.31.5.120', slots: 546 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 2201408 keys | 3277 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 578547 keys | 3278 slots | 1 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 940640 keys | 3276 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 1983357 keys | 3277 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 663063 keys | 3276 slots | 0 slaves.
[OK] 6367015 keys in 5 masters.
388.61 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### REMOVING 172.31.5.69:6379 FROM CLUSTER ###
[0m
> redis-cli --cluster del-node 172.31.5.69:6379 c767ab28fe1051fc42e029246c44c11abb50fc85
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 2201408 keys | 3277 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 578547 keys | 3278 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 940640 keys | 3276 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 1983357 keys | 3277 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 663063 keys | 3276 slots | 0 slaves.
[OK] 6367015 keys in 5 masters.
388.61 keys per slot on average.
 
total slots: 16384
Removing node c767ab28fe1051fc42e029246c44c11abb50fc85 from cluster 172.31.5.69:6379
Sending CLUSTER FORGET messages to the cluster...
Sending CLUSTER RESET SOFT to the deleted node.
[33m### REBALANCING CLUSTER ON 172.31.5.192:6379 ###
[0m
> redis-cli --cluster rebalance 172.31.5.192:6379 --cluster-use-empty-masters | grep -i Rebalancing
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 2201408 keys | 3277 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 578547 keys | 3278 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 940640 keys | 3276 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 1983357 keys | 3277 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 663063 keys | 3276 slots | 0 slaves.
[OK] 6367015 keys in 5 masters.
388.61 keys per slot on average.
 
total slots: 16384
*** No rebalancing needed! All nodes are within the 2.00% threshold.


waiting... 65 64 63 62 61 60 59 58 57 56 55 54 53 52 51 50 49 48 47 46 45 44 43 42 41 40 39 38 37 36 35 34 33 32 31 30 29 28 27 26 25 24 23 22 21 20 19 18 17 16 15 14 13 12 11 10 9 8 7 6 5 4 3 2 1 



[34m******* resize , 5 completed ******* [0m 

------------------------------------------------------------------

[34m******* write , 500000 *******[0m

[33m### WRITING 500000 KEYS ###
[0m
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 2301330 keys | 3277 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 678582 keys | 3278 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 1040658 keys | 3276 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 2083380 keys | 3277 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 763065 keys | 3276 slots | 0 slaves.
[OK] 6867015 keys in 5 masters.
419.13 keys per slot on average.
 
total slots: 16384
0.5M keys written successfully

[34m******* write , 500000 completed ******* [0m 

------------------------------------------------------------------

[34m******* resize , 3 *******[0m

{ clusterSize: 5 }
[33m### REBALANCING CLUSTER ON 172.31.5.120:6379 ###
[0m
> redis-cli --cluster rebalance 172.31.5.120:6379 --cluster-use-empty-masters | grep -i Rebalancing
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 2301330 keys | 3277 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 678582 keys | 3278 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 1040658 keys | 3276 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 2083380 keys | 3277 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 763065 keys | 3276 slots | 0 slaves.
[OK] 6867015 keys in 5 masters.
419.13 keys per slot on average.
 
total slots: 16384
*** No rebalancing needed! All nodes are within the 2.00% threshold.


{ distribution: [ 1093, 1093, 1092 ] }
[33m### RESHARDING FROM 172.31.5.120 TO 172.31.5.192 ###
[0m
{ reshardFrom: '172.31.5.120', reshardTo: '172.31.5.192', slots: 1093 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 2401422 keys | 4370 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 578490 keys | 2185 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 1040658 keys | 3276 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 2083380 keys | 3277 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 763065 keys | 3276 slots | 0 slaves.
[OK] 6867015 keys in 5 masters.
419.13 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.120 TO 172.31.5.72 ###
[0m
{ reshardFrom: '172.31.5.120', reshardTo: '172.31.5.72', slots: 1093 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 2401422 keys | 4370 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 337707 keys | 1092 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 1040658 keys | 3276 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 2324163 keys | 4370 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 763065 keys | 3276 slots | 0 slaves.
[OK] 6867015 keys in 5 masters.
419.13 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.120 TO 172.31.5.142 ###
[0m
{ reshardFrom: '172.31.5.120', reshardTo: '172.31.5.142', slots: 1092 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 2401422 keys | 4370 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 1378365 keys | 4368 slots | 1 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 2324163 keys | 4370 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 763065 keys | 3276 slots | 0 slaves.
[OK] 6867015 keys in 4 masters.
419.13 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### REMOVING 172.31.5.120:6379 FROM CLUSTER ###
[0m
> redis-cli --cluster del-node 172.31.5.120:6379 9ca261e70d34be19b2cda07304fb0a02fcec6a94
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 2401422 keys | 4370 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 1378365 keys | 4368 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 2324163 keys | 4370 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 763065 keys | 3276 slots | 0 slaves.
[OK] 6867015 keys in 4 masters.
419.13 keys per slot on average.
 
total slots: 16384
Removing node 9ca261e70d34be19b2cda07304fb0a02fcec6a94 from cluster 172.31.5.120:6379
Sending CLUSTER FORGET messages to the cluster...
Sending CLUSTER RESET SOFT to the deleted node.
{ distribution: [ 1092, 1092, 1092 ] }
[33m### RESHARDING FROM 172.31.5.9 TO 172.31.5.72 ###
[0m
{ reshardFrom: '172.31.5.9', reshardTo: '172.31.5.72', slots: 1092 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 2401422 keys | 4370 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 1378365 keys | 4368 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 2486258 keys | 5462 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 600970 keys | 2184 slots | 0 slaves.
[OK] 6867015 keys in 4 masters.
419.13 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.9 TO 172.31.5.142 ###
[0m
{ reshardFrom: '172.31.5.9', reshardTo: '172.31.5.142', slots: 1092 }
assertion error.
 {
  keys1: 6867015,
  keys2: 6672428,
  keys: 0,
  slots1: 16384,
  slots2: 16384,
  nodes1: 4,
  nodes2: 4,
  nodes: 0
}
precheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 2401422 keys | 4370 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 1378365 keys | 4368 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 2486258 keys | 5462 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 600970 keys | 2184 slots | 0 slaves.
[OK] 6867015 keys in 4 masters.
419.13 keys per slot on average.

postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 2401422 keys | 4370 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 1784748 keys | 5460 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 2486258 keys | 5462 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 0 keys | 1092 slots | 0 slaves.
[OK] 6672428 keys in 4 masters.
407.25 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.9 TO 172.31.5.192 ###
[0m
{ reshardFrom: '172.31.5.9', reshardTo: '172.31.5.192', slots: 1092 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 2401422 keys | 5462 slots | 1 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 1784748 keys | 5460 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 2486258 keys | 5462 slots | 0 slaves.
[OK] 6672428 keys in 3 masters.
407.25 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### REMOVING 172.31.5.9:6379 FROM CLUSTER ###
[0m
> redis-cli --cluster del-node 172.31.5.9:6379 a4f97e8143f27f4282a37484971dbedd141f3ba9
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 2401422 keys | 5462 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 1784748 keys | 5460 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 2486258 keys | 5462 slots | 0 slaves.
[OK] 6672428 keys in 3 masters.
407.25 keys per slot on average.
 
total slots: 16384
Removing node a4f97e8143f27f4282a37484971dbedd141f3ba9 from cluster 172.31.5.9:6379
Sending CLUSTER FORGET messages to the cluster...
Sending CLUSTER RESET SOFT to the deleted node.
[33m### REBALANCING CLUSTER ON 172.31.5.192:6379 ###
[0m
> redis-cli --cluster rebalance 172.31.5.192:6379 --cluster-use-empty-masters | grep -i Rebalancing
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 2401422 keys | 5462 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 1784748 keys | 5460 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 2486258 keys | 5462 slots | 0 slaves.
[OK] 6672428 keys in 3 masters.
407.25 keys per slot on average.
 
total slots: 16384
*** No rebalancing needed! All nodes are within the 2.00% threshold.


waiting... 65 64 63 62 61 60 59 58 57 56 55 54 53 52 51 50 49 48 47 46 45 44 43 42 41 40 39 38 37 36 35 34 33 32 31 30 29 28 27 26 25 24 23 22 21 20 19 18 17 16 15 14 13 12 11 10 9 8 7 6 5 4 3 2 1 



[34m******* resize , 3 completed ******* [0m 

------------------------------------------------------------------

[34m******* write , 500000 *******[0m

[33m### WRITING 500000 KEYS ###
[0m
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 2567940 keys | 5462 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 1951429 keys | 5460 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 2653059 keys | 5462 slots | 0 slaves.
[OK] 7172428 keys in 3 masters.
437.77 keys per slot on average.
 
total slots: 16384
0.5M keys written successfully

[34m******* write , 500000 completed ******* [0m 

------------------------------------------------------------------

[34m******* resize , 5 *******[0m

{ clusterSize: 3 }
[33m### ADDING 172.31.5.9:6379 NODE TO CLUSTER ###
[0m
> redis-cli --cluster add-node 172.31.5.9:6379 172.31.5.192:6379 | awk '{ gsub(/[[0-9;]*m/, ""); print }'
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 2567940 keys | 5462 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 1951429 keys | 5460 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 2653059 keys | 5462 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 0 keys | 0 slots | 0 slaves.
[OK] 7172428 keys in 4 masters.
437.77 keys per slot on average.
 
total slots: 16384
node added successfully
waiting... 2 1 


[33m### ADDING 172.31.5.120:6379 NODE TO CLUSTER ###
[0m
> redis-cli --cluster add-node 172.31.5.120:6379 172.31.5.192:6379 | awk '{ gsub(/[[0-9;]*m/, ""); print }'
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 2567940 keys | 5462 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 1951429 keys | 5460 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 2653059 keys | 5462 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 0 keys | 0 slots | 0 slaves.
[OK] 7172428 keys in 5 masters.
437.77 keys per slot on average.
 
total slots: 16384
node added successfully
waiting... 2 1 


waiting... 10 9 8 7 6 5 4 3 2 1 


[33m### REBALANCING CLUSTER ON 172.31.5.9:6379 ###
[0m
> redis-cli --cluster rebalance 172.31.5.9:6379 --cluster-use-empty-masters | grep -i Rebalancing
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 2016878 keys | 3276 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 935506 keys | 3278 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 1099678 keys | 3276 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 1995564 keys | 3276 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 1124802 keys | 3278 slots | 0 slaves.
[OK] 7172428 keys in 5 masters.
437.77 keys per slot on average.
 
total slots: 16384
>>> Rebalancing across 5 nodes. Total weight = 5.00



[34m******* resize , 5 completed ******* [0m 

------------------------------------------------------------------

[34m******* write , 500000 *******[0m

[33m### WRITING 500000 KEYS ###
[0m
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 2116863 keys | 3276 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 1035549 keys | 3278 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 1199563 keys | 3276 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 2095560 keys | 3276 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 1224893 keys | 3278 slots | 0 slaves.
[OK] 7672428 keys in 5 masters.
468.29 keys per slot on average.
 
total slots: 16384
0.5M keys written successfully

[34m******* write , 500000 completed ******* [0m 

------------------------------------------------------------------

[34m******* resize , 4 *******[0m

{ clusterSize: 5 }
[33m### REBALANCING CLUSTER ON 172.31.5.120:6379 ###
[0m
> redis-cli --cluster rebalance 172.31.5.120:6379 --cluster-use-empty-masters | grep -i Rebalancing
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 2116863 keys | 3276 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 1035549 keys | 3278 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 1199563 keys | 3276 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 2095560 keys | 3276 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 1224893 keys | 3278 slots | 0 slaves.
[OK] 7672428 keys in 5 masters.
468.29 keys per slot on average.
 
total slots: 16384
*** No rebalancing needed! All nodes are within the 2.00% threshold.


{ distribution: [ 820, 820, 819, 819 ] }
[33m### RESHARDING FROM 172.31.5.120 TO 172.31.5.192 ###
[0m
{ reshardFrom: '172.31.5.120', reshardTo: '172.31.5.192', slots: 820 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 2301334 keys | 4096 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 851078 keys | 2458 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 1199563 keys | 3276 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 2095560 keys | 3276 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 1224893 keys | 3278 slots | 0 slaves.
[OK] 7672428 keys in 5 masters.
468.29 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.120 TO 172.31.5.72 ###
[0m
{ reshardFrom: '172.31.5.120', reshardTo: '172.31.5.72', slots: 820 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 2301334 keys | 4096 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 347668 keys | 1638 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 1199563 keys | 3276 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 2598970 keys | 4096 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 1224893 keys | 3278 slots | 0 slaves.
[OK] 7672428 keys in 5 masters.
468.29 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.120 TO 172.31.5.142 ###
[0m
{ reshardFrom: '172.31.5.120', reshardTo: '172.31.5.142', slots: 819 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 2301334 keys | 4096 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 125157 keys | 819 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 1422074 keys | 4095 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 2598970 keys | 4096 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 1224893 keys | 3278 slots | 0 slaves.
[OK] 7672428 keys in 5 masters.
468.29 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.120 TO 172.31.5.9 ###
[0m
{ reshardFrom: '172.31.5.120', reshardTo: '172.31.5.9', slots: 819 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 2301334 keys | 4096 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 1422074 keys | 4095 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 2598970 keys | 4096 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 1350050 keys | 4097 slots | 1 slaves.
[OK] 7672428 keys in 4 masters.
468.29 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### REMOVING 172.31.5.120:6379 FROM CLUSTER ###
[0m
> redis-cli --cluster del-node 172.31.5.120:6379 9ca261e70d34be19b2cda07304fb0a02fcec6a94
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 2301334 keys | 4096 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 1422074 keys | 4095 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 2598970 keys | 4096 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 1350050 keys | 4097 slots | 0 slaves.
[OK] 7672428 keys in 4 masters.
468.29 keys per slot on average.
 
total slots: 16384
Removing node 9ca261e70d34be19b2cda07304fb0a02fcec6a94 from cluster 172.31.5.120:6379
Sending CLUSTER FORGET messages to the cluster...
Sending CLUSTER RESET SOFT to the deleted node.
[33m### REBALANCING CLUSTER ON 172.31.5.192:6379 ###
[0m
> redis-cli --cluster rebalance 172.31.5.192:6379 --cluster-use-empty-masters | grep -i Rebalancing
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 2301334 keys | 4096 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 1422074 keys | 4095 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 2598970 keys | 4096 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 1350050 keys | 4097 slots | 0 slaves.
[OK] 7672428 keys in 4 masters.
468.29 keys per slot on average.
 
total slots: 16384
*** No rebalancing needed! All nodes are within the 2.00% threshold.


waiting... 65 64 63 62 61 60 59 58 57 56 55 54 53 52 51 50 49 48 47 46 45 44 43 42 41 40 39 38 37 36 35 34 33 32 31 30 29 28 27 26 25 24 23 22 21 20 19 18 17 16 15 14 13 12 11 10 9 8 7 6 5 4 3 2 1 



[34m******* resize , 4 completed ******* [0m 

------------------------------------------------------------------

[34m******* write , 500000 *******[0m

[33m### WRITING 500000 KEYS ###
[0m
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 2426314 keys | 4096 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 1547193 keys | 4095 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 2724097 keys | 4096 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 1474824 keys | 4097 slots | 0 slaves.
[OK] 8172428 keys in 4 masters.
498.81 keys per slot on average.
 
total slots: 16384
0.5M keys written successfully

[34m******* write , 500000 completed ******* [0m 

------------------------------------------------------------------

[34m******* resize , 3 *******[0m

{ clusterSize: 4 }
[33m### REBALANCING CLUSTER ON 172.31.5.9:6379 ###
[0m
> redis-cli --cluster rebalance 172.31.5.9:6379 --cluster-use-empty-masters | grep -i Rebalancing
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 2426314 keys | 4096 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 1547193 keys | 4095 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 2724097 keys | 4096 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 1474824 keys | 4097 slots | 0 slaves.
[OK] 8172428 keys in 4 masters.
498.81 keys per slot on average.
 
total slots: 16384
*** No rebalancing needed! All nodes are within the 2.00% threshold.


{ distribution: [ 1366, 1366, 1365 ] }
[33m### RESHARDING FROM 172.31.5.9 TO 172.31.5.192 ###
[0m
{ reshardFrom: '172.31.5.9', reshardTo: '172.31.5.192', slots: 1366 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 3232249 keys | 5462 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 1547193 keys | 4095 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 2724097 keys | 4096 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 668889 keys | 2731 slots | 0 slaves.
[OK] 8172428 keys in 4 masters.
498.81 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.9 TO 172.31.5.72 ###
[0m
{ reshardFrom: '172.31.5.9', reshardTo: '172.31.5.72', slots: 1366 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 3232249 keys | 5462 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 1547193 keys | 4095 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 3074875 keys | 5462 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 318111 keys | 1365 slots | 0 slaves.
[OK] 8172428 keys in 4 masters.
498.81 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.9 TO 172.31.5.142 ###
[0m
{ reshardFrom: '172.31.5.9', reshardTo: '172.31.5.142', slots: 1365 }
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 3232249 keys | 5462 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 1865304 keys | 5460 slots | 1 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 3074875 keys | 5462 slots | 0 slaves.
[OK] 8172428 keys in 3 masters.
498.81 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### REMOVING 172.31.5.9:6379 FROM CLUSTER ###
[0m
> redis-cli --cluster del-node 172.31.5.9:6379 a4f97e8143f27f4282a37484971dbedd141f3ba9
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 3232249 keys | 5462 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 1865304 keys | 5460 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 3074875 keys | 5462 slots | 0 slaves.
[OK] 8172428 keys in 3 masters.
498.81 keys per slot on average.
 
total slots: 16384
Removing node a4f97e8143f27f4282a37484971dbedd141f3ba9 from cluster 172.31.5.9:6379
Sending CLUSTER FORGET messages to the cluster...
Sending CLUSTER RESET SOFT to the deleted node.
[33m### REBALANCING CLUSTER ON 172.31.5.192:6379 ###
[0m
> redis-cli --cluster rebalance 172.31.5.192:6379 --cluster-use-empty-masters | grep -i Rebalancing
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 3232249 keys | 5462 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 1865304 keys | 5460 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 3074875 keys | 5462 slots | 0 slaves.
[OK] 8172428 keys in 3 masters.
498.81 keys per slot on average.
 
total slots: 16384
*** No rebalancing needed! All nodes are within the 2.00% threshold.


waiting... 65 64 63 62 61 60 59 58 57 56 55 54 53 52 51 50 49 48 47 46 45 44 43 42 41 40 39 38 37 36 35 34 33 32 31 30 29 28 27 26 25 24 23 22 21 20 19 18 17 16 15 14 13 12 11 10 9 8 7 6 5 4 3 2 1 



[34m******* resize , 3 completed ******* [0m 

------------------------------------------------------------------

[34m******* write , 500000 *******[0m

[33m### WRITING 500000 KEYS ###
[0m
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 3398916 keys | 5462 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 2031930 keys | 5460 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 3241582 keys | 5462 slots | 0 slaves.
[OK] 8672428 keys in 3 masters.
529.32 keys per slot on average.
 
total slots: 16384
0.5M keys written successfully

[34m******* write , 500000 completed ******* [0m 

------------------------------------------------------------------

[34m******* resize , 4 *******[0m

{ clusterSize: 3 }
[33m### ADDING 172.31.5.9:6379 NODE TO CLUSTER ###
[0m
> redis-cli --cluster add-node 172.31.5.9:6379 172.31.5.192:6379 | awk '{ gsub(/[[0-9;]*m/, ""); print }'
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 3398916 keys | 5462 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 2031930 keys | 5460 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 3241582 keys | 5462 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 0 keys | 0 slots | 0 slaves.
[OK] 8672428 keys in 4 masters.
529.32 keys per slot on average.
 
total slots: 16384
node added successfully
waiting... 2 1 


waiting... 10 9 8 7 6 5 4 3 2 1 


[33m### REBALANCING CLUSTER ON 172.31.5.9:6379 ###
[0m
> redis-cli --cluster rebalance 172.31.5.9:6379 --cluster-use-empty-masters | grep -i Rebalancing
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 2551327 keys | 4096 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 1575078 keys | 4096 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 2796345 keys | 4096 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 1749678 keys | 4096 slots | 0 slaves.
[OK] 8672428 keys in 4 masters.
529.32 keys per slot on average.
 
total slots: 16384
>>> Rebalancing across 4 nodes. Total weight = 4.00



[34m******* resize , 4 completed ******* [0m 

------------------------------------------------------------------

[34m******* write , 500000 *******[0m

[33m### WRITING 500000 KEYS ###
[0m
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 2676368 keys | 4096 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 1700096 keys | 4096 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 2921262 keys | 4096 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 1874702 keys | 4096 slots | 0 slaves.
[OK] 9172428 keys in 4 masters.
559.84 keys per slot on average.
 
total slots: 16384
0.5M keys written successfully

[34m******* write , 500000 completed ******* [0m 

------------------------------------------------------------------

[34m******* resize , 5 *******[0m

{ clusterSize: 4 }
[33m### ADDING 172.31.5.120:6379 NODE TO CLUSTER ###
[0m
> redis-cli --cluster add-node 172.31.5.120:6379 172.31.5.192:6379 | awk '{ gsub(/[[0-9;]*m/, ""); print }'
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 2676368 keys | 4096 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 1700096 keys | 4096 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 2921262 keys | 4096 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 1874702 keys | 4096 slots | 0 slaves.
[OK] 9172428 keys in 5 masters.
559.84 keys per slot on average.
 
total slots: 16384
node added successfully
waiting... 2 1 


waiting... 10 9 8 7 6 5 4 3 2 1 


[33m### REBALANCING CLUSTER ON 172.31.5.120:6379 ###
[0m
> redis-cli --cluster rebalance 172.31.5.120:6379 --cluster-use-empty-masters | grep -i Rebalancing
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 2416694 keys | 3276 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 1618314 keys | 3280 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 1397372 keys | 3276 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 2565926 keys | 3276 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 1174122 keys | 3276 slots | 0 slaves.
[OK] 9172428 keys in 5 masters.
559.84 keys per slot on average.
 
total slots: 16384
>>> Rebalancing across 5 nodes. Total weight = 5.00



[34m******* resize , 5 completed ******* [0m 

------------------------------------------------------------------

[34m******* write , 500000 *******[0m

[33m### WRITING 500000 KEYS ###
[0m
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 2516535 keys | 3276 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 1718545 keys | 3280 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 1497367 keys | 3276 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 2666060 keys | 3276 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 1273921 keys | 3276 slots | 0 slaves.
[OK] 9672428 keys in 5 masters.
590.36 keys per slot on average.
 
total slots: 16384
0.5M keys written successfully

[34m******* write , 500000 completed ******* [0m 

------------------------------------------------------------------

[34m******* resize , 6 *******[0m

{ clusterSize: 5 }
[33m### ADDING 172.31.5.69:6379 NODE TO CLUSTER ###
[0m
> redis-cli --cluster add-node 172.31.5.69:6379 172.31.5.192:6379 | awk '{ gsub(/[[0-9;]*m/, ""); print }'
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 2516535 keys | 3276 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 1718545 keys | 3280 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 1497367 keys | 3276 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 2666060 keys | 3276 slots | 0 slaves.
172.31.5.69:6379 (c767ab28...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 1273921 keys | 3276 slots | 0 slaves.
[OK] 9672428 keys in 6 masters.
590.36 keys per slot on average.
 
total slots: 16384
node added successfully
waiting... 2 1 


waiting... 10 9 8 7 6 5 4 3 2 1 


[33m### REBALANCING CLUSTER ON 172.31.5.69:6379 ###
[0m
> redis-cli --cluster rebalance 172.31.5.69:6379 --cluster-use-empty-masters | grep -i Rebalancing
assertion error.
 {
  keys1: 9672428,
  keys2: 8398508,
  keys: 0,
  slots1: 16384,
  slots2: 16384,
  nodes1: 6,
  nodes2: 6,
  nodes: 0
}
precheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 2516535 keys | 3276 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 1718545 keys | 3280 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 1497367 keys | 3276 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 2666060 keys | 3276 slots | 0 slaves.
172.31.5.69:6379 (c767ab28...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 1273921 keys | 3276 slots | 0 slaves.
[OK] 9672428 keys in 6 masters.
590.36 keys per slot on average.

postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 2279871 keys | 2730 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 1231642 keys | 2730 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 1342191 keys | 2730 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 2249112 keys | 2730 slots | 0 slaves.
172.31.5.69:6379 (c767ab28...) -> 1295692 keys | 2734 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 0 keys | 2730 slots | 0 slaves.
[OK] 8398508 keys in 6 masters.
512.60 keys per slot on average.
 
total slots: 16384
>>> Rebalancing across 6 nodes. Total weight = 6.00



[34m******* resize , 6 completed ******* [0m 

------------------------------------------------------------------

[34m******* write , 500000 *******[0m

[33m### WRITING 500000 KEYS ###
[0m
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 2363118 keys | 2730 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 1314985 keys | 2730 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 1425482 keys | 2730 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 2332501 keys | 2730 slots | 0 slaves.
172.31.5.69:6379 (c767ab28...) -> 1379152 keys | 2734 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 83270 keys | 2730 slots | 0 slaves.
[OK] 8898508 keys in 6 masters.
543.12 keys per slot on average.
 
total slots: 16384
0.5M keys written successfully

[34m******* write , 500000 completed ******* [0m 

------------------------------------------------------------------

[34m******* resize , 7 *******[0m

{ clusterSize: 6 }
[33m### ADDING 172.31.5.56:6379 NODE TO CLUSTER ###
[0m
> redis-cli --cluster add-node 172.31.5.56:6379 172.31.5.192:6379 | awk '{ gsub(/[[0-9;]*m/, ""); print }'
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 2363118 keys | 2730 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 1314985 keys | 2730 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 1425482 keys | 2730 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 2332501 keys | 2730 slots | 0 slaves.
172.31.5.56:6379 (234e48dd...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.69:6379 (c767ab28...) -> 1379152 keys | 2734 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 83270 keys | 2730 slots | 0 slaves.
[OK] 8898508 keys in 7 masters.
543.12 keys per slot on average.
 
total slots: 16384
node added successfully
waiting... 2 1 


waiting... 10 9 8 7 6 5 4 3 2 1 


[33m### REBALANCING CLUSTER ON 172.31.5.56:6379 ###
[0m
> redis-cli --cluster rebalance 172.31.5.56:6379 --cluster-use-empty-masters | grep -i Rebalancing
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 2142816 keys | 2340 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 1031466 keys | 2340 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 1079382 keys | 2340 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 2142002 keys | 2340 slots | 0 slaves.
172.31.5.56:6379 (234e48dd...) -> 1413058 keys | 2344 slots | 0 slaves.
172.31.5.69:6379 (c767ab28...) -> 1018351 keys | 2340 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 71433 keys | 2340 slots | 0 slaves.
[OK] 8898508 keys in 7 masters.
543.12 keys per slot on average.
 
total slots: 16384
>>> Rebalancing across 7 nodes. Total weight = 7.00



[34m******* resize , 7 completed ******* [0m 

------------------------------------------------------------------

[34m******* write , 500000 *******[0m

[33m### WRITING 500000 KEYS ###
[0m
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 2214420 keys | 2340 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 1102691 keys | 2340 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 1150768 keys | 2340 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 2213245 keys | 2340 slots | 0 slaves.
172.31.5.56:6379 (234e48dd...) -> 1484700 keys | 2344 slots | 0 slaves.
172.31.5.69:6379 (c767ab28...) -> 1089795 keys | 2340 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 142889 keys | 2340 slots | 0 slaves.
[OK] 9398508 keys in 7 masters.
573.64 keys per slot on average.
 
total slots: 16384
0.5M keys written successfully

[34m******* write , 500000 completed ******* [0m 

------------------------------------------------------------------

[34m******* resize , 8 *******[0m

{ clusterSize: 7 }
[33m### ADDING 172.31.5.226:6379 NODE TO CLUSTER ###
[0m
> redis-cli --cluster add-node 172.31.5.226:6379 172.31.5.192:6379 | awk '{ gsub(/[[0-9;]*m/, ""); print }'
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 2214420 keys | 2340 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 1102691 keys | 2340 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 1150768 keys | 2340 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 2213245 keys | 2340 slots | 0 slaves.
172.31.5.226:6379 (1115b088...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.56:6379 (234e48dd...) -> 1484700 keys | 2344 slots | 0 slaves.
172.31.5.69:6379 (c767ab28...) -> 1089795 keys | 2340 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 142889 keys | 2340 slots | 0 slaves.
[OK] 9398508 keys in 8 masters.
573.64 keys per slot on average.
 
total slots: 16384
node added successfully
waiting... 2 1 


waiting... 10 9 8 7 6 5 4 3 2 1 


[33m### REBALANCING CLUSTER ON 172.31.5.226:6379 ###
[0m
> redis-cli --cluster rebalance 172.31.5.226:6379 --cluster-use-empty-masters | grep -i Rebalancing
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 1938137 keys | 2048 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 1004499 keys | 2048 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 1000026 keys | 2048 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 1937030 keys | 2048 slots | 0 slaves.
172.31.5.226:6379 (1115b088...) -> 1255211 keys | 2048 slots | 0 slaves.
172.31.5.56:6379 (234e48dd...) -> 1204687 keys | 2048 slots | 0 slaves.
172.31.5.69:6379 (c767ab28...) -> 933852 keys | 2048 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 125066 keys | 2048 slots | 0 slaves.
[OK] 9398508 keys in 8 masters.
573.64 keys per slot on average.
 
total slots: 16384
>>> Rebalancing across 8 nodes. Total weight = 8.00



[34m******* resize , 8 completed ******* [0m 

------------------------------------------------------------------

[34m******* write , 500000 *******[0m

[33m### WRITING 500000 KEYS ###
[0m
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.192:6379 ###
[0m172.31.5.192:6379 (74a7a131...) -> 2000658 keys | 2048 slots | 0 slaves.
172.31.5.120:6379 (9ca261e7...) -> 1066993 keys | 2048 slots | 0 slaves.
172.31.5.142:6379 (8e98a8c8...) -> 1062516 keys | 2048 slots | 0 slaves.
172.31.5.72:6379 (b61f9f7f...) -> 1999518 keys | 2048 slots | 0 slaves.
172.31.5.226:6379 (1115b088...) -> 1317722 keys | 2048 slots | 0 slaves.
172.31.5.56:6379 (234e48dd...) -> 1267166 keys | 2048 slots | 0 slaves.
172.31.5.69:6379 (c767ab28...) -> 996391 keys | 2048 slots | 0 slaves.
172.31.5.9:6379 (a4f97e81...) -> 187544 keys | 2048 slots | 0 slaves.
[OK] 9898508 keys in 8 masters.
604.16 keys per slot on average.
 
total slots: 16384
0.5M keys written successfully

[34m******* write , 500000 completed ******* [0m 

Time Taken: 11731.748 seconds...

---DONE---
