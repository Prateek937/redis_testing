cluster Size: 3
[33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 0 keys | 5461 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 0 keys | 5462 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 0 keys | 5461 slots | 0 slaves.
[OK] 0 keys in 3 masters.
0.00 keys per slot on average.

------------------------------------------------------------------

[34m******* init  *******[0m

[33m### FLUSHING DATABASE : 172.31.5.88:6379 ###[0m
> redis-cli -h 172.31.5.88 -p 6379 flushall
[33m### FLUSHING DATABASE : 172.31.5.177:6379 ###[0m
> redis-cli -h 172.31.5.177 -p 6379 flushall
[33m### FLUSHING DATABASE : 172.31.5.45:6379 ###[0m
> redis-cli -h 172.31.5.45 -p 6379 flushall
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 0 keys | 5461 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 0 keys | 5462 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 0 keys | 5461 slots | 0 slaves.
[OK] 0 keys in 3 masters.
0.00 keys per slot on average.
 
total slots: 16384
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 0 keys | 5461 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 0 keys | 5462 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 0 keys | 5461 slots | 0 slaves.
[OK] 0 keys in 3 masters.
0.00 keys per slot on average.
 
total slots: 16384
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 0 keys | 5461 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 0 keys | 5462 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 0 keys | 5461 slots | 0 slaves.
[OK] 0 keys in 3 masters.
0.00 keys per slot on average.
 
total slots: 16384
cluster flushed successfully!

[34m******* init  completed ******* [0m 

------------------------------------------------------------------

[34m******* write , 500000 *******[0m

[33m### WRITING 500000 KEYS ###
[0m
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 166552 keys | 5461 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 166877 keys | 5462 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 166571 keys | 5461 slots | 0 slaves.
[OK] 500000 keys in 3 masters.
30.52 keys per slot on average.
 
total slots: 16384
0.5M keys written successfully

[34m******* write , 500000 completed ******* [0m 

------------------------------------------------------------------

[34m******* resize , 8 *******[0m

{ clusterSize: 3 }
[33m### ADDING 172.31.5.239:6379 NODE TO CLUSTER ###
[0m
> redis-cli --cluster add-node 172.31.5.239:6379 172.31.5.88:6379 | awk '{ gsub(/[[0-9;]*m/, ""); print }'
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 166552 keys | 5461 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 166877 keys | 5462 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 166571 keys | 5461 slots | 0 slaves.
[OK] 500000 keys in 4 masters.
30.52 keys per slot on average.
 
total slots: 16384
node added successfully
waiting... 2 1 


[33m### ADDING 172.31.5.178:6379 NODE TO CLUSTER ###
[0m
> redis-cli --cluster add-node 172.31.5.178:6379 172.31.5.88:6379 | awk '{ gsub(/[[0-9;]*m/, ""); print }'
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 166552 keys | 5461 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 166877 keys | 5462 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 166571 keys | 5461 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 0 keys | 0 slots | 0 slaves.
[OK] 500000 keys in 5 masters.
30.52 keys per slot on average.
 
total slots: 16384
node added successfully
waiting... 2 1 


[33m### ADDING 172.31.5.86:6379 NODE TO CLUSTER ###
[0m
> redis-cli --cluster add-node 172.31.5.86:6379 172.31.5.88:6379 | awk '{ gsub(/[[0-9;]*m/, ""); print }'
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 166552 keys | 5461 slots | 0 slaves.
172.31.5.86:6379 (3aac5767...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 166877 keys | 5462 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 166571 keys | 5461 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 0 keys | 0 slots | 0 slaves.
[OK] 500000 keys in 6 masters.
30.52 keys per slot on average.
 
total slots: 16384
node added successfully
waiting... 2 1 


[33m### ADDING 172.31.5.10:6379 NODE TO CLUSTER ###
[0m
> redis-cli --cluster add-node 172.31.5.10:6379 172.31.5.88:6379 | awk '{ gsub(/[[0-9;]*m/, ""); print }'
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 166552 keys | 5461 slots | 0 slaves.
172.31.5.86:6379 (3aac5767...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 166877 keys | 5462 slots | 0 slaves.
172.31.5.10:6379 (88c7571b...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 166571 keys | 5461 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 0 keys | 0 slots | 0 slaves.
[OK] 500000 keys in 7 masters.
30.52 keys per slot on average.
 
total slots: 16384
node added successfully
waiting... 2 1 


[33m### ADDING 172.31.5.50:6379 NODE TO CLUSTER ###
[0m
> redis-cli --cluster add-node 172.31.5.50:6379 172.31.5.88:6379 | awk '{ gsub(/[[0-9;]*m/, ""); print }'
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 166552 keys | 5461 slots | 0 slaves.
172.31.5.86:6379 (3aac5767...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 166877 keys | 5462 slots | 0 slaves.
172.31.5.10:6379 (88c7571b...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 166571 keys | 5461 slots | 0 slaves.
172.31.5.50:6379 (90d55335...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 0 keys | 0 slots | 0 slaves.
[OK] 500000 keys in 8 masters.
30.52 keys per slot on average.
 
total slots: 16384
node added successfully
waiting... 2 1 


waiting... 10 9 8 7 6 5 4 3 2 1 


[33m### REBALANCING CLUSTER ON 172.31.5.239:6379 ###
[0m
> redis-cli --cluster rebalance 172.31.5.239:6379 --cluster-use-empty-masters | grep -i Rebalancing
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 62491 keys | 2048 slots | 0 slaves.
172.31.5.86:6379 (3aac5767...) -> 62487 keys | 2048 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 62474 keys | 2048 slots | 0 slaves.
172.31.5.10:6379 (88c7571b...) -> 62399 keys | 2048 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 62623 keys | 2048 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 62513 keys | 2048 slots | 0 slaves.
172.31.5.50:6379 (90d55335...) -> 62508 keys | 2048 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 62505 keys | 2048 slots | 0 slaves.
[OK] 500000 keys in 8 masters.
30.52 keys per slot on average.
 
total slots: 16384
>>> Rebalancing across 8 nodes. Total weight = 8.00



[34m******* resize , 8 completed ******* [0m 

------------------------------------------------------------------

[34m******* write , 500000 *******[0m

[33m### WRITING 500000 KEYS ###
[0m
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 124987 keys | 2048 slots | 0 slaves.
172.31.5.86:6379 (3aac5767...) -> 125005 keys | 2048 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 124968 keys | 2048 slots | 0 slaves.
172.31.5.10:6379 (88c7571b...) -> 124828 keys | 2048 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 125213 keys | 2048 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 124995 keys | 2048 slots | 0 slaves.
172.31.5.50:6379 (90d55335...) -> 125021 keys | 2048 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 124983 keys | 2048 slots | 0 slaves.
[OK] 1000000 keys in 8 masters.
61.04 keys per slot on average.
 
total slots: 16384
0.5M keys written successfully

[34m******* write , 500000 completed ******* [0m 

------------------------------------------------------------------

[34m******* resize , 3 *******[0m

{ clusterSize: 8 }
[33m### REBALANCING CLUSTER ON 172.31.5.50:6379 ###
[0m
> redis-cli --cluster rebalance 172.31.5.50:6379 --cluster-use-empty-masters | grep -i Rebalancing
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 124987 keys | 2048 slots | 0 slaves.
172.31.5.86:6379 (3aac5767...) -> 125005 keys | 2048 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 124968 keys | 2048 slots | 0 slaves.
172.31.5.10:6379 (88c7571b...) -> 124828 keys | 2048 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 125213 keys | 2048 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 124995 keys | 2048 slots | 0 slaves.
172.31.5.50:6379 (90d55335...) -> 125021 keys | 2048 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 124983 keys | 2048 slots | 0 slaves.
[OK] 1000000 keys in 8 masters.
61.04 keys per slot on average.
 
total slots: 16384
*** No rebalancing needed! All nodes are within the 2.00% threshold.


{ distribution: [ 683, 683, 682 ] }
[33m### RESHARDING FROM 172.31.5.50 TO 172.31.5.88 ###
[0m
{ reshardFrom: '172.31.5.50', reshardTo: '172.31.5.88', slots: 683 }
> redis-cli --cluster reshard 172.31.5.50:6379 --cluster-from 90d5533556bde70609b70e48c8ae0ee812fd3d8a --cluster-to 8b8944dfa3d8f1ff2204dc3aa335b19256357fe0 --cluster-slots 683 --cluster-yes | grep Ready
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 166689 keys | 2731 slots | 0 slaves.
172.31.5.86:6379 (3aac5767...) -> 125005 keys | 2048 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 124968 keys | 2048 slots | 0 slaves.
172.31.5.10:6379 (88c7571b...) -> 124828 keys | 2048 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 125213 keys | 2048 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 124995 keys | 2048 slots | 0 slaves.
172.31.5.50:6379 (90d55335...) -> 83319 keys | 1365 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 124983 keys | 2048 slots | 0 slaves.
[OK] 1000000 keys in 8 masters.
61.04 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.50 TO 172.31.5.177 ###
[0m
{ reshardFrom: '172.31.5.50', reshardTo: '172.31.5.177', slots: 683 }
> redis-cli --cluster reshard 172.31.5.50:6379 --cluster-from 90d5533556bde70609b70e48c8ae0ee812fd3d8a --cluster-to e5fb4afd51fdf082ef6d5eee77b9c8ff3ba46aca --cluster-slots 683 --cluster-yes | grep Ready
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 166689 keys | 2731 slots | 0 slaves.
172.31.5.86:6379 (3aac5767...) -> 125005 keys | 2048 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 166815 keys | 2731 slots | 0 slaves.
172.31.5.10:6379 (88c7571b...) -> 124828 keys | 2048 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 125213 keys | 2048 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 124995 keys | 2048 slots | 0 slaves.
172.31.5.50:6379 (90d55335...) -> 41472 keys | 682 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 124983 keys | 2048 slots | 0 slaves.
[OK] 1000000 keys in 8 masters.
61.04 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.50 TO 172.31.5.45 ###
[0m
{ reshardFrom: '172.31.5.50', reshardTo: '172.31.5.45', slots: 682 }
> redis-cli --cluster reshard 172.31.5.50:6379 --cluster-from 90d5533556bde70609b70e48c8ae0ee812fd3d8a --cluster-to 0e4742121d492415d1f0d097c9691101d6eb8194 --cluster-slots 682 --cluster-yes | grep Ready
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 166689 keys | 2731 slots | 0 slaves.
172.31.5.86:6379 (3aac5767...) -> 125005 keys | 2048 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 166815 keys | 2731 slots | 0 slaves.
172.31.5.10:6379 (88c7571b...) -> 124828 keys | 2048 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 125213 keys | 2048 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 166467 keys | 2730 slots | 1 slaves.
172.31.5.239:6379 (6b7779ab...) -> 124983 keys | 2048 slots | 0 slaves.
[OK] 1000000 keys in 7 masters.
61.04 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### REMOVING 172.31.5.50:6379 FROM CLUSTER ###
[0m
> redis-cli --cluster del-node 172.31.5.50:6379 90d5533556bde70609b70e48c8ae0ee812fd3d8a
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 166689 keys | 2731 slots | 0 slaves.
172.31.5.86:6379 (3aac5767...) -> 125005 keys | 2048 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 166815 keys | 2731 slots | 0 slaves.
172.31.5.10:6379 (88c7571b...) -> 124828 keys | 2048 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 125213 keys | 2048 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 166467 keys | 2730 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 124983 keys | 2048 slots | 0 slaves.
[OK] 1000000 keys in 7 masters.
61.04 keys per slot on average.
 
total slots: 16384
Removing node 90d5533556bde70609b70e48c8ae0ee812fd3d8a from cluster 172.31.5.50:6379
Sending CLUSTER FORGET messages to the cluster...
Sending CLUSTER RESET SOFT to the deleted node.
{ distribution: [ 683, 683, 682 ] }
[33m### RESHARDING FROM 172.31.5.10 TO 172.31.5.177 ###
[0m
{ reshardFrom: '172.31.5.10', reshardTo: '172.31.5.177', slots: 683 }
> redis-cli --cluster reshard 172.31.5.10:6379 --cluster-from 88c7571ba757b3547fc6fbefc0219284839688ba --cluster-to e5fb4afd51fdf082ef6d5eee77b9c8ff3ba46aca --cluster-slots 683 --cluster-yes | grep Ready
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 166689 keys | 2731 slots | 0 slaves.
172.31.5.86:6379 (3aac5767...) -> 125005 keys | 2048 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 208497 keys | 3414 slots | 0 slaves.
172.31.5.10:6379 (88c7571b...) -> 83146 keys | 1365 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 125213 keys | 2048 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 166467 keys | 2730 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 124983 keys | 2048 slots | 0 slaves.
[OK] 1000000 keys in 7 masters.
61.04 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.10 TO 172.31.5.45 ###
[0m
{ reshardFrom: '172.31.5.10', reshardTo: '172.31.5.45', slots: 683 }
> redis-cli --cluster reshard 172.31.5.10:6379 --cluster-from 88c7571ba757b3547fc6fbefc0219284839688ba --cluster-to 0e4742121d492415d1f0d097c9691101d6eb8194 --cluster-slots 683 --cluster-yes | grep Ready
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 166689 keys | 2731 slots | 0 slaves.
172.31.5.86:6379 (3aac5767...) -> 125005 keys | 2048 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 208497 keys | 3414 slots | 0 slaves.
172.31.5.10:6379 (88c7571b...) -> 41413 keys | 682 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 125213 keys | 2048 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 208200 keys | 3413 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 124983 keys | 2048 slots | 0 slaves.
[OK] 1000000 keys in 7 masters.
61.04 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.10 TO 172.31.5.88 ###
[0m
{ reshardFrom: '172.31.5.10', reshardTo: '172.31.5.88', slots: 682 }
> redis-cli --cluster reshard 172.31.5.10:6379 --cluster-from 88c7571ba757b3547fc6fbefc0219284839688ba --cluster-to 8b8944dfa3d8f1ff2204dc3aa335b19256357fe0 --cluster-slots 682 --cluster-yes | grep Ready
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 208102 keys | 3413 slots | 1 slaves.
172.31.5.86:6379 (3aac5767...) -> 125005 keys | 2048 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 208497 keys | 3414 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 125213 keys | 2048 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 208200 keys | 3413 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 124983 keys | 2048 slots | 0 slaves.
[OK] 1000000 keys in 6 masters.
61.04 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### REMOVING 172.31.5.10:6379 FROM CLUSTER ###
[0m
> redis-cli --cluster del-node 172.31.5.10:6379 88c7571ba757b3547fc6fbefc0219284839688ba
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 208102 keys | 3413 slots | 0 slaves.
172.31.5.86:6379 (3aac5767...) -> 125005 keys | 2048 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 208497 keys | 3414 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 125213 keys | 2048 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 208200 keys | 3413 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 124983 keys | 2048 slots | 0 slaves.
[OK] 1000000 keys in 6 masters.
61.04 keys per slot on average.
 
total slots: 16384
Removing node 88c7571ba757b3547fc6fbefc0219284839688ba from cluster 172.31.5.10:6379
Sending CLUSTER FORGET messages to the cluster...
Sending CLUSTER RESET SOFT to the deleted node.
{ distribution: [ 683, 683, 682 ] }
[33m### RESHARDING FROM 172.31.5.86 TO 172.31.5.45 ###
[0m
{ reshardFrom: '172.31.5.86', reshardTo: '172.31.5.45', slots: 683 }
> redis-cli --cluster reshard 172.31.5.86:6379 --cluster-from 3aac57677b916b89b568938c6db362da7ebc2b2a --cluster-to 0e4742121d492415d1f0d097c9691101d6eb8194 --cluster-slots 683 --cluster-yes | grep Ready
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 208102 keys | 3413 slots | 0 slaves.
172.31.5.86:6379 (3aac5767...) -> 83136 keys | 1365 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 208497 keys | 3414 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 125213 keys | 2048 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 250069 keys | 4096 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 124983 keys | 2048 slots | 0 slaves.
[OK] 1000000 keys in 6 masters.
61.04 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.86 TO 172.31.5.88 ###
[0m
{ reshardFrom: '172.31.5.86', reshardTo: '172.31.5.88', slots: 683 }
> redis-cli --cluster reshard 172.31.5.86:6379 --cluster-from 3aac57677b916b89b568938c6db362da7ebc2b2a --cluster-to 8b8944dfa3d8f1ff2204dc3aa335b19256357fe0 --cluster-slots 683 --cluster-yes | grep Ready
assertion error.
 {
  keys1: 1000000,
  keys2: 791504,
  keys: 0,
  slots1: 16384,
  slots2: 16384,
  nodes1: 6,
  nodes2: 6,
  nodes: 0
}
precheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 208102 keys | 3413 slots | 0 slaves.
172.31.5.86:6379 (3aac5767...) -> 83136 keys | 1365 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 208497 keys | 3414 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 125213 keys | 2048 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 250069 keys | 4096 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 124983 keys | 2048 slots | 0 slaves.
[OK] 1000000 keys in 6 masters.
61.04 keys per slot on average.

postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 249748 keys | 4096 slots | 0 slaves.
172.31.5.86:6379 (3aac5767...) -> 41490 keys | 682 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 1 keys | 3414 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 125213 keys | 2048 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 250069 keys | 4096 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 124983 keys | 2048 slots | 0 slaves.
[OK] 791504 keys in 6 masters.
48.31 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.86 TO 172.31.5.177 ###
[0m
{ reshardFrom: '172.31.5.86', reshardTo: '172.31.5.177', slots: 682 }
> redis-cli --cluster reshard 172.31.5.86:6379 --cluster-from 3aac57677b916b89b568938c6db362da7ebc2b2a --cluster-to e5fb4afd51fdf082ef6d5eee77b9c8ff3ba46aca --cluster-slots 682 --cluster-yes | grep Ready
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 249748 keys | 4096 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 41491 keys | 4096 slots | 1 slaves.
172.31.5.178:6379 (96395809...) -> 125213 keys | 2048 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 250069 keys | 4096 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 124983 keys | 2048 slots | 0 slaves.
[OK] 791504 keys in 5 masters.
48.31 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### REMOVING 172.31.5.86:6379 FROM CLUSTER ###
[0m
> redis-cli --cluster del-node 172.31.5.86:6379 3aac57677b916b89b568938c6db362da7ebc2b2a
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 249748 keys | 4096 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 41491 keys | 4096 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 125213 keys | 2048 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 250069 keys | 4096 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 124983 keys | 2048 slots | 0 slaves.
[OK] 791504 keys in 5 masters.
48.31 keys per slot on average.
 
total slots: 16384
Removing node 3aac57677b916b89b568938c6db362da7ebc2b2a from cluster 172.31.5.86:6379
Sending CLUSTER FORGET messages to the cluster...
Sending CLUSTER RESET SOFT to the deleted node.
{ distribution: [ 683, 683, 682 ] }
[33m### RESHARDING FROM 172.31.5.178 TO 172.31.5.88 ###
[0m
{ reshardFrom: '172.31.5.178', reshardTo: '172.31.5.88', slots: 683 }
> redis-cli --cluster reshard 172.31.5.178:6379 --cluster-from 963958096c34d9596c9452b07253481eee2f9f00 --cluster-to 8b8944dfa3d8f1ff2204dc3aa335b19256357fe0 --cluster-slots 683 --cluster-yes | grep Ready
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 291272 keys | 4779 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 41491 keys | 4096 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 83689 keys | 1365 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 250069 keys | 4096 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 124983 keys | 2048 slots | 0 slaves.
[OK] 791504 keys in 5 masters.
48.31 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.178 TO 172.31.5.177 ###
[0m
{ reshardFrom: '172.31.5.178', reshardTo: '172.31.5.177', slots: 683 }
> redis-cli --cluster reshard 172.31.5.178:6379 --cluster-from 963958096c34d9596c9452b07253481eee2f9f00 --cluster-to e5fb4afd51fdf082ef6d5eee77b9c8ff3ba46aca --cluster-slots 683 --cluster-yes | grep Ready
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 291272 keys | 4779 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 83371 keys | 4779 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 41809 keys | 682 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 250069 keys | 4096 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 124983 keys | 2048 slots | 0 slaves.
[OK] 791504 keys in 5 masters.
48.31 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.178 TO 172.31.5.45 ###
[0m
{ reshardFrom: '172.31.5.178', reshardTo: '172.31.5.45', slots: 682 }
> redis-cli --cluster reshard 172.31.5.178:6379 --cluster-from 963958096c34d9596c9452b07253481eee2f9f00 --cluster-to 0e4742121d492415d1f0d097c9691101d6eb8194 --cluster-slots 682 --cluster-yes | grep Ready
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 291272 keys | 4779 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 83371 keys | 4779 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 291878 keys | 4778 slots | 1 slaves.
172.31.5.239:6379 (6b7779ab...) -> 124983 keys | 2048 slots | 0 slaves.
[OK] 791504 keys in 4 masters.
48.31 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### REMOVING 172.31.5.178:6379 FROM CLUSTER ###
[0m
> redis-cli --cluster del-node 172.31.5.178:6379 963958096c34d9596c9452b07253481eee2f9f00
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 291272 keys | 4779 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 83371 keys | 4779 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 291878 keys | 4778 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 124983 keys | 2048 slots | 0 slaves.
[OK] 791504 keys in 4 masters.
48.31 keys per slot on average.
 
total slots: 16384
Removing node 963958096c34d9596c9452b07253481eee2f9f00 from cluster 172.31.5.178:6379
Sending CLUSTER FORGET messages to the cluster...
Sending CLUSTER RESET SOFT to the deleted node.
{ distribution: [ 683, 683, 682 ] }
[33m### RESHARDING FROM 172.31.5.239 TO 172.31.5.177 ###
[0m
{ reshardFrom: '172.31.5.239', reshardTo: '172.31.5.177', slots: 683 }
> redis-cli --cluster reshard 172.31.5.239:6379 --cluster-from 6b7779abdc16827d8fd3a0b04a2068ca4fe5c585 --cluster-to e5fb4afd51fdf082ef6d5eee77b9c8ff3ba46aca --cluster-slots 683 --cluster-yes | grep Ready
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 291272 keys | 4779 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 125230 keys | 5462 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 291878 keys | 4778 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 83124 keys | 1365 slots | 0 slaves.
[OK] 791504 keys in 4 masters.
48.31 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.239 TO 172.31.5.45 ###
[0m
{ reshardFrom: '172.31.5.239', reshardTo: '172.31.5.45', slots: 683 }
> redis-cli --cluster reshard 172.31.5.239:6379 --cluster-from 6b7779abdc16827d8fd3a0b04a2068ca4fe5c585 --cluster-to 0e4742121d492415d1f0d097c9691101d6eb8194 --cluster-slots 683 --cluster-yes | grep Ready
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 291272 keys | 4779 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 125230 keys | 5462 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 333385 keys | 5461 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 41617 keys | 682 slots | 0 slaves.
[OK] 791504 keys in 4 masters.
48.31 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.239 TO 172.31.5.88 ###
[0m
{ reshardFrom: '172.31.5.239', reshardTo: '172.31.5.88', slots: 682 }
> redis-cli --cluster reshard 172.31.5.239:6379 --cluster-from 6b7779abdc16827d8fd3a0b04a2068ca4fe5c585 --cluster-to 8b8944dfa3d8f1ff2204dc3aa335b19256357fe0 --cluster-slots 682 --cluster-yes | grep Ready
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 332889 keys | 5461 slots | 1 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 125230 keys | 5462 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 333385 keys | 5461 slots | 0 slaves.
[OK] 791504 keys in 3 masters.
48.31 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### REMOVING 172.31.5.239:6379 FROM CLUSTER ###
[0m
> redis-cli --cluster del-node 172.31.5.239:6379 6b7779abdc16827d8fd3a0b04a2068ca4fe5c585
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 332889 keys | 5461 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 125230 keys | 5462 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 333385 keys | 5461 slots | 0 slaves.
[OK] 791504 keys in 3 masters.
48.31 keys per slot on average.
 
total slots: 16384
Removing node 6b7779abdc16827d8fd3a0b04a2068ca4fe5c585 from cluster 172.31.5.239:6379
Sending CLUSTER FORGET messages to the cluster...
Sending CLUSTER RESET SOFT to the deleted node.
[33m### REBALANCING CLUSTER ON 172.31.5.88:6379 ###
[0m
> redis-cli --cluster rebalance 172.31.5.88:6379 --cluster-use-empty-masters | grep -i Rebalancing
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 332889 keys | 5461 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 125230 keys | 5462 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 333385 keys | 5461 slots | 0 slaves.
[OK] 791504 keys in 3 masters.
48.31 keys per slot on average.
 
total slots: 16384
*** No rebalancing needed! All nodes are within the 2.00% threshold.


waiting... 65 64 63 62 61 60 59 58 57 56 55 54 53 52 51 50 49 48 47 46 45 44 43 42 41 40 39 38 37 36 35 34 33 32 31 30 29 28 27 26 25 24 23 22 21 20 19 18 17 16 15 14 13 12 11 10 9 8 7 6 5 4 3 2 1 



[34m******* resize , 3 completed ******* [0m 

------------------------------------------------------------------

[34m******* write , 500000 *******[0m

[33m### WRITING 500000 KEYS ###
[0m
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 499483 keys | 5461 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 292029 keys | 5462 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 499992 keys | 5461 slots | 0 slaves.
[OK] 1291504 keys in 3 masters.
78.83 keys per slot on average.
 
total slots: 16384
0.5M keys written successfully

[34m******* write , 500000 completed ******* [0m 

------------------------------------------------------------------

[34m******* resize , 8 *******[0m

{ clusterSize: 3 }
[33m### ADDING 172.31.5.239:6379 NODE TO CLUSTER ###
[0m
> redis-cli --cluster add-node 172.31.5.239:6379 172.31.5.88:6379 | awk '{ gsub(/[[0-9;]*m/, ""); print }'
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 499483 keys | 5461 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 292029 keys | 5462 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 499992 keys | 5461 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 0 keys | 0 slots | 0 slaves.
[OK] 1291504 keys in 4 masters.
78.83 keys per slot on average.
 
total slots: 16384
node added successfully
waiting... 2 1 


[33m### ADDING 172.31.5.178:6379 NODE TO CLUSTER ###
[0m
> redis-cli --cluster add-node 172.31.5.178:6379 172.31.5.88:6379 | awk '{ gsub(/[[0-9;]*m/, ""); print }'
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 499483 keys | 5461 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 292029 keys | 5462 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 499992 keys | 5461 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 0 keys | 0 slots | 0 slaves.
[OK] 1291504 keys in 5 masters.
78.83 keys per slot on average.
 
total slots: 16384
node added successfully
waiting... 2 1 


[33m### ADDING 172.31.5.86:6379 NODE TO CLUSTER ###
[0m
> redis-cli --cluster add-node 172.31.5.86:6379 172.31.5.88:6379 | awk '{ gsub(/[[0-9;]*m/, ""); print }'
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 499483 keys | 5461 slots | 0 slaves.
172.31.5.86:6379 (3aac5767...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 292029 keys | 5462 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 499992 keys | 5461 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 0 keys | 0 slots | 0 slaves.
[OK] 1291504 keys in 6 masters.
78.83 keys per slot on average.
 
total slots: 16384
node added successfully
waiting... 2 1 


[33m### ADDING 172.31.5.10:6379 NODE TO CLUSTER ###
[0m
> redis-cli --cluster add-node 172.31.5.10:6379 172.31.5.88:6379 | awk '{ gsub(/[[0-9;]*m/, ""); print }'
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 499483 keys | 5461 slots | 0 slaves.
172.31.5.86:6379 (3aac5767...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 292029 keys | 5462 slots | 0 slaves.
172.31.5.10:6379 (88c7571b...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 499992 keys | 5461 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 0 keys | 0 slots | 0 slaves.
[OK] 1291504 keys in 7 masters.
78.83 keys per slot on average.
 
total slots: 16384
node added successfully
waiting... 2 1 


[33m### ADDING 172.31.5.50:6379 NODE TO CLUSTER ###
[0m
> redis-cli --cluster add-node 172.31.5.50:6379 172.31.5.88:6379 | awk '{ gsub(/[[0-9;]*m/, ""); print }'
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 499483 keys | 5461 slots | 0 slaves.
172.31.5.86:6379 (3aac5767...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 292029 keys | 5462 slots | 0 slaves.
172.31.5.10:6379 (88c7571b...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 499992 keys | 5461 slots | 0 slaves.
172.31.5.50:6379 (90d55335...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 0 keys | 0 slots | 0 slaves.
[OK] 1291504 keys in 8 masters.
78.83 keys per slot on average.
 
total slots: 16384
node added successfully
waiting... 2 1 


waiting... 10 9 8 7 6 5 4 3 2 1 


[33m### REBALANCING CLUSTER ON 172.31.5.239:6379 ###
[0m
> redis-cli --cluster rebalance 172.31.5.239:6379 --cluster-use-empty-masters | grep -i Rebalancing
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 187174 keys | 2048 slots | 0 slaves.
172.31.5.86:6379 (3aac5767...) -> 187994 keys | 2048 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 103968 keys | 2048 slots | 0 slaves.
172.31.5.10:6379 (88c7571b...) -> 187102 keys | 2048 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 145930 keys | 2048 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 187468 keys | 2048 slots | 0 slaves.
172.31.5.50:6379 (90d55335...) -> 187501 keys | 2048 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 104367 keys | 2048 slots | 0 slaves.
[OK] 1291504 keys in 8 masters.
78.83 keys per slot on average.
 
total slots: 16384
>>> Rebalancing across 8 nodes. Total weight = 8.00



[34m******* resize , 8 completed ******* [0m 

------------------------------------------------------------------

[34m******* write , 500000 *******[0m

[33m### WRITING 500000 KEYS ###
[0m
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 249697 keys | 2048 slots | 0 slaves.
172.31.5.86:6379 (3aac5767...) -> 250451 keys | 2048 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 166516 keys | 2048 slots | 0 slaves.
172.31.5.10:6379 (88c7571b...) -> 249655 keys | 2048 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 208410 keys | 2048 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 249966 keys | 2048 slots | 0 slaves.
172.31.5.50:6379 (90d55335...) -> 249981 keys | 2048 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 166828 keys | 2048 slots | 0 slaves.
[OK] 1791504 keys in 8 masters.
109.34 keys per slot on average.
 
total slots: 16384
0.5M keys written successfully

[34m******* write , 500000 completed ******* [0m 

------------------------------------------------------------------

[34m******* resize , 4 *******[0m

{ clusterSize: 8 }
[33m### REBALANCING CLUSTER ON 172.31.5.50:6379 ###
[0m
> redis-cli --cluster rebalance 172.31.5.50:6379 --cluster-use-empty-masters | grep -i Rebalancing
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 249697 keys | 2048 slots | 0 slaves.
172.31.5.86:6379 (3aac5767...) -> 250451 keys | 2048 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 166516 keys | 2048 slots | 0 slaves.
172.31.5.10:6379 (88c7571b...) -> 249655 keys | 2048 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 208410 keys | 2048 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 249966 keys | 2048 slots | 0 slaves.
172.31.5.50:6379 (90d55335...) -> 249981 keys | 2048 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 166828 keys | 2048 slots | 0 slaves.
[OK] 1791504 keys in 8 masters.
109.34 keys per slot on average.
 
total slots: 16384
*** No rebalancing needed! All nodes are within the 2.00% threshold.


{ distribution: [ 512, 512, 512, 512 ] }
[33m### RESHARDING FROM 172.31.5.50 TO 172.31.5.88 ###
[0m
{ reshardFrom: '172.31.5.50', reshardTo: '172.31.5.88', slots: 512 }
> redis-cli --cluster reshard 172.31.5.50:6379 --cluster-from 90d5533556bde70609b70e48c8ae0ee812fd3d8a --cluster-to 8b8944dfa3d8f1ff2204dc3aa335b19256357fe0 --cluster-slots 512 --cluster-yes | grep Ready
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 312305 keys | 2560 slots | 0 slaves.
172.31.5.86:6379 (3aac5767...) -> 250451 keys | 2048 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 166516 keys | 2048 slots | 0 slaves.
172.31.5.10:6379 (88c7571b...) -> 249655 keys | 2048 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 208410 keys | 2048 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 249966 keys | 2048 slots | 0 slaves.
172.31.5.50:6379 (90d55335...) -> 187373 keys | 1536 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 166828 keys | 2048 slots | 0 slaves.
[OK] 1791504 keys in 8 masters.
109.34 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.50 TO 172.31.5.177 ###
[0m
{ reshardFrom: '172.31.5.50', reshardTo: '172.31.5.177', slots: 512 }
> redis-cli --cluster reshard 172.31.5.50:6379 --cluster-from 90d5533556bde70609b70e48c8ae0ee812fd3d8a --cluster-to e5fb4afd51fdf082ef6d5eee77b9c8ff3ba46aca --cluster-slots 512 --cluster-yes | grep Ready
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 312305 keys | 2560 slots | 0 slaves.
172.31.5.86:6379 (3aac5767...) -> 250451 keys | 2048 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 228932 keys | 2560 slots | 0 slaves.
172.31.5.10:6379 (88c7571b...) -> 249655 keys | 2048 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 208410 keys | 2048 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 249966 keys | 2048 slots | 0 slaves.
172.31.5.50:6379 (90d55335...) -> 124957 keys | 1024 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 166828 keys | 2048 slots | 0 slaves.
[OK] 1791504 keys in 8 masters.
109.34 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.50 TO 172.31.5.45 ###
[0m
{ reshardFrom: '172.31.5.50', reshardTo: '172.31.5.45', slots: 512 }
> redis-cli --cluster reshard 172.31.5.50:6379 --cluster-from 90d5533556bde70609b70e48c8ae0ee812fd3d8a --cluster-to 0e4742121d492415d1f0d097c9691101d6eb8194 --cluster-slots 512 --cluster-yes | grep Ready
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 312305 keys | 2560 slots | 0 slaves.
172.31.5.86:6379 (3aac5767...) -> 250451 keys | 2048 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 228932 keys | 2560 slots | 0 slaves.
172.31.5.10:6379 (88c7571b...) -> 249655 keys | 2048 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 208410 keys | 2048 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 312535 keys | 2560 slots | 0 slaves.
172.31.5.50:6379 (90d55335...) -> 62388 keys | 512 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 166828 keys | 2048 slots | 0 slaves.
[OK] 1791504 keys in 8 masters.
109.34 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.50 TO 172.31.5.239 ###
[0m
{ reshardFrom: '172.31.5.50', reshardTo: '172.31.5.239', slots: 512 }
> redis-cli --cluster reshard 172.31.5.50:6379 --cluster-from 90d5533556bde70609b70e48c8ae0ee812fd3d8a --cluster-to 6b7779abdc16827d8fd3a0b04a2068ca4fe5c585 --cluster-slots 512 --cluster-yes | grep Ready
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 312305 keys | 2560 slots | 0 slaves.
172.31.5.86:6379 (3aac5767...) -> 250451 keys | 2048 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 228932 keys | 2560 slots | 0 slaves.
172.31.5.10:6379 (88c7571b...) -> 249655 keys | 2048 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 208410 keys | 2048 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 312535 keys | 2560 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 229216 keys | 2560 slots | 1 slaves.
[OK] 1791504 keys in 7 masters.
109.34 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### REMOVING 172.31.5.50:6379 FROM CLUSTER ###
[0m
> redis-cli --cluster del-node 172.31.5.50:6379 90d5533556bde70609b70e48c8ae0ee812fd3d8a
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 312305 keys | 2560 slots | 0 slaves.
172.31.5.86:6379 (3aac5767...) -> 250451 keys | 2048 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 228932 keys | 2560 slots | 0 slaves.
172.31.5.10:6379 (88c7571b...) -> 249655 keys | 2048 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 208410 keys | 2048 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 312535 keys | 2560 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 229216 keys | 2560 slots | 0 slaves.
[OK] 1791504 keys in 7 masters.
109.34 keys per slot on average.
 
total slots: 16384
Removing node 90d5533556bde70609b70e48c8ae0ee812fd3d8a from cluster 172.31.5.50:6379
Sending CLUSTER FORGET messages to the cluster...
Sending CLUSTER RESET SOFT to the deleted node.
{ distribution: [ 512, 512, 512, 512 ] }
[33m### RESHARDING FROM 172.31.5.10 TO 172.31.5.177 ###
[0m
{ reshardFrom: '172.31.5.10', reshardTo: '172.31.5.177', slots: 512 }
> redis-cli --cluster reshard 172.31.5.10:6379 --cluster-from 88c7571ba757b3547fc6fbefc0219284839688ba --cluster-to e5fb4afd51fdf082ef6d5eee77b9c8ff3ba46aca --cluster-slots 512 --cluster-yes | grep Ready
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 312305 keys | 2560 slots | 0 slaves.
172.31.5.86:6379 (3aac5767...) -> 250451 keys | 2048 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 291155 keys | 3072 slots | 0 slaves.
172.31.5.10:6379 (88c7571b...) -> 187432 keys | 1536 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 208410 keys | 2048 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 312535 keys | 2560 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 229216 keys | 2560 slots | 0 slaves.
[OK] 1791504 keys in 7 masters.
109.34 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.10 TO 172.31.5.45 ###
[0m
{ reshardFrom: '172.31.5.10', reshardTo: '172.31.5.45', slots: 512 }
> redis-cli --cluster reshard 172.31.5.10:6379 --cluster-from 88c7571ba757b3547fc6fbefc0219284839688ba --cluster-to 0e4742121d492415d1f0d097c9691101d6eb8194 --cluster-slots 512 --cluster-yes | grep Ready
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 312305 keys | 2560 slots | 0 slaves.
172.31.5.86:6379 (3aac5767...) -> 250451 keys | 2048 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 291155 keys | 3072 slots | 0 slaves.
172.31.5.10:6379 (88c7571b...) -> 124617 keys | 1024 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 208410 keys | 2048 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 375350 keys | 3072 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 229216 keys | 2560 slots | 0 slaves.
[OK] 1791504 keys in 7 masters.
109.34 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.10 TO 172.31.5.239 ###
[0m
{ reshardFrom: '172.31.5.10', reshardTo: '172.31.5.239', slots: 512 }
> redis-cli --cluster reshard 172.31.5.10:6379 --cluster-from 88c7571ba757b3547fc6fbefc0219284839688ba --cluster-to 6b7779abdc16827d8fd3a0b04a2068ca4fe5c585 --cluster-slots 512 --cluster-yes | grep Ready
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 312305 keys | 2560 slots | 0 slaves.
172.31.5.86:6379 (3aac5767...) -> 250451 keys | 2048 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 291155 keys | 3072 slots | 0 slaves.
172.31.5.10:6379 (88c7571b...) -> 62407 keys | 512 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 208410 keys | 2048 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 375350 keys | 3072 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 291426 keys | 3072 slots | 0 slaves.
[OK] 1791504 keys in 7 masters.
109.34 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.10 TO 172.31.5.88 ###
[0m
{ reshardFrom: '172.31.5.10', reshardTo: '172.31.5.88', slots: 512 }
> redis-cli --cluster reshard 172.31.5.10:6379 --cluster-from 88c7571ba757b3547fc6fbefc0219284839688ba --cluster-to 8b8944dfa3d8f1ff2204dc3aa335b19256357fe0 --cluster-slots 512 --cluster-yes | grep Ready
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 374712 keys | 3072 slots | 1 slaves.
172.31.5.86:6379 (3aac5767...) -> 250451 keys | 2048 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 291155 keys | 3072 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 208410 keys | 2048 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 375350 keys | 3072 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 291426 keys | 3072 slots | 0 slaves.
[OK] 1791504 keys in 6 masters.
109.34 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### REMOVING 172.31.5.10:6379 FROM CLUSTER ###
[0m
> redis-cli --cluster del-node 172.31.5.10:6379 88c7571ba757b3547fc6fbefc0219284839688ba
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 374712 keys | 3072 slots | 0 slaves.
172.31.5.86:6379 (3aac5767...) -> 250451 keys | 2048 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 291155 keys | 3072 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 208410 keys | 2048 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 375350 keys | 3072 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 291426 keys | 3072 slots | 0 slaves.
[OK] 1791504 keys in 6 masters.
109.34 keys per slot on average.
 
total slots: 16384
Removing node 88c7571ba757b3547fc6fbefc0219284839688ba from cluster 172.31.5.10:6379
Sending CLUSTER FORGET messages to the cluster...
Sending CLUSTER RESET SOFT to the deleted node.
{ distribution: [ 512, 512, 512, 512 ] }
[33m### RESHARDING FROM 172.31.5.86 TO 172.31.5.45 ###
[0m
{ reshardFrom: '172.31.5.86', reshardTo: '172.31.5.45', slots: 512 }
> redis-cli --cluster reshard 172.31.5.86:6379 --cluster-from 3aac57677b916b89b568938c6db362da7ebc2b2a --cluster-to 0e4742121d492415d1f0d097c9691101d6eb8194 --cluster-slots 512 --cluster-yes | grep Ready
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 374712 keys | 3072 slots | 0 slaves.
172.31.5.86:6379 (3aac5767...) -> 187680 keys | 1536 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 291155 keys | 3072 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 208410 keys | 2048 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 438121 keys | 3584 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 291426 keys | 3072 slots | 0 slaves.
[OK] 1791504 keys in 6 masters.
109.34 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.86 TO 172.31.5.239 ###
[0m
{ reshardFrom: '172.31.5.86', reshardTo: '172.31.5.239', slots: 512 }
> redis-cli --cluster reshard 172.31.5.86:6379 --cluster-from 3aac57677b916b89b568938c6db362da7ebc2b2a --cluster-to 6b7779abdc16827d8fd3a0b04a2068ca4fe5c585 --cluster-slots 512 --cluster-yes | grep Ready
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 374712 keys | 3072 slots | 0 slaves.
172.31.5.86:6379 (3aac5767...) -> 125429 keys | 1024 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 291155 keys | 3072 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 208410 keys | 2048 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 438121 keys | 3584 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 353677 keys | 3584 slots | 0 slaves.
[OK] 1791504 keys in 6 masters.
109.34 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.86 TO 172.31.5.88 ###
[0m
{ reshardFrom: '172.31.5.86', reshardTo: '172.31.5.88', slots: 512 }
> redis-cli --cluster reshard 172.31.5.86:6379 --cluster-from 3aac57677b916b89b568938c6db362da7ebc2b2a --cluster-to 8b8944dfa3d8f1ff2204dc3aa335b19256357fe0 --cluster-slots 512 --cluster-yes | grep Ready
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 437501 keys | 3584 slots | 0 slaves.
172.31.5.86:6379 (3aac5767...) -> 62640 keys | 512 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 291155 keys | 3072 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 208410 keys | 2048 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 438121 keys | 3584 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 353677 keys | 3584 slots | 0 slaves.
[OK] 1791504 keys in 6 masters.
109.34 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.86 TO 172.31.5.177 ###
[0m
{ reshardFrom: '172.31.5.86', reshardTo: '172.31.5.177', slots: 512 }
> redis-cli --cluster reshard 172.31.5.86:6379 --cluster-from 3aac57677b916b89b568938c6db362da7ebc2b2a --cluster-to e5fb4afd51fdf082ef6d5eee77b9c8ff3ba46aca --cluster-slots 512 --cluster-yes | grep Ready
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 437501 keys | 3584 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 353795 keys | 3584 slots | 1 slaves.
172.31.5.178:6379 (96395809...) -> 208410 keys | 2048 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 438121 keys | 3584 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 353677 keys | 3584 slots | 0 slaves.
[OK] 1791504 keys in 5 masters.
109.34 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### REMOVING 172.31.5.86:6379 FROM CLUSTER ###
[0m
> redis-cli --cluster del-node 172.31.5.86:6379 3aac57677b916b89b568938c6db362da7ebc2b2a
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 437501 keys | 3584 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 353795 keys | 3584 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 208410 keys | 2048 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 438121 keys | 3584 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 353677 keys | 3584 slots | 0 slaves.
[OK] 1791504 keys in 5 masters.
109.34 keys per slot on average.
 
total slots: 16384
Removing node 3aac57677b916b89b568938c6db362da7ebc2b2a from cluster 172.31.5.86:6379
Sending CLUSTER FORGET messages to the cluster...
Sending CLUSTER RESET SOFT to the deleted node.
{ distribution: [ 512, 512, 512, 512 ] }
[33m### RESHARDING FROM 172.31.5.178 TO 172.31.5.239 ###
[0m
{ reshardFrom: '172.31.5.178', reshardTo: '172.31.5.239', slots: 512 }
> redis-cli --cluster reshard 172.31.5.178:6379 --cluster-from 963958096c34d9596c9452b07253481eee2f9f00 --cluster-to 6b7779abdc16827d8fd3a0b04a2068ca4fe5c585 --cluster-slots 512 --cluster-yes | grep Ready
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 437501 keys | 3584 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 353795 keys | 3584 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 146175 keys | 1536 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 438121 keys | 3584 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 415912 keys | 4096 slots | 0 slaves.
[OK] 1791504 keys in 5 masters.
109.34 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.178 TO 172.31.5.88 ###
[0m
{ reshardFrom: '172.31.5.178', reshardTo: '172.31.5.88', slots: 512 }
> redis-cli --cluster reshard 172.31.5.178:6379 --cluster-from 963958096c34d9596c9452b07253481eee2f9f00 --cluster-to 8b8944dfa3d8f1ff2204dc3aa335b19256357fe0 --cluster-slots 512 --cluster-yes | grep Ready
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 500110 keys | 4096 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 353795 keys | 3584 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 83566 keys | 1024 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 438121 keys | 3584 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 415912 keys | 4096 slots | 0 slaves.
[OK] 1791504 keys in 5 masters.
109.34 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.178 TO 172.31.5.177 ###
[0m
{ reshardFrom: '172.31.5.178', reshardTo: '172.31.5.177', slots: 512 }
> redis-cli --cluster reshard 172.31.5.178:6379 --cluster-from 963958096c34d9596c9452b07253481eee2f9f00 --cluster-to e5fb4afd51fdf082ef6d5eee77b9c8ff3ba46aca --cluster-slots 512 --cluster-yes | grep Ready
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 500110 keys | 4096 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 406100 keys | 4096 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 31261 keys | 512 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 438121 keys | 3584 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 415912 keys | 4096 slots | 0 slaves.
[OK] 1791504 keys in 5 masters.
109.34 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.178 TO 172.31.5.45 ###
[0m
{ reshardFrom: '172.31.5.178', reshardTo: '172.31.5.45', slots: 512 }
> redis-cli --cluster reshard 172.31.5.178:6379 --cluster-from 963958096c34d9596c9452b07253481eee2f9f00 --cluster-to 0e4742121d492415d1f0d097c9691101d6eb8194 --cluster-slots 512 --cluster-yes | grep Ready
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 500110 keys | 4096 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 406100 keys | 4096 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 469382 keys | 4096 slots | 1 slaves.
172.31.5.239:6379 (6b7779ab...) -> 415912 keys | 4096 slots | 0 slaves.
[OK] 1791504 keys in 4 masters.
109.34 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### REMOVING 172.31.5.178:6379 FROM CLUSTER ###
[0m
> redis-cli --cluster del-node 172.31.5.178:6379 963958096c34d9596c9452b07253481eee2f9f00
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 500110 keys | 4096 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 406100 keys | 4096 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 469382 keys | 4096 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 415912 keys | 4096 slots | 0 slaves.
[OK] 1791504 keys in 4 masters.
109.34 keys per slot on average.
 
total slots: 16384
Removing node 963958096c34d9596c9452b07253481eee2f9f00 from cluster 172.31.5.178:6379
Sending CLUSTER FORGET messages to the cluster...
Sending CLUSTER RESET SOFT to the deleted node.
[33m### REBALANCING CLUSTER ON 172.31.5.88:6379 ###
[0m
> redis-cli --cluster rebalance 172.31.5.88:6379 --cluster-use-empty-masters | grep -i Rebalancing
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 500110 keys | 4096 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 406100 keys | 4096 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 469382 keys | 4096 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 415912 keys | 4096 slots | 0 slaves.
[OK] 1791504 keys in 4 masters.
109.34 keys per slot on average.
 
total slots: 16384
*** No rebalancing needed! All nodes are within the 2.00% threshold.


waiting... 65 64 63 62 61 60 59 58 57 56 55 54 53 52 51 50 49 48 47 46 45 44 43 42 41 40 39 38 37 36 35 34 33 32 31 30 29 28 27 26 25 24 23 22 21 20 19 18 17 16 15 14 13 12 11 10 9 8 7 6 5 4 3 2 1 



[34m******* resize , 4 completed ******* [0m 

------------------------------------------------------------------

[34m******* write , 500000 *******[0m

[33m### WRITING 500000 KEYS ###
[0m
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 625136 keys | 4096 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 531061 keys | 4096 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 594481 keys | 4096 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 540826 keys | 4096 slots | 0 slaves.
[OK] 2291504 keys in 4 masters.
139.86 keys per slot on average.
 
total slots: 16384
0.5M keys written successfully

[34m******* write , 500000 completed ******* [0m 

------------------------------------------------------------------

[34m******* resize , 8 *******[0m

{ clusterSize: 4 }
[33m### ADDING 172.31.5.178:6379 NODE TO CLUSTER ###
[0m
> redis-cli --cluster add-node 172.31.5.178:6379 172.31.5.88:6379 | awk '{ gsub(/[[0-9;]*m/, ""); print }'
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 625136 keys | 4096 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 531061 keys | 4096 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 594481 keys | 4096 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 540826 keys | 4096 slots | 0 slaves.
[OK] 2291504 keys in 5 masters.
139.86 keys per slot on average.
 
total slots: 16384
node added successfully
waiting... 2 1 


[33m### ADDING 172.31.5.86:6379 NODE TO CLUSTER ###
[0m
> redis-cli --cluster add-node 172.31.5.86:6379 172.31.5.88:6379 | awk '{ gsub(/[[0-9;]*m/, ""); print }'
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 625136 keys | 4096 slots | 0 slaves.
172.31.5.86:6379 (3aac5767...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 531061 keys | 4096 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 594481 keys | 4096 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 540826 keys | 4096 slots | 0 slaves.
[OK] 2291504 keys in 6 masters.
139.86 keys per slot on average.
 
total slots: 16384
node added successfully
waiting... 2 1 


[33m### ADDING 172.31.5.10:6379 NODE TO CLUSTER ###
[0m
> redis-cli --cluster add-node 172.31.5.10:6379 172.31.5.88:6379 | awk '{ gsub(/[[0-9;]*m/, ""); print }'
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 625136 keys | 4096 slots | 0 slaves.
172.31.5.86:6379 (3aac5767...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 531061 keys | 4096 slots | 0 slaves.
172.31.5.10:6379 (88c7571b...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 594481 keys | 4096 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 540826 keys | 4096 slots | 0 slaves.
[OK] 2291504 keys in 7 masters.
139.86 keys per slot on average.
 
total slots: 16384
node added successfully
waiting... 2 1 


[33m### ADDING 172.31.5.50:6379 NODE TO CLUSTER ###
[0m
> redis-cli --cluster add-node 172.31.5.50:6379 172.31.5.88:6379 | awk '{ gsub(/[[0-9;]*m/, ""); print }'
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 625136 keys | 4096 slots | 0 slaves.
172.31.5.86:6379 (3aac5767...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 531061 keys | 4096 slots | 0 slaves.
172.31.5.10:6379 (88c7571b...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 594481 keys | 4096 slots | 0 slaves.
172.31.5.50:6379 (90d55335...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 540826 keys | 4096 slots | 0 slaves.
[OK] 2291504 keys in 8 masters.
139.86 keys per slot on average.
 
total slots: 16384
node added successfully
waiting... 2 1 


waiting... 10 9 8 7 6 5 4 3 2 1 


[33m### REBALANCING CLUSTER ON 172.31.5.178:6379 ###
[0m
> redis-cli --cluster rebalance 172.31.5.178:6379 --cluster-use-empty-masters | grep -i Rebalancing
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 312599 keys | 2048 slots | 0 slaves.
172.31.5.86:6379 (3aac5767...) -> 270665 keys | 2048 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 260396 keys | 2048 slots | 0 slaves.
172.31.5.10:6379 (88c7571b...) -> 282004 keys | 2048 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 312537 keys | 2048 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 312477 keys | 2048 slots | 0 slaves.
172.31.5.50:6379 (90d55335...) -> 228750 keys | 2048 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 312076 keys | 2048 slots | 0 slaves.
[OK] 2291504 keys in 8 masters.
139.86 keys per slot on average.
 
total slots: 16384
>>> Rebalancing across 8 nodes. Total weight = 8.00



[34m******* resize , 8 completed ******* [0m 

------------------------------------------------------------------

[34m******* write , 500000 *******[0m

[33m### WRITING 500000 KEYS ###
[0m
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 375142 keys | 2048 slots | 0 slaves.
172.31.5.86:6379 (3aac5767...) -> 333035 keys | 2048 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 322893 keys | 2048 slots | 0 slaves.
172.31.5.10:6379 (88c7571b...) -> 344651 keys | 2048 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 375017 keys | 2048 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 374979 keys | 2048 slots | 0 slaves.
172.31.5.50:6379 (90d55335...) -> 291227 keys | 2048 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 374560 keys | 2048 slots | 0 slaves.
[OK] 2791504 keys in 8 masters.
170.38 keys per slot on average.
 
total slots: 16384
0.5M keys written successfully

[34m******* write , 500000 completed ******* [0m 

------------------------------------------------------------------

[34m******* resize , 5 *******[0m

{ clusterSize: 8 }
[33m### REBALANCING CLUSTER ON 172.31.5.50:6379 ###
[0m
> redis-cli --cluster rebalance 172.31.5.50:6379 --cluster-use-empty-masters | grep -i Rebalancing
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 375142 keys | 2048 slots | 0 slaves.
172.31.5.86:6379 (3aac5767...) -> 333035 keys | 2048 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 322893 keys | 2048 slots | 0 slaves.
172.31.5.10:6379 (88c7571b...) -> 344651 keys | 2048 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 375017 keys | 2048 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 374979 keys | 2048 slots | 0 slaves.
172.31.5.50:6379 (90d55335...) -> 291227 keys | 2048 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 374560 keys | 2048 slots | 0 slaves.
[OK] 2791504 keys in 8 masters.
170.38 keys per slot on average.
 
total slots: 16384
*** No rebalancing needed! All nodes are within the 2.00% threshold.


{ distribution: [ 410, 410, 410, 409, 409 ] }
[33m### RESHARDING FROM 172.31.5.50 TO 172.31.5.88 ###
[0m
{ reshardFrom: '172.31.5.50', reshardTo: '172.31.5.88', slots: 410 }
> redis-cli --cluster reshard 172.31.5.50:6379 --cluster-from 90d5533556bde70609b70e48c8ae0ee812fd3d8a --cluster-to 8b8944dfa3d8f1ff2204dc3aa335b19256357fe0 --cluster-slots 410 --cluster-yes | grep Ready
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 449982 keys | 2458 slots | 0 slaves.
172.31.5.86:6379 (3aac5767...) -> 333035 keys | 2048 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 322893 keys | 2048 slots | 0 slaves.
172.31.5.10:6379 (88c7571b...) -> 344651 keys | 2048 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 375017 keys | 2048 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 374979 keys | 2048 slots | 0 slaves.
172.31.5.50:6379 (90d55335...) -> 216387 keys | 1638 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 374560 keys | 2048 slots | 0 slaves.
[OK] 2791504 keys in 8 masters.
170.38 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.50 TO 172.31.5.177 ###
[0m
{ reshardFrom: '172.31.5.50', reshardTo: '172.31.5.177', slots: 410 }
> redis-cli --cluster reshard 172.31.5.50:6379 --cluster-from 90d5533556bde70609b70e48c8ae0ee812fd3d8a --cluster-to e5fb4afd51fdf082ef6d5eee77b9c8ff3ba46aca --cluster-slots 410 --cluster-yes | grep Ready
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 449982 keys | 2458 slots | 0 slaves.
172.31.5.86:6379 (3aac5767...) -> 333035 keys | 2048 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 379058 keys | 2458 slots | 0 slaves.
172.31.5.10:6379 (88c7571b...) -> 344651 keys | 2048 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 375017 keys | 2048 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 374979 keys | 2048 slots | 0 slaves.
172.31.5.50:6379 (90d55335...) -> 160222 keys | 1228 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 374560 keys | 2048 slots | 0 slaves.
[OK] 2791504 keys in 8 masters.
170.38 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.50 TO 172.31.5.45 ###
[0m
{ reshardFrom: '172.31.5.50', reshardTo: '172.31.5.45', slots: 410 }
> redis-cli --cluster reshard 172.31.5.50:6379 --cluster-from 90d5533556bde70609b70e48c8ae0ee812fd3d8a --cluster-to 0e4742121d492415d1f0d097c9691101d6eb8194 --cluster-slots 410 --cluster-yes | grep Ready
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 449982 keys | 2458 slots | 0 slaves.
172.31.5.86:6379 (3aac5767...) -> 333035 keys | 2048 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 379058 keys | 2458 slots | 0 slaves.
172.31.5.10:6379 (88c7571b...) -> 344651 keys | 2048 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 375017 keys | 2048 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 425125 keys | 2458 slots | 0 slaves.
172.31.5.50:6379 (90d55335...) -> 110076 keys | 818 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 374560 keys | 2048 slots | 0 slaves.
[OK] 2791504 keys in 8 masters.
170.38 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.50 TO 172.31.5.239 ###
[0m
{ reshardFrom: '172.31.5.50', reshardTo: '172.31.5.239', slots: 409 }
> redis-cli --cluster reshard 172.31.5.50:6379 --cluster-from 90d5533556bde70609b70e48c8ae0ee812fd3d8a --cluster-to 6b7779abdc16827d8fd3a0b04a2068ca4fe5c585 --cluster-slots 409 --cluster-yes | grep Ready
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 449982 keys | 2458 slots | 0 slaves.
172.31.5.86:6379 (3aac5767...) -> 333035 keys | 2048 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 379058 keys | 2458 slots | 0 slaves.
172.31.5.10:6379 (88c7571b...) -> 344651 keys | 2048 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 375017 keys | 2048 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 425125 keys | 2458 slots | 0 slaves.
172.31.5.50:6379 (90d55335...) -> 60102 keys | 409 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 424534 keys | 2457 slots | 0 slaves.
[OK] 2791504 keys in 8 masters.
170.38 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.50 TO 172.31.5.178 ###
[0m
{ reshardFrom: '172.31.5.50', reshardTo: '172.31.5.178', slots: 409 }
> redis-cli --cluster reshard 172.31.5.50:6379 --cluster-from 90d5533556bde70609b70e48c8ae0ee812fd3d8a --cluster-to 963958096c34d9596c9452b07253481eee2f9f00 --cluster-slots 409 --cluster-yes | grep Ready
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 449982 keys | 2458 slots | 0 slaves.
172.31.5.86:6379 (3aac5767...) -> 333035 keys | 2048 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 379058 keys | 2458 slots | 0 slaves.
172.31.5.10:6379 (88c7571b...) -> 344651 keys | 2048 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 435119 keys | 2457 slots | 1 slaves.
172.31.5.45:6379 (0e474212...) -> 425125 keys | 2458 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 424534 keys | 2457 slots | 0 slaves.
[OK] 2791504 keys in 7 masters.
170.38 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### REMOVING 172.31.5.50:6379 FROM CLUSTER ###
[0m
> redis-cli --cluster del-node 172.31.5.50:6379 90d5533556bde70609b70e48c8ae0ee812fd3d8a
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 449982 keys | 2458 slots | 0 slaves.
172.31.5.86:6379 (3aac5767...) -> 333035 keys | 2048 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 379058 keys | 2458 slots | 0 slaves.
172.31.5.10:6379 (88c7571b...) -> 344651 keys | 2048 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 435119 keys | 2457 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 425125 keys | 2458 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 424534 keys | 2457 slots | 0 slaves.
[OK] 2791504 keys in 7 masters.
170.38 keys per slot on average.
 
total slots: 16384
Removing node 90d5533556bde70609b70e48c8ae0ee812fd3d8a from cluster 172.31.5.50:6379
Sending CLUSTER FORGET messages to the cluster...
Sending CLUSTER RESET SOFT to the deleted node.
{ distribution: [ 410, 410, 410, 409, 409 ] }
[33m### RESHARDING FROM 172.31.5.10 TO 172.31.5.177 ###
[0m
{ reshardFrom: '172.31.5.10', reshardTo: '172.31.5.177', slots: 410 }
> redis-cli --cluster reshard 172.31.5.10:6379 --cluster-from 88c7571ba757b3547fc6fbefc0219284839688ba --cluster-to e5fb4afd51fdf082ef6d5eee77b9c8ff3ba46aca --cluster-slots 410 --cluster-yes | grep Ready
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 449982 keys | 2458 slots | 0 slaves.
172.31.5.86:6379 (3aac5767...) -> 333035 keys | 2048 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 454438 keys | 2868 slots | 0 slaves.
172.31.5.10:6379 (88c7571b...) -> 269271 keys | 1638 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 435119 keys | 2457 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 425125 keys | 2458 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 424534 keys | 2457 slots | 0 slaves.
[OK] 2791504 keys in 7 masters.
170.38 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.10 TO 172.31.5.45 ###
[0m
{ reshardFrom: '172.31.5.10', reshardTo: '172.31.5.45', slots: 410 }
> redis-cli --cluster reshard 172.31.5.10:6379 --cluster-from 88c7571ba757b3547fc6fbefc0219284839688ba --cluster-to 0e4742121d492415d1f0d097c9691101d6eb8194 --cluster-slots 410 --cluster-yes | grep Ready
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 449982 keys | 2458 slots | 0 slaves.
172.31.5.86:6379 (3aac5767...) -> 333035 keys | 2048 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 454438 keys | 2868 slots | 0 slaves.
172.31.5.10:6379 (88c7571b...) -> 194181 keys | 1228 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 435119 keys | 2457 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 500215 keys | 2868 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 424534 keys | 2457 slots | 0 slaves.
[OK] 2791504 keys in 7 masters.
170.38 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.10 TO 172.31.5.239 ###
[0m
{ reshardFrom: '172.31.5.10', reshardTo: '172.31.5.239', slots: 410 }
> redis-cli --cluster reshard 172.31.5.10:6379 --cluster-from 88c7571ba757b3547fc6fbefc0219284839688ba --cluster-to 6b7779abdc16827d8fd3a0b04a2068ca4fe5c585 --cluster-slots 410 --cluster-yes | grep Ready
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 449982 keys | 2458 slots | 0 slaves.
172.31.5.86:6379 (3aac5767...) -> 333035 keys | 2048 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 454438 keys | 2868 slots | 0 slaves.
172.31.5.10:6379 (88c7571b...) -> 118823 keys | 818 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 435119 keys | 2457 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 500215 keys | 2868 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 499892 keys | 2867 slots | 0 slaves.
[OK] 2791504 keys in 7 masters.
170.38 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.10 TO 172.31.5.178 ###
[0m
{ reshardFrom: '172.31.5.10', reshardTo: '172.31.5.178', slots: 409 }
> redis-cli --cluster reshard 172.31.5.10:6379 --cluster-from 88c7571ba757b3547fc6fbefc0219284839688ba --cluster-to 963958096c34d9596c9452b07253481eee2f9f00 --cluster-slots 409 --cluster-yes | grep Ready
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 449982 keys | 2458 slots | 0 slaves.
172.31.5.86:6379 (3aac5767...) -> 333035 keys | 2048 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 454438 keys | 2868 slots | 0 slaves.
172.31.5.10:6379 (88c7571b...) -> 50018 keys | 409 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 503924 keys | 2866 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 500215 keys | 2868 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 499892 keys | 2867 slots | 0 slaves.
[OK] 2791504 keys in 7 masters.
170.38 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.10 TO 172.31.5.88 ###
[0m
{ reshardFrom: '172.31.5.10', reshardTo: '172.31.5.88', slots: 409 }
> redis-cli --cluster reshard 172.31.5.10:6379 --cluster-from 88c7571ba757b3547fc6fbefc0219284839688ba --cluster-to 8b8944dfa3d8f1ff2204dc3aa335b19256357fe0 --cluster-slots 409 --cluster-yes | grep Ready
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 500000 keys | 2867 slots | 1 slaves.
172.31.5.86:6379 (3aac5767...) -> 333035 keys | 2048 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 454438 keys | 2868 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 503924 keys | 2866 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 500215 keys | 2868 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 499892 keys | 2867 slots | 0 slaves.
[OK] 2791504 keys in 6 masters.
170.38 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### REMOVING 172.31.5.10:6379 FROM CLUSTER ###
[0m
> redis-cli --cluster del-node 172.31.5.10:6379 88c7571ba757b3547fc6fbefc0219284839688ba
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 500000 keys | 2867 slots | 0 slaves.
172.31.5.86:6379 (3aac5767...) -> 333035 keys | 2048 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 454438 keys | 2868 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 503924 keys | 2866 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 500215 keys | 2868 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 499892 keys | 2867 slots | 0 slaves.
[OK] 2791504 keys in 6 masters.
170.38 keys per slot on average.
 
total slots: 16384
Removing node 88c7571ba757b3547fc6fbefc0219284839688ba from cluster 172.31.5.10:6379
Sending CLUSTER FORGET messages to the cluster...
Sending CLUSTER RESET SOFT to the deleted node.
{ distribution: [ 410, 410, 410, 409, 409 ] }
[33m### RESHARDING FROM 172.31.5.86 TO 172.31.5.45 ###
[0m
{ reshardFrom: '172.31.5.86', reshardTo: '172.31.5.45', slots: 410 }
> redis-cli --cluster reshard 172.31.5.86:6379 --cluster-from 3aac57677b916b89b568938c6db362da7ebc2b2a --cluster-to 0e4742121d492415d1f0d097c9691101d6eb8194 --cluster-slots 410 --cluster-yes | grep Ready
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 500000 keys | 2867 slots | 0 slaves.
172.31.5.86:6379 (3aac5767...) -> 258235 keys | 1638 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 454438 keys | 2868 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 503924 keys | 2866 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 575015 keys | 3278 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 499892 keys | 2867 slots | 0 slaves.
[OK] 2791504 keys in 6 masters.
170.38 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.86 TO 172.31.5.239 ###
[0m
{ reshardFrom: '172.31.5.86', reshardTo: '172.31.5.239', slots: 410 }
> redis-cli --cluster reshard 172.31.5.86:6379 --cluster-from 3aac57677b916b89b568938c6db362da7ebc2b2a --cluster-to 6b7779abdc16827d8fd3a0b04a2068ca4fe5c585 --cluster-slots 410 --cluster-yes | grep Ready
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 500000 keys | 2867 slots | 0 slaves.
172.31.5.86:6379 (3aac5767...) -> 183501 keys | 1228 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 454438 keys | 2868 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 503924 keys | 2866 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 575015 keys | 3278 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 574626 keys | 3277 slots | 0 slaves.
[OK] 2791504 keys in 6 masters.
170.38 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.86 TO 172.31.5.178 ###
[0m
{ reshardFrom: '172.31.5.86', reshardTo: '172.31.5.178', slots: 410 }
> redis-cli --cluster reshard 172.31.5.86:6379 --cluster-from 3aac57677b916b89b568938c6db362da7ebc2b2a --cluster-to 963958096c34d9596c9452b07253481eee2f9f00 --cluster-slots 410 --cluster-yes | grep Ready
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 500000 keys | 2867 slots | 0 slaves.
172.31.5.86:6379 (3aac5767...) -> 108136 keys | 818 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 454438 keys | 2868 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 579289 keys | 3276 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 575015 keys | 3278 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 574626 keys | 3277 slots | 0 slaves.
[OK] 2791504 keys in 6 masters.
170.38 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.86 TO 172.31.5.88 ###
[0m
{ reshardFrom: '172.31.5.86', reshardTo: '172.31.5.88', slots: 409 }
> redis-cli --cluster reshard 172.31.5.86:6379 --cluster-from 3aac57677b916b89b568938c6db362da7ebc2b2a --cluster-to 8b8944dfa3d8f1ff2204dc3aa335b19256357fe0 --cluster-slots 409 --cluster-yes | grep Ready
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 558301 keys | 3276 slots | 0 slaves.
172.31.5.86:6379 (3aac5767...) -> 49835 keys | 409 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 454438 keys | 2868 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 579289 keys | 3276 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 575015 keys | 3278 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 574626 keys | 3277 slots | 0 slaves.
[OK] 2791504 keys in 6 masters.
170.38 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.86 TO 172.31.5.177 ###
[0m
{ reshardFrom: '172.31.5.86', reshardTo: '172.31.5.177', slots: 409 }
> redis-cli --cluster reshard 172.31.5.86:6379 --cluster-from 3aac57677b916b89b568938c6db362da7ebc2b2a --cluster-to e5fb4afd51fdf082ef6d5eee77b9c8ff3ba46aca --cluster-slots 409 --cluster-yes | grep Ready
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 558301 keys | 3276 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 504273 keys | 3277 slots | 1 slaves.
172.31.5.178:6379 (96395809...) -> 579289 keys | 3276 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 575015 keys | 3278 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 574626 keys | 3277 slots | 0 slaves.
[OK] 2791504 keys in 5 masters.
170.38 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### REMOVING 172.31.5.86:6379 FROM CLUSTER ###
[0m
> redis-cli --cluster del-node 172.31.5.86:6379 3aac57677b916b89b568938c6db362da7ebc2b2a
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 558301 keys | 3276 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 504273 keys | 3277 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 579289 keys | 3276 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 575015 keys | 3278 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 574626 keys | 3277 slots | 0 slaves.
[OK] 2791504 keys in 5 masters.
170.38 keys per slot on average.
 
total slots: 16384
Removing node 3aac57677b916b89b568938c6db362da7ebc2b2a from cluster 172.31.5.86:6379
Sending CLUSTER FORGET messages to the cluster...
Sending CLUSTER RESET SOFT to the deleted node.
[33m### REBALANCING CLUSTER ON 172.31.5.88:6379 ###
[0m
> redis-cli --cluster rebalance 172.31.5.88:6379 --cluster-use-empty-masters | grep -i Rebalancing
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 558301 keys | 3276 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 504273 keys | 3277 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 579289 keys | 3276 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 575015 keys | 3278 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 574626 keys | 3277 slots | 0 slaves.
[OK] 2791504 keys in 5 masters.
170.38 keys per slot on average.
 
total slots: 16384
*** No rebalancing needed! All nodes are within the 2.00% threshold.


waiting... 65 64 63 62 61 60 59 58 57 56 55 54 53 52 51 50 49 48 47 46 45 44 43 42 41 40 39 38 37 36 35 34 33 32 31 30 29 28 27 26 25 24 23 22 21 20 19 18 17 16 15 14 13 12 11 10 9 8 7 6 5 4 3 2 1 



[34m******* resize , 5 completed ******* [0m 

------------------------------------------------------------------

[34m******* write , 500000 *******[0m

[33m### WRITING 500000 KEYS ###
[0m
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 658339 keys | 3276 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 604282 keys | 3277 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 679234 keys | 3276 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 675079 keys | 3278 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 674570 keys | 3277 slots | 0 slaves.
[OK] 3291504 keys in 5 masters.
200.90 keys per slot on average.
 
total slots: 16384
0.5M keys written successfully

[34m******* write , 500000 completed ******* [0m 

------------------------------------------------------------------

[34m******* resize , 8 *******[0m

{ clusterSize: 5 }
[33m### ADDING 172.31.5.86:6379 NODE TO CLUSTER ###
[0m
> redis-cli --cluster add-node 172.31.5.86:6379 172.31.5.88:6379 | awk '{ gsub(/[[0-9;]*m/, ""); print }'
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 658339 keys | 3276 slots | 0 slaves.
172.31.5.86:6379 (3aac5767...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 604282 keys | 3277 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 679234 keys | 3276 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 675079 keys | 3278 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 674570 keys | 3277 slots | 0 slaves.
[OK] 3291504 keys in 6 masters.
200.90 keys per slot on average.
 
total slots: 16384
node added successfully
waiting... 2 1 


[33m### ADDING 172.31.5.10:6379 NODE TO CLUSTER ###
[0m
> redis-cli --cluster add-node 172.31.5.10:6379 172.31.5.88:6379 | awk '{ gsub(/[[0-9;]*m/, ""); print }'
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 658339 keys | 3276 slots | 0 slaves.
172.31.5.86:6379 (3aac5767...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 604282 keys | 3277 slots | 0 slaves.
172.31.5.10:6379 (88c7571b...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 679234 keys | 3276 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 675079 keys | 3278 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 674570 keys | 3277 slots | 0 slaves.
[OK] 3291504 keys in 7 masters.
200.90 keys per slot on average.
 
total slots: 16384
node added successfully
waiting... 2 1 


[33m### ADDING 172.31.5.50:6379 NODE TO CLUSTER ###
[0m
> redis-cli --cluster add-node 172.31.5.50:6379 172.31.5.88:6379 | awk '{ gsub(/[[0-9;]*m/, ""); print }'
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 658339 keys | 3276 slots | 0 slaves.
172.31.5.86:6379 (3aac5767...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 604282 keys | 3277 slots | 0 slaves.
172.31.5.10:6379 (88c7571b...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 679234 keys | 3276 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 675079 keys | 3278 slots | 0 slaves.
172.31.5.50:6379 (90d55335...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 674570 keys | 3277 slots | 0 slaves.
[OK] 3291504 keys in 8 masters.
200.90 keys per slot on average.
 
total slots: 16384
node added successfully
waiting... 2 1 


waiting... 10 9 8 7 6 5 4 3 2 1 


[33m### REBALANCING CLUSTER ON 172.31.5.86:6379 ###
[0m
> redis-cli --cluster rebalance 172.31.5.86:6379 --cluster-use-empty-masters | grep -i Rebalancing
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 427283 keys | 2048 slots | 0 slaves.
172.31.5.86:6379 (3aac5767...) -> 393834 keys | 2048 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 385376 keys | 2048 slots | 0 slaves.
172.31.5.10:6379 (88c7571b...) -> 387538 keys | 2048 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 431248 keys | 2048 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 437500 keys | 2048 slots | 0 slaves.
172.31.5.50:6379 (90d55335...) -> 391493 keys | 2048 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 437232 keys | 2048 slots | 0 slaves.
[OK] 3291504 keys in 8 masters.
200.90 keys per slot on average.
 
total slots: 16384
>>> Rebalancing across 8 nodes. Total weight = 8.00



[34m******* resize , 8 completed ******* [0m 

------------------------------------------------------------------

[34m******* write , 500000 *******[0m

[33m### WRITING 500000 KEYS ###
[0m
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 489760 keys | 2048 slots | 0 slaves.
172.31.5.86:6379 (3aac5767...) -> 456395 keys | 2048 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 447921 keys | 2048 slots | 0 slaves.
172.31.5.10:6379 (88c7571b...) -> 449973 keys | 2048 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 493795 keys | 2048 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 499997 keys | 2048 slots | 0 slaves.
172.31.5.50:6379 (90d55335...) -> 453965 keys | 2048 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 499698 keys | 2048 slots | 0 slaves.
[OK] 3791504 keys in 8 masters.
231.42 keys per slot on average.
 
total slots: 16384
0.5M keys written successfully

[34m******* write , 500000 completed ******* [0m 

------------------------------------------------------------------

[34m******* resize , 6 *******[0m

{ clusterSize: 8 }
[33m### REBALANCING CLUSTER ON 172.31.5.50:6379 ###
[0m
> redis-cli --cluster rebalance 172.31.5.50:6379 --cluster-use-empty-masters | grep -i Rebalancing
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 489760 keys | 2048 slots | 0 slaves.
172.31.5.86:6379 (3aac5767...) -> 456395 keys | 2048 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 447921 keys | 2048 slots | 0 slaves.
172.31.5.10:6379 (88c7571b...) -> 449973 keys | 2048 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 493795 keys | 2048 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 499997 keys | 2048 slots | 0 slaves.
172.31.5.50:6379 (90d55335...) -> 453965 keys | 2048 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 499698 keys | 2048 slots | 0 slaves.
[OK] 3791504 keys in 8 masters.
231.42 keys per slot on average.
 
total slots: 16384
*** No rebalancing needed! All nodes are within the 2.00% threshold.


{ distribution: [ 342, 342, 341, 341, 341, 341 ] }
[33m### RESHARDING FROM 172.31.5.50 TO 172.31.5.88 ###
[0m
{ reshardFrom: '172.31.5.50', reshardTo: '172.31.5.88', slots: 342 }
> redis-cli --cluster reshard 172.31.5.50:6379 --cluster-from 90d5533556bde70609b70e48c8ae0ee812fd3d8a --cluster-to 8b8944dfa3d8f1ff2204dc3aa335b19256357fe0 --cluster-slots 342 --cluster-yes | grep Ready
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 572865 keys | 2390 slots | 0 slaves.
172.31.5.86:6379 (3aac5767...) -> 456395 keys | 2048 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 447921 keys | 2048 slots | 0 slaves.
172.31.5.10:6379 (88c7571b...) -> 449973 keys | 2048 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 493795 keys | 2048 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 499997 keys | 2048 slots | 0 slaves.
172.31.5.50:6379 (90d55335...) -> 370860 keys | 1706 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 499698 keys | 2048 slots | 0 slaves.
[OK] 3791504 keys in 8 masters.
231.42 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.50 TO 172.31.5.177 ###
[0m
{ reshardFrom: '172.31.5.50', reshardTo: '172.31.5.177', slots: 342 }
> redis-cli --cluster reshard 172.31.5.50:6379 --cluster-from 90d5533556bde70609b70e48c8ae0ee812fd3d8a --cluster-to e5fb4afd51fdf082ef6d5eee77b9c8ff3ba46aca --cluster-slots 342 --cluster-yes | grep Ready
assertion error.
 {
  keys1: 3791504,
  keys2: 3333100,
  keys: 0,
  slots1: 16384,
  slots2: 16384,
  nodes1: 8,
  nodes2: 8,
  nodes: 0
}
precheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 572865 keys | 2390 slots | 0 slaves.
172.31.5.86:6379 (3aac5767...) -> 456395 keys | 2048 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 447921 keys | 2048 slots | 0 slaves.
172.31.5.10:6379 (88c7571b...) -> 449973 keys | 2048 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 493795 keys | 2048 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 499997 keys | 2048 slots | 0 slaves.
172.31.5.50:6379 (90d55335...) -> 370860 keys | 1706 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 499698 keys | 2048 slots | 0 slaves.
[OK] 3791504 keys in 8 masters.
231.42 keys per slot on average.

postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 572865 keys | 2390 slots | 0 slaves.
172.31.5.86:6379 (3aac5767...) -> 456395 keys | 2048 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 72963 keys | 2390 slots | 0 slaves.
172.31.5.10:6379 (88c7571b...) -> 449973 keys | 2048 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 493795 keys | 2048 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 499997 keys | 2048 slots | 0 slaves.
172.31.5.50:6379 (90d55335...) -> 287414 keys | 1364 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 499698 keys | 2048 slots | 0 slaves.
[OK] 3333100 keys in 8 masters.
203.44 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.50 TO 172.31.5.45 ###
[0m
{ reshardFrom: '172.31.5.50', reshardTo: '172.31.5.45', slots: 341 }
> redis-cli --cluster reshard 172.31.5.50:6379 --cluster-from 90d5533556bde70609b70e48c8ae0ee812fd3d8a --cluster-to 0e4742121d492415d1f0d097c9691101d6eb8194 --cluster-slots 341 --cluster-yes | grep Ready
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 572865 keys | 2390 slots | 0 slaves.
172.31.5.86:6379 (3aac5767...) -> 456395 keys | 2048 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 72963 keys | 2390 slots | 0 slaves.
172.31.5.10:6379 (88c7571b...) -> 449973 keys | 2048 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 493795 keys | 2048 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 568538 keys | 2389 slots | 0 slaves.
172.31.5.50:6379 (90d55335...) -> 218873 keys | 1023 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 499698 keys | 2048 slots | 0 slaves.
[OK] 3333100 keys in 8 masters.
203.44 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.50 TO 172.31.5.239 ###
[0m
{ reshardFrom: '172.31.5.50', reshardTo: '172.31.5.239', slots: 341 }
> redis-cli --cluster reshard 172.31.5.50:6379 --cluster-from 90d5533556bde70609b70e48c8ae0ee812fd3d8a --cluster-to 6b7779abdc16827d8fd3a0b04a2068ca4fe5c585 --cluster-slots 341 --cluster-yes | grep Ready
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 572865 keys | 2390 slots | 0 slaves.
172.31.5.86:6379 (3aac5767...) -> 456395 keys | 2048 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 72963 keys | 2390 slots | 0 slaves.
172.31.5.10:6379 (88c7571b...) -> 449973 keys | 2048 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 493795 keys | 2048 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 568538 keys | 2389 slots | 0 slaves.
172.31.5.50:6379 (90d55335...) -> 135474 keys | 682 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 583097 keys | 2389 slots | 0 slaves.
[OK] 3333100 keys in 8 masters.
203.44 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.50 TO 172.31.5.178 ###
[0m
{ reshardFrom: '172.31.5.50', reshardTo: '172.31.5.178', slots: 341 }
> redis-cli --cluster reshard 172.31.5.50:6379 --cluster-from 90d5533556bde70609b70e48c8ae0ee812fd3d8a --cluster-to 963958096c34d9596c9452b07253481eee2f9f00 --cluster-slots 341 --cluster-yes | grep Ready
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 572865 keys | 2390 slots | 0 slaves.
172.31.5.86:6379 (3aac5767...) -> 456395 keys | 2048 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 72963 keys | 2390 slots | 0 slaves.
172.31.5.10:6379 (88c7571b...) -> 449973 keys | 2048 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 566709 keys | 2389 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 568538 keys | 2389 slots | 0 slaves.
172.31.5.50:6379 (90d55335...) -> 62560 keys | 341 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 583097 keys | 2389 slots | 0 slaves.
[OK] 3333100 keys in 8 masters.
203.44 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.50 TO 172.31.5.86 ###
[0m
{ reshardFrom: '172.31.5.50', reshardTo: '172.31.5.86', slots: 341 }
> redis-cli --cluster reshard 172.31.5.50:6379 --cluster-from 90d5533556bde70609b70e48c8ae0ee812fd3d8a --cluster-to 3aac57677b916b89b568938c6db362da7ebc2b2a --cluster-slots 341 --cluster-yes | grep Ready
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 572865 keys | 2390 slots | 0 slaves.
172.31.5.86:6379 (3aac5767...) -> 518955 keys | 2389 slots | 1 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 72963 keys | 2390 slots | 0 slaves.
172.31.5.10:6379 (88c7571b...) -> 449973 keys | 2048 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 566709 keys | 2389 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 568538 keys | 2389 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 583097 keys | 2389 slots | 0 slaves.
[OK] 3333100 keys in 7 masters.
203.44 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### REMOVING 172.31.5.50:6379 FROM CLUSTER ###
[0m
> redis-cli --cluster del-node 172.31.5.50:6379 90d5533556bde70609b70e48c8ae0ee812fd3d8a
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 572865 keys | 2390 slots | 0 slaves.
172.31.5.86:6379 (3aac5767...) -> 518955 keys | 2389 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 72963 keys | 2390 slots | 0 slaves.
172.31.5.10:6379 (88c7571b...) -> 449973 keys | 2048 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 566709 keys | 2389 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 568538 keys | 2389 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 583097 keys | 2389 slots | 0 slaves.
[OK] 3333100 keys in 7 masters.
203.44 keys per slot on average.
 
total slots: 16384
Removing node 90d5533556bde70609b70e48c8ae0ee812fd3d8a from cluster 172.31.5.50:6379
Sending CLUSTER FORGET messages to the cluster...
Sending CLUSTER RESET SOFT to the deleted node.
{ distribution: [ 342, 342, 341, 341, 341, 341 ] }
[33m### RESHARDING FROM 172.31.5.10 TO 172.31.5.177 ###
[0m
{ reshardFrom: '172.31.5.10', reshardTo: '172.31.5.177', slots: 342 }
> redis-cli --cluster reshard 172.31.5.10:6379 --cluster-from 88c7571ba757b3547fc6fbefc0219284839688ba --cluster-to e5fb4afd51fdf082ef6d5eee77b9c8ff3ba46aca --cluster-slots 342 --cluster-yes | grep Ready
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 572865 keys | 2390 slots | 0 slaves.
172.31.5.86:6379 (3aac5767...) -> 518955 keys | 2389 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 156814 keys | 2732 slots | 0 slaves.
172.31.5.10:6379 (88c7571b...) -> 366122 keys | 1706 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 566709 keys | 2389 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 568538 keys | 2389 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 583097 keys | 2389 slots | 0 slaves.
[OK] 3333100 keys in 7 masters.
203.44 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.10 TO 172.31.5.45 ###
[0m
{ reshardFrom: '172.31.5.10', reshardTo: '172.31.5.45', slots: 342 }
> redis-cli --cluster reshard 172.31.5.10:6379 --cluster-from 88c7571ba757b3547fc6fbefc0219284839688ba --cluster-to 0e4742121d492415d1f0d097c9691101d6eb8194 --cluster-slots 342 --cluster-yes | grep Ready
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 572865 keys | 2390 slots | 0 slaves.
172.31.5.86:6379 (3aac5767...) -> 518955 keys | 2389 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 156814 keys | 2732 slots | 0 slaves.
172.31.5.10:6379 (88c7571b...) -> 283106 keys | 1364 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 566709 keys | 2389 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 651554 keys | 2731 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 583097 keys | 2389 slots | 0 slaves.
[OK] 3333100 keys in 7 masters.
203.44 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.10 TO 172.31.5.239 ###
[0m
{ reshardFrom: '172.31.5.10', reshardTo: '172.31.5.239', slots: 341 }
> redis-cli --cluster reshard 172.31.5.10:6379 --cluster-from 88c7571ba757b3547fc6fbefc0219284839688ba --cluster-to 6b7779abdc16827d8fd3a0b04a2068ca4fe5c585 --cluster-slots 341 --cluster-yes | grep Ready
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 572865 keys | 2390 slots | 0 slaves.
172.31.5.86:6379 (3aac5767...) -> 518955 keys | 2389 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 156814 keys | 2732 slots | 0 slaves.
172.31.5.10:6379 (88c7571b...) -> 220569 keys | 1023 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 566709 keys | 2389 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 651554 keys | 2731 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 645634 keys | 2730 slots | 0 slaves.
[OK] 3333100 keys in 7 masters.
203.44 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.10 TO 172.31.5.178 ###
[0m
{ reshardFrom: '172.31.5.10', reshardTo: '172.31.5.178', slots: 341 }
> redis-cli --cluster reshard 172.31.5.10:6379 --cluster-from 88c7571ba757b3547fc6fbefc0219284839688ba --cluster-to 963958096c34d9596c9452b07253481eee2f9f00 --cluster-slots 341 --cluster-yes | grep Ready
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 572865 keys | 2390 slots | 0 slaves.
172.31.5.86:6379 (3aac5767...) -> 518955 keys | 2389 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 156814 keys | 2732 slots | 0 slaves.
172.31.5.10:6379 (88c7571b...) -> 141560 keys | 682 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 645718 keys | 2730 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 651554 keys | 2731 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 645634 keys | 2730 slots | 0 slaves.
[OK] 3333100 keys in 7 masters.
203.44 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.10 TO 172.31.5.86 ###
[0m
{ reshardFrom: '172.31.5.10', reshardTo: '172.31.5.86', slots: 341 }
> redis-cli --cluster reshard 172.31.5.10:6379 --cluster-from 88c7571ba757b3547fc6fbefc0219284839688ba --cluster-to 3aac57677b916b89b568938c6db362da7ebc2b2a --cluster-slots 341 --cluster-yes | grep Ready
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 572865 keys | 2390 slots | 0 slaves.
172.31.5.86:6379 (3aac5767...) -> 598272 keys | 2730 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 156814 keys | 2732 slots | 0 slaves.
172.31.5.10:6379 (88c7571b...) -> 62243 keys | 341 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 645718 keys | 2730 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 651554 keys | 2731 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 645634 keys | 2730 slots | 0 slaves.
[OK] 3333100 keys in 7 masters.
203.44 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.10 TO 172.31.5.88 ###
[0m
{ reshardFrom: '172.31.5.10', reshardTo: '172.31.5.88', slots: 341 }
> redis-cli --cluster reshard 172.31.5.10:6379 --cluster-from 88c7571ba757b3547fc6fbefc0219284839688ba --cluster-to 8b8944dfa3d8f1ff2204dc3aa335b19256357fe0 --cluster-slots 341 --cluster-yes | grep Ready
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 635108 keys | 2731 slots | 1 slaves.
172.31.5.86:6379 (3aac5767...) -> 598272 keys | 2730 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 156814 keys | 2732 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 645718 keys | 2730 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 651554 keys | 2731 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 645634 keys | 2730 slots | 0 slaves.
[OK] 3333100 keys in 6 masters.
203.44 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### REMOVING 172.31.5.10:6379 FROM CLUSTER ###
[0m
> redis-cli --cluster del-node 172.31.5.10:6379 88c7571ba757b3547fc6fbefc0219284839688ba
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 635108 keys | 2731 slots | 0 slaves.
172.31.5.86:6379 (3aac5767...) -> 598272 keys | 2730 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 156814 keys | 2732 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 645718 keys | 2730 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 651554 keys | 2731 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 645634 keys | 2730 slots | 0 slaves.
[OK] 3333100 keys in 6 masters.
203.44 keys per slot on average.
 
total slots: 16384
Removing node 88c7571ba757b3547fc6fbefc0219284839688ba from cluster 172.31.5.10:6379
Sending CLUSTER FORGET messages to the cluster...
Sending CLUSTER RESET SOFT to the deleted node.
[33m### REBALANCING CLUSTER ON 172.31.5.88:6379 ###
[0m
> redis-cli --cluster rebalance 172.31.5.88:6379 --cluster-use-empty-masters | grep -i Rebalancing
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 635108 keys | 2731 slots | 0 slaves.
172.31.5.86:6379 (3aac5767...) -> 598272 keys | 2730 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 156814 keys | 2732 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 645718 keys | 2730 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 651554 keys | 2731 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 645634 keys | 2730 slots | 0 slaves.
[OK] 3333100 keys in 6 masters.
203.44 keys per slot on average.
 
total slots: 16384
*** No rebalancing needed! All nodes are within the 2.00% threshold.


waiting... 65 64 63 62 61 60 59 58 57 56 55 54 53 52 51 50 49 48 47 46 45 44 43 42 41 40 39 38 37 36 35 34 33 32 31 30 29 28 27 26 25 24 23 22 21 20 19 18 17 16 15 14 13 12 11 10 9 8 7 6 5 4 3 2 1 



[34m******* resize , 6 completed ******* [0m 

------------------------------------------------------------------

[34m******* write , 500000 *******[0m

[33m### WRITING 500000 KEYS ###
[0m
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 718265 keys | 2731 slots | 0 slaves.
172.31.5.86:6379 (3aac5767...) -> 681752 keys | 2730 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 240284 keys | 2732 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 729005 keys | 2730 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 734864 keys | 2731 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 728930 keys | 2730 slots | 0 slaves.
[OK] 3833100 keys in 6 masters.
233.95 keys per slot on average.
 
total slots: 16384
0.5M keys written successfully

[34m******* write , 500000 completed ******* [0m 

------------------------------------------------------------------

[34m******* resize , 8 *******[0m

{ clusterSize: 6 }
[33m### ADDING 172.31.5.10:6379 NODE TO CLUSTER ###
[0m
> redis-cli --cluster add-node 172.31.5.10:6379 172.31.5.88:6379 | awk '{ gsub(/[[0-9;]*m/, ""); print }'
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 718265 keys | 2731 slots | 0 slaves.
172.31.5.86:6379 (3aac5767...) -> 681752 keys | 2730 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 240284 keys | 2732 slots | 0 slaves.
172.31.5.10:6379 (88c7571b...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 729005 keys | 2730 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 734864 keys | 2731 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 728930 keys | 2730 slots | 0 slaves.
[OK] 3833100 keys in 7 masters.
233.95 keys per slot on average.
 
total slots: 16384
node added successfully
waiting... 2 1 


[33m### ADDING 172.31.5.50:6379 NODE TO CLUSTER ###
[0m
> redis-cli --cluster add-node 172.31.5.50:6379 172.31.5.88:6379 | awk '{ gsub(/[[0-9;]*m/, ""); print }'
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 718265 keys | 2731 slots | 0 slaves.
172.31.5.86:6379 (3aac5767...) -> 681752 keys | 2730 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 240284 keys | 2732 slots | 0 slaves.
172.31.5.10:6379 (88c7571b...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 729005 keys | 2730 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 734864 keys | 2731 slots | 0 slaves.
172.31.5.50:6379 (90d55335...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 728930 keys | 2730 slots | 0 slaves.
[OK] 3833100 keys in 8 masters.
233.95 keys per slot on average.
 
total slots: 16384
node added successfully
waiting... 2 1 


waiting... 10 9 8 7 6 5 4 3 2 1 


[33m### REBALANCING CLUSTER ON 172.31.5.10:6379 ###
[0m
> redis-cli --cluster rebalance 172.31.5.10:6379 --cluster-use-empty-masters | grep -i Rebalancing
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 551969 keys | 2048 slots | 0 slaves.
172.31.5.86:6379 (3aac5767...) -> 519749 keys | 2048 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 62525 keys | 2048 slots | 0 slaves.
172.31.5.10:6379 (88c7571b...) -> 515966 keys | 2048 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 546473 keys | 2048 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 562522 keys | 2048 slots | 0 slaves.
172.31.5.50:6379 (90d55335...) -> 511826 keys | 2048 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 562070 keys | 2048 slots | 0 slaves.
[OK] 3833100 keys in 8 masters.
233.95 keys per slot on average.
 
total slots: 16384
>>> Rebalancing across 8 nodes. Total weight = 8.00



[34m******* resize , 8 completed ******* [0m 

------------------------------------------------------------------

[34m******* write , 500000 *******[0m

[33m### WRITING 500000 KEYS ###
[0m
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 614476 keys | 2048 slots | 0 slaves.
172.31.5.86:6379 (3aac5767...) -> 582359 keys | 2048 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 125015 keys | 2048 slots | 0 slaves.
172.31.5.10:6379 (88c7571b...) -> 578408 keys | 2048 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 609073 keys | 2048 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 625028 keys | 2048 slots | 0 slaves.
172.31.5.50:6379 (90d55335...) -> 574273 keys | 2048 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 624468 keys | 2048 slots | 0 slaves.
[OK] 4333100 keys in 8 masters.
264.47 keys per slot on average.
 
total slots: 16384
0.5M keys written successfully

[34m******* write , 500000 completed ******* [0m 

------------------------------------------------------------------

[34m******* resize , 7 *******[0m

{ clusterSize: 8 }
[33m### REBALANCING CLUSTER ON 172.31.5.50:6379 ###
[0m
> redis-cli --cluster rebalance 172.31.5.50:6379 --cluster-use-empty-masters | grep -i Rebalancing
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 614476 keys | 2048 slots | 0 slaves.
172.31.5.86:6379 (3aac5767...) -> 582359 keys | 2048 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 125015 keys | 2048 slots | 0 slaves.
172.31.5.10:6379 (88c7571b...) -> 578408 keys | 2048 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 609073 keys | 2048 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 625028 keys | 2048 slots | 0 slaves.
172.31.5.50:6379 (90d55335...) -> 574273 keys | 2048 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 624468 keys | 2048 slots | 0 slaves.
[OK] 4333100 keys in 8 masters.
264.47 keys per slot on average.
 
total slots: 16384
*** No rebalancing needed! All nodes are within the 2.00% threshold.


{ distribution: [
    293, 293, 293,
    293, 292, 292,
    292
  ] }
[33m### RESHARDING FROM 172.31.5.50 TO 172.31.5.88 ###
[0m
{ reshardFrom: '172.31.5.50', reshardTo: '172.31.5.88', slots: 293 }
> redis-cli --cluster reshard 172.31.5.50:6379 --cluster-from 90d5533556bde70609b70e48c8ae0ee812fd3d8a --cluster-to 8b8944dfa3d8f1ff2204dc3aa335b19256357fe0 --cluster-slots 293 --cluster-yes | grep Ready
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 702203 keys | 2341 slots | 0 slaves.
172.31.5.86:6379 (3aac5767...) -> 582359 keys | 2048 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 125015 keys | 2048 slots | 0 slaves.
172.31.5.10:6379 (88c7571b...) -> 578408 keys | 2048 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 609073 keys | 2048 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 625028 keys | 2048 slots | 0 slaves.
172.31.5.50:6379 (90d55335...) -> 486546 keys | 1755 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 624468 keys | 2048 slots | 0 slaves.
[OK] 4333100 keys in 8 masters.
264.47 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.50 TO 172.31.5.177 ###
[0m
{ reshardFrom: '172.31.5.50', reshardTo: '172.31.5.177', slots: 293 }
> redis-cli --cluster reshard 172.31.5.50:6379 --cluster-from 90d5533556bde70609b70e48c8ae0ee812fd3d8a --cluster-to e5fb4afd51fdf082ef6d5eee77b9c8ff3ba46aca --cluster-slots 293 --cluster-yes | grep Ready
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 702203 keys | 2341 slots | 0 slaves.
172.31.5.86:6379 (3aac5767...) -> 582359 keys | 2048 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 196589 keys | 2341 slots | 0 slaves.
172.31.5.10:6379 (88c7571b...) -> 578408 keys | 2048 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 609073 keys | 2048 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 625028 keys | 2048 slots | 0 slaves.
172.31.5.50:6379 (90d55335...) -> 414972 keys | 1462 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 624468 keys | 2048 slots | 0 slaves.
[OK] 4333100 keys in 8 masters.
264.47 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.50 TO 172.31.5.45 ###
[0m
{ reshardFrom: '172.31.5.50', reshardTo: '172.31.5.45', slots: 293 }
> redis-cli --cluster reshard 172.31.5.50:6379 --cluster-from 90d5533556bde70609b70e48c8ae0ee812fd3d8a --cluster-to 0e4742121d492415d1f0d097c9691101d6eb8194 --cluster-slots 293 --cluster-yes | grep Ready
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 702203 keys | 2341 slots | 0 slaves.
172.31.5.86:6379 (3aac5767...) -> 582359 keys | 2048 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 196589 keys | 2341 slots | 0 slaves.
172.31.5.10:6379 (88c7571b...) -> 578408 keys | 2048 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 609073 keys | 2048 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 696741 keys | 2341 slots | 0 slaves.
172.31.5.50:6379 (90d55335...) -> 343259 keys | 1169 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 624468 keys | 2048 slots | 0 slaves.
[OK] 4333100 keys in 8 masters.
264.47 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.50 TO 172.31.5.239 ###
[0m
{ reshardFrom: '172.31.5.50', reshardTo: '172.31.5.239', slots: 293 }
> redis-cli --cluster reshard 172.31.5.50:6379 --cluster-from 90d5533556bde70609b70e48c8ae0ee812fd3d8a --cluster-to 6b7779abdc16827d8fd3a0b04a2068ca4fe5c585 --cluster-slots 293 --cluster-yes | grep Ready
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 702203 keys | 2341 slots | 0 slaves.
172.31.5.86:6379 (3aac5767...) -> 582359 keys | 2048 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 196589 keys | 2341 slots | 0 slaves.
172.31.5.10:6379 (88c7571b...) -> 578408 keys | 2048 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 609073 keys | 2048 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 696741 keys | 2341 slots | 0 slaves.
172.31.5.50:6379 (90d55335...) -> 266736 keys | 876 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 700991 keys | 2341 slots | 0 slaves.
[OK] 4333100 keys in 8 masters.
264.47 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.50 TO 172.31.5.178 ###
[0m
{ reshardFrom: '172.31.5.50', reshardTo: '172.31.5.178', slots: 292 }
> redis-cli --cluster reshard 172.31.5.50:6379 --cluster-from 90d5533556bde70609b70e48c8ae0ee812fd3d8a --cluster-to 963958096c34d9596c9452b07253481eee2f9f00 --cluster-slots 292 --cluster-yes | grep Ready
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 702203 keys | 2341 slots | 0 slaves.
172.31.5.86:6379 (3aac5767...) -> 582359 keys | 2048 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 196589 keys | 2341 slots | 0 slaves.
172.31.5.10:6379 (88c7571b...) -> 578408 keys | 2048 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 698128 keys | 2340 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 696741 keys | 2341 slots | 0 slaves.
172.31.5.50:6379 (90d55335...) -> 177681 keys | 584 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 700991 keys | 2341 slots | 0 slaves.
[OK] 4333100 keys in 8 masters.
264.47 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.50 TO 172.31.5.86 ###
[0m
{ reshardFrom: '172.31.5.50', reshardTo: '172.31.5.86', slots: 292 }
> redis-cli --cluster reshard 172.31.5.50:6379 --cluster-from 90d5533556bde70609b70e48c8ae0ee812fd3d8a --cluster-to 3aac57677b916b89b568938c6db362da7ebc2b2a --cluster-slots 292 --cluster-yes | grep Ready
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 702203 keys | 2341 slots | 0 slaves.
172.31.5.86:6379 (3aac5767...) -> 671350 keys | 2340 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 196589 keys | 2341 slots | 0 slaves.
172.31.5.10:6379 (88c7571b...) -> 578408 keys | 2048 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 698128 keys | 2340 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 696741 keys | 2341 slots | 0 slaves.
172.31.5.50:6379 (90d55335...) -> 88690 keys | 292 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 700991 keys | 2341 slots | 0 slaves.
[OK] 4333100 keys in 8 masters.
264.47 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.50 TO 172.31.5.10 ###
[0m
{ reshardFrom: '172.31.5.50', reshardTo: '172.31.5.10', slots: 292 }
> redis-cli --cluster reshard 172.31.5.50:6379 --cluster-from 90d5533556bde70609b70e48c8ae0ee812fd3d8a --cluster-to 88c7571ba757b3547fc6fbefc0219284839688ba --cluster-slots 292 --cluster-yes | grep Ready
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 702203 keys | 2341 slots | 0 slaves.
172.31.5.86:6379 (3aac5767...) -> 671350 keys | 2340 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 196589 keys | 2341 slots | 0 slaves.
172.31.5.10:6379 (88c7571b...) -> 667098 keys | 2340 slots | 1 slaves.
172.31.5.178:6379 (96395809...) -> 698128 keys | 2340 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 696741 keys | 2341 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 700991 keys | 2341 slots | 0 slaves.
[OK] 4333100 keys in 7 masters.
264.47 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### REMOVING 172.31.5.50:6379 FROM CLUSTER ###
[0m
> redis-cli --cluster del-node 172.31.5.50:6379 90d5533556bde70609b70e48c8ae0ee812fd3d8a
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 702203 keys | 2341 slots | 0 slaves.
172.31.5.86:6379 (3aac5767...) -> 671350 keys | 2340 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 196589 keys | 2341 slots | 0 slaves.
172.31.5.10:6379 (88c7571b...) -> 667098 keys | 2340 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 698128 keys | 2340 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 696741 keys | 2341 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 700991 keys | 2341 slots | 0 slaves.
[OK] 4333100 keys in 7 masters.
264.47 keys per slot on average.
 
total slots: 16384
Removing node 90d5533556bde70609b70e48c8ae0ee812fd3d8a from cluster 172.31.5.50:6379
Sending CLUSTER FORGET messages to the cluster...
Sending CLUSTER RESET SOFT to the deleted node.
[33m### REBALANCING CLUSTER ON 172.31.5.88:6379 ###
[0m
> redis-cli --cluster rebalance 172.31.5.88:6379 --cluster-use-empty-masters | grep -i Rebalancing
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 702203 keys | 2341 slots | 0 slaves.
172.31.5.86:6379 (3aac5767...) -> 671350 keys | 2340 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 196589 keys | 2341 slots | 0 slaves.
172.31.5.10:6379 (88c7571b...) -> 667098 keys | 2340 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 698128 keys | 2340 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 696741 keys | 2341 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 700991 keys | 2341 slots | 0 slaves.
[OK] 4333100 keys in 7 masters.
264.47 keys per slot on average.
 
total slots: 16384
*** No rebalancing needed! All nodes are within the 2.00% threshold.


waiting... 65 64 63 62 61 60 59 58 57 56 55 54 53 52 51 50 49 48 47 46 45 44 43 42 41 40 39 38 37 36 35 34 33 32 31 30 29 28 27 26 25 24 23 22 21 20 19 18 17 16 15 14 13 12 11 10 9 8 7 6 5 4 3 2 1 



[34m******* resize , 7 completed ******* [0m 

------------------------------------------------------------------

[34m******* write , 500000 *******[0m

[33m### WRITING 500000 KEYS ###
[0m
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 773611 keys | 2341 slots | 0 slaves.
172.31.5.86:6379 (3aac5767...) -> 742849 keys | 2340 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 268041 keys | 2341 slots | 0 slaves.
172.31.5.10:6379 (88c7571b...) -> 738468 keys | 2340 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 769548 keys | 2340 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 768236 keys | 2341 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 772347 keys | 2341 slots | 0 slaves.
[OK] 4833100 keys in 7 masters.
294.99 keys per slot on average.
 
total slots: 16384
0.5M keys written successfully

[34m******* write , 500000 completed ******* [0m 

------------------------------------------------------------------

[34m******* resize , 3 *******[0m

{ clusterSize: 7 }
[33m### REBALANCING CLUSTER ON 172.31.5.10:6379 ###
[0m
> redis-cli --cluster rebalance 172.31.5.10:6379 --cluster-use-empty-masters | grep -i Rebalancing
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 773611 keys | 2341 slots | 0 slaves.
172.31.5.86:6379 (3aac5767...) -> 742849 keys | 2340 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 268041 keys | 2341 slots | 0 slaves.
172.31.5.10:6379 (88c7571b...) -> 738468 keys | 2340 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 769548 keys | 2340 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 768236 keys | 2341 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 772347 keys | 2341 slots | 0 slaves.
[OK] 4833100 keys in 7 masters.
294.99 keys per slot on average.
 
total slots: 16384
*** No rebalancing needed! All nodes are within the 2.00% threshold.


{ distribution: [ 780, 780, 780 ] }
[33m### RESHARDING FROM 172.31.5.10 TO 172.31.5.88 ###
[0m
{ reshardFrom: '172.31.5.10', reshardTo: '172.31.5.88', slots: 780 }
> redis-cli --cluster reshard 172.31.5.10:6379 --cluster-from 88c7571ba757b3547fc6fbefc0219284839688ba --cluster-to 8b8944dfa3d8f1ff2204dc3aa335b19256357fe0 --cluster-slots 780 --cluster-yes | grep Ready
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 1024959 keys | 3121 slots | 0 slaves.
172.31.5.86:6379 (3aac5767...) -> 742849 keys | 2340 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 268041 keys | 2341 slots | 0 slaves.
172.31.5.10:6379 (88c7571b...) -> 487120 keys | 1560 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 769548 keys | 2340 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 768236 keys | 2341 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 772347 keys | 2341 slots | 0 slaves.
[OK] 4833100 keys in 7 masters.
294.99 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.10 TO 172.31.5.177 ###
[0m
{ reshardFrom: '172.31.5.10', reshardTo: '172.31.5.177', slots: 780 }
> redis-cli --cluster reshard 172.31.5.10:6379 --cluster-from 88c7571ba757b3547fc6fbefc0219284839688ba --cluster-to e5fb4afd51fdf082ef6d5eee77b9c8ff3ba46aca --cluster-slots 780 --cluster-yes | grep Ready
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 1024959 keys | 3121 slots | 0 slaves.
172.31.5.86:6379 (3aac5767...) -> 742849 keys | 2340 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 517252 keys | 3121 slots | 0 slaves.
172.31.5.10:6379 (88c7571b...) -> 237909 keys | 780 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 769548 keys | 2340 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 768236 keys | 2341 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 772347 keys | 2341 slots | 0 slaves.
[OK] 4833100 keys in 7 masters.
294.99 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.10 TO 172.31.5.45 ###
[0m
{ reshardFrom: '172.31.5.10', reshardTo: '172.31.5.45', slots: 780 }
> redis-cli --cluster reshard 172.31.5.10:6379 --cluster-from 88c7571ba757b3547fc6fbefc0219284839688ba --cluster-to 0e4742121d492415d1f0d097c9691101d6eb8194 --cluster-slots 780 --cluster-yes | grep Ready
assertion error.
 {
  keys1: 4833100,
  keys2: 4315849,
  keys: 0,
  slots1: 16384,
  slots2: 16384,
  nodes1: 7,
  nodes2: 6,
  nodes: -1
}
precheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 1024959 keys | 3121 slots | 0 slaves.
172.31.5.86:6379 (3aac5767...) -> 742849 keys | 2340 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 517252 keys | 3121 slots | 0 slaves.
172.31.5.10:6379 (88c7571b...) -> 237909 keys | 780 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 769548 keys | 2340 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 768236 keys | 2341 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 772347 keys | 2341 slots | 0 slaves.
[OK] 4833100 keys in 7 masters.
294.99 keys per slot on average.

postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 1024959 keys | 3121 slots | 0 slaves.
172.31.5.86:6379 (3aac5767...) -> 742849 keys | 2340 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 1 keys | 3121 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 769548 keys | 2340 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 1006145 keys | 3121 slots | 1 slaves.
172.31.5.239:6379 (6b7779ab...) -> 772347 keys | 2341 slots | 0 slaves.
[OK] 4315849 keys in 6 masters.
263.42 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### REMOVING 172.31.5.10:6379 FROM CLUSTER ###
[0m
> redis-cli --cluster del-node 172.31.5.10:6379 88c7571ba757b3547fc6fbefc0219284839688ba
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 1024959 keys | 3121 slots | 0 slaves.
172.31.5.86:6379 (3aac5767...) -> 742849 keys | 2340 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 1 keys | 3121 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 769548 keys | 2340 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 1006145 keys | 3121 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 772347 keys | 2341 slots | 0 slaves.
[OK] 4315849 keys in 6 masters.
263.42 keys per slot on average.
 
total slots: 16384
Removing node 88c7571ba757b3547fc6fbefc0219284839688ba from cluster 172.31.5.10:6379
Sending CLUSTER FORGET messages to the cluster...
Sending CLUSTER RESET SOFT to the deleted node.
{ distribution: [ 780, 780, 780 ] }
[33m### RESHARDING FROM 172.31.5.86 TO 172.31.5.177 ###
[0m
{ reshardFrom: '172.31.5.86', reshardTo: '172.31.5.177', slots: 780 }
> redis-cli --cluster reshard 172.31.5.86:6379 --cluster-from 3aac57677b916b89b568938c6db362da7ebc2b2a --cluster-to e5fb4afd51fdf082ef6d5eee77b9c8ff3ba46aca --cluster-slots 780 --cluster-yes | grep Ready
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 1024959 keys | 3121 slots | 0 slaves.
172.31.5.86:6379 (3aac5767...) -> 499496 keys | 1560 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 243354 keys | 3901 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 769548 keys | 2340 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 1006145 keys | 3121 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 772347 keys | 2341 slots | 0 slaves.
[OK] 4315849 keys in 6 masters.
263.42 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.86 TO 172.31.5.45 ###
[0m
{ reshardFrom: '172.31.5.86', reshardTo: '172.31.5.45', slots: 780 }
> redis-cli --cluster reshard 172.31.5.86:6379 --cluster-from 3aac57677b916b89b568938c6db362da7ebc2b2a --cluster-to 0e4742121d492415d1f0d097c9691101d6eb8194 --cluster-slots 780 --cluster-yes | grep Ready
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 1024959 keys | 3121 slots | 0 slaves.
172.31.5.86:6379 (3aac5767...) -> 237666 keys | 780 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 243354 keys | 3901 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 769548 keys | 2340 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 1267975 keys | 3901 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 772347 keys | 2341 slots | 0 slaves.
[OK] 4315849 keys in 6 masters.
263.42 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.86 TO 172.31.5.88 ###
[0m
{ reshardFrom: '172.31.5.86', reshardTo: '172.31.5.88', slots: 780 }
> redis-cli --cluster reshard 172.31.5.86:6379 --cluster-from 3aac57677b916b89b568938c6db362da7ebc2b2a --cluster-to 8b8944dfa3d8f1ff2204dc3aa335b19256357fe0 --cluster-slots 780 --cluster-yes | grep Ready
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 1262625 keys | 3901 slots | 1 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 243354 keys | 3901 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 769548 keys | 2340 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 1267975 keys | 3901 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 772347 keys | 2341 slots | 0 slaves.
[OK] 4315849 keys in 5 masters.
263.42 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### REMOVING 172.31.5.86:6379 FROM CLUSTER ###
[0m
> redis-cli --cluster del-node 172.31.5.86:6379 3aac57677b916b89b568938c6db362da7ebc2b2a
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 1262625 keys | 3901 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 243354 keys | 3901 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 769548 keys | 2340 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 1267975 keys | 3901 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 772347 keys | 2341 slots | 0 slaves.
[OK] 4315849 keys in 5 masters.
263.42 keys per slot on average.
 
total slots: 16384
Removing node 3aac57677b916b89b568938c6db362da7ebc2b2a from cluster 172.31.5.86:6379
Sending CLUSTER FORGET messages to the cluster...
Sending CLUSTER RESET SOFT to the deleted node.
{ distribution: [ 780, 780, 780 ] }
[33m### RESHARDING FROM 172.31.5.178 TO 172.31.5.45 ###
[0m
{ reshardFrom: '172.31.5.178', reshardTo: '172.31.5.45', slots: 780 }
> redis-cli --cluster reshard 172.31.5.178:6379 --cluster-from 963958096c34d9596c9452b07253481eee2f9f00 --cluster-to 0e4742121d492415d1f0d097c9691101d6eb8194 --cluster-slots 780 --cluster-yes | grep Ready
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 1262625 keys | 3901 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 243354 keys | 3901 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 507211 keys | 1560 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 1530312 keys | 4681 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 772347 keys | 2341 slots | 0 slaves.
[OK] 4315849 keys in 5 masters.
263.42 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.178 TO 172.31.5.88 ###
[0m
{ reshardFrom: '172.31.5.178', reshardTo: '172.31.5.88', slots: 780 }
> redis-cli --cluster reshard 172.31.5.178:6379 --cluster-from 963958096c34d9596c9452b07253481eee2f9f00 --cluster-to 8b8944dfa3d8f1ff2204dc3aa335b19256357fe0 --cluster-slots 780 --cluster-yes | grep Ready
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 1524148 keys | 4681 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 243354 keys | 3901 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 245688 keys | 780 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 1530312 keys | 4681 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 772347 keys | 2341 slots | 0 slaves.
[OK] 4315849 keys in 5 masters.
263.42 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.178 TO 172.31.5.177 ###
[0m
{ reshardFrom: '172.31.5.178', reshardTo: '172.31.5.177', slots: 780 }
> redis-cli --cluster reshard 172.31.5.178:6379 --cluster-from 963958096c34d9596c9452b07253481eee2f9f00 --cluster-to e5fb4afd51fdf082ef6d5eee77b9c8ff3ba46aca --cluster-slots 780 --cluster-yes | grep Ready
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 1524148 keys | 4681 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 489042 keys | 4681 slots | 1 slaves.
172.31.5.45:6379 (0e474212...) -> 1530312 keys | 4681 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 772347 keys | 2341 slots | 0 slaves.
[OK] 4315849 keys in 4 masters.
263.42 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### REMOVING 172.31.5.178:6379 FROM CLUSTER ###
[0m
> redis-cli --cluster del-node 172.31.5.178:6379 963958096c34d9596c9452b07253481eee2f9f00
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 1524148 keys | 4681 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 489042 keys | 4681 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 1530312 keys | 4681 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 772347 keys | 2341 slots | 0 slaves.
[OK] 4315849 keys in 4 masters.
263.42 keys per slot on average.
 
total slots: 16384
Removing node 963958096c34d9596c9452b07253481eee2f9f00 from cluster 172.31.5.178:6379
Sending CLUSTER FORGET messages to the cluster...
Sending CLUSTER RESET SOFT to the deleted node.
{ distribution: [ 781, 780, 780 ] }
[33m### RESHARDING FROM 172.31.5.239 TO 172.31.5.88 ###
[0m
{ reshardFrom: '172.31.5.239', reshardTo: '172.31.5.88', slots: 781 }
> redis-cli --cluster reshard 172.31.5.239:6379 --cluster-from 6b7779abdc16827d8fd3a0b04a2068ca4fe5c585 --cluster-to 8b8944dfa3d8f1ff2204dc3aa335b19256357fe0 --cluster-slots 781 --cluster-yes | grep Ready
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 1772609 keys | 5462 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 489042 keys | 4681 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 1530312 keys | 4681 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 523886 keys | 1560 slots | 0 slaves.
[OK] 4315849 keys in 4 masters.
263.42 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.239 TO 172.31.5.177 ###
[0m
{ reshardFrom: '172.31.5.239', reshardTo: '172.31.5.177', slots: 780 }
> redis-cli --cluster reshard 172.31.5.239:6379 --cluster-from 6b7779abdc16827d8fd3a0b04a2068ca4fe5c585 --cluster-to e5fb4afd51fdf082ef6d5eee77b9c8ff3ba46aca --cluster-slots 780 --cluster-yes | grep Ready
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 1772609 keys | 5462 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 751512 keys | 5461 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 1530312 keys | 4681 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 261416 keys | 780 slots | 0 slaves.
[OK] 4315849 keys in 4 masters.
263.42 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.239 TO 172.31.5.45 ###
[0m
{ reshardFrom: '172.31.5.239', reshardTo: '172.31.5.45', slots: 780 }
> redis-cli --cluster reshard 172.31.5.239:6379 --cluster-from 6b7779abdc16827d8fd3a0b04a2068ca4fe5c585 --cluster-to 0e4742121d492415d1f0d097c9691101d6eb8194 --cluster-slots 780 --cluster-yes | grep Ready
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 1772609 keys | 5462 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 751512 keys | 5461 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 1791728 keys | 5461 slots | 1 slaves.
[OK] 4315849 keys in 3 masters.
263.42 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### REMOVING 172.31.5.239:6379 FROM CLUSTER ###
[0m
> redis-cli --cluster del-node 172.31.5.239:6379 6b7779abdc16827d8fd3a0b04a2068ca4fe5c585
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 1772609 keys | 5462 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 751512 keys | 5461 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 1791728 keys | 5461 slots | 0 slaves.
[OK] 4315849 keys in 3 masters.
263.42 keys per slot on average.
 
total slots: 16384
Removing node 6b7779abdc16827d8fd3a0b04a2068ca4fe5c585 from cluster 172.31.5.239:6379
Sending CLUSTER FORGET messages to the cluster...
Sending CLUSTER RESET SOFT to the deleted node.
[33m### REBALANCING CLUSTER ON 172.31.5.88:6379 ###
[0m
> redis-cli --cluster rebalance 172.31.5.88:6379 --cluster-use-empty-masters | grep -i Rebalancing
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 1772609 keys | 5462 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 751512 keys | 5461 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 1791728 keys | 5461 slots | 0 slaves.
[OK] 4315849 keys in 3 masters.
263.42 keys per slot on average.
 
total slots: 16384
*** No rebalancing needed! All nodes are within the 2.00% threshold.


waiting... 65 64 63 62 61 60 59 58 57 56 55 54 53 52 51 50 49 48 47 46 45 44 43 42 41 40 39 38 37 36 35 34 33 32 31 30 29 28 27 26 25 24 23 22 21 20 19 18 17 16 15 14 13 12 11 10 9 8 7 6 5 4 3 2 1 



[34m******* resize , 3 completed ******* [0m 

------------------------------------------------------------------

[34m******* write , 500000 *******[0m

[33m### WRITING 500000 KEYS ###
[0m
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 1939376 keys | 5462 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 918083 keys | 5461 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 1958390 keys | 5461 slots | 0 slaves.
[OK] 4815849 keys in 3 masters.
293.94 keys per slot on average.
 
total slots: 16384
0.5M keys written successfully

[34m******* write , 500000 completed ******* [0m 

------------------------------------------------------------------

[34m******* resize , 7 *******[0m

{ clusterSize: 3 }
[33m### ADDING 172.31.5.239:6379 NODE TO CLUSTER ###
[0m
> redis-cli --cluster add-node 172.31.5.239:6379 172.31.5.88:6379 | awk '{ gsub(/[[0-9;]*m/, ""); print }'
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 1939376 keys | 5462 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 918083 keys | 5461 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 1958390 keys | 5461 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 0 keys | 0 slots | 0 slaves.
[OK] 4815849 keys in 4 masters.
293.94 keys per slot on average.
 
total slots: 16384
node added successfully
waiting... 2 1 


[33m### ADDING 172.31.5.178:6379 NODE TO CLUSTER ###
[0m
> redis-cli --cluster add-node 172.31.5.178:6379 172.31.5.88:6379 | awk '{ gsub(/[[0-9;]*m/, ""); print }'
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 1939376 keys | 5462 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 918083 keys | 5461 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 1958390 keys | 5461 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 0 keys | 0 slots | 0 slaves.
[OK] 4815849 keys in 5 masters.
293.94 keys per slot on average.
 
total slots: 16384
node added successfully
waiting... 2 1 


[33m### ADDING 172.31.5.86:6379 NODE TO CLUSTER ###
[0m
> redis-cli --cluster add-node 172.31.5.86:6379 172.31.5.88:6379 | awk '{ gsub(/[[0-9;]*m/, ""); print }'
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 1939376 keys | 5462 slots | 0 slaves.
172.31.5.86:6379 (3aac5767...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 918083 keys | 5461 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 1958390 keys | 5461 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 0 keys | 0 slots | 0 slaves.
[OK] 4815849 keys in 6 masters.
293.94 keys per slot on average.
 
total slots: 16384
node added successfully
waiting... 2 1 


[33m### ADDING 172.31.5.10:6379 NODE TO CLUSTER ###
[0m
> redis-cli --cluster add-node 172.31.5.10:6379 172.31.5.88:6379 | awk '{ gsub(/[[0-9;]*m/, ""); print }'
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 1939376 keys | 5462 slots | 0 slaves.
172.31.5.86:6379 (3aac5767...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 918083 keys | 5461 slots | 0 slaves.
172.31.5.10:6379 (88c7571b...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 1958390 keys | 5461 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 0 keys | 0 slots | 0 slaves.
[OK] 4815849 keys in 7 masters.
293.94 keys per slot on average.
 
total slots: 16384
node added successfully
waiting... 2 1 


waiting... 10 9 8 7 6 5 4 3 2 1 


[33m### REBALANCING CLUSTER ON 172.31.5.239:6379 ###
[0m
> redis-cli --cluster rebalance 172.31.5.239:6379 --cluster-use-empty-masters | grep -i Rebalancing
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 828701 keys | 2340 slots | 0 slaves.
172.31.5.86:6379 (3aac5767...) -> 836370 keys | 2341 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 152643 keys | 2340 slots | 0 slaves.
172.31.5.10:6379 (88c7571b...) -> 770748 keys | 2341 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 538649 keys | 2341 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 856613 keys | 2340 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 832125 keys | 2341 slots | 0 slaves.
[OK] 4815849 keys in 7 masters.
293.94 keys per slot on average.
 
total slots: 16384
>>> Rebalancing across 7 nodes. Total weight = 7.00



[34m******* resize , 7 completed ******* [0m 

------------------------------------------------------------------

[34m******* write , 500000 *******[0m

[33m### WRITING 500000 KEYS ###
[0m
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 900143 keys | 2340 slots | 0 slaves.
172.31.5.86:6379 (3aac5767...) -> 907737 keys | 2341 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 224025 keys | 2340 slots | 0 slaves.
172.31.5.10:6379 (88c7571b...) -> 842554 keys | 2341 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 610017 keys | 2341 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 927952 keys | 2340 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 903421 keys | 2341 slots | 0 slaves.
[OK] 5315849 keys in 7 masters.
324.45 keys per slot on average.
 
total slots: 16384
0.5M keys written successfully

[34m******* write , 500000 completed ******* [0m 

------------------------------------------------------------------

[34m******* resize , 4 *******[0m

{ clusterSize: 7 }
[33m### REBALANCING CLUSTER ON 172.31.5.10:6379 ###
[0m
> redis-cli --cluster rebalance 172.31.5.10:6379 --cluster-use-empty-masters | grep -i Rebalancing
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 900143 keys | 2340 slots | 0 slaves.
172.31.5.86:6379 (3aac5767...) -> 907737 keys | 2341 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 224025 keys | 2340 slots | 0 slaves.
172.31.5.10:6379 (88c7571b...) -> 842554 keys | 2341 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 610017 keys | 2341 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 927952 keys | 2340 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 903421 keys | 2341 slots | 0 slaves.
[OK] 5315849 keys in 7 masters.
324.45 keys per slot on average.
 
total slots: 16384
*** No rebalancing needed! All nodes are within the 2.00% threshold.


{ distribution: [ 586, 585, 585, 585 ] }
[33m### RESHARDING FROM 172.31.5.10 TO 172.31.5.88 ###
[0m
{ reshardFrom: '172.31.5.10', reshardTo: '172.31.5.88', slots: 586 }
> redis-cli --cluster reshard 172.31.5.10:6379 --cluster-from 88c7571ba757b3547fc6fbefc0219284839688ba --cluster-to 8b8944dfa3d8f1ff2204dc3aa335b19256357fe0 --cluster-slots 586 --cluster-yes | grep Ready
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 1044531 keys | 2926 slots | 0 slaves.
172.31.5.86:6379 (3aac5767...) -> 907737 keys | 2341 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 224025 keys | 2340 slots | 0 slaves.
172.31.5.10:6379 (88c7571b...) -> 698166 keys | 1755 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 610017 keys | 2341 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 927952 keys | 2340 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 903421 keys | 2341 slots | 0 slaves.
[OK] 5315849 keys in 7 masters.
324.45 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.10 TO 172.31.5.177 ###
[0m
{ reshardFrom: '172.31.5.10', reshardTo: '172.31.5.177', slots: 585 }
> redis-cli --cluster reshard 172.31.5.10:6379 --cluster-from 88c7571ba757b3547fc6fbefc0219284839688ba --cluster-to e5fb4afd51fdf082ef6d5eee77b9c8ff3ba46aca --cluster-slots 585 --cluster-yes | grep Ready
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 1044531 keys | 2926 slots | 0 slaves.
172.31.5.86:6379 (3aac5767...) -> 907737 keys | 2341 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 456729 keys | 2925 slots | 0 slaves.
172.31.5.10:6379 (88c7571b...) -> 465462 keys | 1170 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 610017 keys | 2341 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 927952 keys | 2340 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 903421 keys | 2341 slots | 0 slaves.
[OK] 5315849 keys in 7 masters.
324.45 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.10 TO 172.31.5.45 ###
[0m
{ reshardFrom: '172.31.5.10', reshardTo: '172.31.5.45', slots: 585 }
> redis-cli --cluster reshard 172.31.5.10:6379 --cluster-from 88c7571ba757b3547fc6fbefc0219284839688ba --cluster-to 0e4742121d492415d1f0d097c9691101d6eb8194 --cluster-slots 585 --cluster-yes | grep Ready
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 1044531 keys | 2926 slots | 0 slaves.
172.31.5.86:6379 (3aac5767...) -> 907737 keys | 2341 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 456729 keys | 2925 slots | 0 slaves.
172.31.5.10:6379 (88c7571b...) -> 232839 keys | 585 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 610017 keys | 2341 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 1160575 keys | 2925 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 903421 keys | 2341 slots | 0 slaves.
[OK] 5315849 keys in 7 masters.
324.45 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.10 TO 172.31.5.239 ###
[0m
{ reshardFrom: '172.31.5.10', reshardTo: '172.31.5.239', slots: 585 }
> redis-cli --cluster reshard 172.31.5.10:6379 --cluster-from 88c7571ba757b3547fc6fbefc0219284839688ba --cluster-to 6b7779abdc16827d8fd3a0b04a2068ca4fe5c585 --cluster-slots 585 --cluster-yes | grep Ready
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 1044531 keys | 2926 slots | 0 slaves.
172.31.5.86:6379 (3aac5767...) -> 907737 keys | 2341 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 456729 keys | 2925 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 610017 keys | 2341 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 1160575 keys | 2925 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 1136260 keys | 2926 slots | 1 slaves.
[OK] 5315849 keys in 6 masters.
324.45 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### REMOVING 172.31.5.10:6379 FROM CLUSTER ###
[0m
> redis-cli --cluster del-node 172.31.5.10:6379 88c7571ba757b3547fc6fbefc0219284839688ba
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 1044531 keys | 2926 slots | 0 slaves.
172.31.5.86:6379 (3aac5767...) -> 907737 keys | 2341 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 456729 keys | 2925 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 610017 keys | 2341 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 1160575 keys | 2925 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 1136260 keys | 2926 slots | 0 slaves.
[OK] 5315849 keys in 6 masters.
324.45 keys per slot on average.
 
total slots: 16384
Removing node 88c7571ba757b3547fc6fbefc0219284839688ba from cluster 172.31.5.10:6379
Sending CLUSTER FORGET messages to the cluster...
Sending CLUSTER RESET SOFT to the deleted node.
{ distribution: [ 586, 585, 585, 585 ] }
[33m### RESHARDING FROM 172.31.5.86 TO 172.31.5.177 ###
[0m
{ reshardFrom: '172.31.5.86', reshardTo: '172.31.5.177', slots: 586 }
> redis-cli --cluster reshard 172.31.5.86:6379 --cluster-from 3aac57677b916b89b568938c6db362da7ebc2b2a --cluster-to e5fb4afd51fdf082ef6d5eee77b9c8ff3ba46aca --cluster-slots 586 --cluster-yes | grep Ready
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 1044531 keys | 2926 slots | 0 slaves.
172.31.5.86:6379 (3aac5767...) -> 675918 keys | 1755 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 688548 keys | 3511 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 610017 keys | 2341 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 1160575 keys | 2925 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 1136260 keys | 2926 slots | 0 slaves.
[OK] 5315849 keys in 6 masters.
324.45 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.86 TO 172.31.5.45 ###
[0m
{ reshardFrom: '172.31.5.86', reshardTo: '172.31.5.45', slots: 585 }
> redis-cli --cluster reshard 172.31.5.86:6379 --cluster-from 3aac57677b916b89b568938c6db362da7ebc2b2a --cluster-to 0e4742121d492415d1f0d097c9691101d6eb8194 --cluster-slots 585 --cluster-yes | grep Ready
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 1044531 keys | 2926 slots | 0 slaves.
172.31.5.86:6379 (3aac5767...) -> 443980 keys | 1170 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 688548 keys | 3511 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 610017 keys | 2341 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 1392513 keys | 3510 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 1136260 keys | 2926 slots | 0 slaves.
[OK] 5315849 keys in 6 masters.
324.45 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.86 TO 172.31.5.239 ###
[0m
{ reshardFrom: '172.31.5.86', reshardTo: '172.31.5.239', slots: 585 }
> redis-cli --cluster reshard 172.31.5.86:6379 --cluster-from 3aac57677b916b89b568938c6db362da7ebc2b2a --cluster-to 6b7779abdc16827d8fd3a0b04a2068ca4fe5c585 --cluster-slots 585 --cluster-yes | grep Ready
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 1044531 keys | 2926 slots | 0 slaves.
172.31.5.86:6379 (3aac5767...) -> 211130 keys | 585 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 688548 keys | 3511 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 610017 keys | 2341 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 1392513 keys | 3510 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 1369110 keys | 3511 slots | 0 slaves.
[OK] 5315849 keys in 6 masters.
324.45 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.86 TO 172.31.5.88 ###
[0m
{ reshardFrom: '172.31.5.86', reshardTo: '172.31.5.88', slots: 585 }
> redis-cli --cluster reshard 172.31.5.86:6379 --cluster-from 3aac57677b916b89b568938c6db362da7ebc2b2a --cluster-to 8b8944dfa3d8f1ff2204dc3aa335b19256357fe0 --cluster-slots 585 --cluster-yes | grep Ready
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 1255661 keys | 3511 slots | 1 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 688548 keys | 3511 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 610017 keys | 2341 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 1392513 keys | 3510 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 1369110 keys | 3511 slots | 0 slaves.
[OK] 5315849 keys in 5 masters.
324.45 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### REMOVING 172.31.5.86:6379 FROM CLUSTER ###
[0m
> redis-cli --cluster del-node 172.31.5.86:6379 3aac57677b916b89b568938c6db362da7ebc2b2a
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 1255661 keys | 3511 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 688548 keys | 3511 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 610017 keys | 2341 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 1392513 keys | 3510 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 1369110 keys | 3511 slots | 0 slaves.
[OK] 5315849 keys in 5 masters.
324.45 keys per slot on average.
 
total slots: 16384
Removing node 3aac57677b916b89b568938c6db362da7ebc2b2a from cluster 172.31.5.86:6379
Sending CLUSTER FORGET messages to the cluster...
Sending CLUSTER RESET SOFT to the deleted node.
{ distribution: [ 586, 585, 585, 585 ] }
[33m### RESHARDING FROM 172.31.5.178 TO 172.31.5.45 ###
[0m
{ reshardFrom: '172.31.5.178', reshardTo: '172.31.5.45', slots: 586 }
> redis-cli --cluster reshard 172.31.5.178:6379 --cluster-from 963958096c34d9596c9452b07253481eee2f9f00 --cluster-to 0e4742121d492415d1f0d097c9691101d6eb8194 --cluster-slots 586 --cluster-yes | grep Ready
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 1255661 keys | 3511 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 688548 keys | 3511 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 574189 keys | 1755 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 1428341 keys | 4096 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 1369110 keys | 3511 slots | 0 slaves.
[OK] 5315849 keys in 5 masters.
324.45 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.178 TO 172.31.5.239 ###
[0m
{ reshardFrom: '172.31.5.178', reshardTo: '172.31.5.239', slots: 585 }
> redis-cli --cluster reshard 172.31.5.178:6379 --cluster-from 963958096c34d9596c9452b07253481eee2f9f00 --cluster-to 6b7779abdc16827d8fd3a0b04a2068ca4fe5c585 --cluster-slots 585 --cluster-yes | grep Ready
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 1255661 keys | 3511 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 688548 keys | 3511 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 383081 keys | 1170 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 1428341 keys | 4096 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 1560218 keys | 4096 slots | 0 slaves.
[OK] 5315849 keys in 5 masters.
324.45 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.178 TO 172.31.5.88 ###
[0m
{ reshardFrom: '172.31.5.178', reshardTo: '172.31.5.88', slots: 585 }
> redis-cli --cluster reshard 172.31.5.178:6379 --cluster-from 963958096c34d9596c9452b07253481eee2f9f00 --cluster-to 8b8944dfa3d8f1ff2204dc3aa335b19256357fe0 --cluster-slots 585 --cluster-yes | grep Ready
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 1413866 keys | 4096 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 688548 keys | 3511 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 224876 keys | 585 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 1428341 keys | 4096 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 1560218 keys | 4096 slots | 0 slaves.
[OK] 5315849 keys in 5 masters.
324.45 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.178 TO 172.31.5.177 ###
[0m
{ reshardFrom: '172.31.5.178', reshardTo: '172.31.5.177', slots: 585 }
> redis-cli --cluster reshard 172.31.5.178:6379 --cluster-from 963958096c34d9596c9452b07253481eee2f9f00 --cluster-to e5fb4afd51fdf082ef6d5eee77b9c8ff3ba46aca --cluster-slots 585 --cluster-yes | grep Ready
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 1413866 keys | 4096 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 913424 keys | 4096 slots | 1 slaves.
172.31.5.45:6379 (0e474212...) -> 1428341 keys | 4096 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 1560218 keys | 4096 slots | 0 slaves.
[OK] 5315849 keys in 4 masters.
324.45 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### REMOVING 172.31.5.178:6379 FROM CLUSTER ###
[0m
> redis-cli --cluster del-node 172.31.5.178:6379 963958096c34d9596c9452b07253481eee2f9f00
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 1413866 keys | 4096 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 913424 keys | 4096 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 1428341 keys | 4096 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 1560218 keys | 4096 slots | 0 slaves.
[OK] 5315849 keys in 4 masters.
324.45 keys per slot on average.
 
total slots: 16384
Removing node 963958096c34d9596c9452b07253481eee2f9f00 from cluster 172.31.5.178:6379
Sending CLUSTER FORGET messages to the cluster...
Sending CLUSTER RESET SOFT to the deleted node.
[33m### REBALANCING CLUSTER ON 172.31.5.88:6379 ###
[0m
> redis-cli --cluster rebalance 172.31.5.88:6379 --cluster-use-empty-masters | grep -i Rebalancing
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 1413866 keys | 4096 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 913424 keys | 4096 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 1428341 keys | 4096 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 1560218 keys | 4096 slots | 0 slaves.
[OK] 5315849 keys in 4 masters.
324.45 keys per slot on average.
 
total slots: 16384
*** No rebalancing needed! All nodes are within the 2.00% threshold.


waiting... 65 64 63 62 61 60 59 58 57 56 55 54 53 52 51 50 49 48 47 46 45 44 43 42 41 40 39 38 37 36 35 34 33 32 31 30 29 28 27 26 25 24 23 22 21 20 19 18 17 16 15 14 13 12 11 10 9 8 7 6 5 4 3 2 1 



[34m******* resize , 4 completed ******* [0m 

------------------------------------------------------------------

[34m******* write , 500000 *******[0m

[33m### WRITING 500000 KEYS ###
[0m
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 1538942 keys | 4096 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 1038441 keys | 4096 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 1553433 keys | 4096 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 1685033 keys | 4096 slots | 0 slaves.
[OK] 5815849 keys in 4 masters.
354.97 keys per slot on average.
 
total slots: 16384
0.5M keys written successfully

[34m******* write , 500000 completed ******* [0m 

------------------------------------------------------------------

[34m******* resize , 7 *******[0m

{ clusterSize: 4 }
[33m### ADDING 172.31.5.178:6379 NODE TO CLUSTER ###
[0m
> redis-cli --cluster add-node 172.31.5.178:6379 172.31.5.88:6379 | awk '{ gsub(/[[0-9;]*m/, ""); print }'
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 1538942 keys | 4096 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 1038441 keys | 4096 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 1553433 keys | 4096 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 1685033 keys | 4096 slots | 0 slaves.
[OK] 5815849 keys in 5 masters.
354.97 keys per slot on average.
 
total slots: 16384
node added successfully
waiting... 2 1 


[33m### ADDING 172.31.5.86:6379 NODE TO CLUSTER ###
[0m
> redis-cli --cluster add-node 172.31.5.86:6379 172.31.5.88:6379 | awk '{ gsub(/[[0-9;]*m/, ""); print }'
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 1538942 keys | 4096 slots | 0 slaves.
172.31.5.86:6379 (3aac5767...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 1038441 keys | 4096 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 1553433 keys | 4096 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 1685033 keys | 4096 slots | 0 slaves.
[OK] 5815849 keys in 6 masters.
354.97 keys per slot on average.
 
total slots: 16384
node added successfully
waiting... 2 1 


[33m### ADDING 172.31.5.10:6379 NODE TO CLUSTER ###
[0m
> redis-cli --cluster add-node 172.31.5.10:6379 172.31.5.88:6379 | awk '{ gsub(/[[0-9;]*m/, ""); print }'
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 1538942 keys | 4096 slots | 0 slaves.
172.31.5.86:6379 (3aac5767...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 1038441 keys | 4096 slots | 0 slaves.
172.31.5.10:6379 (88c7571b...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 1553433 keys | 4096 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 1685033 keys | 4096 slots | 0 slaves.
[OK] 5815849 keys in 7 masters.
354.97 keys per slot on average.
 
total slots: 16384
node added successfully
waiting... 2 1 


waiting... 10 9 8 7 6 5 4 3 2 1 


[33m### REBALANCING CLUSTER ON 172.31.5.178:6379 ###
[0m
> redis-cli --cluster rebalance 172.31.5.178:6379 --cluster-use-empty-masters | grep -i Rebalancing
assertion error.
 {
  keys1: 5815849,
  keys2: 5018203,
  keys: 0,
  slots1: 16384,
  slots2: 16384,
  nodes1: 7,
  nodes2: 7,
  nodes: 0
}
precheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 1538942 keys | 4096 slots | 0 slaves.
172.31.5.86:6379 (3aac5767...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 1038441 keys | 4096 slots | 0 slaves.
172.31.5.10:6379 (88c7571b...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 1553433 keys | 4096 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 1685033 keys | 4096 slots | 0 slaves.
[OK] 5815849 keys in 7 masters.
354.97 keys per slot on average.

postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 974249 keys | 2340 slots | 0 slaves.
172.31.5.86:6379 (3aac5767...) -> 1 keys | 2341 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 294259 keys | 2340 slots | 0 slaves.
172.31.5.10:6379 (88c7571b...) -> 940633 keys | 2341 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 815775 keys | 2342 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 999427 keys | 2340 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 993859 keys | 2340 slots | 0 slaves.
[OK] 5018203 keys in 7 masters.
306.29 keys per slot on average.
 
total slots: 16384
>>> Rebalancing across 7 nodes. Total weight = 7.00



[34m******* resize , 7 completed ******* [0m 

------------------------------------------------------------------

[34m******* write , 500000 *******[0m

[33m### WRITING 500000 KEYS ###
[0m
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 1045596 keys | 2340 slots | 0 slaves.
172.31.5.86:6379 (3aac5767...) -> 71391 keys | 2341 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 365580 keys | 2340 slots | 0 slaves.
172.31.5.10:6379 (88c7571b...) -> 1011892 keys | 2341 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 887442 keys | 2342 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 1070811 keys | 2340 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 1065491 keys | 2340 slots | 0 slaves.
[OK] 5518203 keys in 7 masters.
336.80 keys per slot on average.
 
total slots: 16384
0.5M keys written successfully

[34m******* write , 500000 completed ******* [0m 

------------------------------------------------------------------

[34m******* resize , 5 *******[0m

{ clusterSize: 7 }
[33m### REBALANCING CLUSTER ON 172.31.5.10:6379 ###
[0m
> redis-cli --cluster rebalance 172.31.5.10:6379 --cluster-use-empty-masters | grep -i Rebalancing
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 1045596 keys | 2340 slots | 0 slaves.
172.31.5.86:6379 (3aac5767...) -> 71391 keys | 2341 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 365580 keys | 2340 slots | 0 slaves.
172.31.5.10:6379 (88c7571b...) -> 1011892 keys | 2341 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 887442 keys | 2342 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 1070811 keys | 2340 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 1065491 keys | 2340 slots | 0 slaves.
[OK] 5518203 keys in 7 masters.
336.80 keys per slot on average.
 
total slots: 16384
*** No rebalancing needed! All nodes are within the 2.00% threshold.


{ distribution: [ 469, 468, 468, 468, 468 ] }
[33m### RESHARDING FROM 172.31.5.10 TO 172.31.5.88 ###
[0m
{ reshardFrom: '172.31.5.10', reshardTo: '172.31.5.88', slots: 469 }
> redis-cli --cluster reshard 172.31.5.10:6379 --cluster-from 88c7571ba757b3547fc6fbefc0219284839688ba --cluster-to 8b8944dfa3d8f1ff2204dc3aa335b19256357fe0 --cluster-slots 469 --cluster-yes | grep Ready
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 1248938 keys | 2809 slots | 0 slaves.
172.31.5.86:6379 (3aac5767...) -> 71391 keys | 2341 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 365580 keys | 2340 slots | 0 slaves.
172.31.5.10:6379 (88c7571b...) -> 808550 keys | 1872 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 887442 keys | 2342 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 1070811 keys | 2340 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 1065491 keys | 2340 slots | 0 slaves.
[OK] 5518203 keys in 7 masters.
336.80 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.10 TO 172.31.5.177 ###
[0m
{ reshardFrom: '172.31.5.10', reshardTo: '172.31.5.177', slots: 468 }
> redis-cli --cluster reshard 172.31.5.10:6379 --cluster-from 88c7571ba757b3547fc6fbefc0219284839688ba --cluster-to e5fb4afd51fdf082ef6d5eee77b9c8ff3ba46aca --cluster-slots 468 --cluster-yes | grep Ready
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 1248938 keys | 2809 slots | 0 slaves.
172.31.5.86:6379 (3aac5767...) -> 71391 keys | 2341 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 580358 keys | 2808 slots | 0 slaves.
172.31.5.10:6379 (88c7571b...) -> 593772 keys | 1404 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 887442 keys | 2342 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 1070811 keys | 2340 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 1065491 keys | 2340 slots | 0 slaves.
[OK] 5518203 keys in 7 masters.
336.80 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.10 TO 172.31.5.45 ###
[0m
{ reshardFrom: '172.31.5.10', reshardTo: '172.31.5.45', slots: 468 }
> redis-cli --cluster reshard 172.31.5.10:6379 --cluster-from 88c7571ba757b3547fc6fbefc0219284839688ba --cluster-to 0e4742121d492415d1f0d097c9691101d6eb8194 --cluster-slots 468 --cluster-yes | grep Ready
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 1248938 keys | 2809 slots | 0 slaves.
172.31.5.86:6379 (3aac5767...) -> 71391 keys | 2341 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 580358 keys | 2808 slots | 0 slaves.
172.31.5.10:6379 (88c7571b...) -> 403952 keys | 936 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 887442 keys | 2342 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 1260631 keys | 2808 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 1065491 keys | 2340 slots | 0 slaves.
[OK] 5518203 keys in 7 masters.
336.80 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.10 TO 172.31.5.239 ###
[0m
{ reshardFrom: '172.31.5.10', reshardTo: '172.31.5.239', slots: 468 }
> redis-cli --cluster reshard 172.31.5.10:6379 --cluster-from 88c7571ba757b3547fc6fbefc0219284839688ba --cluster-to 6b7779abdc16827d8fd3a0b04a2068ca4fe5c585 --cluster-slots 468 --cluster-yes | grep Ready
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 1248938 keys | 2809 slots | 0 slaves.
172.31.5.86:6379 (3aac5767...) -> 71391 keys | 2341 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 580358 keys | 2808 slots | 0 slaves.
172.31.5.10:6379 (88c7571b...) -> 213820 keys | 468 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 887442 keys | 2342 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 1260631 keys | 2808 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 1255623 keys | 2808 slots | 0 slaves.
[OK] 5518203 keys in 7 masters.
336.80 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.10 TO 172.31.5.178 ###
[0m
{ reshardFrom: '172.31.5.10', reshardTo: '172.31.5.178', slots: 468 }
> redis-cli --cluster reshard 172.31.5.10:6379 --cluster-from 88c7571ba757b3547fc6fbefc0219284839688ba --cluster-to 963958096c34d9596c9452b07253481eee2f9f00 --cluster-slots 468 --cluster-yes | grep Ready
assertion error.
 {
  keys1: 5518203,
  keys2: 5314674,
  keys: 0,
  slots1: 16384,
  slots2: 16384,
  nodes1: 7,
  nodes2: 6,
  nodes: -1
}
precheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 1248938 keys | 2809 slots | 0 slaves.
172.31.5.86:6379 (3aac5767...) -> 71391 keys | 2341 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 580358 keys | 2808 slots | 0 slaves.
172.31.5.10:6379 (88c7571b...) -> 213820 keys | 468 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 887442 keys | 2342 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 1260631 keys | 2808 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 1255623 keys | 2808 slots | 0 slaves.
[OK] 5518203 keys in 7 masters.
336.80 keys per slot on average.

postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 1248938 keys | 2809 slots | 0 slaves.
172.31.5.86:6379 (3aac5767...) -> 71391 keys | 2341 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 580358 keys | 2808 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 897733 keys | 2810 slots | 1 slaves.
172.31.5.45:6379 (0e474212...) -> 1260631 keys | 2808 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 1255623 keys | 2808 slots | 0 slaves.
[OK] 5314674 keys in 6 masters.
324.38 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### REMOVING 172.31.5.10:6379 FROM CLUSTER ###
[0m
> redis-cli --cluster del-node 172.31.5.10:6379 88c7571ba757b3547fc6fbefc0219284839688ba
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 1248938 keys | 2809 slots | 0 slaves.
172.31.5.86:6379 (3aac5767...) -> 71391 keys | 2341 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 580358 keys | 2808 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 897733 keys | 2810 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 1260631 keys | 2808 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 1255623 keys | 2808 slots | 0 slaves.
[OK] 5314674 keys in 6 masters.
324.38 keys per slot on average.
 
total slots: 16384
Removing node 88c7571ba757b3547fc6fbefc0219284839688ba from cluster 172.31.5.10:6379
Sending CLUSTER FORGET messages to the cluster...
Sending CLUSTER RESET SOFT to the deleted node.
{ distribution: [ 469, 468, 468, 468, 468 ] }
[33m### RESHARDING FROM 172.31.5.86 TO 172.31.5.177 ###
[0m
{ reshardFrom: '172.31.5.86', reshardTo: '172.31.5.177', slots: 469 }
> redis-cli --cluster reshard 172.31.5.86:6379 --cluster-from 3aac57677b916b89b568938c6db362da7ebc2b2a --cluster-to e5fb4afd51fdf082ef6d5eee77b9c8ff3ba46aca --cluster-slots 469 --cluster-yes | grep Ready
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 1248938 keys | 2809 slots | 0 slaves.
172.31.5.86:6379 (3aac5767...) -> 57139 keys | 1872 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 594610 keys | 3277 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 897733 keys | 2810 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 1260631 keys | 2808 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 1255623 keys | 2808 slots | 0 slaves.
[OK] 5314674 keys in 6 masters.
324.38 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.86 TO 172.31.5.45 ###
[0m
{ reshardFrom: '172.31.5.86', reshardTo: '172.31.5.45', slots: 468 }
> redis-cli --cluster reshard 172.31.5.86:6379 --cluster-from 3aac57677b916b89b568938c6db362da7ebc2b2a --cluster-to 0e4742121d492415d1f0d097c9691101d6eb8194 --cluster-slots 468 --cluster-yes | grep Ready
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 1248938 keys | 2809 slots | 0 slaves.
172.31.5.86:6379 (3aac5767...) -> 42913 keys | 1404 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 594610 keys | 3277 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 897733 keys | 2810 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 1274857 keys | 3276 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 1255623 keys | 2808 slots | 0 slaves.
[OK] 5314674 keys in 6 masters.
324.38 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.86 TO 172.31.5.239 ###
[0m
{ reshardFrom: '172.31.5.86', reshardTo: '172.31.5.239', slots: 468 }
> redis-cli --cluster reshard 172.31.5.86:6379 --cluster-from 3aac57677b916b89b568938c6db362da7ebc2b2a --cluster-to 6b7779abdc16827d8fd3a0b04a2068ca4fe5c585 --cluster-slots 468 --cluster-yes | grep Ready
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 1248938 keys | 2809 slots | 0 slaves.
172.31.5.86:6379 (3aac5767...) -> 28591 keys | 936 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 594610 keys | 3277 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 897733 keys | 2810 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 1274857 keys | 3276 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 1269945 keys | 3276 slots | 0 slaves.
[OK] 5314674 keys in 6 masters.
324.38 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.86 TO 172.31.5.178 ###
[0m
{ reshardFrom: '172.31.5.86', reshardTo: '172.31.5.178', slots: 468 }
> redis-cli --cluster reshard 172.31.5.86:6379 --cluster-from 3aac57677b916b89b568938c6db362da7ebc2b2a --cluster-to 963958096c34d9596c9452b07253481eee2f9f00 --cluster-slots 468 --cluster-yes | grep Ready
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 1248938 keys | 2809 slots | 0 slaves.
172.31.5.86:6379 (3aac5767...) -> 14247 keys | 468 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 594610 keys | 3277 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 912077 keys | 3278 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 1274857 keys | 3276 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 1269945 keys | 3276 slots | 0 slaves.
[OK] 5314674 keys in 6 masters.
324.38 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.86 TO 172.31.5.88 ###
[0m
{ reshardFrom: '172.31.5.86', reshardTo: '172.31.5.88', slots: 468 }
> redis-cli --cluster reshard 172.31.5.86:6379 --cluster-from 3aac57677b916b89b568938c6db362da7ebc2b2a --cluster-to 8b8944dfa3d8f1ff2204dc3aa335b19256357fe0 --cluster-slots 468 --cluster-yes | grep Ready
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 1263185 keys | 3277 slots | 1 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 594610 keys | 3277 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 912077 keys | 3278 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 1274857 keys | 3276 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 1269945 keys | 3276 slots | 0 slaves.
[OK] 5314674 keys in 5 masters.
324.38 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### REMOVING 172.31.5.86:6379 FROM CLUSTER ###
[0m
> redis-cli --cluster del-node 172.31.5.86:6379 3aac57677b916b89b568938c6db362da7ebc2b2a
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 1263185 keys | 3277 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 594610 keys | 3277 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 912077 keys | 3278 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 1274857 keys | 3276 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 1269945 keys | 3276 slots | 0 slaves.
[OK] 5314674 keys in 5 masters.
324.38 keys per slot on average.
 
total slots: 16384
Removing node 3aac57677b916b89b568938c6db362da7ebc2b2a from cluster 172.31.5.86:6379
Sending CLUSTER FORGET messages to the cluster...
Sending CLUSTER RESET SOFT to the deleted node.
[33m### REBALANCING CLUSTER ON 172.31.5.88:6379 ###
[0m
> redis-cli --cluster rebalance 172.31.5.88:6379 --cluster-use-empty-masters | grep -i Rebalancing
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 1263185 keys | 3277 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 594610 keys | 3277 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 912077 keys | 3278 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 1274857 keys | 3276 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 1269945 keys | 3276 slots | 0 slaves.
[OK] 5314674 keys in 5 masters.
324.38 keys per slot on average.
 
total slots: 16384
*** No rebalancing needed! All nodes are within the 2.00% threshold.


waiting... 65 64 63 62 61 60 59 58 57 56 55 54 53 52 51 50 49 48 47 46 45 44 43 42 41 40 39 38 37 36 35 34 33 32 31 30 29 28 27 26 25 24 23 22 21 20 19 18 17 16 15 14 13 12 11 10 9 8 7 6 5 4 3 2 1 



[34m******* resize , 5 completed ******* [0m 

------------------------------------------------------------------

[34m******* write , 500000 *******[0m

[33m### WRITING 500000 KEYS ###
[0m
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 1363252 keys | 3277 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 694616 keys | 3277 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 1012079 keys | 3278 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 1374854 keys | 3276 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 1369873 keys | 3276 slots | 0 slaves.
[OK] 5814674 keys in 5 masters.
354.90 keys per slot on average.
 
total slots: 16384
0.5M keys written successfully

[34m******* write , 500000 completed ******* [0m 

------------------------------------------------------------------

[34m******* resize , 7 *******[0m

{ clusterSize: 5 }
[33m### ADDING 172.31.5.86:6379 NODE TO CLUSTER ###
[0m
> redis-cli --cluster add-node 172.31.5.86:6379 172.31.5.88:6379 | awk '{ gsub(/[[0-9;]*m/, ""); print }'
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 1363252 keys | 3277 slots | 0 slaves.
172.31.5.86:6379 (3aac5767...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 694616 keys | 3277 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 1012079 keys | 3278 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 1374854 keys | 3276 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 1369873 keys | 3276 slots | 0 slaves.
[OK] 5814674 keys in 6 masters.
354.90 keys per slot on average.
 
total slots: 16384
node added successfully
waiting... 2 1 


[33m### ADDING 172.31.5.10:6379 NODE TO CLUSTER ###
[0m
> redis-cli --cluster add-node 172.31.5.10:6379 172.31.5.88:6379 | awk '{ gsub(/[[0-9;]*m/, ""); print }'
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 1363252 keys | 3277 slots | 0 slaves.
172.31.5.86:6379 (3aac5767...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 694616 keys | 3277 slots | 0 slaves.
172.31.5.10:6379 (88c7571b...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 1012079 keys | 3278 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 1374854 keys | 3276 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 1369873 keys | 3276 slots | 0 slaves.
[OK] 5814674 keys in 7 masters.
354.90 keys per slot on average.
 
total slots: 16384
node added successfully
waiting... 2 1 


waiting... 10 9 8 7 6 5 4 3 2 1 


[33m### REBALANCING CLUSTER ON 172.31.5.86:6379 ###
[0m
> redis-cli --cluster rebalance 172.31.5.86:6379 --cluster-use-empty-masters | grep -i Rebalancing
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 1117017 keys | 2340 slots | 0 slaves.
172.31.5.86:6379 (3aac5767...) -> 772228 keys | 2342 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 436999 keys | 2340 slots | 0 slaves.
172.31.5.10:6379 (88c7571b...) -> 566980 keys | 2342 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 714216 keys | 2340 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 1142242 keys | 2340 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 1064992 keys | 2340 slots | 0 slaves.
[OK] 5814674 keys in 7 masters.
354.90 keys per slot on average.
 
total slots: 16384
>>> Rebalancing across 7 nodes. Total weight = 7.00



[34m******* resize , 7 completed ******* [0m 

------------------------------------------------------------------

[34m******* write , 500000 *******[0m

[33m### WRITING 500000 KEYS ###
[0m
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 1188409 keys | 2340 slots | 0 slaves.
172.31.5.86:6379 (3aac5767...) -> 843650 keys | 2342 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 508359 keys | 2340 slots | 0 slaves.
172.31.5.10:6379 (88c7571b...) -> 638359 keys | 2342 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 785743 keys | 2340 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 1213671 keys | 2340 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 1136483 keys | 2340 slots | 0 slaves.
[OK] 6314674 keys in 7 masters.
385.42 keys per slot on average.
 
total slots: 16384
0.5M keys written successfully

[34m******* write , 500000 completed ******* [0m 

------------------------------------------------------------------

[34m******* resize , 6 *******[0m

{ clusterSize: 7 }
[33m### REBALANCING CLUSTER ON 172.31.5.10:6379 ###
[0m
> redis-cli --cluster rebalance 172.31.5.10:6379 --cluster-use-empty-masters | grep -i Rebalancing
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 1188409 keys | 2340 slots | 0 slaves.
172.31.5.86:6379 (3aac5767...) -> 843650 keys | 2342 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 508359 keys | 2340 slots | 0 slaves.
172.31.5.10:6379 (88c7571b...) -> 638359 keys | 2342 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 785743 keys | 2340 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 1213671 keys | 2340 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 1136483 keys | 2340 slots | 0 slaves.
[OK] 6314674 keys in 7 masters.
385.42 keys per slot on average.
 
total slots: 16384
*** No rebalancing needed! All nodes are within the 2.00% threshold.


{ distribution: [ 391, 391, 390, 390, 390, 390 ] }
[33m### RESHARDING FROM 172.31.5.10 TO 172.31.5.88 ###
[0m
{ reshardFrom: '172.31.5.10', reshardTo: '172.31.5.88', slots: 391 }
> redis-cli --cluster reshard 172.31.5.10:6379 --cluster-from 88c7571ba757b3547fc6fbefc0219284839688ba --cluster-to 8b8944dfa3d8f1ff2204dc3aa335b19256357fe0 --cluster-slots 391 --cluster-yes | grep Ready
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 1326433 keys | 2731 slots | 0 slaves.
172.31.5.86:6379 (3aac5767...) -> 843650 keys | 2342 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 508359 keys | 2340 slots | 0 slaves.
172.31.5.10:6379 (88c7571b...) -> 500335 keys | 1951 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 785743 keys | 2340 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 1213671 keys | 2340 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 1136483 keys | 2340 slots | 0 slaves.
[OK] 6314674 keys in 7 masters.
385.42 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.10 TO 172.31.5.177 ###
[0m
{ reshardFrom: '172.31.5.10', reshardTo: '172.31.5.177', slots: 391 }
> redis-cli --cluster reshard 172.31.5.10:6379 --cluster-from 88c7571ba757b3547fc6fbefc0219284839688ba --cluster-to e5fb4afd51fdf082ef6d5eee77b9c8ff3ba46aca --cluster-slots 391 --cluster-yes | grep Ready
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 1326433 keys | 2731 slots | 0 slaves.
172.31.5.86:6379 (3aac5767...) -> 843650 keys | 2342 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 701355 keys | 2731 slots | 0 slaves.
172.31.5.10:6379 (88c7571b...) -> 307339 keys | 1560 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 785743 keys | 2340 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 1213671 keys | 2340 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 1136483 keys | 2340 slots | 0 slaves.
[OK] 6314674 keys in 7 masters.
385.42 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.10 TO 172.31.5.45 ###
[0m
{ reshardFrom: '172.31.5.10', reshardTo: '172.31.5.45', slots: 390 }
> redis-cli --cluster reshard 172.31.5.10:6379 --cluster-from 88c7571ba757b3547fc6fbefc0219284839688ba --cluster-to 0e4742121d492415d1f0d097c9691101d6eb8194 --cluster-slots 390 --cluster-yes | grep Ready
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 1326433 keys | 2731 slots | 0 slaves.
172.31.5.86:6379 (3aac5767...) -> 843650 keys | 2342 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 701355 keys | 2731 slots | 0 slaves.
172.31.5.10:6379 (88c7571b...) -> 152483 keys | 1170 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 785743 keys | 2340 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 1368527 keys | 2730 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 1136483 keys | 2340 slots | 0 slaves.
[OK] 6314674 keys in 7 masters.
385.42 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.10 TO 172.31.5.239 ###
[0m
{ reshardFrom: '172.31.5.10', reshardTo: '172.31.5.239', slots: 390 }
> redis-cli --cluster reshard 172.31.5.10:6379 --cluster-from 88c7571ba757b3547fc6fbefc0219284839688ba --cluster-to 6b7779abdc16827d8fd3a0b04a2068ca4fe5c585 --cluster-slots 390 --cluster-yes | grep Ready
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 1326433 keys | 2731 slots | 0 slaves.
172.31.5.86:6379 (3aac5767...) -> 843650 keys | 2342 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 701355 keys | 2731 slots | 0 slaves.
172.31.5.10:6379 (88c7571b...) -> 116885 keys | 780 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 785743 keys | 2340 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 1368527 keys | 2730 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 1172081 keys | 2730 slots | 0 slaves.
[OK] 6314674 keys in 7 masters.
385.42 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.10 TO 172.31.5.178 ###
[0m
{ reshardFrom: '172.31.5.10', reshardTo: '172.31.5.178', slots: 390 }
> redis-cli --cluster reshard 172.31.5.10:6379 --cluster-from 88c7571ba757b3547fc6fbefc0219284839688ba --cluster-to 963958096c34d9596c9452b07253481eee2f9f00 --cluster-slots 390 --cluster-yes | grep Ready
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 1326433 keys | 2731 slots | 0 slaves.
172.31.5.86:6379 (3aac5767...) -> 843650 keys | 2342 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 701355 keys | 2731 slots | 0 slaves.
172.31.5.10:6379 (88c7571b...) -> 35652 keys | 390 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 866976 keys | 2730 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 1368527 keys | 2730 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 1172081 keys | 2730 slots | 0 slaves.
[OK] 6314674 keys in 7 masters.
385.42 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.10 TO 172.31.5.86 ###
[0m
{ reshardFrom: '172.31.5.10', reshardTo: '172.31.5.86', slots: 390 }
> redis-cli --cluster reshard 172.31.5.10:6379 --cluster-from 88c7571ba757b3547fc6fbefc0219284839688ba --cluster-to 3aac57677b916b89b568938c6db362da7ebc2b2a --cluster-slots 390 --cluster-yes | grep Ready
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 1326433 keys | 2731 slots | 0 slaves.
172.31.5.86:6379 (3aac5767...) -> 879302 keys | 2732 slots | 1 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 701355 keys | 2731 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 866976 keys | 2730 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 1368527 keys | 2730 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 1172081 keys | 2730 slots | 0 slaves.
[OK] 6314674 keys in 6 masters.
385.42 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### REMOVING 172.31.5.10:6379 FROM CLUSTER ###
[0m
> redis-cli --cluster del-node 172.31.5.10:6379 88c7571ba757b3547fc6fbefc0219284839688ba
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 1326433 keys | 2731 slots | 0 slaves.
172.31.5.86:6379 (3aac5767...) -> 879302 keys | 2732 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 701355 keys | 2731 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 866976 keys | 2730 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 1368527 keys | 2730 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 1172081 keys | 2730 slots | 0 slaves.
[OK] 6314674 keys in 6 masters.
385.42 keys per slot on average.
 
total slots: 16384
Removing node 88c7571ba757b3547fc6fbefc0219284839688ba from cluster 172.31.5.10:6379
Sending CLUSTER FORGET messages to the cluster...
Sending CLUSTER RESET SOFT to the deleted node.
[33m### REBALANCING CLUSTER ON 172.31.5.88:6379 ###
[0m
> redis-cli --cluster rebalance 172.31.5.88:6379 --cluster-use-empty-masters | grep -i Rebalancing
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 1326433 keys | 2731 slots | 0 slaves.
172.31.5.86:6379 (3aac5767...) -> 879302 keys | 2732 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 701355 keys | 2731 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 866976 keys | 2730 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 1368527 keys | 2730 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 1172081 keys | 2730 slots | 0 slaves.
[OK] 6314674 keys in 6 masters.
385.42 keys per slot on average.
 
total slots: 16384
*** No rebalancing needed! All nodes are within the 2.00% threshold.


waiting... 65 64 63 62 61 60 59 58 57 56 55 54 53 52 51 50 49 48 47 46 45 44 43 42 41 40 39 38 37 36 35 34 33 32 31 30 29 28 27 26 25 24 23 22 21 20 19 18 17 16 15 14 13 12 11 10 9 8 7 6 5 4 3 2 1 



[34m******* resize , 6 completed ******* [0m 

------------------------------------------------------------------

[34m******* write , 500000 *******[0m

[33m### WRITING 500000 KEYS ###
[0m
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 1409779 keys | 2731 slots | 0 slaves.
172.31.5.86:6379 (3aac5767...) -> 962841 keys | 2732 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 784746 keys | 2731 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 950115 keys | 2730 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 1451948 keys | 2730 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 1255245 keys | 2730 slots | 0 slaves.
[OK] 6814674 keys in 6 masters.
415.93 keys per slot on average.
 
total slots: 16384
0.5M keys written successfully

[34m******* write , 500000 completed ******* [0m 

------------------------------------------------------------------

[34m******* resize , 3 *******[0m

{ clusterSize: 6 }
[33m### REBALANCING CLUSTER ON 172.31.5.86:6379 ###
[0m
> redis-cli --cluster rebalance 172.31.5.86:6379 --cluster-use-empty-masters | grep -i Rebalancing
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 1409779 keys | 2731 slots | 0 slaves.
172.31.5.86:6379 (3aac5767...) -> 962841 keys | 2732 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 784746 keys | 2731 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 950115 keys | 2730 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 1451948 keys | 2730 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 1255245 keys | 2730 slots | 0 slaves.
[OK] 6814674 keys in 6 masters.
415.93 keys per slot on average.
 
total slots: 16384
*** No rebalancing needed! All nodes are within the 2.00% threshold.


{ distribution: [ 911, 911, 910 ] }
[33m### RESHARDING FROM 172.31.5.86 TO 172.31.5.88 ###
[0m
{ reshardFrom: '172.31.5.86', reshardTo: '172.31.5.88', slots: 911 }
> redis-cli --cluster reshard 172.31.5.86:6379 --cluster-from 3aac57677b916b89b568938c6db362da7ebc2b2a --cluster-to 8b8944dfa3d8f1ff2204dc3aa335b19256357fe0 --cluster-slots 911 --cluster-yes | grep Ready
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 1886297 keys | 3642 slots | 0 slaves.
172.31.5.86:6379 (3aac5767...) -> 486323 keys | 1821 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 784746 keys | 2731 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 950115 keys | 2730 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 1451948 keys | 2730 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 1255245 keys | 2730 slots | 0 slaves.
[OK] 6814674 keys in 6 masters.
415.93 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.86 TO 172.31.5.177 ###
[0m
{ reshardFrom: '172.31.5.86', reshardTo: '172.31.5.177', slots: 911 }
> redis-cli --cluster reshard 172.31.5.86:6379 --cluster-from 3aac57677b916b89b568938c6db362da7ebc2b2a --cluster-to e5fb4afd51fdf082ef6d5eee77b9c8ff3ba46aca --cluster-slots 911 --cluster-yes | grep Ready
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 1886297 keys | 3642 slots | 0 slaves.
172.31.5.86:6379 (3aac5767...) -> 252533 keys | 910 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 1018536 keys | 3642 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 950115 keys | 2730 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 1451948 keys | 2730 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 1255245 keys | 2730 slots | 0 slaves.
[OK] 6814674 keys in 6 masters.
415.93 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.86 TO 172.31.5.45 ###
[0m
{ reshardFrom: '172.31.5.86', reshardTo: '172.31.5.45', slots: 910 }
> redis-cli --cluster reshard 172.31.5.86:6379 --cluster-from 3aac57677b916b89b568938c6db362da7ebc2b2a --cluster-to 0e4742121d492415d1f0d097c9691101d6eb8194 --cluster-slots 910 --cluster-yes | grep Ready
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 1886297 keys | 3642 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 1018536 keys | 3642 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 950115 keys | 2730 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 1704481 keys | 3640 slots | 1 slaves.
172.31.5.239:6379 (6b7779ab...) -> 1255245 keys | 2730 slots | 0 slaves.
[OK] 6814674 keys in 5 masters.
415.93 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### REMOVING 172.31.5.86:6379 FROM CLUSTER ###
[0m
> redis-cli --cluster del-node 172.31.5.86:6379 3aac57677b916b89b568938c6db362da7ebc2b2a
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 1886297 keys | 3642 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 1018536 keys | 3642 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 950115 keys | 2730 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 1704481 keys | 3640 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 1255245 keys | 2730 slots | 0 slaves.
[OK] 6814674 keys in 5 masters.
415.93 keys per slot on average.
 
total slots: 16384
Removing node 3aac57677b916b89b568938c6db362da7ebc2b2a from cluster 172.31.5.86:6379
Sending CLUSTER FORGET messages to the cluster...
Sending CLUSTER RESET SOFT to the deleted node.
{ distribution: [ 910, 910, 910 ] }
[33m### RESHARDING FROM 172.31.5.178 TO 172.31.5.177 ###
[0m
{ reshardFrom: '172.31.5.178', reshardTo: '172.31.5.177', slots: 910 }
> redis-cli --cluster reshard 172.31.5.178:6379 --cluster-from 963958096c34d9596c9452b07253481eee2f9f00 --cluster-to e5fb4afd51fdf082ef6d5eee77b9c8ff3ba46aca --cluster-slots 910 --cluster-yes | grep Ready
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 1886297 keys | 3642 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 1429876 keys | 4552 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 538775 keys | 1820 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 1704481 keys | 3640 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 1255245 keys | 2730 slots | 0 slaves.
[OK] 6814674 keys in 5 masters.
415.93 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.178 TO 172.31.5.45 ###
[0m
{ reshardFrom: '172.31.5.178', reshardTo: '172.31.5.45', slots: 910 }
> redis-cli --cluster reshard 172.31.5.178:6379 --cluster-from 963958096c34d9596c9452b07253481eee2f9f00 --cluster-to 0e4742121d492415d1f0d097c9691101d6eb8194 --cluster-slots 910 --cluster-yes | grep Ready
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 1886297 keys | 3642 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 1429876 keys | 4552 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 392802 keys | 910 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 1850454 keys | 4550 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 1255245 keys | 2730 slots | 0 slaves.
[OK] 6814674 keys in 5 masters.
415.93 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.178 TO 172.31.5.88 ###
[0m
{ reshardFrom: '172.31.5.178', reshardTo: '172.31.5.88', slots: 910 }
> redis-cli --cluster reshard 172.31.5.178:6379 --cluster-from 963958096c34d9596c9452b07253481eee2f9f00 --cluster-to 8b8944dfa3d8f1ff2204dc3aa335b19256357fe0 --cluster-slots 910 --cluster-yes | grep Ready
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 2279099 keys | 4552 slots | 1 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 1429876 keys | 4552 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 1850454 keys | 4550 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 1255245 keys | 2730 slots | 0 slaves.
[OK] 6814674 keys in 4 masters.
415.93 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### REMOVING 172.31.5.178:6379 FROM CLUSTER ###
[0m
> redis-cli --cluster del-node 172.31.5.178:6379 963958096c34d9596c9452b07253481eee2f9f00
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 2279099 keys | 4552 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 1429876 keys | 4552 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 1850454 keys | 4550 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 1255245 keys | 2730 slots | 0 slaves.
[OK] 6814674 keys in 4 masters.
415.93 keys per slot on average.
 
total slots: 16384
Removing node 963958096c34d9596c9452b07253481eee2f9f00 from cluster 172.31.5.178:6379
Sending CLUSTER FORGET messages to the cluster...
Sending CLUSTER RESET SOFT to the deleted node.
{ distribution: [ 910, 910, 910 ] }
[33m### RESHARDING FROM 172.31.5.239 TO 172.31.5.45 ###
[0m
{ reshardFrom: '172.31.5.239', reshardTo: '172.31.5.45', slots: 910 }
> redis-cli --cluster reshard 172.31.5.239:6379 --cluster-from 6b7779abdc16827d8fd3a0b04a2068ca4fe5c585 --cluster-to 0e4742121d492415d1f0d097c9691101d6eb8194 --cluster-slots 910 --cluster-yes | grep Ready
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 2279099 keys | 4552 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 1429876 keys | 4552 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 2176786 keys | 5460 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 928913 keys | 1820 slots | 0 slaves.
[OK] 6814674 keys in 4 masters.
415.93 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.239 TO 172.31.5.88 ###
[0m
{ reshardFrom: '172.31.5.239', reshardTo: '172.31.5.88', slots: 910 }
> redis-cli --cluster reshard 172.31.5.239:6379 --cluster-from 6b7779abdc16827d8fd3a0b04a2068ca4fe5c585 --cluster-to 8b8944dfa3d8f1ff2204dc3aa335b19256357fe0 --cluster-slots 910 --cluster-yes | grep Ready
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 2707135 keys | 5462 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 1429876 keys | 4552 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 2176786 keys | 5460 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 500877 keys | 910 slots | 0 slaves.
[OK] 6814674 keys in 4 masters.
415.93 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.239 TO 172.31.5.177 ###
[0m
{ reshardFrom: '172.31.5.239', reshardTo: '172.31.5.177', slots: 910 }
> redis-cli --cluster reshard 172.31.5.239:6379 --cluster-from 6b7779abdc16827d8fd3a0b04a2068ca4fe5c585 --cluster-to e5fb4afd51fdf082ef6d5eee77b9c8ff3ba46aca --cluster-slots 910 --cluster-yes | grep Ready
assertion error.
 {
  keys1: 6814674,
  keys2: 6525534,
  keys: 0,
  slots1: 16384,
  slots2: 16384,
  nodes1: 4,
  nodes2: 3,
  nodes: -1
}
precheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 2707135 keys | 5462 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 1429876 keys | 4552 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 2176786 keys | 5460 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 500877 keys | 910 slots | 0 slaves.
[OK] 6814674 keys in 4 masters.
415.93 keys per slot on average.

postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 2707135 keys | 5462 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 1641613 keys | 5462 slots | 1 slaves.
172.31.5.45:6379 (0e474212...) -> 2176786 keys | 5460 slots | 0 slaves.
[OK] 6525534 keys in 3 masters.
398.29 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### REMOVING 172.31.5.239:6379 FROM CLUSTER ###
[0m
> redis-cli --cluster del-node 172.31.5.239:6379 6b7779abdc16827d8fd3a0b04a2068ca4fe5c585
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 2707135 keys | 5462 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 1641613 keys | 5462 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 2176786 keys | 5460 slots | 0 slaves.
[OK] 6525534 keys in 3 masters.
398.29 keys per slot on average.
 
total slots: 16384
Removing node 6b7779abdc16827d8fd3a0b04a2068ca4fe5c585 from cluster 172.31.5.239:6379
Sending CLUSTER FORGET messages to the cluster...
Sending CLUSTER RESET SOFT to the deleted node.
[33m### REBALANCING CLUSTER ON 172.31.5.88:6379 ###
[0m
> redis-cli --cluster rebalance 172.31.5.88:6379 --cluster-use-empty-masters | grep -i Rebalancing
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 2707135 keys | 5462 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 1641613 keys | 5462 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 2176786 keys | 5460 slots | 0 slaves.
[OK] 6525534 keys in 3 masters.
398.29 keys per slot on average.
 
total slots: 16384
*** No rebalancing needed! All nodes are within the 2.00% threshold.


waiting... 65 64 63 62 61 60 59 58 57 56 55 54 53 52 51 50 49 48 47 46 45 44 43 42 41 40 39 38 37 36 35 34 33 32 31 30 29 28 27 26 25 24 23 22 21 20 19 18 17 16 15 14 13 12 11 10 9 8 7 6 5 4 3 2 1 



[34m******* resize , 3 completed ******* [0m 

------------------------------------------------------------------

[34m******* write , 500000 *******[0m

[33m### WRITING 500000 KEYS ###
[0m
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 2873753 keys | 5462 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 1808604 keys | 5462 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 2343177 keys | 5460 slots | 0 slaves.
[OK] 7025534 keys in 3 masters.
428.80 keys per slot on average.
 
total slots: 16384
0.5M keys written successfully

[34m******* write , 500000 completed ******* [0m 

------------------------------------------------------------------

[34m******* resize , 6 *******[0m

{ clusterSize: 3 }
[33m### ADDING 172.31.5.239:6379 NODE TO CLUSTER ###
[0m
> redis-cli --cluster add-node 172.31.5.239:6379 172.31.5.88:6379 | awk '{ gsub(/[[0-9;]*m/, ""); print }'
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 2873753 keys | 5462 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 1808604 keys | 5462 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 2343177 keys | 5460 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 0 keys | 0 slots | 0 slaves.
[OK] 7025534 keys in 4 masters.
428.80 keys per slot on average.
 
total slots: 16384
node added successfully
waiting... 2 1 


[33m### ADDING 172.31.5.178:6379 NODE TO CLUSTER ###
[0m
> redis-cli --cluster add-node 172.31.5.178:6379 172.31.5.88:6379 | awk '{ gsub(/[[0-9;]*m/, ""); print }'
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 2873753 keys | 5462 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 1808604 keys | 5462 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 2343177 keys | 5460 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 0 keys | 0 slots | 0 slaves.
[OK] 7025534 keys in 5 masters.
428.80 keys per slot on average.
 
total slots: 16384
node added successfully
waiting... 2 1 


[33m### ADDING 172.31.5.86:6379 NODE TO CLUSTER ###
[0m
> redis-cli --cluster add-node 172.31.5.86:6379 172.31.5.88:6379 | awk '{ gsub(/[[0-9;]*m/, ""); print }'
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 2873753 keys | 5462 slots | 0 slaves.
172.31.5.86:6379 (3aac5767...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 1808604 keys | 5462 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 2343177 keys | 5460 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 0 keys | 0 slots | 0 slaves.
[OK] 7025534 keys in 6 masters.
428.80 keys per slot on average.
 
total slots: 16384
node added successfully
waiting... 2 1 


waiting... 10 9 8 7 6 5 4 3 2 1 


[33m### REBALANCING CLUSTER ON 172.31.5.239:6379 ###
[0m
> redis-cli --cluster rebalance 172.31.5.239:6379 --cluster-use-empty-masters | grep -i Rebalancing
assertion error.
 {
  keys1: 7025534,
  keys2: 5880220,
  keys: 0,
  slots1: 16384,
  slots2: 16384,
  nodes1: 6,
  nodes2: 6,
  nodes: 0
}
precheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 2873753 keys | 5462 slots | 0 slaves.
172.31.5.86:6379 (3aac5767...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 1808604 keys | 5462 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 2343177 keys | 5460 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 0 keys | 0 slots | 0 slaves.
[OK] 7025534 keys in 6 masters.
428.80 keys per slot on average.

postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 1533997 keys | 2730 slots | 0 slaves.
172.31.5.86:6379 (3aac5767...) -> 927252 keys | 2731 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 663272 keys | 2730 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 1 keys | 2731 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 1415942 keys | 2730 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 1339756 keys | 2732 slots | 0 slaves.
[OK] 5880220 keys in 6 masters.
358.90 keys per slot on average.
 
total slots: 16384
>>> Rebalancing across 6 nodes. Total weight = 6.00



[34m******* resize , 6 completed ******* [0m 

------------------------------------------------------------------

[34m******* write , 500000 *******[0m

[33m### WRITING 500000 KEYS ###
[0m
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 1617372 keys | 2730 slots | 0 slaves.
172.31.5.86:6379 (3aac5767...) -> 1010511 keys | 2731 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 746651 keys | 2730 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 83473 keys | 2731 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 1499168 keys | 2730 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 1423045 keys | 2732 slots | 0 slaves.
[OK] 6380220 keys in 6 masters.
389.42 keys per slot on average.
 
total slots: 16384
0.5M keys written successfully

[34m******* write , 500000 completed ******* [0m 

------------------------------------------------------------------

[34m******* resize , 4 *******[0m

{ clusterSize: 6 }
[33m### REBALANCING CLUSTER ON 172.31.5.86:6379 ###
[0m
> redis-cli --cluster rebalance 172.31.5.86:6379 --cluster-use-empty-masters | grep -i Rebalancing
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 1617372 keys | 2730 slots | 0 slaves.
172.31.5.86:6379 (3aac5767...) -> 1010511 keys | 2731 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 746651 keys | 2730 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 83473 keys | 2731 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 1499168 keys | 2730 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 1423045 keys | 2732 slots | 0 slaves.
[OK] 6380220 keys in 6 masters.
389.42 keys per slot on average.
 
total slots: 16384
*** No rebalancing needed! All nodes are within the 2.00% threshold.


{ distribution: [ 683, 683, 683, 682 ] }
[33m### RESHARDING FROM 172.31.5.86 TO 172.31.5.88 ###
[0m
{ reshardFrom: '172.31.5.86', reshardTo: '172.31.5.88', slots: 683 }
> redis-cli --cluster reshard 172.31.5.86:6379 --cluster-from 3aac57677b916b89b568938c6db362da7ebc2b2a --cluster-to 8b8944dfa3d8f1ff2204dc3aa335b19256357fe0 --cluster-slots 683 --cluster-yes | grep Ready
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 1951015 keys | 3413 slots | 0 slaves.
172.31.5.86:6379 (3aac5767...) -> 676868 keys | 2048 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 746651 keys | 2730 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 83473 keys | 2731 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 1499168 keys | 2730 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 1423045 keys | 2732 slots | 0 slaves.
[OK] 6380220 keys in 6 masters.
389.42 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.86 TO 172.31.5.177 ###
[0m
{ reshardFrom: '172.31.5.86', reshardTo: '172.31.5.177', slots: 683 }
> redis-cli --cluster reshard 172.31.5.86:6379 --cluster-from 3aac57677b916b89b568938c6db362da7ebc2b2a --cluster-to e5fb4afd51fdf082ef6d5eee77b9c8ff3ba46aca --cluster-slots 683 --cluster-yes | grep Ready
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 1951015 keys | 3413 slots | 0 slaves.
172.31.5.86:6379 (3aac5767...) -> 471639 keys | 1365 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 951880 keys | 3413 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 83473 keys | 2731 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 1499168 keys | 2730 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 1423045 keys | 2732 slots | 0 slaves.
[OK] 6380220 keys in 6 masters.
389.42 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.86 TO 172.31.5.45 ###
[0m
{ reshardFrom: '172.31.5.86', reshardTo: '172.31.5.45', slots: 683 }
> redis-cli --cluster reshard 172.31.5.86:6379 --cluster-from 3aac57677b916b89b568938c6db362da7ebc2b2a --cluster-to 0e4742121d492415d1f0d097c9691101d6eb8194 --cluster-slots 683 --cluster-yes | grep Ready
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 1951015 keys | 3413 slots | 0 slaves.
172.31.5.86:6379 (3aac5767...) -> 148845 keys | 682 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 951880 keys | 3413 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 83473 keys | 2731 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 1821962 keys | 3413 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 1423045 keys | 2732 slots | 0 slaves.
[OK] 6380220 keys in 6 masters.
389.42 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.86 TO 172.31.5.239 ###
[0m
{ reshardFrom: '172.31.5.86', reshardTo: '172.31.5.239', slots: 682 }
> redis-cli --cluster reshard 172.31.5.86:6379 --cluster-from 3aac57677b916b89b568938c6db362da7ebc2b2a --cluster-to 6b7779abdc16827d8fd3a0b04a2068ca4fe5c585 --cluster-slots 682 --cluster-yes | grep Ready
assertion error.
 {
  keys1: 6380220,
  keys2: 4842286,
  keys: 0,
  slots1: 16384,
  slots2: 16384,
  nodes1: 6,
  nodes2: 5,
  nodes: -1
}
precheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 1951015 keys | 3413 slots | 0 slaves.
172.31.5.86:6379 (3aac5767...) -> 148845 keys | 682 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 951880 keys | 3413 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 83473 keys | 2731 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 1821962 keys | 3413 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 1423045 keys | 2732 slots | 0 slaves.
[OK] 6380220 keys in 6 masters.
389.42 keys per slot on average.

postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 1951015 keys | 3413 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 951880 keys | 3413 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 83473 keys | 2731 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 1821962 keys | 3413 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 33956 keys | 3414 slots | 1 slaves.
[OK] 4842286 keys in 5 masters.
295.55 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### REMOVING 172.31.5.86:6379 FROM CLUSTER ###
[0m
> redis-cli --cluster del-node 172.31.5.86:6379 3aac57677b916b89b568938c6db362da7ebc2b2a
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 1951015 keys | 3413 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 951880 keys | 3413 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 83473 keys | 2731 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 1821962 keys | 3413 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 33956 keys | 3414 slots | 0 slaves.
[OK] 4842286 keys in 5 masters.
295.55 keys per slot on average.
 
total slots: 16384
Removing node 3aac57677b916b89b568938c6db362da7ebc2b2a from cluster 172.31.5.86:6379
Sending CLUSTER FORGET messages to the cluster...
Sending CLUSTER RESET SOFT to the deleted node.
{ distribution: [ 683, 683, 683, 682 ] }
[33m### RESHARDING FROM 172.31.5.178 TO 172.31.5.177 ###
[0m
{ reshardFrom: '172.31.5.178', reshardTo: '172.31.5.177', slots: 683 }
> redis-cli --cluster reshard 172.31.5.178:6379 --cluster-from 963958096c34d9596c9452b07253481eee2f9f00 --cluster-to e5fb4afd51fdf082ef6d5eee77b9c8ff3ba46aca --cluster-slots 683 --cluster-yes | grep Ready
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 1951015 keys | 3413 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 972733 keys | 4096 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 62620 keys | 2048 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 1821962 keys | 3413 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 33956 keys | 3414 slots | 0 slaves.
[OK] 4842286 keys in 5 masters.
295.55 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.178 TO 172.31.5.45 ###
[0m
{ reshardFrom: '172.31.5.178', reshardTo: '172.31.5.45', slots: 683 }
> redis-cli --cluster reshard 172.31.5.178:6379 --cluster-from 963958096c34d9596c9452b07253481eee2f9f00 --cluster-to 0e4742121d492415d1f0d097c9691101d6eb8194 --cluster-slots 683 --cluster-yes | grep Ready
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 1951015 keys | 3413 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 972733 keys | 4096 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 41888 keys | 1365 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 1842694 keys | 4096 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 33956 keys | 3414 slots | 0 slaves.
[OK] 4842286 keys in 5 masters.
295.55 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.178 TO 172.31.5.239 ###
[0m
{ reshardFrom: '172.31.5.178', reshardTo: '172.31.5.239', slots: 683 }
> redis-cli --cluster reshard 172.31.5.178:6379 --cluster-from 963958096c34d9596c9452b07253481eee2f9f00 --cluster-to 6b7779abdc16827d8fd3a0b04a2068ca4fe5c585 --cluster-slots 683 --cluster-yes | grep Ready
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 1951015 keys | 3413 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 972733 keys | 4096 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 20897 keys | 682 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 1842694 keys | 4096 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 54947 keys | 4097 slots | 0 slaves.
[OK] 4842286 keys in 5 masters.
295.55 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.178 TO 172.31.5.88 ###
[0m
{ reshardFrom: '172.31.5.178', reshardTo: '172.31.5.88', slots: 682 }
> redis-cli --cluster reshard 172.31.5.178:6379 --cluster-from 963958096c34d9596c9452b07253481eee2f9f00 --cluster-to 8b8944dfa3d8f1ff2204dc3aa335b19256357fe0 --cluster-slots 682 --cluster-yes | grep Ready
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 1971912 keys | 4095 slots | 1 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 972733 keys | 4096 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 1842694 keys | 4096 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 54947 keys | 4097 slots | 0 slaves.
[OK] 4842286 keys in 4 masters.
295.55 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### REMOVING 172.31.5.178:6379 FROM CLUSTER ###
[0m
> redis-cli --cluster del-node 172.31.5.178:6379 963958096c34d9596c9452b07253481eee2f9f00
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 1971912 keys | 4095 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 972733 keys | 4096 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 1842694 keys | 4096 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 54947 keys | 4097 slots | 0 slaves.
[OK] 4842286 keys in 4 masters.
295.55 keys per slot on average.
 
total slots: 16384
Removing node 963958096c34d9596c9452b07253481eee2f9f00 from cluster 172.31.5.178:6379
Sending CLUSTER FORGET messages to the cluster...
Sending CLUSTER RESET SOFT to the deleted node.
[33m### REBALANCING CLUSTER ON 172.31.5.88:6379 ###
[0m
> redis-cli --cluster rebalance 172.31.5.88:6379 --cluster-use-empty-masters | grep -i Rebalancing
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 1971912 keys | 4095 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 972733 keys | 4096 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 1842694 keys | 4096 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 54947 keys | 4097 slots | 0 slaves.
[OK] 4842286 keys in 4 masters.
295.55 keys per slot on average.
 
total slots: 16384
*** No rebalancing needed! All nodes are within the 2.00% threshold.


waiting... 65 64 63 62 61 60 59 58 57 56 55 54 53 52 51 50 49 48 47 46 45 44 43 42 41 40 39 38 37 36 35 34 33 32 31 30 29 28 27 26 25 24 23 22 21 20 19 18 17 16 15 14 13 12 11 10 9 8 7 6 5 4 3 2 1 



[34m******* resize , 4 completed ******* [0m 

------------------------------------------------------------------

[34m******* write , 500000 *******[0m

[33m### WRITING 500000 KEYS ###
[0m
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 2097013 keys | 4095 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 1097732 keys | 4096 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 1967637 keys | 4096 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 179904 keys | 4097 slots | 0 slaves.
[OK] 5342286 keys in 4 masters.
326.07 keys per slot on average.
 
total slots: 16384
0.5M keys written successfully

[34m******* write , 500000 completed ******* [0m 

------------------------------------------------------------------

[34m******* resize , 6 *******[0m

{ clusterSize: 4 }
[33m### ADDING 172.31.5.178:6379 NODE TO CLUSTER ###
[0m
> redis-cli --cluster add-node 172.31.5.178:6379 172.31.5.88:6379 | awk '{ gsub(/[[0-9;]*m/, ""); print }'
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 2097013 keys | 4095 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 1097732 keys | 4096 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 1967637 keys | 4096 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 179904 keys | 4097 slots | 0 slaves.
[OK] 5342286 keys in 5 masters.
326.07 keys per slot on average.
 
total slots: 16384
node added successfully
waiting... 2 1 


[33m### ADDING 172.31.5.86:6379 NODE TO CLUSTER ###
[0m
> redis-cli --cluster add-node 172.31.5.86:6379 172.31.5.88:6379 | awk '{ gsub(/[[0-9;]*m/, ""); print }'
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 2097013 keys | 4095 slots | 0 slaves.
172.31.5.86:6379 (3aac5767...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 1097732 keys | 4096 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 1967637 keys | 4096 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 179904 keys | 4097 slots | 0 slaves.
[OK] 5342286 keys in 6 masters.
326.07 keys per slot on average.
 
total slots: 16384
node added successfully
waiting... 2 1 


waiting... 10 9 8 7 6 5 4 3 2 1 


[33m### REBALANCING CLUSTER ON 172.31.5.178:6379 ###
[0m
> redis-cli --cluster rebalance 172.31.5.178:6379 --cluster-use-empty-masters | grep -i Rebalancing
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 1700680 keys | 2730 slots | 0 slaves.
172.31.5.86:6379 (3aac5767...) -> 782172 keys | 2732 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 830048 keys | 2730 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 310770 keys | 2732 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 1582411 keys | 2730 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 136205 keys | 2730 slots | 0 slaves.
[OK] 5342286 keys in 6 masters.
326.07 keys per slot on average.
 
total slots: 16384
>>> Rebalancing across 6 nodes. Total weight = 6.00



[34m******* resize , 6 completed ******* [0m 

------------------------------------------------------------------

[34m******* write , 500000 *******[0m

[33m### WRITING 500000 KEYS ###
[0m
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 1783973 keys | 2730 slots | 0 slaves.
172.31.5.86:6379 (3aac5767...) -> 865463 keys | 2732 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 913297 keys | 2730 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 394258 keys | 2732 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 1665802 keys | 2730 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 219493 keys | 2730 slots | 0 slaves.
[OK] 5842286 keys in 6 masters.
356.58 keys per slot on average.
 
total slots: 16384
0.5M keys written successfully

[34m******* write , 500000 completed ******* [0m 

------------------------------------------------------------------

[34m******* resize , 5 *******[0m

{ clusterSize: 6 }
[33m### REBALANCING CLUSTER ON 172.31.5.86:6379 ###
[0m
> redis-cli --cluster rebalance 172.31.5.86:6379 --cluster-use-empty-masters | grep -i Rebalancing
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 1783973 keys | 2730 slots | 0 slaves.
172.31.5.86:6379 (3aac5767...) -> 865463 keys | 2732 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 913297 keys | 2730 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 394258 keys | 2732 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 1665802 keys | 2730 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 219493 keys | 2730 slots | 0 slaves.
[OK] 5842286 keys in 6 masters.
356.58 keys per slot on average.
 
total slots: 16384
*** No rebalancing needed! All nodes are within the 2.00% threshold.


{ distribution: [ 547, 547, 546, 546, 546 ] }
[33m### RESHARDING FROM 172.31.5.86 TO 172.31.5.88 ###
[0m
{ reshardFrom: '172.31.5.86', reshardTo: '172.31.5.88', slots: 547 }
> redis-cli --cluster reshard 172.31.5.86:6379 --cluster-from 3aac57677b916b89b568938c6db362da7ebc2b2a --cluster-to 8b8944dfa3d8f1ff2204dc3aa335b19256357fe0 --cluster-slots 547 --cluster-yes | grep Ready
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 1849783 keys | 3277 slots | 0 slaves.
172.31.5.86:6379 (3aac5767...) -> 799653 keys | 2185 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 913297 keys | 2730 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 394258 keys | 2732 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 1665802 keys | 2730 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 219493 keys | 2730 slots | 0 slaves.
[OK] 5842286 keys in 6 masters.
356.58 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.86 TO 172.31.5.177 ###
[0m
{ reshardFrom: '172.31.5.86', reshardTo: '172.31.5.177', slots: 547 }
> redis-cli --cluster reshard 172.31.5.86:6379 --cluster-from 3aac57677b916b89b568938c6db362da7ebc2b2a --cluster-to e5fb4afd51fdf082ef6d5eee77b9c8ff3ba46aca --cluster-slots 547 --cluster-yes | grep Ready
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 1849783 keys | 3277 slots | 0 slaves.
172.31.5.86:6379 (3aac5767...) -> 529331 keys | 1638 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 1183619 keys | 3277 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 394258 keys | 2732 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 1665802 keys | 2730 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 219493 keys | 2730 slots | 0 slaves.
[OK] 5842286 keys in 6 masters.
356.58 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.86 TO 172.31.5.45 ###
[0m
{ reshardFrom: '172.31.5.86', reshardTo: '172.31.5.45', slots: 546 }
> redis-cli --cluster reshard 172.31.5.86:6379 --cluster-from 3aac57677b916b89b568938c6db362da7ebc2b2a --cluster-to 0e4742121d492415d1f0d097c9691101d6eb8194 --cluster-slots 546 --cluster-yes | grep Ready
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 1849783 keys | 3277 slots | 0 slaves.
172.31.5.86:6379 (3aac5767...) -> 338092 keys | 1092 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 1183619 keys | 3277 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 394258 keys | 2732 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 1857041 keys | 3276 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 219493 keys | 2730 slots | 0 slaves.
[OK] 5842286 keys in 6 masters.
356.58 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.86 TO 172.31.5.239 ###
[0m
{ reshardFrom: '172.31.5.86', reshardTo: '172.31.5.239', slots: 546 }
> redis-cli --cluster reshard 172.31.5.86:6379 --cluster-from 3aac57677b916b89b568938c6db362da7ebc2b2a --cluster-to 6b7779abdc16827d8fd3a0b04a2068ca4fe5c585 --cluster-slots 546 --cluster-yes | grep Ready
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 1849783 keys | 3277 slots | 0 slaves.
172.31.5.86:6379 (3aac5767...) -> 54229 keys | 546 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 1183619 keys | 3277 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 394258 keys | 2732 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 1857041 keys | 3276 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 503356 keys | 3276 slots | 0 slaves.
[OK] 5842286 keys in 6 masters.
356.58 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.86 TO 172.31.5.178 ###
[0m
{ reshardFrom: '172.31.5.86', reshardTo: '172.31.5.178', slots: 546 }
> redis-cli --cluster reshard 172.31.5.86:6379 --cluster-from 3aac57677b916b89b568938c6db362da7ebc2b2a --cluster-to 963958096c34d9596c9452b07253481eee2f9f00 --cluster-slots 546 --cluster-yes | grep Ready
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 1849783 keys | 3277 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 1183619 keys | 3277 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 448487 keys | 3278 slots | 1 slaves.
172.31.5.45:6379 (0e474212...) -> 1857041 keys | 3276 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 503356 keys | 3276 slots | 0 slaves.
[OK] 5842286 keys in 5 masters.
356.58 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### REMOVING 172.31.5.86:6379 FROM CLUSTER ###
[0m
> redis-cli --cluster del-node 172.31.5.86:6379 3aac57677b916b89b568938c6db362da7ebc2b2a
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 1849783 keys | 3277 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 1183619 keys | 3277 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 448487 keys | 3278 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 1857041 keys | 3276 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 503356 keys | 3276 slots | 0 slaves.
[OK] 5842286 keys in 5 masters.
356.58 keys per slot on average.
 
total slots: 16384
Removing node 3aac57677b916b89b568938c6db362da7ebc2b2a from cluster 172.31.5.86:6379
Sending CLUSTER FORGET messages to the cluster...
Sending CLUSTER RESET SOFT to the deleted node.
[33m### REBALANCING CLUSTER ON 172.31.5.88:6379 ###
[0m
> redis-cli --cluster rebalance 172.31.5.88:6379 --cluster-use-empty-masters | grep -i Rebalancing
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 1849783 keys | 3277 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 1183619 keys | 3277 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 448487 keys | 3278 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 1857041 keys | 3276 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 503356 keys | 3276 slots | 0 slaves.
[OK] 5842286 keys in 5 masters.
356.58 keys per slot on average.
 
total slots: 16384
*** No rebalancing needed! All nodes are within the 2.00% threshold.


waiting... 65 64 63 62 61 60 59 58 57 56 55 54 53 52 51 50 49 48 47 46 45 44 43 42 41 40 39 38 37 36 35 34 33 32 31 30 29 28 27 26 25 24 23 22 21 20 19 18 17 16 15 14 13 12 11 10 9 8 7 6 5 4 3 2 1 



[34m******* resize , 5 completed ******* [0m 

------------------------------------------------------------------

[34m******* write , 500000 *******[0m

[33m### WRITING 500000 KEYS ###
[0m
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 1949797 keys | 3277 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 1283672 keys | 3277 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 548498 keys | 3278 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 1957006 keys | 3276 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 603313 keys | 3276 slots | 0 slaves.
[OK] 6342286 keys in 5 masters.
387.10 keys per slot on average.
 
total slots: 16384
0.5M keys written successfully

[34m******* write , 500000 completed ******* [0m 

------------------------------------------------------------------

[34m******* resize , 3 *******[0m

{ clusterSize: 5 }
[33m### REBALANCING CLUSTER ON 172.31.5.178:6379 ###
[0m
> redis-cli --cluster rebalance 172.31.5.178:6379 --cluster-use-empty-masters | grep -i Rebalancing
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 1949797 keys | 3277 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 1283672 keys | 3277 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 548498 keys | 3278 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 1957006 keys | 3276 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 603313 keys | 3276 slots | 0 slaves.
[OK] 6342286 keys in 5 masters.
387.10 keys per slot on average.
 
total slots: 16384
*** No rebalancing needed! All nodes are within the 2.00% threshold.


{ distribution: [ 1093, 1093, 1092 ] }
[33m### RESHARDING FROM 172.31.5.178 TO 172.31.5.88 ###
[0m
{ reshardFrom: '172.31.5.178', reshardTo: '172.31.5.88', slots: 1093 }
> redis-cli --cluster reshard 172.31.5.178:6379 --cluster-from 963958096c34d9596c9452b07253481eee2f9f00 --cluster-to 8b8944dfa3d8f1ff2204dc3aa335b19256357fe0 --cluster-slots 1093 --cluster-yes | grep Ready
assertion error.
 {
  keys1: 6342286,
  keys2: 4332305,
  keys: 0,
  slots1: 16384,
  slots2: 16384,
  nodes1: 5,
  nodes2: 5,
  nodes: 0
}
precheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 1949797 keys | 3277 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 1283672 keys | 3277 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 548498 keys | 3278 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 1957006 keys | 3276 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 603313 keys | 3276 slots | 0 slaves.
[OK] 6342286 keys in 5 masters.
387.10 keys per slot on average.

postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 45372 keys | 4370 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 1283672 keys | 3277 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 442942 keys | 2185 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 1957006 keys | 3276 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 603313 keys | 3276 slots | 0 slaves.
[OK] 4332305 keys in 5 masters.
264.42 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.178 TO 172.31.5.177 ###
[0m
{ reshardFrom: '172.31.5.178', reshardTo: '172.31.5.177', slots: 1093 }
> redis-cli --cluster reshard 172.31.5.178:6379 --cluster-from 963958096c34d9596c9452b07253481eee2f9f00 --cluster-to e5fb4afd51fdf082ef6d5eee77b9c8ff3ba46aca --cluster-slots 1093 --cluster-yes | grep Ready
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 45372 keys | 4370 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 1485987 keys | 4370 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 240627 keys | 1092 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 1957006 keys | 3276 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 603313 keys | 3276 slots | 0 slaves.
[OK] 4332305 keys in 5 masters.
264.42 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.178 TO 172.31.5.45 ###
[0m
{ reshardFrom: '172.31.5.178', reshardTo: '172.31.5.45', slots: 1092 }
> redis-cli --cluster reshard 172.31.5.178:6379 --cluster-from 963958096c34d9596c9452b07253481eee2f9f00 --cluster-to 0e4742121d492415d1f0d097c9691101d6eb8194 --cluster-slots 1092 --cluster-yes | grep Ready
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 45372 keys | 4370 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 1485987 keys | 4370 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 2197633 keys | 4368 slots | 1 slaves.
172.31.5.239:6379 (6b7779ab...) -> 603313 keys | 3276 slots | 0 slaves.
[OK] 4332305 keys in 4 masters.
264.42 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### REMOVING 172.31.5.178:6379 FROM CLUSTER ###
[0m
> redis-cli --cluster del-node 172.31.5.178:6379 963958096c34d9596c9452b07253481eee2f9f00
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 45372 keys | 4370 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 1485987 keys | 4370 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 2197633 keys | 4368 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 603313 keys | 3276 slots | 0 slaves.
[OK] 4332305 keys in 4 masters.
264.42 keys per slot on average.
 
total slots: 16384
Removing node 963958096c34d9596c9452b07253481eee2f9f00 from cluster 172.31.5.178:6379
Sending CLUSTER FORGET messages to the cluster...
Sending CLUSTER RESET SOFT to the deleted node.
{ distribution: [ 1092, 1092, 1092 ] }
[33m### RESHARDING FROM 172.31.5.239 TO 172.31.5.177 ###
[0m
{ reshardFrom: '172.31.5.239', reshardTo: '172.31.5.177', slots: 1092 }
> redis-cli --cluster reshard 172.31.5.239:6379 --cluster-from 6b7779abdc16827d8fd3a0b04a2068ca4fe5c585 --cluster-to e5fb4afd51fdf082ef6d5eee77b9c8ff3ba46aca --cluster-slots 1092 --cluster-yes | grep Ready
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 45372 keys | 4370 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 1823019 keys | 5462 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 2197633 keys | 4368 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 266281 keys | 2184 slots | 0 slaves.
[OK] 4332305 keys in 4 masters.
264.42 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.239 TO 172.31.5.45 ###
[0m
{ reshardFrom: '172.31.5.239', reshardTo: '172.31.5.45', slots: 1092 }
> redis-cli --cluster reshard 172.31.5.239:6379 --cluster-from 6b7779abdc16827d8fd3a0b04a2068ca4fe5c585 --cluster-to 0e4742121d492415d1f0d097c9691101d6eb8194 --cluster-slots 1092 --cluster-yes | grep Ready
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 45372 keys | 4370 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 1823019 keys | 5462 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 2330100 keys | 5460 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 133814 keys | 1092 slots | 0 slaves.
[OK] 4332305 keys in 4 masters.
264.42 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.239 TO 172.31.5.88 ###
[0m
{ reshardFrom: '172.31.5.239', reshardTo: '172.31.5.88', slots: 1092 }
> redis-cli --cluster reshard 172.31.5.239:6379 --cluster-from 6b7779abdc16827d8fd3a0b04a2068ca4fe5c585 --cluster-to 8b8944dfa3d8f1ff2204dc3aa335b19256357fe0 --cluster-slots 1092 --cluster-yes | grep Ready
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 179186 keys | 5462 slots | 1 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 1823019 keys | 5462 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 2330100 keys | 5460 slots | 0 slaves.
[OK] 4332305 keys in 3 masters.
264.42 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### REMOVING 172.31.5.239:6379 FROM CLUSTER ###
[0m
> redis-cli --cluster del-node 172.31.5.239:6379 6b7779abdc16827d8fd3a0b04a2068ca4fe5c585
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 179186 keys | 5462 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 1823019 keys | 5462 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 2330100 keys | 5460 slots | 0 slaves.
[OK] 4332305 keys in 3 masters.
264.42 keys per slot on average.
 
total slots: 16384
Removing node 6b7779abdc16827d8fd3a0b04a2068ca4fe5c585 from cluster 172.31.5.239:6379
Sending CLUSTER FORGET messages to the cluster...
Sending CLUSTER RESET SOFT to the deleted node.
[33m### REBALANCING CLUSTER ON 172.31.5.88:6379 ###
[0m
> redis-cli --cluster rebalance 172.31.5.88:6379 --cluster-use-empty-masters | grep -i Rebalancing
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 179186 keys | 5462 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 1823019 keys | 5462 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 2330100 keys | 5460 slots | 0 slaves.
[OK] 4332305 keys in 3 masters.
264.42 keys per slot on average.
 
total slots: 16384
*** No rebalancing needed! All nodes are within the 2.00% threshold.


waiting... 65 64 63 62 61 60 59 58 57 56 55 54 53 52 51 50 49 48 47 46 45 44 43 42 41 40 39 38 37 36 35 34 33 32 31 30 29 28 27 26 25 24 23 22 21 20 19 18 17 16 15 14 13 12 11 10 9 8 7 6 5 4 3 2 1 



[34m******* resize , 3 completed ******* [0m 

------------------------------------------------------------------

[34m******* write , 500000 *******[0m

[33m### WRITING 500000 KEYS ###
[0m
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 345869 keys | 5462 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 1989777 keys | 5462 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 2496659 keys | 5460 slots | 0 slaves.
[OK] 4832305 keys in 3 masters.
294.94 keys per slot on average.
 
total slots: 16384
0.5M keys written successfully

[34m******* write , 500000 completed ******* [0m 

------------------------------------------------------------------

[34m******* resize , 5 *******[0m

{ clusterSize: 3 }
[33m### ADDING 172.31.5.239:6379 NODE TO CLUSTER ###
[0m
> redis-cli --cluster add-node 172.31.5.239:6379 172.31.5.88:6379 | awk '{ gsub(/[[0-9;]*m/, ""); print }'
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 345869 keys | 5462 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 1989777 keys | 5462 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 2496659 keys | 5460 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 0 keys | 0 slots | 0 slaves.
[OK] 4832305 keys in 4 masters.
294.94 keys per slot on average.
 
total slots: 16384
node added successfully
waiting... 2 1 


[33m### ADDING 172.31.5.178:6379 NODE TO CLUSTER ###
[0m
> redis-cli --cluster add-node 172.31.5.178:6379 172.31.5.88:6379 | awk '{ gsub(/[[0-9;]*m/, ""); print }'
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 345869 keys | 5462 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 1989777 keys | 5462 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 2496659 keys | 5460 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 0 keys | 0 slots | 0 slaves.
[OK] 4832305 keys in 5 masters.
294.94 keys per slot on average.
 
total slots: 16384
node added successfully
waiting... 2 1 


waiting... 10 9 8 7 6 5 4 3 2 1 


[33m### REBALANCING CLUSTER ON 172.31.5.239:6379 ###
[0m
> redis-cli --cluster rebalance 172.31.5.239:6379 --cluster-use-empty-masters | grep -i Rebalancing
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 165110 keys | 3276 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 1366777 keys | 3276 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 1009104 keys | 3278 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 1915083 keys | 3276 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 376231 keys | 3278 slots | 0 slaves.
[OK] 4832305 keys in 5 masters.
294.94 keys per slot on average.
 
total slots: 16384
>>> Rebalancing across 5 nodes. Total weight = 5.00



[34m******* resize , 5 completed ******* [0m 

------------------------------------------------------------------

[34m******* write , 500000 *******[0m

[33m### WRITING 500000 KEYS ###
[0m
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 265067 keys | 3276 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 1466704 keys | 3276 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 1109147 keys | 3278 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 2015144 keys | 3276 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 476243 keys | 3278 slots | 0 slaves.
[OK] 5332305 keys in 5 masters.
325.46 keys per slot on average.
 
total slots: 16384
0.5M keys written successfully

[34m******* write , 500000 completed ******* [0m 

------------------------------------------------------------------

[34m******* resize , 4 *******[0m

{ clusterSize: 5 }
[33m### REBALANCING CLUSTER ON 172.31.5.178:6379 ###
[0m
> redis-cli --cluster rebalance 172.31.5.178:6379 --cluster-use-empty-masters | grep -i Rebalancing
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 265067 keys | 3276 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 1466704 keys | 3276 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 1109147 keys | 3278 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 2015144 keys | 3276 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 476243 keys | 3278 slots | 0 slaves.
[OK] 5332305 keys in 5 masters.
325.46 keys per slot on average.
 
total slots: 16384
*** No rebalancing needed! All nodes are within the 2.00% threshold.


{ distribution: [ 820, 820, 819, 819 ] }
[33m### RESHARDING FROM 172.31.5.178 TO 172.31.5.88 ###
[0m
{ reshardFrom: '172.31.5.178', reshardTo: '172.31.5.88', slots: 820 }
> redis-cli --cluster reshard 172.31.5.178:6379 --cluster-from 963958096c34d9596c9452b07253481eee2f9f00 --cluster-to 8b8944dfa3d8f1ff2204dc3aa335b19256357fe0 --cluster-slots 820 --cluster-yes | grep Ready
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 752203 keys | 4096 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 1466704 keys | 3276 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 622011 keys | 2458 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 2015144 keys | 3276 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 476243 keys | 3278 slots | 0 slaves.
[OK] 5332305 keys in 5 masters.
325.46 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.178 TO 172.31.5.177 ###
[0m
{ reshardFrom: '172.31.5.178', reshardTo: '172.31.5.177', slots: 820 }
> redis-cli --cluster reshard 172.31.5.178:6379 --cluster-from 963958096c34d9596c9452b07253481eee2f9f00 --cluster-to e5fb4afd51fdf082ef6d5eee77b9c8ff3ba46aca --cluster-slots 820 --cluster-yes | grep Ready
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 752203 keys | 4096 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 1658722 keys | 4096 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 429993 keys | 1638 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 2015144 keys | 3276 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 476243 keys | 3278 slots | 0 slaves.
[OK] 5332305 keys in 5 masters.
325.46 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.178 TO 172.31.5.45 ###
[0m
{ reshardFrom: '172.31.5.178', reshardTo: '172.31.5.45', slots: 819 }
> redis-cli --cluster reshard 172.31.5.178:6379 --cluster-from 963958096c34d9596c9452b07253481eee2f9f00 --cluster-to 0e4742121d492415d1f0d097c9691101d6eb8194 --cluster-slots 819 --cluster-yes | grep Ready
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 752203 keys | 4096 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 1658722 keys | 4096 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 162437 keys | 819 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 2282700 keys | 4095 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 476243 keys | 3278 slots | 0 slaves.
[OK] 5332305 keys in 5 masters.
325.46 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.178 TO 172.31.5.239 ###
[0m
{ reshardFrom: '172.31.5.178', reshardTo: '172.31.5.239', slots: 819 }
> redis-cli --cluster reshard 172.31.5.178:6379 --cluster-from 963958096c34d9596c9452b07253481eee2f9f00 --cluster-to 6b7779abdc16827d8fd3a0b04a2068ca4fe5c585 --cluster-slots 819 --cluster-yes | grep Ready
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 752203 keys | 4096 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 1658722 keys | 4096 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 2282700 keys | 4095 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 638680 keys | 4097 slots | 1 slaves.
[OK] 5332305 keys in 4 masters.
325.46 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### REMOVING 172.31.5.178:6379 FROM CLUSTER ###
[0m
> redis-cli --cluster del-node 172.31.5.178:6379 963958096c34d9596c9452b07253481eee2f9f00
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 752203 keys | 4096 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 1658722 keys | 4096 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 2282700 keys | 4095 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 638680 keys | 4097 slots | 0 slaves.
[OK] 5332305 keys in 4 masters.
325.46 keys per slot on average.
 
total slots: 16384
Removing node 963958096c34d9596c9452b07253481eee2f9f00 from cluster 172.31.5.178:6379
Sending CLUSTER FORGET messages to the cluster...
Sending CLUSTER RESET SOFT to the deleted node.
[33m### REBALANCING CLUSTER ON 172.31.5.88:6379 ###
[0m
> redis-cli --cluster rebalance 172.31.5.88:6379 --cluster-use-empty-masters | grep -i Rebalancing
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 752203 keys | 4096 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 1658722 keys | 4096 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 2282700 keys | 4095 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 638680 keys | 4097 slots | 0 slaves.
[OK] 5332305 keys in 4 masters.
325.46 keys per slot on average.
 
total slots: 16384
*** No rebalancing needed! All nodes are within the 2.00% threshold.


waiting... 65 64 63 62 61 60 59 58 57 56 55 54 53 52 51 50 49 48 47 46 45 44 43 42 41 40 39 38 37 36 35 34 33 32 31 30 29 28 27 26 25 24 23 22 21 20 19 18 17 16 15 14 13 12 11 10 9 8 7 6 5 4 3 2 1 



[34m******* resize , 4 completed ******* [0m 

------------------------------------------------------------------

[34m******* write , 500000 *******[0m

[33m### WRITING 500000 KEYS ###
[0m
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 877152 keys | 4096 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 1783780 keys | 4096 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 2407678 keys | 4095 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 763695 keys | 4097 slots | 0 slaves.
[OK] 5832305 keys in 4 masters.
355.98 keys per slot on average.
 
total slots: 16384
0.5M keys written successfully

[34m******* write , 500000 completed ******* [0m 

------------------------------------------------------------------

[34m******* resize , 3 *******[0m

{ clusterSize: 4 }
[33m### REBALANCING CLUSTER ON 172.31.5.239:6379 ###
[0m
> redis-cli --cluster rebalance 172.31.5.239:6379 --cluster-use-empty-masters | grep -i Rebalancing
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 877152 keys | 4096 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 1783780 keys | 4096 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 2407678 keys | 4095 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 763695 keys | 4097 slots | 0 slaves.
[OK] 5832305 keys in 4 masters.
355.98 keys per slot on average.
 
total slots: 16384
*** No rebalancing needed! All nodes are within the 2.00% threshold.


{ distribution: [ 1366, 1366, 1365 ] }
[33m### RESHARDING FROM 172.31.5.239 TO 172.31.5.88 ###
[0m
{ reshardFrom: '172.31.5.239', reshardTo: '172.31.5.88', slots: 1366 }
> redis-cli --cluster reshard 172.31.5.239:6379 --cluster-from 6b7779abdc16827d8fd3a0b04a2068ca4fe5c585 --cluster-to 8b8944dfa3d8f1ff2204dc3aa335b19256357fe0 --cluster-slots 1366 --cluster-yes | grep Ready
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 1077139 keys | 5462 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 1783780 keys | 4096 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 2407678 keys | 4095 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 563708 keys | 2731 slots | 0 slaves.
[OK] 5832305 keys in 4 masters.
355.98 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.239 TO 172.31.5.177 ###
[0m
{ reshardFrom: '172.31.5.239', reshardTo: '172.31.5.177', slots: 1366 }
> redis-cli --cluster reshard 172.31.5.239:6379 --cluster-from 6b7779abdc16827d8fd3a0b04a2068ca4fe5c585 --cluster-to e5fb4afd51fdf082ef6d5eee77b9c8ff3ba46aca --cluster-slots 1366 --cluster-yes | grep Ready
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 1077139 keys | 5462 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 2041268 keys | 5462 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 2407678 keys | 4095 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 306220 keys | 1365 slots | 0 slaves.
[OK] 5832305 keys in 4 masters.
355.98 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### RESHARDING FROM 172.31.5.239 TO 172.31.5.45 ###
[0m
{ reshardFrom: '172.31.5.239', reshardTo: '172.31.5.45', slots: 1365 }
> redis-cli --cluster reshard 172.31.5.239:6379 --cluster-from 6b7779abdc16827d8fd3a0b04a2068ca4fe5c585 --cluster-to 0e4742121d492415d1f0d097c9691101d6eb8194 --cluster-slots 1365 --cluster-yes | grep Ready
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 1077139 keys | 5462 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 2041268 keys | 5462 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 2713898 keys | 5460 slots | 1 slaves.
[OK] 5832305 keys in 3 masters.
355.98 keys per slot on average.
 
total slots: 16384
resharded successfully!
waiting... 2 1 


[33m### REMOVING 172.31.5.239:6379 FROM CLUSTER ###
[0m
> redis-cli --cluster del-node 172.31.5.239:6379 6b7779abdc16827d8fd3a0b04a2068ca4fe5c585
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 1077139 keys | 5462 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 2041268 keys | 5462 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 2713898 keys | 5460 slots | 0 slaves.
[OK] 5832305 keys in 3 masters.
355.98 keys per slot on average.
 
total slots: 16384
Removing node 6b7779abdc16827d8fd3a0b04a2068ca4fe5c585 from cluster 172.31.5.239:6379
Sending CLUSTER FORGET messages to the cluster...
Sending CLUSTER RESET SOFT to the deleted node.
[33m### REBALANCING CLUSTER ON 172.31.5.88:6379 ###
[0m
> redis-cli --cluster rebalance 172.31.5.88:6379 --cluster-use-empty-masters | grep -i Rebalancing
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 1077139 keys | 5462 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 2041268 keys | 5462 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 2713898 keys | 5460 slots | 0 slaves.
[OK] 5832305 keys in 3 masters.
355.98 keys per slot on average.
 
total slots: 16384
*** No rebalancing needed! All nodes are within the 2.00% threshold.


waiting... 65 64 63 62 61 60 59 58 57 56 55 54 53 52 51 50 49 48 47 46 45 44 43 42 41 40 39 38 37 36 35 34 33 32 31 30 29 28 27 26 25 24 23 22 21 20 19 18 17 16 15 14 13 12 11 10 9 8 7 6 5 4 3 2 1 



[34m******* resize , 3 completed ******* [0m 

------------------------------------------------------------------

[34m******* write , 500000 *******[0m

[33m### WRITING 500000 KEYS ###
[0m
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 1243831 keys | 5462 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 2207970 keys | 5462 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 2880504 keys | 5460 slots | 0 slaves.
[OK] 6332305 keys in 3 masters.
386.49 keys per slot on average.
 
total slots: 16384
0.5M keys written successfully

[34m******* write , 500000 completed ******* [0m 

------------------------------------------------------------------

[34m******* resize , 4 *******[0m

{ clusterSize: 3 }
[33m### ADDING 172.31.5.239:6379 NODE TO CLUSTER ###
[0m
> redis-cli --cluster add-node 172.31.5.239:6379 172.31.5.88:6379 | awk '{ gsub(/[[0-9;]*m/, ""); print }'
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 1243831 keys | 5462 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 2207970 keys | 5462 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 2880504 keys | 5460 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 0 keys | 0 slots | 0 slaves.
[OK] 6332305 keys in 4 masters.
386.49 keys per slot on average.
 
total slots: 16384
node added successfully
waiting... 2 1 


waiting... 10 9 8 7 6 5 4 3 2 1 


[33m### REBALANCING CLUSTER ON 172.31.5.239:6379 ###
[0m
> redis-cli --cluster rebalance 172.31.5.239:6379 --cluster-use-empty-masters | grep -i Rebalancing
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 1002153 keys | 4096 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 1908827 keys | 4096 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 2408915 keys | 4096 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 1012410 keys | 4096 slots | 0 slaves.
[OK] 6332305 keys in 4 masters.
386.49 keys per slot on average.
 
total slots: 16384
>>> Rebalancing across 4 nodes. Total weight = 4.00



[34m******* resize , 4 completed ******* [0m 

------------------------------------------------------------------

[34m******* write , 500000 *******[0m

[33m### WRITING 500000 KEYS ###
[0m
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 1127240 keys | 4096 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 2033750 keys | 4096 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 2533910 keys | 4096 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 1137405 keys | 4096 slots | 0 slaves.
[OK] 6832305 keys in 4 masters.
417.01 keys per slot on average.
 
total slots: 16384
0.5M keys written successfully

[34m******* write , 500000 completed ******* [0m 

------------------------------------------------------------------

[34m******* resize , 5 *******[0m

{ clusterSize: 4 }
[33m### ADDING 172.31.5.178:6379 NODE TO CLUSTER ###
[0m
> redis-cli --cluster add-node 172.31.5.178:6379 172.31.5.88:6379 | awk '{ gsub(/[[0-9;]*m/, ""); print }'
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 1127240 keys | 4096 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 2033750 keys | 4096 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 2533910 keys | 4096 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 1137405 keys | 4096 slots | 0 slaves.
[OK] 6832305 keys in 5 masters.
417.01 keys per slot on average.
 
total slots: 16384
node added successfully
waiting... 2 1 


waiting... 10 9 8 7 6 5 4 3 2 1 


[33m### REBALANCING CLUSTER ON 172.31.5.178:6379 ###
[0m
> redis-cli --cluster rebalance 172.31.5.178:6379 --cluster-use-empty-masters | grep -i Rebalancing
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 565069 keys | 3276 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 1766596 keys | 3276 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 1169874 keys | 3280 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 2333268 keys | 3276 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 997498 keys | 3276 slots | 0 slaves.
[OK] 6832305 keys in 5 masters.
417.01 keys per slot on average.
 
total slots: 16384
>>> Rebalancing across 5 nodes. Total weight = 5.00



[34m******* resize , 5 completed ******* [0m 

------------------------------------------------------------------

[34m******* write , 500000 *******[0m

[33m### WRITING 500000 KEYS ###
[0m
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 665031 keys | 3276 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 1866502 keys | 3276 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 1269927 keys | 3280 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 2433273 keys | 3276 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 1097572 keys | 3276 slots | 0 slaves.
[OK] 7332305 keys in 5 masters.
447.53 keys per slot on average.
 
total slots: 16384
0.5M keys written successfully

[34m******* write , 500000 completed ******* [0m 

------------------------------------------------------------------

[34m******* resize , 6 *******[0m

{ clusterSize: 5 }
[33m### ADDING 172.31.5.86:6379 NODE TO CLUSTER ###
[0m
> redis-cli --cluster add-node 172.31.5.86:6379 172.31.5.88:6379 | awk '{ gsub(/[[0-9;]*m/, ""); print }'
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 665031 keys | 3276 slots | 0 slaves.
172.31.5.86:6379 (3aac5767...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 1866502 keys | 3276 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 1269927 keys | 3280 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 2433273 keys | 3276 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 1097572 keys | 3276 slots | 0 slaves.
[OK] 7332305 keys in 6 masters.
447.53 keys per slot on average.
 
total slots: 16384
node added successfully
waiting... 2 1 


waiting... 10 9 8 7 6 5 4 3 2 1 


[33m### REBALANCING CLUSTER ON 172.31.5.86:6379 ###
[0m
> redis-cli --cluster rebalance 172.31.5.86:6379 --cluster-use-empty-masters | grep -i Rebalancing
assertion error.
 {
  keys1: 7332305,
  keys2: 6667274,
  keys: 0,
  slots1: 16384,
  slots2: 16384,
  nodes1: 6,
  nodes2: 6,
  nodes: 0
}
precheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 665031 keys | 3276 slots | 0 slaves.
172.31.5.86:6379 (3aac5767...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 1866502 keys | 3276 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 1269927 keys | 3280 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 2433273 keys | 3276 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 1097572 keys | 3276 slots | 0 slaves.
[OK] 7332305 keys in 6 masters.
447.53 keys per slot on average.

postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 0 keys | 2730 slots | 0 slaves.
172.31.5.86:6379 (3aac5767...) -> 856462 keys | 2734 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 1496455 keys | 2730 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 1169572 keys | 2730 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 2207334 keys | 2730 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 937451 keys | 2730 slots | 0 slaves.
[OK] 6667274 keys in 6 masters.
406.94 keys per slot on average.
 
total slots: 16384
>>> Rebalancing across 6 nodes. Total weight = 6.00



[34m******* resize , 6 completed ******* [0m 

------------------------------------------------------------------

[34m******* write , 500000 *******[0m

[33m### WRITING 500000 KEYS ###
[0m
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 83406 keys | 2730 slots | 0 slaves.
172.31.5.86:6379 (3aac5767...) -> 939631 keys | 2734 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 1579792 keys | 2730 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 1252979 keys | 2730 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 2290637 keys | 2730 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 1020829 keys | 2730 slots | 0 slaves.
[OK] 7167274 keys in 6 masters.
437.46 keys per slot on average.
 
total slots: 16384
0.5M keys written successfully

[34m******* write , 500000 completed ******* [0m 

------------------------------------------------------------------

[34m******* resize , 7 *******[0m

{ clusterSize: 6 }
[33m### ADDING 172.31.5.10:6379 NODE TO CLUSTER ###
[0m
> redis-cli --cluster add-node 172.31.5.10:6379 172.31.5.88:6379 | awk '{ gsub(/[[0-9;]*m/, ""); print }'
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 83406 keys | 2730 slots | 0 slaves.
172.31.5.86:6379 (3aac5767...) -> 939631 keys | 2734 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 1579792 keys | 2730 slots | 0 slaves.
172.31.5.10:6379 (88c7571b...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 1252979 keys | 2730 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 2290637 keys | 2730 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 1020829 keys | 2730 slots | 0 slaves.
[OK] 7167274 keys in 7 masters.
437.46 keys per slot on average.
 
total slots: 16384
node added successfully
waiting... 2 1 


waiting... 10 9 8 7 6 5 4 3 2 1 


[33m### REBALANCING CLUSTER ON 172.31.5.10:6379 ###
[0m
> redis-cli --cluster rebalance 172.31.5.10:6379 --cluster-use-empty-masters | grep -i Rebalancing
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 71406 keys | 2340 slots | 0 slaves.
172.31.5.86:6379 (3aac5767...) -> 855827 keys | 2340 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 1436422 keys | 2340 slots | 0 slaves.
172.31.5.10:6379 (88c7571b...) -> 689057 keys | 2344 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 1078186 keys | 2340 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 2141698 keys | 2340 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 894678 keys | 2340 slots | 0 slaves.
[OK] 7167274 keys in 7 masters.
437.46 keys per slot on average.
 
total slots: 16384
>>> Rebalancing across 7 nodes. Total weight = 7.00



[34m******* resize , 7 completed ******* [0m 

------------------------------------------------------------------

[34m******* write , 500000 *******[0m

[33m### WRITING 500000 KEYS ###
[0m
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 142845 keys | 2340 slots | 0 slaves.
172.31.5.86:6379 (3aac5767...) -> 927419 keys | 2340 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 1507903 keys | 2340 slots | 0 slaves.
172.31.5.10:6379 (88c7571b...) -> 760303 keys | 2344 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 1149622 keys | 2340 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 2213198 keys | 2340 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 965984 keys | 2340 slots | 0 slaves.
[OK] 7667274 keys in 7 masters.
467.97 keys per slot on average.
 
total slots: 16384
0.5M keys written successfully

[34m******* write , 500000 completed ******* [0m 

------------------------------------------------------------------

[34m******* resize , 8 *******[0m

{ clusterSize: 7 }
[33m### ADDING 172.31.5.50:6379 NODE TO CLUSTER ###
[0m
> redis-cli --cluster add-node 172.31.5.50:6379 172.31.5.88:6379 | awk '{ gsub(/[[0-9;]*m/, ""); print }'
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 142845 keys | 2340 slots | 0 slaves.
172.31.5.86:6379 (3aac5767...) -> 927419 keys | 2340 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 1507903 keys | 2340 slots | 0 slaves.
172.31.5.10:6379 (88c7571b...) -> 760303 keys | 2344 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 1149622 keys | 2340 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 2213198 keys | 2340 slots | 0 slaves.
172.31.5.50:6379 (90d55335...) -> 0 keys | 0 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 965984 keys | 2340 slots | 0 slaves.
[OK] 7667274 keys in 8 masters.
467.97 keys per slot on average.
 
total slots: 16384
node added successfully
waiting... 2 1 


waiting... 10 9 8 7 6 5 4 3 2 1 


[33m### REBALANCING CLUSTER ON 172.31.5.50:6379 ###
[0m
> redis-cli --cluster rebalance 172.31.5.50:6379 --cluster-use-empty-masters | grep -i Rebalancing
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 125014 keys | 2048 slots | 0 slaves.
172.31.5.86:6379 (3aac5767...) -> 842359 keys | 2048 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 1249841 keys | 2048 slots | 0 slaves.
172.31.5.10:6379 (88c7571b...) -> 688210 keys | 2048 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 891009 keys | 2048 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 1937544 keys | 2048 slots | 0 slaves.
172.31.5.50:6379 (90d55335...) -> 1063221 keys | 2048 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 870076 keys | 2048 slots | 0 slaves.
[OK] 7667274 keys in 8 masters.
467.97 keys per slot on average.
 
total slots: 16384
>>> Rebalancing across 8 nodes. Total weight = 8.00



[34m******* resize , 8 completed ******* [0m 

------------------------------------------------------------------

[34m******* write , 500000 *******[0m

[33m### WRITING 500000 KEYS ###
[0m
assertion success.
postcheck: 
 [33m### CHECK NODE 172.31.5.88:6379 ###
[0m172.31.5.88:6379 (8b8944df...) -> 187542 keys | 2048 slots | 0 slaves.
172.31.5.86:6379 (3aac5767...) -> 904784 keys | 2048 slots | 0 slaves.
172.31.5.177:6379 (e5fb4afd...) -> 1312301 keys | 2048 slots | 0 slaves.
172.31.5.10:6379 (88c7571b...) -> 750783 keys | 2048 slots | 0 slaves.
172.31.5.178:6379 (96395809...) -> 953540 keys | 2048 slots | 0 slaves.
172.31.5.45:6379 (0e474212...) -> 2000069 keys | 2048 slots | 0 slaves.
172.31.5.50:6379 (90d55335...) -> 1125731 keys | 2048 slots | 0 slaves.
172.31.5.239:6379 (6b7779ab...) -> 932524 keys | 2048 slots | 0 slaves.
[OK] 8167274 keys in 8 masters.
498.49 keys per slot on average.
 
total slots: 16384
0.5M keys written successfully

[34m******* write , 500000 completed ******* [0m 

Time Taken: 31373.263 seconds...

---DONE---
